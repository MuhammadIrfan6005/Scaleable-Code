<!DOCTYPE html>
<html lang="en">

<head>
</head>

<body style="width: 100%;">

</body>
<script>


    $(window).load(function () {
        //By Default hide both of the fields racial and gender categories field
        $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").hide();
        $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").hide();

        //by default hide all members fileds
        $("#rfdi_racial_leadership_member").closest("td").find("div.control, div.info").hide();
        $("#rfdi_racial_board_member").closest("td").find("div.control, div.info").hide();
        $("#rfdi_gender_leadership_member").closest("td").find("div.control, div.info").hide();
        $("#rfdi_gender_board_member").closest("td").find("div.control, div.info").hide();

        //Function call when click on "first create member"

        var last_member_name = parent.window.$(".table-fluid").eq(0).find("tbody").find('tr:last').children('td:first').text();
        var myArray = [];
        var activelist_racial = window.parent.$('.list-group-item').eq(2);
        var activelist_gender = window.parent.$('.list-group-item').eq(3);

        if (last_member_name == "") {
            if (activelist_racial.hasClass('active')) {
                // add class to the hyperlink at the same index
                console.log("activelist racial leader is empty");
                $("#rfdi_racial_leadership_member").val("Member 1");
            }
            else if (activelist_gender.hasClass('active')) {
                console.log("activelist gender leader is empty");
                $("#rfdi_gender_leadership_member").val("Member 1");
            }
        }
        else {
            myArray = last_member_name.split(" ");
            var lastnum = Number(myArray[1]);
            lastnum = lastnum + 1;

            var newMember = 'Member ' + lastnum;
            console.log("newMember");

            if (activelist_racial.hasClass('active')) {
                // add class to the hyperlink at the same index
                console.log("activelist is racial leader");
                $("#rfdi_racial_leadership_member").val(newMember);
            }
            else if (activelist_gender.hasClass('active')) {
                console.log("activelist is gender leader");
                $("#rfdi_gender_leadership_member").val(newMember);
            }
        }


        // //for racial board member
        var last_member_name = parent.window.$(".table-fluid").eq(1).find("tbody").find('tr:last').children('td:first').text();
        var myArray = [];
        var activelist_racial = window.parent.$('.list-group-item').eq(2);
        var activelist_gender = window.parent.$('.list-group-item').eq(3);

        if (last_member_name == "") {
            if (activelist_racial.hasClass('active')) {
                // add class to the hyperlink at the same index
                console.log("activelist racial leader is empty");
                $("#rfdi_racial_board_member").val("Member 1");
            }
            else if (activelist_gender.hasClass('active')) {
                console.log("activelist gender leader is empty");
                $("#rfdi_gender_board_member").val("Member 1");
            }
        }
        else {
            myArray = last_member_name.split(" ");
            var lastnum = Number(myArray[1]);
            lastnum = lastnum + 1;

            var newMember = 'Member ' + lastnum;

            if (activelist_racial.hasClass('active')) {
                // add class to the hyperlink at the same index
                console.log("activelist is racial board");
                $("#rfdi_racial_board_member").val(newMember);
            }
            else if (activelist_gender.hasClass('active')) {
                console.log("activelist is gender board");
                $("#rfdi_gender_board_member").val(newMember);
            }
        }

        //Set value into lookup column "Current Survey"
        var GuidClass = window.parent.document.getElementsByClassName("entity-grid")[0];
        var SurveyGuid = GuidClass.getAttribute("data-ref-id");
        console.log("Guid " + SurveyGuid);

        var Surveyname = window.parent.$("td[data-attribute='rfdi_redi_survey_members']").eq(1).text();
        alert("survey is " + Surveyname);
        if (Surveyname = "") {
            alert("survey is empty");
            Surveyname = window.parent.$("td[data-attribute='rfdi_redi_survey_members']").eq(0).text();
        }
        console.log("Surveyname" + Surveyname);

        var entityname = "rfdi_redisurvey";
        console.log("entityname" + entityname);

        $("#rfdi_redi_survey_members").attr("value", SurveyGuid);

        $("#rfdi_redi_survey_members_name").attr("value", Surveyname );

        //Survey = entity name
        $("#rfdi_redi_survey_members_entityname").attr("value", entityname);

        // $("#rfdi_member_type option[value='1']").attr('selected', true);  
        // $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").hide();
        // $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").show();
        $("#rfdi_member_type").change(function () { FieldChanged(); });
    });

    function FieldChanged() {
        var selectedValue = $("#rfdi_member_type").find("option:selected").text();
        if (selectedValue == "Racial Leadership") {
            $("#rfdi_racial_leadership_member").closest("td").find("div.control, div.info").show();
            $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").hide();
            $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").show();

        }
        else if (selectedValue == "Racial Board") {
            $("#rfdi_racial_board_member").closest("td").find("div.control, div.info").show();
            $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").hide();
            $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").show();
        }
        else if (selectedValue == "Gender Leadership") {
            $("#rfdi_gender_leadership_member").closest("td").find("div.control, div.info").show();
            $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").hide();
            $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").show();

        }
        else if (selectedValue == "Gender Board") {
            $("#rfdi_gender_board_member").closest("td").find("div.control, div.info").show();
            $("#rfdi_racial_identity_categories").closest("td").find("div.control, div.info").hide();
            $("#rfdi_gender_identity_cetegories").closest("td").find("div.control, div.info").show();

        }
    }
</script>

</html>