<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" crossorigin="anonymous"></script>
    <script src="bbo_SDK.REST.js"></script>
    <script src="new_FileSaver"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js" crossorigin="anonymous"></script>
    <script src="../WebResources/ss_contractdocumentjs"></script>
    <style>
        table {
            font-size: 12px;
            height: 100%;
            min-height: 100%;
            width: 100%;
            overflow-y: hidden;

        }

        .fileLink {
            color: blue;

        }

        .btn-outline-info:hover {
            background-color: white !important;
            color: rgb(19, 166, 224) !important;
            border-color: rgb(19, 166, 224) !important;
        }

        table#mainTbl {

            padding-bottom: 55px !important;
            display: table !important;
        }

        table#mainTbl1 {

            padding-bottom: 55px !important;
            display: table !important;
        }

        table.removetable {
            padding-bottom: 25px !important;
        }

        .createmode {
            display: none;
            color: grey;
            vertical-align: center;
        }

        .statusRadioBtn {
            float: left;
        }

        a {
            color: black;
        }

        .modifyStatus {
            font-size: 10px;
            height: 0px;
            float: auto;
            padding: 8px;
        }

        span {
            font-size: 11px;
        }

        .statusVal {

            margin-top: 3px !important;


            float: left;
        }

        #mainTblDiv {
            padding-top: 5px;
            padding-bottom: 70px;
            /* overflow-x: hidden; */
        }

        #mainTblDiv1 {
            padding-top: 5px;
            padding-bottom: 70px;
            overflow-x: hidden;
        }

        .dropdownPosition {
            border: 2px solid lightblue;
            padding: 2px;
            float: right;
            z-index: 5000;
            margin: -50px -79px 50px 79px;
            width: 122px !important;
            min-width: 122px !important;
        }

        .selectedData {
            float: left;
            margin-left: 5px;


        }

        .goliveproduct {
            height: 16px;
            width: 17%;
            border-style: none;
        }

        .dropdownProductsPosition {
            border: 2px solid lightblue;
            padding: 2px;
            float: right;
            margin: -50px -79px 50px 79px;
            width: 122px !important;
            min-width: 122px !important;
            z-index: 5000;
        }

        table thead th {
            text-align: center;


        }

        .maektextleft {
            text-align: left;
        }

        #saveContracts {
            font-size: 10px;
            float: right;
            margin-bottom: 5px;

        }

        .Prod-and-ContractName {
            text-align: left !important;
        }

        .dropdown-menu {
            z-index: 5000;
            background-color: #F5F5F5;
        }

        #refreshData:hover {
            background-color: white;
        }

        #refreshpartnerData:hover {
            background-color: white;
        }

        #overlay {
            background: #f5f5f5;
            color: #666666;
            position: fixed;
            height: 100%;
            width: 100%;
            z-index: 5000;
            top: 0;
            left: 0;
            float: left;
            text-align: center;
            padding-top: 25%;
            opacity: .50;
        }

        .spinner {

            position: absolute;
            left: 45%;
            top: 30%;
            height: 60px;
            width: 60px;
            margin: 0px auto;
            -webkit-animation: rotation .8s infinite linear;
            -moz-animation: rotation .8s infinite linear;
            -o-animation: rotation .8s infinite linear;
            animation: rotation .8s infinite linear;
            border-left: 6px solid rgba(0, 174, 239, .15);
            border-right: 6px solid rgba(0, 174, 239, .15);
            border-bottom: 6px solid rgba(0, 174, 239, .15);
            border-top: 6px solid rgba(0, 174, 239, .8);
            border-radius: 100%;
            z-index: 5000;
        }

        @-webkit-keyframes rotation {
            from {
                -webkit-transform: rotate(0deg);
            }

            to {
                -webkit-transform: rotate(359deg);
            }
        }

        @-moz-keyframes rotation {
            from {
                -moz-transform: rotate(0deg);
            }

            to {
                -moz-transform: rotate(359deg);
            }
        }

        @-o-keyframes rotation {
            from {
                -o-transform: rotate(0deg);
            }

            to {
                -o-transform: rotate(359deg);
            }
        }

        @keyframes rotation {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(359deg);
            }
        }

        .menu-btn {
            border-radius: 48px;
            border: 0.5px solid lightgrey;
            font-size: 0.9em;
            padding: 2px 10px;
            background-color: white;
        }

        .menu {
            padding-top: 10px;
            z-index: 200;
            margin-top: 4px;
            background-color: white;
            position: absolute;
            display: block;
        }

        .menu-option {
            padding: 6px 20px 6px;

        }

        #overlay {
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
            z-index: 100;
        }

        #products {
            padding: 0px 20px 0px 20px;
            background-color: rgb(240, 242, 246);
            border-radius: 3px;
        }

        .middle {
            text-align: center;
        }

        .multiselect {
            width: 200px;
        }

        .selectBox {
            position: relative;
        }

        .selectBox select {
            width: 100%;
            font-weight: bold;
        }

        .overSelect {
            position: absolute;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
        }

        #productsegmentcheckboxes {
            display: none;
            border: 1px #dadada solid;
        }

        #productcheckboxes {
            display: none;
            border: 1px #dadada solid;
        }

        #productsegmentcheckboxes label {
            display: block;
        }

        #productcheckboxes label {
            display: block;
        }

        #productsegmentcheckboxes label:hover {
            background-color: #1e90ff;
        }

        #productcheckboxes label:hover {
            background-color: #1e90ff;
        }

        .centerclass {
            /* justify-content: center; */
            display: flex;
            align-items: center;
            float: left;
            margin-left: 25px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked+.slider {
            background-color: #2196F3;
        }

        input:focus+.slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked+.slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }

        /* Rounded sliders */
        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }
        /* irf: hide the increseID by default */
        /* .increasesTD {
          display: none;
        } */
        /* .design {
            float: left;
        } */
    </style>
<meta></head>

<body style="overflow-wrap: break-word;" onfocusout="parent.setEmailRange();">
    <div style="margin-left: 20px;">
        <h4><b><select class="form-select" id="products">
                    <option selected="" value="0"> -- select an option -- </option>
                    <option value="1">Product Segment</option>
                    <option value="2">Products</option>
                </select></b></h4>
    </div>
    <div class="row" id="filtersrow" style="display: none">
        <table>
            <tbody>
                <tr>
                    <th>
                        <div class="container centerclass" id="productsegmentdropdown">
                            <div class="multiselect">
                                <div class="selectBox" onclick="showprodcutsegmentCheckboxes()">
                                    <select>
                                        <option>Select an option</option>
                                    </select>
                                    <div class="overSelect"></div>
                                </div>
                                <div id="productsegmentcheckboxes">
                                    <label for="one">
                                        <input type="checkbox" value="1">IR Cockpit</label><br>
                                    <label for="two">
                                        <input type="checkbox" value="2">IR Products</label><br>
                                    <label for="three">
                                        <input type="checkbox" value="3">Compliance Cockpit</label><br>
                                    <label for="four">
                                        <input type="checkbox" value="4">Compliance Product</label>
                                </div>
                                <!--  -->
                            </div>
                            <button class="btn btn-primary btn-sm " id="productsegmentsearch">Search</button>
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
    </div>
    <div class="container-fluid">
        <div class="row" style="width: fit-content;">
            <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 col-xl-12" id="mainTblDiv">
                <button class="btn btn-success btn-sm" id="saveContracts">Save <i class="fa fa-envelope-square fa-lg" style="float: left;padding: 2px 7px 0px 0px;"></i></button>
                <table class="table table-bordered table-responsive  text-center border border-0" id="mainTbl">
                    <thead class="table-info">
                        <tr>
                            <!-- irf: remove "contract price increse" column and rename "Current year price increse to 'increse type'" -->
                            <th></th>
                            <th>Opportunity Name</th>
                            <th>Product Segment</th>
                            <th>Product</th>
                            <th>Total ARR</th>
                            <th>Actual License Fee (BC)</th>
                            <th class="Prod-and-ContractName">Contract Name</th>
                            <th>Contract Number</th>
                            <th>Revision Number</th>
                            <!-- <th id="cypi">Increase Type</th>
                            <th>Current Increase in %</th>
                            <th>Next Allowed Increase Date</th> -->
                            <th>Cross-Sell</th>
                            <th>Contract Start Date</th>
                            <th>Opportunity Owner</th>
                            <th>Contract Owner</th>
                            <th>Termination Period</th>
                            <th>End of Contract</th>
                            <th>BC End of Contract</th>
                            <th>Auto-renewal</th>
                            <th>Contract Status</th>
                            <th style="width: 5%;">Contract Termination</th>
                            <th id="cancelledatdate" style="display: none; ">Cancelled at Date</th>
                            <th id="cancelledtodate" style="display: none;">Contract Expiry Date</th>
                            <th id="cancelreason" style="display: none; width: 10%;">Reason</th>
                            <th id="refreshData" onclick="loadData()">
                                <a href="#">
                                    <span class="glyphicon glyphicon-repeat" style="padding: 0px 5px 0px 5px;"></span>
                                </a>
                            </th>
                        </tr>

                    </thead>
                    <tbody id="contractDetailsTblBody">
                    </tbody>

                </table>

                <div id="overlay" class="loader">
                    <div class="spinner loader"></div>
                </div>
            </div>
            <p class="createmode">To enable this content create record first!</p>
        </div>

    </div>
    <!-- <div class="container-fluid">
        <div class="row">
            <div class="col-md-12 col-sm-12" id="mainTblDiv1">
                <table class="table table-bordered table-responsive  text-center border border-0" id="mainTbl1">
                    <thead class="table-info">
                        <tr>
                            <th style="width:30%;" class="Prod-and-ContractName">Partner Contract</th>
                            <th>Created On</th>
                            <th>Contract Owner</th>
                            <th id="refreshpartnerData" onclick="loadData()">
                                <a href="#">
                                    <span class="glyphicon glyphicon-repeat" style="padding: 0px 5px 0px 5px;"></span>
                                </a>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="partnercontractDetailsTblBody">
                    </tbody>

                </table>

                <div id="overlay" class="loader">
                    <div class="spinner loader"></div>
                </div>
            </div>
            <p class="createmode">To enable this content create record first!</p>
        </div>
    </div> -->
    <script>

        // $(document).ready(function () {
        //     GetPartnerContractDetails();
        // });
        // function loadData() {
        //         setTimeout(function () {
        //             location.reload(true);
        //         }, 1000);

        //         }
        // function GetPartnerContractDetails() {
        //     //$("#mainTbl1 tbody>tr").remove();
        //     console.log("In Parnter Table");
        //     var tablerow = "";
        //     var accountid = window.parent.Xrm.Page.data.entity.getId();
        //     if (accountid) {
        //         //============================
        //         var fetchXML2 = `<fetch version="1.0" output-format="xml-platform" mapping="logical" distinct="true" >
        //                <entity name="opportunity">
        //                     <attribute name="opportunityid" />
        //                     <attribute name="name" />
        //                      <order attribute="createdon"/>
        //                     <filter type="and">
        //                     <condition attribute="parentaccountid" operator="eq" value="`+ accountid + `" />
        //                     </filter>
        //                     <link-entity name="annotation" from="objectid" to="opportunityid" link-type="inner" alias="ano" >
        //                             <attribute name="objectid" distinct="true"/>
        //                             <attribute name="annotationid" />
        //                             <attribute name="createdon" />
        //                             <attribute name="filename" />
        //                             <attribute name="ownerid" />
        //                             <attribute name="notetext" />
        //                             <attribute name="subject" />
        //                             <order attribute="createdon" descending="true"/>
        //                     <filter type="and">
        //                         <condition attribute="notetext" operator="like" value="%{{Partner--%" />
        //                     </filter>
        //                     </link-entity>
        //             </entity>
        //         </fetch>`;

        //         fetchXML2 = "?fetchXml=" + encodeURIComponent(fetchXML2);
        //         window.parent.Xrm.WebApi.online.retrieveMultipleRecords("opportunity", fetchXML2).then(
        //             function success(results) {
        //                 // alert(results.entities.length);
        //                 for (var i = 0; i < results.entities.length; i++) {

        //                     var annotationid = results.entities[i]["ano.annotationid"];
        //                     var createdOn = results.entities[i]["ano.createdon"];
        //                     if (createdOn != undefined)
        //                         createdOn = createdOn.substring(0, 10);
        //                     var filename = results.entities[i]["ano.filename"];
        //                     var notetext = results.entities[i]["ano.notetext"];

        //                     var ownerName = results.entities[i]["ano.ownerid@OData.Community.Display.V1.FormattedValue"];
        //                     var subject = results.entities[i]["ano.subject"];
        //                     tablerow += "<tr>";
        //                     tablerow += "<td><a class='fileLink' href=# onclick='getFile(\"" + annotationid + "\")'>" + filename + "</a></td>";
        //                     tablerow += "<td>" + createdOn + "</td>";
        //                     tablerow += "<td>" + ownerName + "</td>";
        //                     tablerow += "<td><button type='button' class='btn btn-danger' onclick='DeletePartnerContact(\"" + annotationid + "\")'>Delete</button></td>";
        //                     tablerow += "</tr>";
        //                 }
        //                 if (tablerow) {
        //                     $("#partnercontractDetailsTblBody").append(tablerow);
        //                 }


        //             },
        //             function (error) {
        //                 var alertStrings = { confirmButtonLabel: "Yes", text: error.message, title: "Error in loading Partner Contracts" };
        //                 var alertOptions = { height: 120, width: 260 };
        //                 parent.Xrm.Navigation.openAlertDialog(alertStrings, alertOptions);
        //             }
        //         );

        //     }

        // }
        //DeletePartnerContact
        // function DeletePartnerContact(noteId) {
        //     parent.Xrm.WebApi.online.deleteRecord("annotation", noteId).then(
        //         function success(result) {
        //             loadData();
        //         },
        //         function (error) {
        //             var alertStrings = { confirmButtonLabel: "Yes", text: error.message, title: "Error in Upload Contract" };
        //             var alertOptions = { height: 120, width: 260 };
        //             parent.Xrm.Navigation.openAlertDialog(alertStrings, alertOptions);
        //         }
        //     );
        // }
    </script>



</body></html>