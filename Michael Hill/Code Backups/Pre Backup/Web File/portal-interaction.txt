var backgroundEntityFormModel = null;
var actionRequestFormId = "c2356ca5-2048-ed11-bba2-00224892cc36";

$(document).ready(function () {
    init();
});

function createInteraction(category, payload) {
    var requestData = JSON.stringify(payload);
    var token = xomni.utils.newGuid();

    var fieldValues = [
        { "name": "ed_name", "value": token },
        { "name": "ed_category", "value": category },
        { "name": "ed_payload", "value": requestData }
    ];

    submitActionRequest(fieldValues, function (success) {
        if (!success) {
            return;
        }
    });
}

function init() {
    if (backgroundEntityFormModel == null) {
        backgroundEntityFormModel = ed.portal.backgroundEntityForm.getBackgroundEntityFormModel(
        {
            iframeContainerElementId: "bg-entityform-iframe-container"
        });
    }
}

function submitActionRequest (fieldValues, callback) {
    backgroundEntityFormModel.create(actionRequestFormId, fieldValues, function (msg) {
        callback(true);
        return;
    });
}