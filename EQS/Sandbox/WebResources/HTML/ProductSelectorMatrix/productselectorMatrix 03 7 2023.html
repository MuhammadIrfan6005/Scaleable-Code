<html><head>
    <style type="text/css">
        P {
            margin: 0;
        }
    </style>
    <meta>
    <meta>
</head>
<!-- parent.setEmailRange();  -->

<body onload="getParentDate()" onfocusout="parent.setEmailRange();" style="overflow-wrap: break-word;">

    <style>
        body {
            padding-top: 5px;
            overflow-y: scroll !important;
            overflow-x: auto;
        }

        .subtableBody {
            background: mistyrose;
        }

        .itegrityText {
            margin-right: 12px;
            float: left;
            font-size: 12px;
            font-weight: bold;
        }

        .integrityClass3 {
            margin-left: 25px;
        }

        .integrityClass {
            width: 130px;
        }

        .integrityClass2 {
            width: 50px;
        }

        .integrityClassEnd {
            float: right;
        }

        .integrityCheckbox,
        .integrityCheckbox2,
        .integrityCheckbox3 .integrityCheckbox4 {
            /* margin-top: 9px !important; */
        }

        .subfield {
            text-align: left;
            font-size: small;
            font-weight: 500;
        }

        .removetable>tbody>tr>td>input[type="text"] {
            text-align: center;
            width: 120px;
            height: 22px;
            font-size: 13px;
            font-weight: 500;
        }

        .removetable>tbody>tr>td>input[type="number"] {
            text-align: center;
            width: 50px;
            height: 22px;
            font-size: 13px;
            font-weight: 500;
        }

        .removetable>tbody>tr>.supportTd {
            text-align: center;
            width: 50px;
            height: 22px;

        }

        .removetable>tbody>tr>.additionaldetails {
            text-align: center;
            width: 50px;
            height: 22px;

        }

        .removetable>tbody>tr>.mainSupportTd {
            text-align: left;
            font-weight: bold;

        }

        /* ================= nH*/
        #Createdon {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
            background: transparent url(ss_background.png) no-repeat scroll -165px -37px;
        }

        div#scrollable_content {
            height: 100%;
            overflow-y: auto;
            width: 100%;
        }

        #Modifiedon {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        #Createdby {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        #Filename {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        /* Nh */

        #functionalArea {
            position: fixed;
            bottom: 0;
            width: 93%;
        }

        /*==========================*/
        #setupFee,
        #mlicFee,
        #licFee {
            border: none;
            border-bottom: 2px solid #e4e4e4;
            width: 120px;
            text-align: center;

        }

        #sb,
        #mlb,
        #lb {
            text-align: center;
        }

        .col-sm-2>input[type=text] {
            text-align: center;
        }

        .table-custom>thead>tr>th {
            width: 120px;
        }

        .table-custom>tbody>tr>td:nth-child(5),
        .table-custom>tbody>tr>td:nth-child(6),
        .table-custom>tbody>tr>td:nth-child(7),
        .table-custom>tbody>tr>td:nth-child(8),
        .table-custom>tbody>tr>td:nth-child(9),
        .table-custom>tbody>tr>td:nth-child(10) {
            width: 120px;
        }

        .table-custom>tbody>tr>td:nth-child(4) {
            width: 150px;
        }

        .table-custom>tbody>tr>td>input[type=text],
        .table-custom>tbody>tr>td>input[type=textarea],
        .table-custom>tbody>tr>td>input[type=date] {
            width: 120px;
        }

        /*New design*/

        #sumAmount {
            align-self: center;

        }

        #row {
            margin-left: 140px;
            align-items: center;
            width: 90%;
        }


        /*===========================*/
        #title {
            padding-right: 5px;
            width: 13px;
        }

        .table-container {
            width: auto;
            margin-left: 0;
            margin-right: auto;
            font-family: "Segoe UI", Arial, Sans-Serif;
            font-size: 12px;
        }

        .h2 {
            font-family: "Segoe UI", Arial, Sans-Serif;
            font-size: 12px;
            color: #000000;
            /* width: 200px; */
            display: inline;
        }

        .table-custom {
            border-spacing: 0;
            width: 100%;
        }

        .table-custom>thead>tr>th {
            /*border-top: 1px solid rgba(128, 128, 128, 0.21);*/
            cursor: pointer;
            text-align: center;
            padding: 5px 5px;
            border-bottom: 0px solid rgba(128, 128, 128, 0.21);
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: #080808;
            font-size: 12px;
        }


        tbody {
            height: 100px;
            overflow: auto;
        }

        .table-custom>tbody>tr>td {
            height: 25px;
            border: 2px solid white;
            padding: 5px 10px;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: #080808;
            font-size: 12px;
            font-weight: 500;
            background-color: #f3f3f3;
            text-align: center;
            /*width: 140px;*/
        }

        .table-custom>tbody>tr {
            height: 25px;
            padding-top: 3px;
            padding-left: 5px;
            /*min-width: 140px;*/
        }

        .tr_alignright {
            padding-right: 5px;
            text-align: right;
        }

        .tr_alignmiddle {
            padding: 0px;
            text-align: center;
        }

        tr.selected {
            background-color: #D7EBF9;
        }

        img.unselected {
            display: none;
        }

        #TBL_CampaignActivities th:not(:last-child) {
            border-right: 1px solid rgba(128, 128, 128, 0.21);
        }

        hr {
            display: block;
            height: 0px;
            border: 1px solid lightgray;
            margin: 1em 0;
            padding: 0;
        }

        #TBL_CampaignActivities th #headright {
            border-right: none;
        }

        .blue {
            color: #1160B7 !important;
        }

        .black {
            color: #000000 !important;
            font-weight: 500 !important;
        }

        .light-black {
            color: #000000 !important;
        }

        #rightColumn {
            border-right: none;
        }

        #plusimage {
            margin-right: 10px;
            float: right;
            background-image: url("ss_DownArrow");
            cursor: pointer;
        }

        #delete-input-btn {
            visibility: hidden;
        }

        tr:hover div#fdib #delete-input-btn {
            visibility: visible;
            float: right;
            margin-right: 25px;
        }


        .toptable {
            width: 100%;
            top: -5px;
        }

        .toptable tr {
            height: 8px;
        }

        #nonotes {
            margin-top: 10px;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        .loaderStyle {
            text-align: center;
            cursor: wait;
            background: transparent;
            font-size: 12px;
            position: absolute;
            display: none;
            left: 45%;
            top: 200px;
            width: 50px;
            height: 50px;
        }

        .loaderStyle img {
            margin-top: 10px;
            border: none;
        }

        #paging {
            height: 10px;
            float: right;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        #paging1 {
            height: 10px;
            float: right;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        #preprevious {
            background: transparent url(ss_background.png) no-repeat scroll -157px -135px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #preprevious1 {
            background: transparent url(ss_background.png) no-repeat scroll -157px -135px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #forward {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -157px -124px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #forward1 {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -95px -159px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #previous {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -167px -118px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #previous1 {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -167px -118px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        .table-custom>thead>tr>td:hover {
            background-color: #D7EBF9;
            text-decoration: underline;
            cursor: pointer;
        }

        .table-custom>tbody>tr:hover {
            background-color: #D7EBF9;
            text-decoration: underline;
            text-decoration: none;
            cursor: pointer;
        }

        .nohover {
            background-color: white !important;
        }

        #head {
            margin-bottom: 8px;
        }

        #searchtable {
            border-spacing: 0px;
            padding: 0px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        #search {
            border-right: none;
            width: 280px;
            margin-left: 5px;
        }

        #moreRecords {
            color: #005592;
            text-align: right;
            display: none;
        }

        #withoutpadding {
            padding: 0px;
            border-spacing: 0px;
        }

        #mainContainer {
            margin-bottom: 160px;
            width: 95%;
        }

        #shoppingcart {
            width: 33%;
            float: left;
        }

        #cartContainer {
            height: 450px;
            width: 100%;
            clear: both;
        }

        #cartTableContainer {
            max-height: 380px;
            overflow-x: hidden;
            overflow-y: auto;
            width: 100%;
            padding: 0px;
            margin: 0px;
            clear: both;
        }

        #cartTotals {
            width: 100%;
        }

        .input-xs {
            height: 22px;
            padding: 2px 5px;
            font-size: 12px;
            line-height: 1.5;
            width: 80%;
            margin-left: 9%;
            margin-right: 9%;
        }


        .inactive {
            display: none;
        }

        #delete-cart-btn {
            margin-bottom: 2px;
            opacity: 0.7;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        #msgDiv img {
            width: 300px;
        }

        .borderfocus {
            border-color: #D7EBF9;
        }

        .nav-tabs>li.active>a,
        .nav-tabs>li.active>a:hover {
            color: #ffffff;
            background-color: #337ab7;
            border: 0px solid #ddd;
            border-bottom-color: transparent;
            cursor: default;
        }

        .nav>li>a {
            position: relative;
            display: block;
        }

        .nav {
            display: table;
            width: 100%;
            margin: 0;
        }

        .nav-tabs>li.active>a,
        .nav-tabs>li.active>a:hover,
        .nav-tabs>li.active>a:focus {
            background-color: #337ab7;
            color: #ffffff;
            border: 0px solid #ddd;
        }

        a {
            color: #ffffff;
        }

        td.checker {
            width: 3% !important;
            background: white !important;
        }

        p.TabHeading,
        #productselector_heading1 {
            color: #337ab7;
            font-size: 25px;
            font-weight: 400;
            margin-top: 30px;
            margin-bottom: 20px;
        }

        td {
            font-size: 12px;
        }

        .kap_pak {
            text-align: center;
            width: 120px;
            height: 10px;
            font-size: 8px;
            font-weight: 500;
        }

        .contract_len {
            display: none;
        }
    </style>


    <meta charset="utf-8">
    <link rel="stylesheet" href="ss_bootstrap.min.css">
    <script src="ss_jquery"></script>
    <script src="ss_bootstrap.min.js"></script>
    <script src="ClientGlobalContext.js.aspx"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="ss_css_loader">


    <style>
        body {

            overflow-x: auto;
            background-color: #eee;
        }

        .on {
            background-color: #a7cdf0;
        }

        #Createdon {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
            background: transparent url(ss_background.png) no-repeat scroll -165px -37px;
        }

        div#scrollable_content {
            height: 100%;
            overflow-y: auto;
            width: 100%;
        }

        #Modifiedon {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        #Createdby {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        #Filename {
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }

        /*#title {
            display: inline;
            width: 10px;
            height: 14px;
            overflow: hidden;
            vertical-align: bottom;
        }*/

        #title {
            padding-right: 5px;
            width: 13px;
        }

        .table-container {
            width: auto;
            margin-left: 0;
            margin-right: auto;
            font-family: "Segoe UI", Arial, Sans-Serif;
            font-size: 12px;
        }

        .h2 {
            font-family: "Segoe UI", Arial, Sans-Serif;
            font-size: 12px;
            color: #000000;
            display: inline;
        }

        .table-custom {
            border-spacing: 0;
            width: 100%;
        }

        .contract_field {
            display: none;
        }




        .table-custom>thead>tr>td {
            padding: 2px 5px;
            /*width: 140px;*/
        }

        tbody {
            height: 100px;
            overflow: auto;
        }


        .table-custom>tbody>tr {
            height: 25px;
            padding-top: 3px;
            padding-left: 5px;
            /*min-width: 140px;*/
        }

        .tr_alignright {
            padding-right: 5px;
            text-align: right;
        }

        .tr_alignmiddle {
            padding: 0px;
            text-align: center;
        }

        tr.selected {
            background-color: #D7EBF9;
        }

        img.unselected {
            display: none;
        }

        #TBL_CampaignActivities th:not(:last-child) {
            border-right: 1px solid rgba(128, 128, 128, 0.21);
        }

        hr {
            display: block;
            height: 1px;
            border: 0;
            border-top: 1px solid #d6d6d6;
            margin: 1em 0;
            padding: 0;
        }

        #TBL_CampaignActivities th #headright {
            border-right: none;
        }

        .blue {
            color: #1160B7 !important;
        }

        .black {
            color: #000000 !important;
            font-weight: 500 !important;
        }

        .light-black {
            color: #000000 !important;
        }

        #rightColumn {
            border-right: none;
        }

        #plusimage {
            margin-right: 10px;
            float: right;
            background-image: url("ss_DownArrow");
            cursor: pointer;
        }

        #delete-input-btn {
            visibility: hidden;
        }

        tr:hover div#fdib #delete-input-btn {
            visibility: visible;
            float: right;
            margin-right: 25px;
        }


        .toptable {
            width: 100%;
            top: -5px;
        }

        .toptable tr {
            height: 8px;
        }

        #nonotes {
            margin-top: 10px;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        .loaderStyle {
            text-align: center;
            cursor: wait;
            background: transparent;
            font-size: 12px;
            position: absolute;
            display: none;
            left: 45%;
            top: 200px;
            width: 50px;
            height: 50px;
        }

        .loaderStyle img {
            margin-top: 10px;
            border: none;
        }

        #paging {
            height: 10px;
            float: right;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        #paging1 {
            height: 10px;
            float: right;
            font-family: "Segoe UI", Arial, Sans-Serif;
            color: grey;
            font-size: 12px;
        }

        #preprevious {
            background: transparent url(ss_background.png) no-repeat scroll -157px -135px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #preprevious1 {
            background: transparent url(ss_background.png) no-repeat scroll -157px -135px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #forward {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -157px -124px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #forward1 {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -95px -159px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #previous {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -167px -118px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        #previous1 {
            float: right;
            background: transparent url(ss_background.png) no-repeat scroll -167px -118px;
            width: 8px;
            height: 9px;
            overflow: hidden;
        }

        .table-custom>thead>tr>td:hover {
            background-color: #D7EBF9;
            text-decoration: underline;
            cursor: pointer;
        }

        .table-custom>tbody>tr:hover {
            background-color: #D7EBF9;
            text-decoration: underline;
            text-decoration: none;
            cursor: pointer;
        }

        .nohover {
            background-color: white !important;
        }

        #head {
            margin-bottom: 8px;
        }


        #searchtable {
            border-spacing: 0px;
            padding: 0px;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        #search {
            border-right: none;
            width: 280px;
            margin-left: 5px;
        }

        #moreRecords {
            color: #005592;
            text-align: right;
            display: none;
        }

        #withoutpadding {
            padding: 0px;
            border-spacing: 0px;
        }



        #shoppingcart {
            /*background-image: url(ss_cart);*/
            width: 33%;
            float: left;
        }

        #cartContainer {
            height: 450px;
            width: 100%;
            clear: both;
        }

        #cartTableContainer {
            max-height: 380px;
            overflow-x: hidden;
            overflow-y: auto;
            width: 100%;
            padding: 0px;
            margin: 0px;
            clear: both;
        }

        #cartTotals {
            width: 100%;
        }

        .input-xs {
            height: 22px;
            padding: 2px 5px;
            font-size: 12px;
            line-height: 1.5;
            width: 80%;
            margin-left: 9%;
            margin-right: 9%;
        }

        select {
            border: none;
            border-bottom: 2px solid #e4e4e4;
            padding-right: 48px;
        }

        .single-button {
            background-color: white;
            height: 50px;
            text-align: center;
        }

        .inactive {
            display: none;
        }

        /*.loader {
            text-align: center;
            cursor: wait;
            background-color: transparent;
            display: none;
            margin-top: 5px;
        }

            .loader img {
                border: none;
            }*/

        #delete-cart-btn {
            margin-bottom: 2px;
            opacity: 0.7;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        #msgDiv img {
            width: 300px;
        }

        .borderfocus {
            border-color: #D7EBF9;
        }

        .nav-tabs>li {

            font-size: 19px;
            width: 25%;
            margin: -3px 7px 0px 7px !important;
            font-weight: 500;
            border: 2px solid transparent;
            float: none;
            display: table-cell;
            text-align: center;
        }

        .nav-tabs>li>a {
            background-color: #716f6f;
            margin-right: 0px;
            line-height: 1.42857143;
            border: 2px solid transparent;
            border-radius: 0px 0px 0 0;
        }

        .nav-tabs>li.active>a,
        .nav-tabs>li.active>a:hover {
            color: #ffffff;
            background-color: #337ab7;
            border: 0px solid #ddd;
            border-bottom-color: transparent;
            cursor: default;
        }



        .nav {
            display: table;
            width: 100%;
            margin: 0;
        }

        .nav-tabs>li.active>a,
        .nav-tabs>li.active>a:hover,
        .nav-tabs>li.active>a:focus {
            background-color: #337ab7;
            color: #ffffff;
            border: 0px solid #ddd;
        }

        a {
            color: #ffffff;
        }

        td.productname {
            text-align: left !important;
            padding-left: 15px !important;
        }

        input[type=textarea] {
            width: -webkit-fill-available;
            /*margin-right: 5px;
            margin-left: 5px;*/
        }

        .packageCheckbox {
            font-weight: bold;
            font-size: 13px;
            vertical-align: sub;
        }

        .sumAmount {
            margin-top: 15px;
            background-color: white;
            padding: 25px 55px;
        }

        .scroll1 {
            padding: 1px 25px;
            margin-top: 20px;
            background-color: white;
            padding-bottom: 30px;
            margin-bottom: 15px;
        }

        input {
            background-position: right;
            border: 2px solid #e1e1e1;
            padding-left: 5px;
        }

        .tablepopulate {
            width: 100%;
        }

        input.DiscountedSetupTextbox:focus {
            border: 1px solid #337ab7;
            outline: 0px;
        }

        .checkbox_hr {
            margin-top: 0px;
            margin-bottom: 0px;
            background: white;
        }

        .checkbox_hr2 {
            margin-top: 9px;
            margin-bottom: -11px;
        }

        .checkboxrow {
            background: white;
            padding-top: 10px;
            padding-bottom: 14px;
        }

        .row1 {
            margin-top: 30px;
        }

        .row.checkboxrow {
            margin-left: 0px;
            margin-right: 0px;
        }

        .second-CheckboxRow {
            display: none;
        }

        input[readonly="readonly"] {
            background: lightgray;
            /* color: white; */
            /* border: 1px solid white; */
        }

        .elements {
            width: 25%;
        }

        .centeredelements {
            width: 25%;
            text-align: center;
        }

        .floatelements {
            float: right;
        }

        .autoheightelement {
            height: auto;
        }

        .checkboxelement {
            margin-right: 35px;
        }
    </style>
    <script>
        try {
            //==========

            var setupfield = "";
            var licensefield = "";
            var mlicensefield = "";
            var singlesetupfield = "";
            var singlelicensefield = "";
            var singlemlicensefield = "";
            //=========
            var CurrencySymbol = "";
            var DecimalSymbol = "";
            var NumberSeparator = "";
            var UILanguageId = "";
            var isSaveandClose = false;
            var producttype = "";

            var contractStartDate = new Date("01-Sep-2001");
            var contractEndDate = new Date("01-Sep-2001");

            var globelcontext = opener.parent.Xrm.Utility.getGlobalContext();

            function AddFormattings(x) {
                //debugger;
                var number = x;
                var thousand = NumberSeparator;
                var decimal = DecimalSymbol;
                var places = 2;
                var symbol = CurrencySymbol;


                number = number || 0;
                places = !isNaN(places = Math.abs(places)) ? places : 2;
                symbol = symbol !== undefined ? symbol : "$";
                thousand = thousand || ",";
                decimal = decimal || ".";
                var negative = number < 0 ? "-" : "",
                    i = parseInt(number = Math.abs(+number || 0).toFixed(places), 10) + "",
                    j = (j = i.length) > 3 ? j % 3 : 0;
                return negative + (j ? i.substr(0, j) + thousand : "") + i.substr(j).replace(/(\d{3})(?=\d)/g, "$1" + thousand) + (places ? decimal + Math.abs(number - i).toFixed(places).slice(2) : "") + " " + symbol;




            }
            function RemoveFormattings(x) {
                //if (CurrencySymbol === '\u20AC')
                if (DecimalSymbol === ',' && x != null) {

                    // debugger

                    if ((x.indexOf(CurrencySymbol) > -1)) {
                        x = x.replace(CurrencySymbol, "");
                    }

                    if (DecimalSymbol === ',') {

                        //german case
                        x = x.replace(/\,/g, 'a');
                        x = x.replace(/\./g, '');
                        x = x.replace(/\a/g, '.');

                        x = Number(x).toLocaleString("es-US", { minimumFractionDigits: 2 });
                        x = x.replace(/\,/g, '');

                        //x = x.replace(/\,/g, 'a');
                        //x = x.replace(DecimalSymbol, ',');
                        //x = x.replace(/\a/g, '');

                        //x = Number(x).toLocaleString("de-DE", { minimumFractionDigits: 2 });
                        //x = x.replace('.', '');
                    }



                }
                else if (DecimalSymbol === "." && x != null) {

                    //debugger;
                    if ((x.indexOf(CurrencySymbol) > -1)) {
                        x = x.replace(CurrencySymbol, "");
                    }
                    //x = x.replace(/\./g, 'a');
                    //x = x.replace(/\,/g, '');
                    //x = x.replace(/\a/g, '.');
                    //console.log("in fucntion " + x);
                    //x = Number(x).toLocaleString("es-US", { minimumFractionDigits: 2 });
                    //console.log("after number function " + x);
                    x = x.replace(',', '');
                    ///console.log("end of if statement " + x);

                }
                else if (DecimalSymbol === "'" && x != null) {

                    if ((x.indexOf(CurrencySymbol) > -1)) {
                        x = x.replace(CurrencySymbol, "");
                    }
                    x = x.replace(/\'/g, 'a');
                    x = x.replace(DecimalSymbol, '.');
                    x = x.replace(/\a/g, '');
                    x = Number(x).toLocaleString("es-US", { minimumFractionDigits: 2 });
                    x = x.replace(',', '');
                }

                else if (x != null) {

                    if ((x.indexOf(CurrencySymbol) > -1)) {
                        x = x.replace(CurrencySymbol, "");
                    }
                    x = x.replace(/\,/g, 'a');
                    x = x.replace(DecimalSymbol, '.');
                    x = x.replace(/\a/g, '');
                    x = Number(x).toLocaleString("es-US", { minimumFractionDigits: 2 });
                    x = x.replace(',', '');

                }

                return x;
            }

            function MakeFieldsReadOnly() {
                setTimeout(function () {
                    //console.log($("#640050_pt td input[type='text']").length + "-inputs");
                    //EQS Policy Manager
                    // $("#640050_pt td input[type='text']").attr("readonly", "readonly");
                    // $("#640050_pt td input[type='text']").attr("onfocus", "this.blur()");
                    // $("#640070_pt td input[type='text']").attr("readonly", "readonly");
                    // $("#640070_pt td input[type='text']").attr("onfocus", "this.blur()");
                    //EQS Approval Manager
                    $("#640080_pt td input[type='text']").attr("readonly", "readonly");
                    $("#640080_pt td input[type='text']").attr("onfocus", "this.blur()");
                    $("#640081_pt td input[type='text']").attr("readonly", "readonly");
                    $("#640081_pt td input[type='text']").attr("onfocus", "this.blur()");


                    $('#update_products').removeClass('is-active');
                }, 2000);

            }
            //for checkbox auto check
            //markerb1
            function checkboxChecker(object) {
                var classname = object.id;

                if (classname === "BasicWeb") {
                    if ($("#BasicWeb").is(':checked')) {
                        $(".IRB").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $(".IRB").each(function () {
                            if (!($(this).hasClass('IRBP') && $("#BestPracticeWeb").is(':checked')) && !($(this).hasClass('IRBC') && $("#BestInClassWeb").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "BestPracticeWeb") {
                    if ($("#BestPracticeWeb").is(':checked')) {
                        $(".IRBP").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $(".IRBP").each(function () {
                            if (!($(this).hasClass('IRB') && $("#BasicWeb").is(':checked')) && !($(this).hasClass('IRBC') && $("#BestInClassWeb").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "BestInClassWeb") {
                    if ($("#BestInClassWeb").is(':checked')) {
                        $(".IRBC").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $(".IRBC").each(function () {
                            if (!($(this).hasClass('IRBP') && $("#BestPracticeWeb").is(':checked')) && !($(this).hasClass('IRB') && $("#BasicWeb").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "BasicTool") {
                    if ($("#BasicTool").is(':checked')) {
                        $(".IRTB").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $(".IRTB").each(function () {
                            if (!($(this).hasClass('IRTBP') && $("#BestPracticeTool").is(':checked')) && !($(this).hasClass('IRTBC') && $("#BestInClassTool").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "BestPracticeTool") {
                    if ($("#BestPracticeTool").is(':checked')) {
                        $(".IRTBP").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {
                        $(".IRTBP").each(function () {
                            if (!($(this).hasClass('IRTB') && $("#BasicTool").is(':checked')) && !($(this).hasClass('IRTBC') && $("#BestInClassTool").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "BestInClassTool") {
                    if ($("#BestInClassTool").is(':checked')) {
                        $(".IRTBC").each(function () {
                            $(this).prop("checked", true);
                        });

                    } else {

                        $(".IRTBC").each(function () {
                            if (!($(this).hasClass('IRTBP') && $("#BestPracticeTool").is(':checked')) && !($(this).hasClass('IRTB') && $("#BasicTool").is(':checked')))
                                $(this).prop("checked", false);
                        });
                    }
                }
                else if (classname === "ComplianceCockpitCheckbox") {
                    if ($("#ComplianceCockpitCheckbox").is(':checked')) {
                        $(".ComplianceDependent").each(function () {
                            $(this).prop("checked", true);
                            $('.OppProducts24').show();
                            $('.OppProducts25').show();
                            $('.OppProducts26').show();
                            $('.OppProducts27').show();
                            $('.OppProducts28').show();


                        });

                    } else {
                        $(".ComplianceDependent").each(function () {

                            $(this).prop("checked", false);
                            $('.OppProducts24').hide();
                            $('.OppProducts25').hide();
                            $('.OppProducts26').hide();
                            $('.OppProducts27').hide();
                            $('.OppProducts28').hide();
                        });
                    }
                }
                calculateFee();

            }


            var heading1 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading" >Website & Apps</b></p>';
            var heading2 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">IR Tools</b></p>';
            var heading3 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Contact Manager & Mailing</b></p>';
            var heading4 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">(Regulatory) News Distribution</b></p>';
            var heading5 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Compliance Cockpit - Applications</b></p>';
            var heading14 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Compliance Cockpit - Add-Ons</b></p>';
            var heading15 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Others</b></p>';
            var heading16 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">RuleBook</b></p>';
            var heading6 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Webcast</b></p>';
            var heading7 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">Online Reports</b></p>';
            var heading8 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">LEI</b></p>';
            var heading9 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">XML PR Cockpit</b></p>';
            var heading10 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">XML Konzerngesellschaften (T&oumlchter)</b></p>';
            var heading11 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">XML Konzern</b></p>';
            var heading12 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">XML Fonds</b></p>';
            var heading13 = '<div class="scroll1"><p class="TabHeading"><b id="productselector_heading1" class="TabHeading">EQS IR Cockpit</b></p>';

            var thead = '<table style="width:100%" id="MyTable" class="table-custom">';
            thead += '<thead>' +
                '<tr>' +
                '<th style="display:none;"></th>' +
                '<th style="display:none;"></th>' +
                '<th></th>' +
                '<th class="productname">Product</th>' +
                '<th>Setup</th>' +
                '<th>Monthly Fee</th>' +
                '<th>Yearly Fee</th>' +
                '<th>Comment</th>' +
                // '<th>Contract Start Date</th>' +
                // '<th>Contract Length</th>' +
                // '<th>Contract End Date</th>' +
                '<th style="display:none;"></th>' +
                '<th style="display:none;"></th>' +
                '</tr>' +
                '</thead>' +
                '<tbody class="tbody">';

            tbottom = '</tbody>' +
                '</table>' +
                '</div>';
            var pricelevelId = "";
            var priceID = "";
            var app = "";
            var contractMail = "";
            var EQSIRCockpit = "";
            var news = "";
            var webcast = "";
            var reports = "";
            var LEI = "";
            var tool = "";
            var compliance = "";
            var complianceaddons = "";
            var complianceothers = "";
            var c2s2 = "";
            var XMLPRCockpit = "";
            var XMLKonzerngesellschaften = "";
            var XMLKonzern = "";
            var XMLFonds = "";

            var EQSCompalianceCockpitCheckbox = '<div class="row checkboxrow row1">' +
                '<div class="col-sm-3 Set1ck1 packageCheckbox" style="margin-right: 4.55%;"><input type="checkbox" id="ComplianceCockpitCheckbox" onchange="checkboxChecker(this)">&nbsp;&nbsp;EQS Compliance Cockpit</div><div class="col-sm-2"><input type="text" style="width: 140px;text-align: center;" id="setupfee" value="" readonly="readonly"></div><div class="col-sm-2"><input type="text" style="width: 140px;text-align: center;" id="monthlyfee" value="" readonly="readonly"></div><div class="col-sm-2"><input type="text" style="width: 140px;text-align: center;" id="yearlyfee" value="" readonly="readonly"></div></div>';
            var checkBoxSet1 = '<div class="row checkboxrow row1">' +
                '<div class="col-sm-4 Set1ck1 packageCheckbox"><input type="checkbox" id="BasicWeb" onchange="checkboxChecker(this)">&nbsp;&nbsp;IR Website Basic</div>' +
                '<div class="col-sm-4 Set1ck2 packageCheckbox"><input type="checkbox" id="BestPracticeWeb" onchange="checkboxChecker(this)" >&nbsp;&nbsp;IR Website Best Practice</div>' +
                '<div class="col-sm-4 Set1ck3 packageCheckbox"><input type="checkbox" id="BestInClassWeb" onchange="checkboxChecker(this)">&nbsp;&nbsp;IR Website Best in Class</div>' + '</div>';
            var checkBoxSet2 = '<div class="row checkboxrow second-CheckboxRow">' +
                '<div class="col-sm-4 Set2ck1 packageCheckbox"><input type="checkbox" id="BasicTool" onchange="checkboxChecker(this)">&nbsp;&nbsp;IR Tool Package Basic</div>' +
                '<div class="col-sm-4 Set2ck2 packageCheckbox"><input type="checkbox" id="BestPracticeTool" onchange="checkboxChecker(this)">&nbsp;&nbsp;IR Tool Package Best Practice</div>' +
                '<div class="col-sm-4 Set2ck3 packageCheckbox"><input type="checkbox"  id="BestInClassTool" onchange="checkboxChecker(this)">&nbsp;&nbsp;IR Tool Package Best in Class</div>' +
                '</div>';


            var oportunityproducts = [];

            var prodID = [];
            var SetupFee = 0;
            var licenseFee = 0;
            var mlicenseFee = 0.00;
            var monthlyLicfee = 0.00;
            var mdiscLicenseFee = 0.00;
            var discSetupFee = 0;
            var discLicenseFee = 0;


            function getParentDate() {
                // change M107


                retrieveUserSettings();
                //importing the user setting to set currencey,decimal,separator formattings
                // app = "";
                // contractMail = "";
                // news = "";
                // webcast = "";
                // reports = "";
                // LEI = "";
                // tool = "";
                // compliance = "";
                // XMLPRCockpit = "";
                // XMLKonzerngesellschaften = "";
                // XMLKonzern = "";
                // XMLFonds = "";
                // if (location.search != "") {
                //     vals = location.search.substr(1).split("&");
                //     for (var i in vals) {
                //         vals[i] = vals[i].replace(/\+/g, " ").split("=");
                //     }
                //     //look for the parameter named 'data'
                //     var found = false;
                //     for (var i in vals) {
                //         if (vals[i][0].toLowerCase() === "data") {
                //             parseDataValue(vals[i][1]);
                //             found = true;
                //             break;
                //         }
                //     }
                // }
            }
            function parseDataValue(datavalue) {
                if (datavalue != "") {
                    var vals = new Array();
                    vals = decodeURIComponent(datavalue).split("&");
                    for (var i in vals) {
                        vals[i] = vals[i].replace(/\+/g, " ").split("=");
                    }
                }
                pricelevelId = vals[0];
                pricelevelId = pricelevelId.toString();
                pricelevelId = pricelevelId.replace('"', '');
                pricelevelId = pricelevelId.replace('"', '');
                priceID = pricelevelId.replace('{', '').replace('}', '');

                //$.LoadingOverlay("show");
                // $('#update_products').addClass('is-active');
                retrieveProduct(priceID);
                //  $('#update_products').attr('data-text', 'Loading Products');



                // $.LoadingOverlay("hide");
            }

            function retrieveProduct(priceID) {

                // var Terminate = opener.parent.Xrm.Page.getAttribute("ss_terminationperiod").getValue();
                // $("#terminate").val(Terminate);
                // var contract = opener.parent.Xrm.Page.getAttribute("ss_contractperiod").getValue();
                // $("#contract").val(contract);
                getOpportunityProducts();

            }

            function loadproducts() {
                var fetch = '<fetch>' +
                    ' <entity name="productpricelevel" >' +
                    ' <attribute name="productnumber" />' +
                    ' <attribute name="uomid" />' +
                    ' <attribute name="pricelevelid" />' +
                    ' <attribute name="productid" />' +
                    ' <attribute name="amount" />' +
                    '  <filter type="or" >' +
                    '  <condition entityname="product" attribute="producttypecode" operator="in" >' +
                    '  <value>100000003</value>' +
                    '   <value>100000001</value>' +
                    ' </condition>' +
                    ' </filter>' +
                    '   <filter type="and" >' +
                    '  <condition attribute="pricelevelid" operator="eq" value="' + priceID + '" />' +
                    ' </filter>' +
                    '   <link-entity name="product" from="productid" to="productid" link-type="inner" >' +
                    '  <attribute name="ss_issalesproduct" />' +
                    ' <attribute name="name" />' +
                    ' <attribute name="ss_productdescription" />' +
                    ' <attribute name="productnumber" />' +
                    ' <attribute name="producttypecode" />' +
                    '<attribute name="ss_relatedlicencefee" />' +
                    '<attribute name="ss_productmaincategory" />' +
                    '<attribute name="ss_crmproductgroups" />' +
                    '<attribute name="ss_irwebsitebasic" />' +
                    '<attribute name="ss_irwebsitebestpractice" />' +
                    '<attribute name="ss_irwebsitebestinclass" />' +
                    '<attribute name="ss_irtoolpackagebasic" />' +
                    '<attribute name="ss_irtoolpackagebestpractice" />' +
                    '<attribute name="ss_irtoolpackagebestinclass" />' +
                    '<attribute name="statecode" />' +
                    '<attribute name="ss_productseletorsortorder" />' +
                    ' <filter>' +
                    '<condition attribute="ss_issalesproduct" operator="eq" value="1" />' +
                    '<condition attribute="statecode" operator="eq" value="0" />' +
                    '</filter>' +
                    '<order attribute="ss_productseletorsortorder" />' +
                    '</link-entity>' +
                    '</entity>' +
                    '</fetch>';
                //console.log(fetch);
                var req = new XMLHttpRequest();
                req.open("GET", Xrm.Utility.getGlobalContext().getClientUrl() + "/api/data/v8.2/productpricelevels?fetchXml=" + fetch, true);
                req.setRequestHeader("OData-MaxVersion", "4.0");
                req.setRequestHeader("OData-Version", "4.0");
                req.setRequestHeader("Accept", "application/json");
                req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
                req.onreadystatechange = function () {
                    if (this.readyState === 4) {
                        req.onreadystatechange = null;
                        if (this.status === 200) {
                            var results = JSON.parse(this.response);

                            for (var i = 0; i < results.value.length; i++) {
                                //Nh=============================================
                                var crmLicProdGroup = "";
                                var crmLicProdMainGroup = "";
                                var Prod_Id = ""
                                var ss_productdescription = "";
                                var crmProdGroup = results.value[i]["product1_x002e_ss_crmproductgroups"]; //===nh

                                var crmProdMainGroup = results.value[i]["product1_x002e_ss_productmaincategory"]; //===nh              
                                var crmProdDescription = results.value[i]["product1_x002e_ss_productdescription"]; //===nh  
                                //============================================nH
                                producttype = results.value[i]["product1_x002e_producttypecode"];
                                if (results.value[i]["product1_x002e_producttypecode"] === 100000003) {
                                    //For IR package selection
                                    Prod_Id = results.value[i]["product1_x002e_productnumber"];
                                    ss_productdescription = results.value[i]["product1_x002e_ss_productdescription"];
                                    //console.log("Prod_Id => " + Prod_Id) ;
                                    var IRpackage = "";

                                    if (results.value[i]["product1_x002e_ss_irwebsitebasic"] === true) {
                                        IRpackage += "IRB ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (results.value[i]["product1_x002e_ss_irwebsitebestpractice"] === true) {
                                        IRpackage += "IRBP ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (results.value[i]["product1_x002e_ss_irwebsitebestinclass"] === true) {
                                        IRpackage += "IRBC ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (results.value[i]["product1_x002e_ss_irtoolpackagebasic"] === true) {
                                        IRpackage += "IRTB ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (results.value[i]["product1_x002e_ss_irtoolpackagebestpractice"] === true) {
                                        IRpackage += "IRTBP ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (results.value[i]["product1_x002e_ss_irtoolpackagebestinclass"] === true) {
                                        IRpackage += "IRTBC ";
                                    }
                                    else {
                                        IRpackage += "";
                                    }

                                    if (IRpackage != "")
                                        IRpackage = IRpackage.slice(0, -1);

                                    // For different product groups
                                    //App And IR website

                                    if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "App" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "IR Website" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Corp Web & Micro") {

                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //variable declarations and intializations

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var mlicDiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var licDiscountedAmountFormatted = "";
                                        var setupdiscountedAmountFormatted = "";
                                        var setupFeeFormatted = "";
                                        var licFeeFormatted = "";
                                        var mlicFeeFormatted = "";
                                        var startDate = "";
                                        var endDate = "";
                                        // Getting the License product ID fro related license fee field to be used in the grid and for adding the license product with Setup product
                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }
                                        // if the Product is already added in the opportunity Products
                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"])
                                                    desc = oportunityproducts.value[j]["description"];

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                licDiscountedAmountFormatted = "0";

                                                count += 1;

                                            }
                                            if (count === 2)
                                                break;
                                        }

                                        //Populating row in case of already added products
                                        if (flag === 1) {

                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            app += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox"  class="' + IRpackage + ' checkboxClass" onchange="calculateFee()"  checked></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            app += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //app += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            app += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            app += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';


                                        }


                                        // Populating row in case of price list items
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            app += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            app += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //app += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            app += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            app += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';

                                        }
                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        //  if (licenseOpProdID != "") {
                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        //  }

                                        /*   else
                                           {
                                               app += '<td class="startDate contract_field"><input type="text" class="startDate contract_field"  style="text-align:center;" readonly></td>';
       
                                               app += '<td class="endDate contract_field"><input type="text" class="endDate contract_field" style="text-align:center;" readonly></td>';
       
                                           }*/
                                        if (OpProdId != "") {
                                            app += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            app += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            app += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';
                                            app += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';
                                            app += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            app += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            app += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            app += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            app += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';
                                            app += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';
                                            app += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            app += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                        if (Prod_Id === "640100") {
                                            app += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            app += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     app += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }
                                    //IR Tools, pt1                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Charts & Invest. Calc." ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Fact Sheet" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Newsfeed" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Portal Network" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Quick Analyzer" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Others") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {

                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //variable declarations and intializations
                                        // change M107

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var licDiscountedAmountFormatted = "";
                                        var setupdiscountedAmountFormatted = "";
                                        var setupFeeFormatted = "";
                                        var licFeeFormatted = "";
                                        var startDate = "";
                                        var endDate = "";
                                        // Getting the License product ID fro related license fee field to be used in the grid and for adding the license product with Setup product
                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }
                                        // if the Product is already added in the opportunity Products
                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];

                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"]) {
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                    if (oportunityproducts.value[j]["ss_startdate"])
                                                        startDate = oportunityproducts.value[j]["ss_startdate"];
                                                    if (oportunityproducts.value[j]["ss_termenddate"])
                                                        endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                }

                                                else
                                                    licDiscountedAmount = 0.00;
                                                licDiscountedAmountFormatted = "0";

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }

                                        //Populating row in case of already added products
                                        if (flag === 1) {

                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            tool += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox"  class="' + IRpackage + ' checkboxClass" onchange="calculateFee()"  checked></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            tool += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //tool += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            tool += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            tool += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }

                                        // Populating row in case of price list items
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            tool += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            tool += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //tool += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            tool += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            tool += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }
                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            tool += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            tool += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            tool += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            tool += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            tool += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            tool += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            tool += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            tool += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            tool += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            tool += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            tool += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            tool += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                        if (Prod_Id === "640100") {
                                            tool += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            tool += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     tool += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }

                                    }
                                    // EQS IR Cockpit
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "EQS IR Cockpit") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];

                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            //change M107
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);


                                            EQSIRCockpit += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox"  onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            EQSIRCockpit += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //contractMail += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            EQSIRCockpit += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            EQSIRCockpit += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            //col 1=productid col2=unitId
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            EQSIRCockpit += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            EQSIRCockpit += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //contractMail += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            EQSIRCockpit += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            EQSIRCockpit += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }
                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            EQSIRCockpit += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            EQSIRCockpit += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            EQSIRCockpit += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            EQSIRCockpit += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            EQSIRCockpit += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            EQSIRCockpit += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            EQSIRCockpit += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            EQSIRCockpit += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            EQSIRCockpit += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            EQSIRCockpit += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            EQSIRCockpit += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            EQSIRCockpit += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                        if (Prod_Id === "640100") {
                                            EQSIRCockpit += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            EQSIRCockpit += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     EQSIRCockpit += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }


                                    }
                                    ////
                                    //Contact Manager & Mailing *haider                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Contact Manager") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];

                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            //change M107
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);


                                            contractMail += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox"  onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            contractMail += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //contractMail += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            contractMail += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            contractMail += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            //col 1=productid col2=unitId
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            contractMail += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            contractMail += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //contractMail += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            contractMail += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            contractMail += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }
                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            contractMail += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            contractMail += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            contractMail += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            contractMail += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            contractMail += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            contractMail += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            contractMail += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            contractMail += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            contractMail += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            contractMail += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            contractMail += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            contractMail += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                        if (Prod_Id === "640100") {
                                            contractMail += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            contractMail += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     contractMail += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                        // else if (productname === "10 Mitteilungen in unbegrenzter Länge" || productname === "5 Mitteilungen in unbegrenzter Länge" || productname === "Paketergänzung: PDF-Option: 5 PDF" || productname === "Paketergänzung: Bild-Option: 10 Pressebilder" || productname === "Paketergänzung: Bild-Option: 5 Pressebilder" || productname === "Paketergänzung: Branchen-Option: 5 Spezial-Branchenverteiler" || productname === "Paketergänzung: Branchen-Option: 10 Spezial-Branchenverteiler" || productname === "Paketergänzung: PDF-Option: 10 PDF" || productname === "Paketergänzung: Einstellservice für 5 Meldungen") {
                                        //     contractMail += embedSubTableforRegulatoryandNews(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                        else if (Prod_Id === "614007a" || Prod_Id === "614002a" || Prod_Id === "614005a" || Prod_Id === "614008a" || Prod_Id === "614003a" || Prod_Id === "614004a" || Prod_Id === "614009a" || Prod_Id === "614010a" || Prod_Id === "614006a") {
                                            contractMail += embedSubTableforPAKCheck(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }


                                    }
                                    //Regulatory & News

                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Regulatory & News") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            //change M107
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            news += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            news += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //news += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            news += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            news += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            //change M107
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            news += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            news += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //news += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            news += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            news += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {

                                            news += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            news += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            news += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';
                                            news += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';
                                            news += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            news += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        else {
                                            news += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            news += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            news += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            news += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            news += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            news += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                        if (Prod_Id === "640100") {
                                            news += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            news += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     news += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                        else if (productname === "Verbundene Stimmrechte Setup" || productname === "Corporate News & Press Releases via Agency / TUG" || productname === "MAR-Package Best Practice (new client)" || productname === "Vorabbekanntmachung Finanzberichte" || productname === "Zulassungsfolgepflichten (§ 30e WpHG)" || productname === "Directors Dealings Setup" || productname === "Gesamtstimmrechtsmitteilungen" || productname === "UK/Ireland Regulatory News Setup" || productname === "Zulassungsfolgepflichten (§ 30e WpHG)" || productname === "Related Partner Setup" || productname === "Ad-hoc-Mitteilungen Online" || Prod_Id === "615284" || productname === "UK/Ireland Regulatory News Standard Setup" || productname === "Corporate News  & Press Releases via Agency / TUG") {
                                            news += embedSubTableforRegulatoryandNews(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }

                                    }
                                    //Compliance                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Insider Manager" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Integrity Line" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Policy Manager" || results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Compliance Cockpit Applications") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];

                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            if ((Prod_Id === "640070") || (Prod_Id === "640081a") || (Prod_Id === "640030") || (Prod_Id === "640160") || (Prod_Id === "640032")) {
                                                compliance += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked class="' + IRpackage + ' checkboxClass ComplianceDependent"></td><td class="productname">' + productname + '</td>';

                                                //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                                compliance += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" readonly="readonly" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                                //compliance += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                                compliance += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" readonly="readonly" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                                compliance += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" readonly="readonly" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                            }
                                            else {
                                                compliance += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                                //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                                compliance += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                                //compliance += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                                compliance += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                                compliance += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                            }
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            if ((Prod_Id === "640070") || (Prod_Id === "640081a") || (Prod_Id === "640030") || (Prod_Id === "640160") || (Prod_Id === "640032")) {
                                                //for EQS Policy Manager, EQS Approval Manager, EQS Integrity Line, EQS Compliance Cockpit Platform, EQS Risk Manager
                                                compliance += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker "><input type="checkbox" onchange="calculateFee()"  class="' + IRpackage + ' checkboxClass ComplianceDependent"></td><td class="productname">' + productname + '</td>';
                                                //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                                compliance += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" readonly="readonly" disabled value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                                //compliance += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                                compliance += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" readonly="readonly" disabled value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                                compliance += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" readonly="readonly" disabled value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            }
                                            else {
                                                //col 1=productid col2=unitId
                                                compliance += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                                //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                                compliance += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                                //compliance += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                                compliance += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                                compliance += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            }
                                        }

                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            compliance += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            compliance += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            compliance += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            compliance += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            compliance += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            compliance += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            compliance += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            compliance += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            compliance += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            compliance += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            compliance += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            compliance += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640032") {
                                            compliance += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (Prod_Id === "640050") {
                                            compliance += embedSubTableForIntegrityClassic(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "EQS Approval Manager") {
                                            compliance += embedSubTableForApprovalManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "EQS Policy Manager") {
                                            compliance += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "BKMS System" || Prod_Id === "640120") {
                                            compliance += embedSubTableForBKMS(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "BKMS Case Management" || Prod_Id === "640122") {
                                            compliance += embedSubTableForBKMSCaseManagement(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "BKMS Compliance System" || Prod_Id === "640128") {
                                            compliance += embedsubtableforBKMScompliancesystemaddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "BKMS Third Party" || Prod_Id === "640132") {
                                            compliance += BKMSThirdParty(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription)
                                        }
                                        if (productname === "EQS Risk Manager") {
                                            compliance += embedSubTableForRiskManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (productname === "EQS Compliance Cockpit Platform" || Prod_Id === "640030") {
                                            compliance += embedSubTableForCockpitPlatform(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        if (Prod_Id === "640100") {
                                            compliance += embedSubTableForIntegrityLine(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                    }

                                    //compliance addons
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Compliance Cockpit Add-on") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {
                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }
                                        if (productname === "EQS Integrity Line Classic Add-On") {
                                            productname = "EQS Integrity Line Add-On";

                                        }
                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            complianceaddons += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            complianceaddons += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //compliance += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            complianceaddons += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            complianceaddons += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            complianceaddons += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            complianceaddons += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //compliance += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            complianceaddons += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            complianceaddons += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }

                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            complianceaddons += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';

                                            complianceaddons += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceaddons += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            complianceaddons += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceaddons += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';

                                            complianceaddons += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            complianceaddons += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';

                                            complianceaddons += '<td style="display:none;" class="startDate contract_field" ><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceaddons += '<td style="display:none; class ="contract_field contract_len" "><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            complianceaddons += '<td style="display:none;" class="endDate contract_field" ><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceaddons += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            complianceaddons += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640052a" || productname === "EQS Integrity Line Classic Add-On") {
                                            complianceaddons += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640130" || productname === "BKMS Compliance System Add-on") {
                                            complianceaddons += embedsubtableforBKMScompliancesystemaddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640124" || productname === "BKMS Case Management Add-on") {
                                            complianceaddons += EmbedSubTableForBKMSCaseManagementAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640126" || productname === "BKMS System Add-on") {
                                            complianceaddons += EmbedSubTableForBKMSSystemAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640082" || productname === "EQS Approval Manager Add-On") {
                                            complianceaddons += EQSApprovalManagerAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }

                                    }

                                    //compliance others

                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Other") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];

                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            complianceothers += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            complianceothers += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //compliance += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            complianceothers += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            complianceothers += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';


                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            complianceothers += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            complianceothers += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //compliance += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            complianceothers += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            complianceothers += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }

                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            complianceothers += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            complianceothers += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceothers += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            complianceothers += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceothers += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            complianceothers += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            complianceothers += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            complianceothers += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceothers += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            complianceothers += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            complianceothers += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            complianceothers += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }

                                    }

                                    // compliance c2s2

                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "C2S2") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];

                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            c2s2 += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            c2s2 += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //compliance += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            c2s2 += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            c2s2 += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';


                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            c2s2 += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            c2s2 += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';

                                            //compliance += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            c2s2 += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';

                                            c2s2 += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }

                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            c2s2 += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            c2s2 += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            c2s2 += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            c2s2 += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            c2s2 += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            c2s2 += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            c2s2 += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            c2s2 += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            c2s2 += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            c2s2 += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            c2s2 += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            c2s2 += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640205a") {
                                            c2s2 += embedSubTableForLicenseRuleBot(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640206a") {
                                            c2s2 += embedSubTableForLicenseRuleBot(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640207a") {
                                            c2s2 += embedSubTableForLicenseRuleBot(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640204a") {
                                            c2s2 += embedSubTableForLicensAdditionalRulebookClient(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640208") {
                                            c2s2 += embedSubTableForInitialDigitizationandUpdateRulebook(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640209") {
                                            c2s2 += embedSubTableForInitialDigitizationandUpdateRulebook(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640200") {
                                            c2s2 += embedSubTableForIOnboardingOneoffservicesRulebook(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "640203a") {
                                            c2s2 += embedSubTableForLicenseRulebookPlatform(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }

                                    }
                                    //Nh============================================================
                                    //XML PR Cockpit                                    
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "XML PR Cockpit") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            XMLPRCockpit += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            XMLPRCockpit += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            XMLPRCockpit += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            XMLPRCockpit += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);

                                            XMLPRCockpit += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLPRCockpit += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            XMLPRCockpit += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            XMLPRCockpit += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }



                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            XMLPRCockpit += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLPRCockpit += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLPRCockpit += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            XMLPRCockpit += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLPRCockpit += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            XMLPRCockpit += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            XMLPRCockpit += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLPRCockpit += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLPRCockpit += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            XMLPRCockpit += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLPRCockpit += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            XMLPRCockpit += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            XMLPRCockpit += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            XMLPRCockpit += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     XMLPRCockpit += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }
                                    //XML Konzerngesellschaften ( Töchter)                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups"] === 25) {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            XMLKonzerngesellschaften += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLKonzerngesellschaften += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            XMLKonzerngesellschaften += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            XMLKonzerngesellschaften += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            XMLKonzerngesellschaften += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLKonzerngesellschaften += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            XMLKonzerngesellschaften += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            XMLKonzerngesellschaften += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }



                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            XMLKonzerngesellschaften += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLKonzerngesellschaften += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzerngesellschaften += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';
                                            XMLKonzerngesellschaften += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';

                                            XMLKonzerngesellschaften += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzerngesellschaften += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            XMLKonzerngesellschaften += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLKonzerngesellschaften += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzerngesellschaften += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            XMLKonzerngesellschaften += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzerngesellschaften += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            XMLKonzerngesellschaften += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            XMLKonzerngesellschaften += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            XMLKonzerngesellschaften += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     XMLKonzerngesellschaften += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }
                                    //XML Konzern                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "XML Konzern") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            XMLKonzern += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLKonzern += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            XMLKonzern += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            XMLKonzern += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            XMLKonzern += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLKonzern += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            XMLKonzern += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            XMLKonzern += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }



                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            XMLKonzern += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLKonzern += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzern += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            XMLKonzern += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzern += 'td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            XMLKonzern += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            XMLKonzern += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLKonzern += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzern += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            XMLKonzern += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLKonzern += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            XMLKonzern += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            XMLKonzern += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            XMLKonzern += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     XMLKonzern += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }
                                    //XML Fonds                                   
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "XML Fonds") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];
                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            XMLFonds += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLFonds += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            XMLFonds += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            XMLFonds += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            XMLFonds += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            XMLFonds += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            XMLFonds += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            XMLFonds += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }



                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            XMLFonds += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLFonds += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLFonds += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            XMLFonds += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLFonds += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            XMLFonds += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            XMLFonds += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            XMLFonds += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLFonds += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            XMLFonds += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            XMLFonds += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            XMLFonds += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            XMLFonds += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            XMLFonds += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     XMLFonds += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }

                                    //============================================================nH
                                    //Webcast                                    
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Video Webcast" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Audio Webcast" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Telco") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];

                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups
                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;

                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            webcast += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            webcast += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //webcast += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            webcast += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            webcast += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            webcast += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            webcast += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //webcast += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            webcast += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            webcast += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }


                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            webcast += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            webcast += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            webcast += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';
                                            webcast += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';

                                            webcast += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            webcast += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            webcast += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            webcast += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            webcast += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';
                                            webcast += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';

                                            webcast += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            webcast += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            webcast += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            webcast += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     webcast += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                        else if (Prod_Id === "689272a" || Prod_Id === "689273a" || Prod_Id === "689270a" || Prod_Id === "689271a") {
                                            webcast += embedSubTableforPAKCheck(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }

                                    }

                                    // Online Reports                                    
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Online Report") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups


                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            reports += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            reports += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //reports += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            reports += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            reports += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            reports += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            reports += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //reports += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            reports += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            reports += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }


                                        // Adding Start Date End Date fields (Changes by Zain Arshad)
                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            reports += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            reports += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            reports += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            reports += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            reports += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            reports += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            reports += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            reports += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            reports += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            reports += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            reports += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            reports += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            reports += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            reports += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     reports += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }
                                    //LEI                                     
                                    else if (results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "XML Conversion" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "LEI" ||
                                        results.value[i]["product1_x002e_ss_crmproductgroups@OData.Community.Display.V1.FormattedValue"] === "Translation") {
                                        if (results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"]) {


                                            var productname = results.value[i]["_productid_value@OData.Community.Display.V1.FormattedValue"];
                                        }

                                        else {
                                            var productname = "";
                                        }

                                        if (results.value[i]["amount"]) {
                                            var setupFee = results.value[i]["amount"];

                                        }
                                        else {
                                            var setupFee = 0.00;
                                        }
                                        //license product

                                        var OPIndex = -1;
                                        var count = 0;
                                        var flag = 0;
                                        var OpProdId = "";
                                        var desc = "";
                                        var licUID = "";
                                        var licenseProductID = "";
                                        var licenseOpProdID = "";
                                        var licDiscountedAmount = 0.00;
                                        var setupdiscountedAmount = 0.00;
                                        var monthlyLicfee = 0.00;
                                        var startDate = "";
                                        var endDate = "";

                                        if (results.value[i]["product1_x002e_ss_relatedlicencefee"]) {
                                            var licFee = 0.00;
                                            for (var j = 0; j < results.value.length; j++) {
                                                if (results.value[i]["product1_x002e_ss_relatedlicencefee"] === results.value[j]["_productid_value"]) {
                                                    //Nh===========================
                                                    if (results.value[j]["product1_x002e_ss_crmproductgroups"] != null && results.value[j]["product1_x002e_ss_crmproductgroups"] != undefined) {
                                                        crmLicProdGroup = results.value[j]["product1_x002e_ss_crmproductgroups"];
                                                    }
                                                    if (results.value[j]["product1_x002e_ss_productmaincategory"] != null && results.value[j]["product1_x002e_ss_productmaincategory"] != undefined) {
                                                        crmLicProdMainGroup = results.value[j]["product1_x002e_ss_productmaincategory"];
                                                    }
                                                    //================================nH
                                                    if (results.value[j]["amount"] != null)
                                                        licFee = results.value[j]["amount"];
                                                    else
                                                        licFee = 0.00;
                                                    licUID = results.value[j]["_uomid_value"];
                                                    licenseProductID = results.value[i]["product1_x002e_ss_relatedlicencefee"];

                                                }

                                            }
                                        }
                                        else {
                                            var licFee = 0.00;
                                        }

                                        for (var j = 0; j < oportunityproducts.value.length; j++) {

                                            if (results.value[i]["_productid_value"] === oportunityproducts.value[j]["_productid_value"]) {
                                                flag = 1;
                                                OPIndex = j;
                                                OpProdId = oportunityproducts.value[j]["opportunityproductid"];
                                                var ss_productcontractlength = oportunityproducts.value[j]["ss_productcontractlength"];
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    setupdiscountedAmount = oportunityproducts.value[j]["extendedamount"];

                                                count += 1;
                                                if (oportunityproducts.value[j]["description"]) {
                                                    desc = oportunityproducts.value[j]["description"];

                                                }
                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    setupFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                            }
                                            if (licenseProductID === oportunityproducts.value[j]["_productid_value"]) {
                                                OPIndex = j;
                                                licenseOpProdID = oportunityproducts.value[j]["opportunityproductid"];
                                                if (oportunityproducts.value[j]["ss_monthlylicensefee"])
                                                    monthlyLicfee = oportunityproducts.value[j]["ss_monthlylicensefee"];
                                                else
                                                    monthlyLicfee = 0.00;
                                                if (oportunityproducts.value[j]["extendedamount"])
                                                    licDiscountedAmount = oportunityproducts.value[j]["extendedamount"];
                                                else
                                                    licDiscountedAmount = 0.00;

                                                if (oportunityproducts.value[j]["priceperunit"])
                                                    licFee = oportunityproducts.value[j]["priceperunit"]; //updating setup for manual setups

                                                if (oportunityproducts.value[j]["ss_startdate"])
                                                    startDate = oportunityproducts.value[j]["ss_startdate"];
                                                if (oportunityproducts.value[j]["ss_termenddate"])
                                                    endDate = oportunityproducts.value[j]["ss_termenddate"];

                                                count += 1;
                                            }
                                            if (count === 2)
                                                break;
                                        }
                                        if (flag === 1) {
                                            setupdiscountedAmount = AddFormattings(setupdiscountedAmount);
                                            mlicDiscountedAmount = (licDiscountedAmount / 12);
                                            mlicDiscountedAmount = AddFormattings(mlicDiscountedAmount);
                                            licDiscountedAmount = AddFormattings(licDiscountedAmount);

                                            LEI += '<tr class="opportunityProduct" id="' + Prod_Id + '"><td style="display:none;">' + OpProdId + ' </td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"  checked  class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';

                                            //app += '<td class="DiscountedSetup">' + setupdiscountedAmount + '</td><td class="originalSetup" style="display:none;">' + //setupFee + '</td>';

                                            LEI += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupdiscountedAmount + '" style="text-align:center;" ></td><td class="originalSetup" id="' + OpProdId + '_P" style="display:none;">' + RemoveFormattings(setupdiscountedAmount) + '</td>';

                                            //LEI += '<td class="DiscountedLic">' + licDiscountedAmount + '</td><td class="originalLicense" style="display:none;">' + //licFee + '</td>';
                                            LEI += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + mlicDiscountedAmount + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(mlicDiscountedAmount) + '</td>';
                                            LEI += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licDiscountedAmount + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licDiscountedAmount) + '</td>';
                                        }
                                        else {
                                            setupFee = AddFormattings(setupFee);
                                            monthlyLicfee = licFee / 12;
                                            licFee = AddFormattings(licFee);
                                            monthlyLicfee = AddFormattings(monthlyLicfee);
                                            //col 1=productid col2=unitId
                                            LEI += '<tr class="PriceListItem" id="' + Prod_Id + '"><td style="display:none;">' + results.value[i]["_productid_value"] + '</td><td style="display:none;">' + results.value[i]["_uomid_value"] + '</td><td class="checker"><input type="checkbox" onchange="calculateFee()"   class="' + IRpackage + ' checkboxClass"></td><td class="productname">' + productname + '</td>';
                                            //app += '<td class="DiscountedSetup">' + //setupFee + '</td><td class="originalSetup" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            LEI += '<td class="DiscountedSetup"><input type="text" class="DiscountedSetupTextbox" value="' + setupFee + '" style="text-align:center;" ></td><td class="originalSetup" id="' + results.value[i]["_productid_value"] + '_P" style="display:none;">' + RemoveFormattings(setupFee); + '</td>';
                                            //LEI += '<td class="DiscountedLic">' + //licFee + '</td><td class="originalLicense" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                            LEI += '<td class="mDiscountedLic"><input type="text" class="mDiscountedLicTextbox" value="' + monthlyLicfee + '" style="text-align:center;" ></td><td class="moriginalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_MLP" style="display:none;">' + RemoveFormattings(monthlyLicfee); + '</td>';
                                            LEI += '<td class="DiscountedLic"><input type="text" class="DiscountedLicTextbox" value="' + licFee + '" style="text-align:center;" ></td><td class="originalLicense" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_LP" style="display:none;">' + RemoveFormattings(licFee); + '</td>';
                                        }


                                        // Adding Start Date End Date fields (Changes by Zain Arshad)

                                        if (startDate) {
                                            var appStartDate = dateForm(startDate);
                                        }
                                        else {
                                            var appStartDate = "";

                                        }
                                        if (endDate) {
                                            var appEndDate = dateForm(endDate);
                                        }
                                        else {
                                            var appEndDate = "";

                                        }

                                        if (OpProdId != "") {
                                            LEI += '<td><input type="textarea" value="' + desc + '" id="' + OpProdId + '_C" ></td><td style="display:none;">' + licenseOpProdID + '</td><td style="display:none;">' + licUID + '</td>';
                                            LEI += '<td class="startDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE" class="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + ' start_Date" value="' + appStartDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            LEI += '<td class ="contract_field contract_len"><select name="contract_length" id="' + OpProdId + '_CL" class ="contract_val" ><option value="3" ' + ((ss_productcontractlength === 3) ? "selected" : "") + '>3</option><option value="6" ' + ((ss_productcontractlength === 6) ? "selected" : "") + '>6</option><option value="9" ' + ((ss_productcontractlength === 9) ? "selected" : "") + '>9</option><option value="12" ' + ((ss_productcontractlength === 12) ? "selected" : "") + '>12</option><option value="24" ' + ((ss_productcontractlength === 24) ? "selected" : "") + '>24</option><option value="36" ' + ((ss_productcontractlength === 36) ? "selected" : "") + '>36</option><option value="7" ' + ((ss_productcontractlength === 7) ? "selected" : "") + '>unlimited</option></select></td>';

                                            LEI += '<td class="endDate contract_field"><input type="date" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" ></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            LEI += '<td style="display:none;" class="DiscountSetup" id="' + OpProdId + '_S"></td><td style="display:none;" class="DiscountLic" id="' + licenseOpProdID + '"></td>';
                                            LEI += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }//ptr 22
                                        else {
                                            LEI += '<td><input type="textarea" id="' + results.value[i]["_productid_value"] + '_C"></td><td style="display:none;">' + licenseProductID + '</td><td style="display:none;">' + licUID + '</td>';
                                            LEI += '<td class="startDate contract_field" style="display:none;"><input type="date" class="start_Date" value="' + appStartDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_SDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            LEI += '<td class ="contract_field contract_len" style="display:none;"><select name="contract_length" id="' + results.value[i]["_productid_value"] + '_CL" class ="contract_val" ><option value="3">3</option><option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option><option value="36">36</option><option value="7">unlimited</option></select></td>';

                                            LEI += '<td class="endDate contract_field" style="display:none;"><input type="date" class="end_Date"  value="' + appEndDate + '" style="text-align:center;" id="' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '_EDATE"></td><td style="display:none;">' + (OpProdId != "" ? licenseOpProdID : licenseProductID) + '</td>';

                                            LEI += '<td style="display:none;" class="DiscountSetup"  id="' + results.value[i]["_productid_value"] + '_Setup"></td><td style="display:none;" class="DiscountLic" id="' + licenseProductID + '_Lic"></td>';
                                            LEI += '<td style="display:none;" class="crmProductgroup" id="' + crmProdGroup + '">' + crmLicProdGroup + '</td> <td style="display:none;" class="crmProductmaingroup" id="' + crmProdMainGroup + '">' + crmLicProdMainGroup + '</td><td style="display:none;" >' + crmProdDescription + '</td> </tr>';
                                        }
                                        if (Prod_Id === "640100") {
                                            LEI += embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        }
                                        else if (Prod_Id === "SP-115" || productname === "EQS Integrity Line Add-On") {
                                            LEI += embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);

                                        }
                                        // else if (productname === "EQS Policy Manager" || productname === "EQS Approval Manager") {
                                        //     LEI += embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription);
                                        // }
                                    }


                                }

                            }
                            //pt11
                            document.getElementById("tblEQSIRCockpit").innerHTML = checkBoxSet1 + "<hr class='checkbox_hr'>" + checkBoxSet2 + "<hr class='checkbox_hr2'>" + heading13 + thead + EQSIRCockpit + tbottom;
                            document.getElementById("homeTbl1").innerHTML = heading3 + "<hr class=''>" + thead + contractMail + tbottom;
                            document.getElementById("homeTbl2").innerHTML = heading4 + "<hr class=''>" + thead + news + tbottom;
                            document.getElementById("menu1").innerHTML = heading1 + thead + app + tbottom + heading2 + thead + tool + tbottom + heading6 + thead + webcast + tbottom + heading7 + thead + reports + tbottom;
                            document.getElementById("menu2").innerHTML = EQSCompalianceCockpitCheckbox + heading5 + thead + compliance + tbottom + heading14 + thead + complianceaddons + tbottom + heading15 + thead + complianceothers + tbottom + heading16 + thead + c2s2 + tbottom;
                            document.getElementById("menu3").innerHTML = heading8 + thead + LEI + tbottom + heading9 + thead + XMLPRCockpit + tbottom + heading10 + thead + XMLKonzerngesellschaften + tbottom + heading11 + thead + XMLKonzern + tbottom + heading12 + thead + XMLFonds + tbottom;

                            //EQS Compliance Cockpit

                            for (var j = 0; j < oportunityproducts.value.length; j++) {
                                if (!($("#ComplianceCockpitCheckbox").is(':checked'))) {
                                    if (oportunityproducts.value[j]["ss_eqscompliancecockpit"] === true) {
                                        $('#ComplianceCockpitCheckbox').prop('checked', true);
                                        $("#setupfee").val(AddFormattings(oportunityproducts.value[j]["ss_compliancecockpitsetupfee_ps"]));
                                        $("#monthlyfee").val(AddFormattings(oportunityproducts.value[j]["ss_compliancecockpitmonthlyfee_ps"]));
                                        $("#yearlyfee").val(AddFormattings(oportunityproducts.value[j]["ss_compliancecockpityearlyfee_ps"]));
                                    }
                                }
                            }

                            calculateFee();


                        } else {

                            // V8.00 method for alert Dialog: Xrm.Utility.alertDialog(this.statusText);

                            // V9.00 Method for Alert Dialog, Changed by SS_A.Jawad:

                            var alertStrings = { confirmButtonLabel: "Ok", text: this.statusText };
                            var alertOptions = { height: 120, width: 260 };
                            Xrm.Navigation.openAlertDialog(alertStrings, alertOptions).then(
                                function success(result) {
                                    console.log("Alert dialog closed");
                                },
                                function (error) {
                                    $('#update_products').removeClass('is-active');
                                    console.log(error.message + "#611 Api failed ss_ProductSelector Matrix. Cannot get data from entity product price levels");
                                });

                        }
                    }
                };
                MakeFieldsReadOnly();
                req.send();

            } //end of loadProducts

            $(document).on("focusin", ".DiscountedSetupTextbox", function () {
                // skip for arrow keys
                ///marker111

                var discountedsetuptextboxvalue = $(this).val();
                singlesetupfield = $(this).val();

                var obj = RemoveFormattings(discountedsetuptextboxvalue);
                if (DecimalSymbol === ',') {
                    obj = obj.replace('.', ',');
                }

                $(this).val(obj);

            });
            $(document).on("focusout", ".DiscountedSetupTextbox", function () {
                // skip for arrow keys
                //marker 212

                var textboxvalue = $(this).val();

                // textboxvalue = Number.parseInt(textboxvalue);
                //now
                if (DecimalSymbol === ',') {
                    // for german
                    textboxvalue = textboxvalue.replace(',', '.');
                    // textboxvalue = Number.parseFloat(textboxvalue);
                } else {
                    //textboxvalue = Number.parseFloat(textboxvalue);
                }
                //til-now
                //console.log(textboxvalue);
                if (textboxvalue >= 0) {

                    var obj = AddFormattings(textboxvalue);
                    //now

                    //til-now

                    $(this).val(obj);


                }
            });
            $(document).on("focusin", ".DiscountedLicTextbox", function () {
                // skip for arrow keys
                //    debugger;
                var textboxvalue = $(this).val();
                singlelicensefield = $(this).val();

                var obj = RemoveFormattings(textboxvalue);
                if (DecimalSymbol === ',') {
                    obj = obj.replace('.', ',');
                }
                $(this).val(obj);

            });
            //===========

            $(document).on("focusout", ".DiscountedLicTextbox", function () {
                // skip for arrow keys
                //  debugger;
                var textboxvalue = $(this).val();

                //textboxvalue = Number.parseInt(textboxvalue);
                //now
                if (DecimalSymbol === ',') {
                    // for german
                    textboxvalue = textboxvalue.replace(',', '.');
                    // textboxvalue = Number.parseFloat(textboxvalue);
                } else {
                    // textboxvalue = Number.parseFloat(textboxvalue);
                }
                //til-now
                if (textboxvalue >= 0) {
                    var obj = AddFormattings(textboxvalue);
                    //now

                    //til-now

                    $(this).val(obj);


                }

            });

            //==============
            $(document).on("focusin", ".mDiscountedLicTextbox", function () {
                // skip for arrow keys
                //    debugger;
                var textboxvalue = $(this).val();
                singlemlicensefield = $(this).val();
                var obj = RemoveFormattings(textboxvalue);
                if (DecimalSymbol === ',') {
                    obj = obj.replace('.', ',');
                }
                $(this).val(obj);

            });
            $(document).on("focusout", ".mDiscountedLicTextbox", function () {
                // skip for arrow keys
                //  debugger;
                var textboxvalue = $(this).val();
                //textboxvalue = Number.parseInt(textboxvalue);
                //now
                if (DecimalSymbol === ',') {
                    // for german
                    textboxvalue = textboxvalue.replace(',', '.');
                    // textboxvalue = Number.parseFloat(textboxvalue);
                }
                //til-now
                if (textboxvalue >= 0) {
                    var obj = AddFormattings(textboxvalue);
                    //now

                    //til-now

                    $(this).val(obj);



                }

            });
            //for getting the opportunity product later to be used for already added products
            function getOpportunityProducts() {

                var id = opener.parent.Xrm.Page.data.entity.getId();
                var fetchXml = '<fetch>' +
                    '<entity name="opportunityproduct" >' +
                    '<all-attributes />' +
                    '  <filter>' +
                    '    <condition attribute="opportunityid" operator="eq" value="' + id + '" />' +
                    '  </filter>' +
                    '   <order attribute="productidname" />' +
                    '<link-entity name="product" from="productid" to="productid" link-type="outer"  >' +
                    '  <attribute name="producttypecode" />' +
                    ' <link-entity name="ss_productdescription" from="ss_productsid" to="productid" link-type="outer" alias="pdescrition" >' +
                    '  <attribute name="ss_name" />' +
                    ' </link-entity>' +
                    '  </link-entity>' +
                    '</entity>' +
                    '</fetch>';

                var req = new XMLHttpRequest();
                req.open("GET", parent.Xrm.Utility.getGlobalContext().getClientUrl() + "/api/data/v8.0/opportunityproducts?fetchXml=" + encodeURI(fetchXml), true);
                req.setRequestHeader("OData-MaxVersion", "4.0");
                req.setRequestHeader("OData-Version", "4.0");
                req.setRequestHeader("Accept", "application/json");
                req.setRequestHeader("Prefer", "odata.include-annotations=\"OData.Community.Display.V1.FormattedValue\"");
                req.onreadystatechange = function () {
                    if (this.readyState === 4) {
                        req.onreadystatechange = null;
                        if (this.status === 200) {
                            oportunityproducts = JSON.parse(this.response);
                            loadproducts();
                        }
                        else {
                            alert(this.statusText);
                        }
                    }

                };
                req.send();
            }
            //Adding Products in the opportunity
            var contractnumber = 0;
            function addProducts(productId, UnitId, csdate) {
                //debugger;
                var testCount = 0;

                var entitycollection = [];


                var opID = window.top.opener.parent.Xrm.Page.data.entity.getId();
                //var contractnumber = 0;
                for (var i = 0; i < productId.length; i++) {
                    var subtable = "";
                    var isLicProduct = false;
                    var entity = {};
                    entity["uomid@odata.bind"] = "/uoms(" + UnitId[i].replace('{', '').replace('}', '') + ")";
                    entity["productid@odata.bind"] = "/products(" + productId[i].replace('{', '').replace('}', '') + ")";
                    entity["opportunityid@odata.bind"] = "/opportunities(" + opID.replace('{', '').replace('}', '') + ")";

                    if ($("#" + productId[i] + "_C").length > 0 && $("#" + productId[i] + "_Setup").length > 0) {

                        //nh================================
                        subtable = $("#" + productId[i] + "_P").closest('tr').next();
                        var crmproductgroups = $("#" + productId[i] + "_P").closest('tr').find('td:eq(20)').attr('id');
                        var productmaincategory = $("#" + productId[i] + "_P").closest('tr').find('td:eq(21)').attr('id');
                        var oppProdDesc = $("#" + productId[i] + "_P").closest('tr').find('td:last-child').text();

                        if (crmproductgroups != undefined && crmproductgroups != "") {
                            entity.ss_crmproductgroups = parseInt(crmproductgroups);
                        }
                        if (productmaincategory != undefined && productmaincategory != "") {
                            entity.ss_productmaincategory = parseInt(productmaincategory);
                        }
                        //  if(oppProdDesc === undefined || oppProdDesc === null || oppProdDesc === "undefined")
                        //  {
                        //     entity.ss_customdescription =  "";
                        //  }
                        //  else
                        //  {
                        //     entity.ss_customdescription = "\n" + oppProdDesc.replace("20", );                            
                        //  }
                        //===============================nh
                        if ($("#" + productId[i] + "_P").html() != null && $("#" + productId[i] + "_P").html() != "" && $("#" + productId[i] + "_P").html() != undefined) {
                            entity.ispriceoverridden = true;    //overridden
                            entity.priceperunit = Number($("#" + productId[i] + "_P").html());
                        }
                        //===

                        entity.ss_monthlylicensefee = 0.00;


                        //===
                        if ($("#" + productId[i] + "_C").val() != null && $("#" + productId[i] + "_C").val() != "" && $("#" + productId[i] + "_C").val() != undefined) {
                            entity.description = $("#" + productId[i] + "_C").val();
                        }
                        if ($("#" + productId[i] + "_Setup").text() != null && $("#" + productId[i] + "_Setup").text() != "" && $("#" + productId[i] + "_Setup").text() != undefined) {
                            entity.manualdiscountamount = Number($("#" + productId[i] + "_Setup").html());
                        }
                        producttype = 717800000;
                        // contractnumber = contractnumber + 10000;
                        // entity.ss_contractlinenumber = contractnumber;

                    }
                    else if ($("#" + productId[i] + "_Lic").length > 0) {
                        //nh================================
                        isLicProduct = true;
                        subtable = $("#" + productId[i] + "_LP").closest('tr').next();
                        var crmproductgroups = $("#" + productId[i] + "_LP").closest('tr').find('td:eq(20)').html();
                        var productmaincategory = $("#" + productId[i] + "_LP").closest('tr').find('td:eq(21)').html();
                        var oppProdDesc = $("#" + productId[i] + "_LP").closest('tr').find('td:last-child').text();

                        if (crmproductgroups != undefined && crmproductgroups != "") {
                            entity.ss_crmproductgroups = parseInt(crmproductgroups);
                        }
                        if (productmaincategory != undefined && productmaincategory != "") {
                            entity.ss_productmaincategory = parseInt(productmaincategory);
                        }

                        //===============================nh
                        if ($("#" + productId[i] + "_LP").html() != null && $("#" + productId[i] + "_LP").html() != "" && $("#" + productId[i] + "_LP").html() != undefined) {
                            entity.ispriceoverridden = true;    //overridden

                            entity.priceperunit = Number($("#" + productId[i] + "_LP").html());

                        }

                        //=========
                        if ($("#" + productId[i] + "_MLP").html() != null && $("#" + productId[i] + "_MLP").html() != "" && $("#" + productId[i] + "_MLP").html() != undefined) {

                            entity.ss_monthlylicensefee = Number($("#" + productId[i] + "_MLP").html());
                        }
                        //=======
                        if ($("#" + productId[i] + "_Lic").html() != null && $("#" + productId[i] + "_Lic").html() != "" && $("#" + productId[i] + "_Lic").html() != undefined) {
                            entity.manualdiscountamount = Number($("#" + productId[i] + "_Lic").html());


                        }
                        producttype = 717800001;
                        contractnumber = contractnumber + 10000;
                        entity.ss_contractlinenumber = contractnumber;
                    }
                    //============
                    if ($("#" + productId[i] + "_SDATE").val() != null && $("#" + productId[i] + "_SDATE").val() != "" && $("#" + productId[i] + "_SDATE").val() != undefined) {

                        var ContractSDate = new Date($("#" + productId[i] + "_SDATE").val());
                        if (ContractSDate > contractStartDate) {
                            contractStartDate = ContractSDate;

                        }



                        entity.ss_startdate = $("#" + productId[i] + "_SDATE").val();
                    }
                    else {
                        entity.ss_startdate = null;
                    }
                    if ($("#" + productId[i] + "_EDATE").html() != null && $("#" + productId[i] + "_EDATE").val() != "" && $("#" + productId[i] + "_EDATE").val() != undefined) {

                        entity.ss_termenddate = $("#" + productId[i] + "_EDATE").val();
                        var tempEndDate = new Date($("#" + productId[i] + "_EDATE").val());
                        if (tempEndDate > contractEndDate) {
                            contractEndDate = tempEndDate;
                        }

                    }
                    else {
                        entity.ss_termenddate = null;
                    }
                    if ($("#" + productId[i] + "_CL").length > 0) {

                        var contractlength = $("#" + productId[i] + "_CL").closest('tr').find('.contract_val').val();

                        entity.ss_productcontractlength = parseInt(contractlength);

                    }
                    //EQS Compliance Cockpit
                    if ($("#ComplianceCockpitCheckbox").is(':checked')) {
                        entity.ss_eqscompliancecockpit = true;
                        entity.ss_compliancecockpitsetupfee_ps = parseFloat(RemoveFormattings($("#setupfee").val()));
                        entity.ss_compliancecockpitmonthlyfee_ps = parseFloat(RemoveFormattings($("#monthlyfee").val()));
                        entity.ss_compliancecockpityearlyfee_ps = parseFloat(RemoveFormattings($("#yearlyfee").val()));
                    }
                    else {
                        entity.ss_eqscompliancecockpit = false;
                    }
                    //Nh======================17-July-2020============
                    var subtableClass = $(subtable).attr('class');


                    if (subtableClass === "OppProducts") {
                        AddSubTableDataForIntegrityLineComplianceCockpit(entity, subtable, isLicProduct, oppProdDesc);
                    }
                    else if (subtableClass === "OppProducts2") {
                        AddSubTableDataForIntegrityAdd_On(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts3" || subtableClass === "OppProducts4") {
                        AddSubTableDataForPolicyManager(entity, subtable, isLicProduct);
                    }
                    //new
                    else if (subtableClass === "OppProducts5") {
                        AddSubTableDataForRegulatoryNews(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts6") {
                        AddSubTableForIntegrityClassic(entity, subtable, isLicProduct, oppProdDesc);
                    }
                    else if (subtableClass === "OppProducts7") {
                        AddSubTableForBKMS(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts8") {
                        AddSubTableForBKMSCaseManagement(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts10") {
                        AddSubTableForBKMSSystemAddOn(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts11") {
                        AddSubTableForBKMSCaseManagementAddon(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts12") {
                        BKMSThirdPartyData(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts13") {
                        AddSubTableForBKMSSystemAddOnComplianceAddon(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts14") {
                        AddSubTableForLicenseRulebot(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts15") {
                        AddSubTableForLicensAdditionalRulebookClient(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts16") {
                        AddSubTableDataForInitizationandUpdateRulebook(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts17") {
                        AddSubTableForOnboardingOneoffservicesRulebook(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts18") {
                        AddDataTableForLicenseRulebookPlatform(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts19") {
                        AddSubTableDataForPAKCheck(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts20") {
                        EQSApprovalManagerAddonData(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts24") {
                        AddDataTabeForRiskManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts25") {
                        AddDataTabeForApprovalManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts26") {
                        AddDataTabeForPolicyManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts27") {
                        AddSubTableDataForIntegrityLineComplianceCockpit(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts28") {
                        AddDataTableForEQSComplianceCockpitPlatform(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts29") {
                        AddSubTableDataForIntegrityLine(entity, subtable, isLicProduct);
                    }
                    //======================17-July-2020===============nH

                    var x = $("#_SDATE").val();
                    entity.ss_producttype = producttype;
                    entity.quantity = Number(parseFloat(1).toFixed(5));
                    entitycollection.push(JSON.stringify(entity));
                }
                //=======
                // if (testCount == 0) {
                //     opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").setValue(null);
                // }
                // if (testCount > 0) {
                //     opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").setValue(csdate);
                // }
                //=======

                var data = [];
                data.push('--batch_123789');
                data.push('Content-Type: multipart/mixed;boundary=changeset_BBB457');
                data.push('');
                //Add requests to the collection
                for (var i = 0; i < entitycollection.length; i++) {
                    data.push('--changeset_BBB457');
                    data.push('Content-Type:application/http');
                    data.push('Content-Transfer-Encoding:binary');
                    var id = i + 1;
                    data.push('Content-ID:' + id);
                    data.push('');
                    data.push('POST ' + parent.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.2/opportunityproducts HTTP/1.1');
                    data.push('Content-Type:application/json;type=entry');
                    data.push('');
                    data.push(entitycollection[i]);
                }
                data.push('--changeset_BBB457--');
                data.push('--batch_123789--');
                //alert();
                //prompt("copy",JSON.stringify(data));
                var payload = data.join('\r\n');
                $.ajax(
                    {
                        method: 'POST',
                        url: parent.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.2/$batch',
                        headers: {
                            'Content-Type': 'multipart/mixed;boundary=batch_123789',
                            'Accept': 'application/json',
                            'Odata-MaxVersion': '4.0',
                            'Odata-Version': '4.0'

                        },
                        data: payload,
                        async: false,

                        success: function (data) {
                            //console.dir(data);
                            //  $('#update_products').removeClass('is-active');

                        },
                        error: function (xhr, textStatus, errorThrown) {
                            $('#update_products').removeClass('is-active');
                            alert(textStatus + " " + errorThrown + " " + "#612 Api failed ss_productSelectorMatrix.Cannot push data into entity opportunit products");
                        }
                    });


                //updating Term Start Date and Term End Date (Changes By Zain Arshad)

                return csdate;
            }
            //Update Products in the opportunity Products
            //pointer upd1

            function updateProducts() {


                var productID = [];
                var unitID = [];
                var delProdID = [];
                var updateProductID = [];


                //getting rows which are unchecked
                $(".tbody").each(function () {
                    $(this).find("tr.opportunityProduct").each(function () {


                        var td = $(this).find('td');
                        var input = $(td[2]).find("input");
                        if (input[0].checked === false) {


                            delProdID.push($(td[0], this).html());

                            if ($(td[11], this).html() != null && $(td[11], this).html() != "") {
                                delProdID.push($(td[11], this).html());

                            }

                        }

                    });
                });

                if (delProdID.length > 0) {
                    deleteProducts(delProdID);
                    //====
                    //opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").setValue(null);
                    //===
                }


                //to add products in the Opportunity
                $(".tbody").each(function () {
                    $(this).find("tr.PriceListItem").each(function () {

                        var td = $(this).find('td');


                        var input = $(td[2]).find("input");

                        if (input[0].checked === true) {


                            productID.push($(td[0], this).html());
                            unitID.push($(td[1], this).html());

                            if ($(td[11], this).html() != null && $(td[11], this).html() != "") {
                                productID.push($(td[11], this).html());

                            }
                            if ($(td[12], this).html() != null && $(td[12], this).html() != "") {
                                unitID.push($(td[12], this).html());
                            }
                        }
                    });
                });


                if (productID.length > 0) {
                    //=======
                    var ContractStartDate = new Date("01-Sep-2001");
                    //=======
                    var ContractDate = addProducts(productID, unitID, ContractStartDate);

                }

                //to update already added products
                $(".tbody").each(function () {
                    //$(this).find("input:checkbox:checked").each(function (index, item) {
                    $(this).find("tr.opportunityProduct").each(function () {
                        //======
                        var td = $(this).find('td');
                        var input = $(td[2]).find("input");
                        if (input[0].checked === true) {
                            //=====    
                            var setupProdid = $(this).find('td.DiscountSetup').attr('id');

                            if (setupProdid != null && setupProdid != "") {
                                var id = setupProdid.split('_');
                                //alert(id[0] +" <=> "+ id[1]);
                                if (updateProductID.indexOf(id[0]) === -1) {

                                    updateProductID.push(id[0]);
                                }
                            }

                            var LicProdid = $(this).find('td.DiscountLic').attr('id');
                            if (LicProdid != null && LicProdid != "") {

                                updateProductID.push(LicProdid);
                            }
                        }
                    });
                });

                if (updateProductID.length > 0) {
                    //======
                    var ContractStartDate = new Date("01-Sep-2001");
                    //=======
                    var ContractDate = updateComments(updateProductID, ContractStartDate);

                }





                opener.parent.Xrm.Page.getAttribute("ss_productselectortimestamp").setValue(new Date());
                //Nh======================================== 14-Oct-2020
                // if(!isSaveandClose)
                // {
                //     getParentDate();
                // }

                //==================================================nH
                //=======nd

                getTotalSetupAndLicfee(isSaveandClose, productID);


                // var gettotals = getTotalSetupAndLicfee();
                // if(gettotals)
                // {
                //     opener.window.location.reload(true);
                // opener.parent.Xrm.Page.data.save().then(function () {
                //     opener.parent.Xrm.Page.data.refresh();

                //     //change M107 loader
                //     $('#update_products').removeClass('is-active');
                //     if (isSaveandClose === true) {
                //         window.close();
                //     }

                // });
                // }

            }

            function updateComments(oppoid, csdate) {

                entitycollection = [];
                var testCount = 0;

                for (var i = 0; i < oppoid.length; i++) {
                    var entity = {};
                    var subtable = "";
                    var isLicProduct = false;
                    if ($("#" + oppoid[i] + "_C").length > 0 && $("#" + oppoid[i] + "_S").length > 0 && $("#" + oppoid[i] + "_P").length > 0) {
                        //nh================================
                        subtable = $("#" + oppoid[i] + "_P").closest('tr').next();
                        var crmproductgroups = $("#" + oppoid[i] + "_P").closest('tr').find('td:eq(20)').attr('id');
                        var productmaincategory = $("#" + oppoid[i] + "_P").closest('tr').find('td:eq(21)').attr('id');
                        var oppProdDesc = $("#" + oppoid[i] + "_P").closest('tr').find('td:last-child').text();

                        if (crmproductgroups != undefined && crmproductgroups != "") {
                            entity.ss_crmproductgroups = parseInt(crmproductgroups);
                        }
                        if (productmaincategory != undefined && productmaincategory != "") {
                            entity.ss_productmaincategory = parseInt(productmaincategory);
                        }
                        //  if(oppProdDesc === undefined || oppProdDesc === null || oppProdDesc === "undefined")
                        //  {
                        //     entity.ss_customdescription =  "";
                        //  }
                        //  else
                        //  {
                        //     entity.ss_customdescription = "\n" + oppProdDesc;                            
                        //  }
                        //===============================nh
                        if ($("#" + oppoid[i] + "_P").html() != null && $("#" + oppoid[i] + "_P").html() != "" && $("#" + oppoid[i] + "_P").html() != undefined) {
                            entity.ispriceoverridden = true;    //if overridden
                            entity.priceperunit = Number($("#" + oppoid[i] + "_P").html());
                        }
                        //===

                        entity.ss_monthlylicensefee = 0.00;
                        //===
                        if ($("#" + oppoid[i] + "_S").html() != null && $("#" + oppoid[i] + "_S").html() != "" && $("#" + oppoid[i] + "_S").html() != undefined) {
                            entity.manualdiscountamount = Number($("#" + oppoid[i] + "_S").html());
                        }
                        if ($("#" + oppoid[i] + "_C").val() != null && $("#" + oppoid[i] + "_C").val() != "" && $("#" + oppoid[i] + "_C").val() != undefined) {
                            entity.description = $("#" + oppoid[i] + "_C").val();
                        }
                        // contractnumber = contractnumber + 10000;
                        // entity.ss_contractlinenumber = contractnumber;

                    }
                    else if ($("#" + oppoid[i]).length > 0 && $("#" + oppoid[i] + "_LP").length > 0) {
                        //nh================================
                        isLicProduct = true;
                        subtable = $("#" + oppoid[i] + "_LP").closest('tr').next();
                        var crmproductgroups = $("#" + oppoid[i] + "_LP").closest('tr').find('td:eq(20)').html();
                        var productmaincategory = $("#" + oppoid[i] + "_LP").closest('tr').find('td:eq(21)').html();
                        var oppProdDesc = $("#" + oppoid[i] + "_LP").closest('tr').find('td:last-child').text();

                        if (crmproductgroups != undefined && crmproductgroups != "") {
                            entity.ss_crmproductgroups = parseInt(crmproductgroups);
                        }
                        if (productmaincategory != undefined && productmaincategory != "") {
                            entity.ss_productmaincategory = parseInt(productmaincategory);
                        }

                        //===============================nh

                        testCount++;



                        if ($("#" + oppoid[i] + "_LP").html() != null && $("#" + oppoid[i] + "_LP").html() != "" && $("#" + oppoid[i] + "_LP").html() != undefined) {
                            entity.ispriceoverridden = true;    //overridden
                            entity.priceperunit = Number($("#" + oppoid[i] + "_LP").html());


                        }

                        //=======
                        if ($("#" + oppoid[i] + "_MLP").html() != null && $("#" + oppoid[i] + "_MLP").html() != "" && $("#" + oppoid[i] + "_MLP").html() != undefined) {

                            entity.ss_monthlylicensefee = Number($("#" + oppoid[i] + "_MLP").html());
                        }
                        //=============

                        if ($("#" + oppoid[i]).html() != null && $("#" + oppoid[i]).html() != "" && $("#" + oppoid[i]).html() != undefined) {
                            entity.manualdiscountamount = Number($("#" + oppoid[i]).html());


                        }
                        contractnumber = contractnumber + 10000;
                        entity.ss_contractlinenumber = contractnumber;

                    }

                    if ($("#" + oppoid[i] + "_SDATE").val() != null && $("#" + oppoid[i] + "_SDATE").val() != "" && $("#" + oppoid[i] + "_SDATE").val() != undefined) {
                        entity.ss_startdate = $("#" + oppoid[i] + "_SDATE").val();
                        var tempSDate = new Date($("#" + oppoid[i] + "_SDATE").val());
                        if (tempSDate > contractEndDate) {
                            contractStartDate = tempSDate;
                        }

                    }
                    else {
                        entity.ss_startdate = null;
                    }
                    if ($("#" + oppoid[i] + "_EDATE").val() != null && $("#" + oppoid[i] + "_EDATE").val() != "" && $("#" + oppoid[i] + "_EDATE").val() != undefined) {
                        entity.ss_termenddate = $("#" + oppoid[i] + "_EDATE").val();
                        var tempEndDate = new Date($("#" + oppoid[i] + "_EDATE").val());
                        if (tempEndDate > contractEndDate) {
                            contractEndDate = tempEndDate;
                        }
                    }
                    else {
                        entity.ss_termenddate = null;
                    }
                    var oppstartdate = $("#" + oppoid[i] + "_SDATE").val();
                    var ContractSDate = oppstartdate ? new Date(oppstartdate) : new Date("01-Sep-2001");

                    // var preContractDate = opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").getValue();
                    if (ContractSDate > csdate) {
                        csdate = ContractSDate;
                    }
                    if ($("#" + oppoid[i] + "_CL").length > 0) {
                        var contractlength = $("#" + oppoid[i] + "_CL").closest('tr').find('.contract_val').val();

                        entity.ss_productcontractlength = parseInt(contractlength);

                    }
                    //EQS Compliance Cockpit
                    if ($("#ComplianceCockpitCheckbox").is(':checked')) {
                        entity.ss_eqscompliancecockpit = true;
                        entity.ss_compliancecockpitsetupfee_ps = parseFloat(RemoveFormattings($("#setupfee").val()));
                        entity.ss_compliancecockpitmonthlyfee_ps = parseFloat(RemoveFormattings($("#monthlyfee").val()));
                        entity.ss_compliancecockpityearlyfee_ps = parseFloat(RemoveFormattings($("#yearlyfee").val()));
                    }
                    else {
                        entity.ss_eqscompliancecockpit = false;
                    }
                    //Nh======================17-July-2020===============
                    var subtableClass = $(subtable).attr('class');

                    if (subtableClass === "OppProducts") {
                        AddSubTableDataForIntegrityLineComplianceCockpit(entity, subtable, isLicProduct, oppProdDesc);
                    }
                    else if (subtableClass === "OppProducts2") {
                        AddSubTableDataForIntegrityAdd_On(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts3" || subtableClass === "OppProducts4") {
                        AddSubTableDataForPolicyManager(entity, subtable, isLicProduct);
                    }
                    //new
                    else if (subtableClass === "OppProducts5") {
                        AddSubTableDataForRegulatoryNews(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts6") {
                        AddSubTableForIntegrityClassic(entity, subtable, isLicProduct, oppProdDesc);
                    }
                    else if (subtableClass === "OppProducts7") {
                        AddSubTableForBKMS(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts8") {
                        AddSubTableForBKMSCaseManagement(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts10") {
                        AddSubTableForBKMSSystemAddOn(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts11") {
                        AddSubTableForBKMSCaseManagementAddon(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts12") {
                        BKMSThirdPartyData(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts13") {
                        AddSubTableForBKMSSystemAddOnComplianceAddon(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts14") {
                        AddSubTableForLicenseRulebot(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts15") {
                        AddSubTableForLicensAdditionalRulebookClient(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts16") {
                        AddSubTableDataForInitizationandUpdateRulebook(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts17") {
                        AddSubTableForOnboardingOneoffservicesRulebook(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts18") {
                        AddDataTableForLicenseRulebookPlatform(entity, subtable, isLicProduct)
                    }
                    else if (subtableClass === "OppProducts19") {
                        AddSubTableDataForPAKCheck(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts20") {
                        EQSApprovalManagerAddonData(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts24") {
                        AddDataTabeForRiskManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts25") {
                        AddDataTabeForApprovalManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts26") {
                        AddDataTabeForPolicyManager(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts27") {
                        AddSubTableDataForIntegrityLineComplianceCockpit(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts28") {
                        AddDataTableForEQSComplianceCockpitPlatform(entity, subtable, isLicProduct);
                    }
                    else if (subtableClass === "OppProducts29") {
                        AddSubTableDataForIntegrityLine(entity, subtable, isLicProduct);
                    }
                    //======================17-July-2020=============nH
                    entitycollection.push(JSON.stringify(entity));

                }
                //====
                // if (testCount == 0) {
                //     opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").setValue(null);
                // }
                // if (testCount > 0) {
                //     opener.parent.Xrm.Page.getAttribute("ss_contractstartdate").setValue(csdate);
                // }
                //====

                var data = [];
                data.push('--batch_9999');
                data.push('Content-Type: multipart/mixed;boundary=changeset_BBB786');
                data.push('');
                //Add requests to the collection
                for (var i = 0; i < entitycollection.length; i++) {
                    data.push('--changeset_BBB786');
                    data.push('Content-Type:application/http');
                    data.push('Content-Transfer-Encoding:binary');
                    var id = i + 1;
                    data.push('Content-ID:' + id);
                    data.push('');
                    data.push('PATCH ' + parent.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.2/opportunityproducts(' + oppoid[i].replace("{", "").replace("}", "") + ')  HTTP/1.1');
                    data.push('Content-Type:application/json;type=entry');
                    data.push('');
                    data.push(entitycollection[i]);
                }
                data.push('--changeset_BBB786--');
                data.push('--batch_9999--');
                var payload = data.join('\r\n');
                $.ajax(
                    {
                        method: 'PATCH',
                        url: parent.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.2/$batch',
                        headers: {
                            'Content-Type': 'multipart/mixed;boundary=batch_9999',
                            'Accept': 'application/json',
                            'Odata-MaxVersion': '4.0',
                            'Odata-Version': '4.0'

                        },
                        data: payload,
                        async: false,

                        success: function (data) {
                            //  $('#update_products').removeClass('is-active');



                        },
                        error: function (xhr, textStatus, errorThrown) {
                            $('#update_products').removeClass('is-active');
                            alert(textStatus + " " + errorThrown + " #613 Api falid ss_productSelectorMatrix.Cannot push data to entity opportunity product Comments");
                        }
                    });


                return csdate;
            }  //end update comments method


            function deleteProducts(delProdID) {

                var data = [];
                data.push('--batch_123456');
                data.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
                data.push('');
                //Add requests to the collection
                for (var i = 0; i < delProdID.length; i++) {
                    data.push('--changeset_BBB456');
                    data.push('Content-Type:application/http');
                    data.push('Content-Transfer-Encoding:binary');
                    var id = i + 1;
                    data.push('Content-ID:' + id);
                    data.push('');
                    data.push('DELETE ' + opener.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.1/opportunityproducts(' + delProdID[i] + ') HTTP/1.1');
                    data.push('Content-Type:application/json;type=entry');
                    data.push('');
                    data.push('{}');
                }
                data.push('--changeset_BBB456--');
                data.push('--batch_123456--');
                var payload = data.join('\r\n');
                $.ajax(
                    {
                        method: 'POST',

                        url: opener.Xrm.Utility.getGlobalContext().getClientUrl() + '/api/data/v8.1/$batch',
                        headers: {
                            'Content-Type': 'multipart/mixed;boundary=batch_123456',
                            'Accept': 'application/json',
                            'Odata-MaxVersion': '4.0',
                            'Odata-Version': '4.0'

                        },
                        data: payload,
                        async: false,
                        success: function (data, textStatus, xhr) {


                        },
                        error: function (xhr, textStatus, errorThrown) {
                            //  alert(textStatus + " " + errorThrown);
                            alert("Error Occurred \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);

                            LogExceptioninCRM(errorThrown, 0, " #614 Api failed ss_ProductSelectorMatrix. Error in deleting opportunityproducts");
                            window.close();
                        }
                    });
            }

            function calculateFee() {
                SetupFee = 0;
                licenseFee = 0;
                mlicenseFee = 0;
                discSetupFee = 0;
                discLicenseFee = 0;
                mdiscLicenseFee = 0;
                var ccsetupfee = 0;
                var ccmfee = 0;
                var ccyfee = 0;
                $(".tbody").each(function () {
                    $(this).find("input:checkbox:checked").each(function (index, item) {
                        var checkBoxClass = $(this).attr("class");
                        // if (checkBoxClass.includes("supportb") || checkBoxClass.includes("supportp") || checkBoxClass.includes("hostingp") || checkBoxClass.includes("azurecloud") || checkBoxClass.includes("supportb2") || checkBoxClass.includes("supportp2") || checkBoxClass.includes("supportb3") || checkBoxClass.includes("supportp3") || checkBoxClass.includes("integ_essential") || checkBoxClass.includes("fieldcheck_kap") || checkBoxClass.includes("fieldcheck_pak") || checkBoxClass.includes("fieldcheck") || checkBoxClass.includes("numberfield") || checkBoxClass.includes("additionaldetails") || checkBoxClass.includes("Integ_CheckBox")) {
                        //     return;
                        // }
                        //For original Setup Fee
                        var amount = ($(this).closest("tr").find(".originalSetup").html());
                        var nextRow = $(this).closest("tr").next();
                        var nextRowClass = $(nextRow).attr("class");
                        if (nextRowClass === "OppProducts") {
                            $("#ss_imphours_ps").val(CalculateImplementationHours(Number(amount)));
                        }
                        SetupFee += Number(amount);

                        //For Original License Fee
                        if ($(this).closest("tr").find(".originalLicense").html() !== undefined) {
                            var licamount = ($(this).closest("tr").find(".originalLicense").html());


                            licenseFee += Number(licamount);
                        }

                        if($(this).closest("tr").find(".moriginalLicense").html() !== undefined) {
                            var mlicamount = ($(this).closest("tr").find(".moriginalLicense").html());


                            mlicenseFee += Number(mlicamount);
                        }




                        //For discounted Setup fee
                        //var discAmount = ($(this).closest("tr").find(".DiscountedSetup").html());
                        if($(this).closest("tr").find(".DiscountedSetupTextbox").val() !== undefined) {
                            var discAmount = ($(this).closest("tr").find(".DiscountedSetupTextbox").val());
                            discAmount = RemoveFormattings(discAmount);

                            discSetupFee += Number(discAmount);
                        }


                        //for discounted License Fee
                        //var discLicAmount = ($(this).closest("tr").find(".DiscountedLic").html());
                        if($(this).closest("tr").find(".DiscountedLicTextbox").val()) {
                            var discLicAmount = ($(this).closest("tr").find(".DiscountedLicTextbox").val());
                            discLicAmount = RemoveFormattings(discLicAmount);

                            discLicenseFee += Number(discLicAmount);
                        }

                        if($(this).closest("tr").find(".mDiscountedLicTextbox").val() !== undefined) {
                            var mdiscLicAmount = ($(this).closest("tr").find(".mDiscountedLicTextbox").val());
                            mdiscLicAmount = RemoveFormattings(mdiscLicAmount);

                            mdiscLicenseFee += Number(mdiscLicAmount);
                        }
                        if ($("#ComplianceCockpitCheckbox").is(':checked') && (nextRowClass === "OppProducts24" || nextRowClass === "OppProducts25" || nextRowClass === "OppProducts26" || nextRowClass === "OppProducts27" || nextRowClass === "OppProducts28")) {

                            ccsetupfee += Number(($(this).closest("tr").find(".originalSetup").html()));
                            ccmfee += Number(($(this).closest("tr").find(".moriginalLicense").html()));
                            ccyfee += Number(($(this).closest("tr").find(".originalLicense").html()));
                        }
                    });

                });
                document.getElementById("setupFee").value = AddFormattings(discSetupFee.toFixed(2));
                document.getElementById("licFee").value = AddFormattings(discLicenseFee.toFixed(2));
                document.getElementById("mlicFee").value = AddFormattings(mdiscLicenseFee.toFixed(2));

                //EQS Compliance COckpit
                document.getElementById("setupfee").value = AddFormattings(ccsetupfee.toFixed(2));
                document.getElementById("monthlyfee").value = AddFormattings(ccmfee.toFixed(2));
                document.getElementById("yearlyfee").value = AddFormattings(ccyfee.toFixed(2));


            }
            var SetupDiscount = 0;
            var licDiscount = 0;
            var mlicDiscount = 0;

            function calculateSetupDiscount() {

                SetupDiscount = 0;
                SetupDiscount = document.getElementById("setupFee").value;

                if (DecimalSymbol === ',') {
                    // for german
                    SetupDiscount = SetupDiscount.replace(',', '.');
                }
                // var formattedNumber = AddFormattings(SetupDiscount);
                // $("#setupFee").val(formattedNumber);
                SetupDiscount = parseFloat(SetupDiscount);
                SetupFee = parseFloat(SetupFee);
                if (Number(SetupDiscount) != Number(SetupFee) && Number(SetupDiscount) < Number(SetupFee)) {
                    SetupDiscount = (SetupFee) - Number(SetupDiscount);
                }
                else {
                    SetupDiscount = 0;
                }



                changeSetupDiscount();
            }
            function calculateLicDiscount() {
                licDiscount = 0;
                licDiscount = document.getElementById("licFee").value;
                if (DecimalSymbol === ',') {
                    // for german
                    licDiscount = licDiscount.replace(',', '.');
                }
                //   document.getElementById("licFee").value = AddFormattings(licDiscount);

                if (Number(licDiscount) != Number(licenseFee) && Number(licDiscount) < Number(licenseFee)) {
                    licDiscount = (licenseFee) - Number(licDiscount);
                }


                changeLicDiscount();
                calculateFee();
            }
            //////////////
            function calculatemLicDiscount() {
                mlicDiscount = 0;
                mlicDiscount = document.getElementById("mlicFee").value;
                if (DecimalSymbol === ',') {
                    // for german
                    mlicDiscount = mlicDiscount.replace(',', '.');
                }


                if (Number(mlicDiscount) != Number(mlicenseFee) && Number(mlicDiscount) < Number(mlicenseFee)) {
                    mlicDiscount = (mlicenseFee) - Number(mlicDiscount);
                }

                changemLicDiscount();
                calculateFee();
            }
            function changeSetupDiscount() {

                var manualDiscountSum = 0.00;
                var adjustmentDiscountRow;
                $(".tbody > tr").find("input[type='checkbox']:checked").each(function () {

                    var discount = 0;
                    var originalPrice = $(this).closest("tr").find(".originalSetup").html();
                    var nextRow = $(this).closest("tr").next();
                    var nextRowClass = $(nextRow).attr("class");

                    var orignaltextboxVal = parseFloat(RemoveFormattings($(this).closest("tr").find(".DiscountedSetupTextbox").val()));
                    if (Number(originalPrice) != 0) {
                        adjustmentDiscountRow = $(this);

                    }
                    if (SetupFee != 0) {
                        discount = ((Number(originalPrice) / Number(SetupFee)) * Number(SetupDiscount)).toFixed(2);
                    }


                    $(this).closest("tr").find(".DiscountSetup").html(Number(discount).toFixed(2));
                    manualDiscountSum = Number(discount);
                    discount = (Number(originalPrice) - Number(discount)).toFixed(2);
                    var newVal = orignaltextboxVal - discount;
                    var DiscValue = discount;
                    discount = AddFormattings(discount);
                    //$(this).closest("tr").find(".DiscountedSetup").html(discount);
                    $(this).closest("tr").find(".DiscountedSetup").html('<input type="text" class="DiscountedSetupTextbox" value="' + discount + '" style="text-align:center;">');
                    if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4") {
                        if (nextRowClass === "OppProducts") {
                            $("#ss_imphours_ps").val(CalculateImplementationHours(DiscValue));
                        }
                        calculateSubTableSetupDiscount(nextRow);
                    }
                });


            }
            ///////////////
            function changemLicDiscount() {
                var adjustmentDiscountRow;
                var manualDiscountSum = 0;
                $(".tbody > tr").find("input[type='checkbox']:checked").each(function () {

                    var originalPrice = $(this).closest("tr").find(".moriginalLicense").html();
                    var originalPriceyearly = $(this).closest("tr").find(".originalLicense").html();
                    var discount = 0;
                    var nextRow = $(this).closest("tr").next();
                    var nextRowClass = $(nextRow).attr("class");
                    var yearlydiscount = 0;
                    var orignaltextboxVal = parseFloat(RemoveFormattings($(this).closest("tr").find(".mDiscountedLicTextbox").val()));
                    if (Number(originalPrice) != 0) {
                        adjustmentDiscountRow = $(this);

                    }
                    if (mlicenseFee != 0) {
                        discount = ((Number(originalPrice) / Number(mlicenseFee)) * Number(mlicDiscount)).toFixed(2);
                    }


                    discount = (Number(originalPrice) - Number(discount)).toFixed(2);
                    //$(this).closest("tr").find(".moriginalLicense").html(Number(discount).toFixed(2))
                    var yobj = discount;
                    yobj = (yobj * 12);

                    yearlydiscount = (originalPriceyearly - yobj);
                    $(this).closest("tr").find(".DiscountLic").html(Number(yearlydiscount).toFixed(2));
                    //======
                    $(this).closest("tr").find(".moriginalLicense").html(Number(discount).toFixed(2));
                    //======
                    yobj = AddFormattings(yobj);
                    var newVal = orignaltextboxVal - discount;
                    discount = AddFormattings(discount);

                    $(this).closest("tr").find(".DiscountedLicTextbox").val(yobj);
                    // $(this).closest("tr").find(".mDiscountedLicTextbox").val(discount);
                    $(this).closest("tr").find(".mDiscountedLic").html('<input type="text" class="mDiscountedLicTextbox" value="' + discount + '" style="text-align:center;">');
                    if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4") {
                        calculateSubTableMFeeDiscount(nextRow);
                    }
                });



            }
            function changeLicDiscount() {
                var adjustmentDiscountRow;
                var manualDiscountSum = 0;
                $(".tbody > tr").find("input[type='checkbox']:checked").each(function () {

                    var originalPrice = $(this).closest("tr").find(".originalLicense").html();
                    var discount = 0;
                    var nextRow = $(this).closest("tr").next();
                    var nextRowClass = $(nextRow).attr("class");
                    var orignaltextboxVal = parseFloat(RemoveFormattings($(this).closest("tr").find(".DiscountedLicTextbox").val()));
                    if (Number(originalPrice) != 0) {
                        adjustmentDiscountRow = $(this);

                    }
                    if (licenseFee != 0) {
                        discount = ((Number(originalPrice) / Number(licenseFee)) * Number(licDiscount)).toFixed(2);
                    }

                    ////
                    var test = Number(discount).toFixed(2);
                    $(this).closest("tr").find(".DiscountLic").html(Number(discount).toFixed(2));
                    manualDiscountSum += Number(discount);
                    discount = (Number(originalPrice) - Number(discount)).toFixed(2);
                    var newVal = orignaltextboxVal - discount;
                    var mobj = discount;
                    mobj = (mobj / 12);
                    //======
                    $(this).closest("tr").find(".moriginalLicense").html(Number(mobj).toFixed(2));
                    //=========
                    mobj = AddFormattings(mobj);
                    discount = AddFormattings(discount);

                    // $(this).closest("tr").find(".DiscountedLicTextbox").val(discount);
                    $(this).closest("tr").find(".mDiscountedLicTextbox").val(mobj);
                    $(this).closest("tr").find(".DiscountedLic").html('<input type="text" class="DiscountedLicTextbox" value="' + discount + '" style="text-align:center;">');
                    if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4") {
                        calculateSubTableYFeeDiscount(nextRow);
                    }
                });
                //====================


            }


            ////prac
            $(document).on("change keyup paste", "#setupFee", function (event) {
                // skip for arrow keys
                if (event.which >= 37 && event.which <= 40) { event.preventDefault(); }

                // format number
                $(this).val(function (index, value) {

                    value = value.replace(/,/g, '');// u dont need this
                    if (value > SetupFee) {
                        value = SetupFee;
                    }
                    return value;
                });
            });
            //======

            $(document).on("change paste", ".DiscountedSetupTextbox", function (event) {

                var discount = 0.00;

                var textboxval = parseFloat($(this).val());
                if ((textboxval) >= 0) {
                    $(this).closest("tr").find(".originalSetup").html(textboxval);
                    $(this).closest("tr").find(".DiscountSetup").html(Number(discount).toFixed(2));
                    RemoveAllSetupDiscounts();
                    calculateFee();
                } else {

                    alert("Please enter a positive amount");
                    $(this).val(singlesetupfield);
                }
                var nextRow = $(this).closest("tr").next();
                var nextRowClass = $(nextRow).attr("class");
                if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4" || nextRowClass === "OppProducts20") {

                    calculateSubTableSetupDiscount(nextRow);
                }

            });
            $(document).on("change paste", ".mDiscountedLicTextbox", function (event) {

                var discount = 0.00;
                var textboxvalue = parseFloat($(this).val());
                if (textboxvalue >= 0) {
                    var yfee = (textboxvalue * 12);
                    var yobj = AddFormattings(yfee);

                    $(this).closest("tr").find(".moriginalLicense").html(textboxvalue);
                    $(this).val(AddFormattings(textboxvalue));
                    $(this).closest("tr").find(".DiscountedLicTextbox").val(yobj);
                    $(this).closest("tr").find(".originalLicense").html(yfee);
                    $(this).closest("tr").find(".DiscountLic").html(Number(discount).toFixed(2));
                    //  RemoveAllmLicenceDiscounts();
                    RemoveAllLicenceDiscounts();
                    calculateFee();
                } else {
                    alert("Please enter a positive amount");
                    $(this).val(singlemlicensefield);
                    $(this).closest("tr").find(".moriginalLicense").html(singlemlicensefield);
                }
                var nextRow = $(this).closest("tr").next();
                var nextRowClass = $(nextRow).attr("class");
                if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4" || nextRowClass === "OppProducts20") {
                    calculateSubTableMFeeDiscount(nextRow);
                }


            });
            $(document).on("change paste", ".DiscountedLicTextbox", function (event) {

                var discount = 0.00;
                var textboxvalue = parseFloat($(this).val());

                if (textboxvalue >= 0) {
                    var mfee = (textboxvalue / 12);
                    var mobj = AddFormattings(mfee);

                    $(this).closest("tr").find(".moriginalLicense").html(mfee);
                    $(this).closest("tr").find(".mDiscountedLicTextbox").val(mobj);
                    $(this).val(AddFormattings(textboxvalue));
                    $(this).closest("tr").find(".originalLicense").html(textboxvalue);
                    $(this).closest("tr").find(".DiscountLic").html(Number(discount).toFixed(2));
                    RemoveAllLicenceDiscounts();
                    // RemoveAllmLicenceDiscounts();
                    calculateFee();
                } else {
                    alert("Please enter a positive amount");
                    $(this).val(singlelicensefield);
                    $(this).closest("tr").find(".originalLicense").html(singlelicensefield);
                }
                var nextRow = $(this).closest("tr").next();
                var nextRowClass = $(nextRow).attr("class");
                if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4" || nextRowClass === "OppProducts20") {
                    calculateSubTableYFeeDiscount(nextRow);
                }


            });
            //======
            $(document).on("change paste", "#setupFee", function (event) {
                if (($(this).val()) >= 0) {



                    calculateSetupDiscount();

                } else {

                    //resetting to original

                    $(this).val(setupfield);
                    alert("Please enter a positive amount");
                }

            });
            //=========
            $(document).on("change paste", "#licFee", function () {
                if (($(this).val()) >= 0) {
                    calculateLicDiscount();
                } else {

                    //resetting to original

                    $(this).val(licensefield);
                    alert("Please enter a positive amount");
                }
            });

            $(document).on("change paste", "#mlicFee", function () {
                if (($(this).val()) >= 0) {
                    calculatemLicDiscount();
                } else {

                    //resetting to original

                    $(this).val(mlicensefield);
                    alert("Please enter a positive amount");
                }
            });
            //=========
            $(document).on("change keyup paste", "#licFee", function () {
                // skip for arrow keys
                if (event.which >= 37 && event.which <= 40) { event.preventDefault(); }

                // format number
                $(this).val(function (index, value) {

                    value = value.replace(/,/g, '');// u dont need this
                    if (value > licenseFee) {
                        value = licenseFee;
                    }
                    return value;
                });
            });
            $(document).on("change keyup paste", "#mlicFee", function () {
                // skip for arrow keys
                if (event.which >= 37 && event.which <= 40) { event.preventDefault(); }

                // format number
                $(this).val(function (index, value) {

                    value = value.replace(/,/g, '');// u dont need this
                    if (value > mlicenseFee) {
                        value = mlicenseFee;
                    }
                    return value;
                });
            });
            ////end prac
            // function setTermination() {
            //     var option = document.getElementById("terminate").value;
            //     opener.parent.Xrm.Page.getAttribute("ss_terminationperiod").setValue(Number(option));
            // }
            // function setContract() {
            //     var option = document.getElementById("contract").value;
            //     opener.parent.Xrm.Page.getAttribute("ss_contractperiod").setValue(Number(option));

            // }
            function retrieveUserSettings() {

                // V8.00 Method for get userID :   var userId = opener.parent.Xrm.Page.context.getUserId();

                //Bellow line is V9.00 Method for get userID, cahnged by SS_A.Jawad:

                var userId = globelcontext.userSettings.userId;
                userId = userId.replace(/[{}]/g, "");

                var req = new XMLHttpRequest();
                req.open("GET", parent.Xrm.Utility.getGlobalContext().getClientUrl() + "/api/data/v8.0/usersettingscollection(" + userId + ")?$select=decimalsymbol,numberseparator,uilanguageid", true);
                req.setRequestHeader("OData-MaxVersion", "4.0");
                req.setRequestHeader("OData-Version", "4.0");
                req.setRequestHeader("Accept", "application/json");
                req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
                req.setRequestHeader("Prefer", "odata.include-annotations=\"OData.Community.Display.V1.FormattedValue\"");
                req.onreadystatechange = function () {
                    if (this.readyState === 4) {
                        req.onreadystatechange = null;
                        if (this.status === 200) {
                            var result = JSON.parse(this.response);
                            retrieveUserSettingsCallBack(result);

                        }
                        else {
                            alert(this.statusText);
                        }
                    }
                };
                req.send();


            }
            function retrieveUserSettingsCallBack(result) {

                DecimalSymbol = result["decimalsymbol"];
                NumberSeparator = result["numberseparator"];
                UILanguageId = result["uilanguageid"];
                // if (UILanguageId === 1031) {
                //     //need to replace invalid character in preceding code line row checkboxrow
                //     document.getElementById("plusimage").title = "Fügen Sie den Datensatz Verkaufschance (Produkt) hinzu.";
                //     document.getElementById("headerRow").innerHTML = "<tr id='headerRow'><th id='headercolumn'></th><th width='33%'>Produktname</th><th width='7%'>Einheit</th><th width='12%'>Einzelpreis</th><th width='10%'>Menge</th><th width='10%'>Rabatt</th><th width='13%'>Erweiterter Betrag</th><th width='10%'></th></tr>";
                // }
                var TransactionCurrwncyId = opener.parent.Xrm.Page.getAttribute("transactioncurrencyid").getValue();

                var Tid = TransactionCurrwncyId[0].id;
                Tid = Tid.replace("{", "").replace("}", "");
                retrieveCurrencySymbol(Tid);
            }
            function retrieveCurrencySymbol(Tid) {

                opener.parent.Xrm.WebApi.online.retrieveRecord("transactioncurrency", Tid, "?$select=currencysymbol").then(
                    function success(result) {
                        CurrencySymbol = result["currencysymbol"];
                        //Nh=======================================
                        app = "";
                        contractMail = "";
                        EQSIRCockpit = "";
                        news = "";
                        webcast = "";
                        reports = "";
                        LEI = "";
                        tool = "";
                        compliance = "";
                        XMLPRCockpit = "";
                        XMLKonzerngesellschaften = "";
                        XMLKonzern = "";
                        XMLFonds = "";
                        if (location.search != "") {
                            vals = location.search.substr(1).split("&");
                            for (var i in vals) {
                                vals[i] = vals[i].replace(/\+/g, " ").split("=");
                            }
                            //look for the parameter named 'data'
                            var found = false;
                            for (var i in vals) {
                                if (vals[i][0].toLowerCase() === "data") {
                                    parseDataValue(vals[i][1]);
                                    found = true;
                                    break;
                                }
                            }
                        }
                        //=======================================nH

                    },
                    function (error) {
                        parent.Xrm.Utility.alertDialog(error.message);
                    }
                );

            }
            // function retrieveCurrencySymbolCallBack(result) {

            //     CurrencySymbol = result["currencysymbol"];

            // }
            function showLoaderandCallUpdate(x) {
                //change M107 loader
                if (x === 0) {
                    isSaveandClose = true;
                }
                else {
                    isSaveandClose = false;
                }

                //irf: check for Feature Tier (All Applications):*	any of the checkbox should be checked
                if ($(".ComplianceDependent").is(":checked") && (!$(".integcheckbox1").is(":checked") && !$(".integcheckbox2").is(":checked") && !$(".integcheckbox3").is(":checked"))) {

                    var alertStrings = { confirmButtonLabel: "Ok", text: "Feature tier application is not selected" };
                    var alertOptions = { height: 150, width: 330 };
                    Xrm.Navigation.openAlertDialog(alertStrings, alertOptions).then(
                        function success(result) {
                            return;
                        },
                        function (error) {
                            console.log(error.message);
                        });
                }

                //===============================================================15-Sep-2020
                //irf: added else conditon
                else {
                    var isBasicOrPremiumChecked = false;
                    var isSubTableIntegrityIncluded = false;
                    var isBasic2OrPremium2Checked = false;
                    var isSubTablePolicyIncluded = false;
                    $(".tbody").each(function () {
                        $(this).find(".checkboxClass").each(function (index, item) {
                            var isChecked = $(this).prop("checked");

                            if (isChecked) {

                                var nextRow = $(this).closest("tr").next();
                                var nextRowClass = $(nextRow).attr("class");
                                if (nextRowClass === "OppProducts" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4") {
                                    if (nextRowClass === "OppProducts") {
                                        isSubTableIntegrityIncluded = true;
                                        var subTBody = $(nextRow).find('td:eq(1)').find('.subtableBody');
                                        var tr6 = $(subTBody).find('tr:eq(6)');
                                        var tr7 = $(subTBody).find('tr:eq(7)');
                                        var sBasic = $(tr6).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                                        var sprofessional = $(tr7).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                                        if (sBasic || sprofessional) {
                                            isBasicOrPremiumChecked = true;
                                        }
                                    }
                                    else {
                                        isSubTablePolicyIncluded = true;
                                        var subTBody = $(nextRow).find('td:eq(1)').find('.subtableBody');
                                        var tr5 = $(subTBody).find('tr:eq(5)');
                                        var tr6 = $(subTBody).find('tr:eq(6)');
                                        var sBasic = $(tr5).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                                        var sprofessional = $(tr6).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                                        if (sBasic || sprofessional) {
                                            isBasic2OrPremium2Checked = true;
                                        }
                                    }


                                }

                            }

                        });


                    });

                    //=====================================================================Nh
                    if ((!isBasicOrPremiumChecked && isSubTableIntegrityIncluded) || (!isBasic2OrPremium2Checked && isSubTablePolicyIncluded)) {
                        var alertStrings = { confirmButtonLabel: "Ok", text: "Please select atleast one Basic Support or Professional Support" };
                        var alertOptions = { height: 150, width: 330 };
                        Xrm.Navigation.openAlertDialog(alertStrings, alertOptions).then(
                            function success(result) {

                            },
                            function (error) {
                                console.log(error.message);
                            });
                    }
                    else {
                        $('#update_products').attr('data-text', 'Updating Products');
                        $('#update_products').addClass('is-active');
                        setTimeout(function () { updateProducts(); }, 100);
                    }
                }

            }
            function getTotalSetupAndLicfee(isSaveandClose, productID) {
                var Oppid = opener.parent.Xrm.Page.data.entity.getId();
                // var TotalLicensefee = discLicenseFee.toFixed(2);
                // var TotalSetupfee = discSetupFee.toFixed(2);
                var TotalLicensefee = discLicenseFee;
                var TotalSetupfee = discSetupFee;
                var tempdate = new Date("01-Sep-2001");
                var tempcontractenddate = null;
                var tempcontractstartdate = null;
                if (contractEndDate > tempdate) {

                    tempcontractenddate = contractEndDate;
                }
                if (tempcontractstartdate > tempdate) {

                    tempcontractstartdate = contractStartDate;
                }

                //nh===========
                var entity = {};
                entity.ss_totallicencefee = TotalLicensefee;
                entity.ss_totalsetupfee = TotalSetupfee;
                entity.ss_contractenddate = tempcontractenddate;
                entity.ss_contractstartdate = tempcontractstartdate;
                // if (productID.includes("ba498df7-9f53-ed11-bba2-000d3addc3f9")) {
                //     entity.ss_createxmlaccount = true;
                //     var ss_createxmlaccount = opener.parent.Xrm.Page.getControl("ss_createxmlaccount");
                //     if(ss_createxmlaccount) {
                //         ss_createxmlaccount.setVisible(true);
                //     }
                // }

                opener.parent.Xrm.WebApi.online.updateRecord("opportunity", Oppid, entity).then(
                    function success(result) {
                        var updatedEntityId = result.id;
                        opener.window.location.reload(true);
                        opener.parent.Xrm.Page.data.save().then(function () {
                            opener.parent.Xrm.Page.data.refresh();

                            //change M107 loader
                            $('#update_products').removeClass('is-active');
                            if (isSaveandClose === true) {
                                window.close();
                            }
                            else {
                                getParentDate();
                            }

                        });
                    },
                    function (error) {
                        opener.parent.Xrm.Utility.alertDialog("Error " + error.message);
                    }
                );
                //===========nh            
            }
        }
        catch (err) {
            alert(err.message);
        }
    </script>

    <div class="loader loader-default is-active" id="update_products" data-text="Loading"></div>
    <ul class="nav nav-tabs">
        <li class="active">
            <a data-toggle="tab" href="#home"> IR Cockpit </a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu1"> IR Products </a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu2"> Compliance Cockpit </a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu3"> Compliance Product </a>
        </li>
    </ul>

    <div class="container" id="mainContainer">
        <div class="tab-content" id="product-list">
            <div id="home" class="tab-pane fade in active">
                <div class="tablepopulate" id="tblEQSIRCockpit"></div>
                <div class="tablepopulate" id="homeTbl1"></div>
                <div class="tablepopulate" id="homeTbl2"></div>
            </div>
            <div id="menu1" class="tab-pane fade"></div>
            <div id="menu2" class="tab-pane fade"></div>
            <div id="menu3" class="tab-pane fade"></div>
        </div>
        <div id="functionalArea">

            <div class="sumAmount" id="sumAmount">

                <div class="row" id="row">
                    <div class="col-sm-2" id="sb">
                        <label class="textbox_main">Setup</label>
                        <input type="text" pattern="[0-9]" class="SetupTextBox textbox_main" id="setupFee">
                    </div>
                    <div class="col-sm-2" id="mlb">
                        <label class="textbox_main">Monthly License</label>
                        <input type="text" class="SetupTextBox textbox_main" id="mlicFee">
                    </div>
                    <div class="col-sm-2" id="lb">
                        <label class="textbox_main">Yearly License</label>
                        <input type="text" class="SetupTextBox textbox_main" id="licFee">
                    </div>
                    <!-- <div class="col-sm-2">
                        <label class="textbox_main">Contract</label>
                        <select id="contract" class="textbox_main" onchange="setContract()">
                            <option value="0">None</option>
                            <option value="1">12</option>
                            <option value="2">18</option>
                            <option value="3">24</option>
                            <option value="4">36</option>
                        </select>
                    </div>
                    <div class="col-sm-2">
                        <label class="textbox_main">Termination</label>
                        <select id="terminate" class="textbox_main" onchange="setTermination()">
                            <option value="0">None</option>
                            <option value="1">1 Month</option>
                            <option value="2">3 Months</option>
                        </select>
                    </div> -->
                </div>
            </div>

            <div class="single-button" id="savebutton">
                <button class="btn btn-primary text-center btn_main" id="CancelOp_button" onclick="showLoaderandCallUpdate(0);">Save
                    And Close</button>
                <button class="btn btn-primary text-center btn_main" id="SaveOp_button" onclick="showLoaderandCallUpdate(1);">Save
                    Changes</button>
                <button class="btn btn-primary text-center btn_main" id="CancelOp_button" onclick="window.close()">Discard
                    Changes</button>

                <!-- <div id="msgDiv" style="display:none;margin-top: -520px; opacity:0.5; animation: 3s rotate linear infinite;"><img alt="" src="ss_bigloaderstill"></div>-->
                <!-- <div id="msgDiv" style="margin-top: -35px; padding-left: 210px;" class="loader"><img alt='' src='/_imgs/AdvFind/progress.gif' /></div> -->
                <!--<div id="msgDivText" style="margin-top: -190px;  text-align: center;  font-size: large; font-weight: bolder;">Loading Products...</div>-->
            </div>
        </div>
    </div>

    <script>
        $(document).on("focusin", "#setupFee", function () {

            // skip for arrow keys
            // marker111
            var textboxvalue = $(this).val();
            setupfield = textboxvalue;

            //debugger;
            var obj = RemoveFormattings(textboxvalue);

            if (DecimalSymbol === ',') {
                obj = obj.replace('.', ',');
            }


            $(this).val(obj);

        });
        $(document).on("focusin", "#licFee", function () {
            // skip for arrow keys

            var textboxvalue = $(this).val();
            licensefield = textboxvalue;

            var obj = RemoveFormattings(textboxvalue);
            if (DecimalSymbol === ',') {
                obj = obj.replace('.', ',');
            }


            $(this).val(obj);

        });

        $(document).on("focusin", "#mlicFee", function () {
            // skip for arrow keys

            var textboxvalue = $(this).val();
            mlicensefield = textboxvalue;
            var obj = RemoveFormattings(textboxvalue);
            if (DecimalSymbol === ',') {
                obj = obj.replace('.', ',');
            }


            $(this).val(obj);

        });
        $(function () {
            $("#setupFee").on("blur", function () {

                var textboxvalue = $(this).val();


                //marker 212

                if (DecimalSymbol === ',') {
                    textboxvalue = textboxvalue.replace(',', '.');
                }
                textboxvalue = Number.parseInt(textboxvalue);


                // textboxvalue = RemoveFormattings(textboxvalue);


                if (textboxvalue >= 0) {

                    textboxvalue = AddFormattings(textboxvalue);
                    $("#setupFee").val(textboxvalue);
                }
                else {
                    alert("Please enter a positive amount")
                    $(this).val(AddFormattings(textboxvalue));
                }

            });

        })
        $(function () {
            $("#mlicFee").on("blur", function () {

                var textboxvalue = $(this).val();
                if (DecimalSymbol === ',') {
                    textboxvalue = textboxvalue.replace(',', '.');
                }
                //marker 212
                textboxvalue = Number.parseInt(textboxvalue);
                //  textboxvalue = RemoveFormattings(textboxvalue);
                if (textboxvalue >= 0) {

                    textboxvalue = AddFormattings(textboxvalue);
                    $("#mlicFee").val(textboxvalue);

                }
                else {
                    alert("Please enter a positive amount");
                    $(this).val(AddFormattings(textboxvalue));
                }
            });
        })
        $(function () {
            $("#licFee").on("blur", function () {

                var textboxvalue = $(this).val();
                if (DecimalSymbol === ',') {
                    textboxvalue = textboxvalue.replace(',', '.');
                }
                //marker 212
                textboxvalue = Number.parseInt(textboxvalue);
                //  textboxvalue = RemoveFormattings(textboxvalue);
                if (textboxvalue >= 0) {

                    textboxvalue = AddFormattings(textboxvalue);
                    $("#licFee").val(textboxvalue);
                }
                else {
                    alert("Please enter a positive amount")
                    $(this).val(AddFormattings(textboxvalue));
                }
            });
        })
        function RemoveAllSetupDiscounts() {
            $(".tbody").each(function () {
                $(this).find("tr.opportunityProduct").each(function () {
                    //var discount=0;
                    //removing discount
                    // $(this).find('.DiscountSetup').html("");
                    //  $(this).find(".DiscountSetup").html(Number(discount).toFixed(2));

                    //resetting all to original
                    var original = $(this).find('.originalSetup').html();
                    var obj = AddFormattings(original);
                    $(this).find('.DiscountedSetupTextbox').val(obj); //removing

                });
            });
        }
        //////
        function RemoveAllmLicenceDiscounts() {
            $(".tbody").each(function () {
                $(this).find("tr.opportunityProduct").each(function () {

                    //removing discount
                    // $(this).find('.DiscountLic').html(""); //removing

                    //resetting all to original
                    var original = $(this).find('.moriginalLicense').html();
                    var obj = AddFormattings(original);
                    $(this).find('.mDiscountedLicTextbox').val(obj); //removing
                });
            });
        }
        function RemoveAllLicenceDiscounts() {
            $(".tbody").each(function () {
                $(this).find("tr.opportunityProduct").each(function () {

                    //removing discount
                    // $(this).find('.DiscountLic').html(""); //removing

                    //resetting all to original
                    var original = $(this).find('.originalLicense').html();
                    //======
                    var moriginal = original / 12;
                    moriginal = AddFormattings(moriginal);
                    $(this).find('.mDiscountedLicTextbox').val(moriginal);
                    //======
                    var obj = AddFormattings(original);
                    $(this).find('.DiscountedLicTextbox').val(obj); //removing
                });
            });
        }
        // Functions for Setting Term Start Date and End Date (Changes made by Zain Arshad)
        function dateForm(value) {
            var index = 10;
            var x = value.substring(0, index);
            var year = x.substring(0, 4);
            var month = x.substring(5, 7);
            var day = x.substring(8, 10);
            var date = year + "-" + month + "-" + day;
            return date;


        }


        function gettingCurrentDate() {
            var today = new Date();
            var dd = String(today.getDate()).padStart(2, '0');
            var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
            var yyyy = today.getFullYear();

            today = yyyy + '-' + mm + '-' + dd;

            return today;
        }

        $(document).on("click", ".integ_essential", function () {
            var isChecked = $(this).prop('checked');
            var sys_checked = $('.integrityCheckbox4').prop('checked');
            var best_checked = $('.integrityCheckbox2').prop('checked');
            var cls_checked = $('.integrityCheckbox1').prop('checked');
            if (isChecked) {
                $('.trshowhideclass').show();
            }
            else if (!sys_checked && !best_checked && !cls_checked) {
                $('.trshowhideclass').hide();
            }
        });


        $(document).on("click", ".checkboxClass", function () {


            var isChecked = $(this).prop('checked');
            var nextRowClass = $(this).closest('tr').next().attr('class');
            if (isChecked === false && (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4" || nextRowClass === "OppProducts5" || nextRowClass === "OppProducts6" || nextRowClass === "OppProducts7" || nextRowClass === "OppProducts8" || nextRowClass === "OppProducts10" || nextRowClass === "OppProducts11" || nextRowClass === "OppProducts12" || nextRowClass === "OppProducts13" || nextRowClass === "OppProducts14" || nextRowClass === "OppProducts15" || nextRowClass === "OppProducts16" || nextRowClass === "OppProducts17" || nextRowClass === "OppProducts18" || nextRowClass === "OppProducts19" || nextRowClass === "OppProducts20" || nextRowClass === "OppProducts24" || nextRowClass === "OppProducts25" || nextRowClass === "OppProducts26" || nextRowClass === "OppProducts27" || nextRowClass === "OppProducts28" || nextRowClass === "OppProducts29")) {
                $(this).closest('tr').next().hide();
            }
            else if (isChecked === true && (nextRowClass === "OppProducts" || nextRowClass === "OppProducts2" || nextRowClass === "OppProducts3" || nextRowClass === "OppProducts4" || nextRowClass === "OppProducts5" || nextRowClass === "OppProducts6" || nextRowClass === "OppProducts7" || nextRowClass === "OppProducts8" || nextRowClass === "OppProducts10" || nextRowClass === "OppProducts11" || nextRowClass === "OppProducts12" || nextRowClass === "OppProducts13" || nextRowClass === "OppProducts14" || nextRowClass === "OppProducts15" || nextRowClass === "OppProducts16" || nextRowClass === "OppProducts17" || nextRowClass === "OppProducts18" || nextRowClass === "OppProducts19" || nextRowClass === "OppProducts20" || nextRowClass === "OppProducts24" || nextRowClass === "OppProducts25" || nextRowClass === "OppProducts26" || nextRowClass === "OppProducts27" || nextRowClass === "OppProducts28" || nextRowClass === "OppProducts29")) {
                $(this).closest('tr').next().show();
            }


        });
        //new
        $(document).on("click", ".fieldcheck_pak", function () {
            var isChecked = $(this).prop('checked');
            var td = $(this).closest('td').next('td').attr('id');
            if (isChecked) {
                $('#' + td).show();
            }
            else {
                $('#' + td).hide();
            }
        });
        $(document).on("click", ".fieldcheck_kap", function () {
            var isChecked = $(this).prop('checked');
            var td = $(this).closest('td').next('td').attr('id');
            var td1 = $(this).closest('tr').find('td:last').attr('id');
            if (isChecked) {
                $('#' + td).show();
                $('#' + td1).show();
            }
            else {
                $('#' + td).hide();
                $('#' + td1).hide();
            }
        });
        $(document).on("click", "#additionaldetails", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.additionaldetailsRow').show();
            }
            else {
                $('.additionaldetailsRow').hide();
            }
        });
        $(document).on("click", ".supportp", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportb').prop('checked', false);
            }
        });
        $(document).on("click", ".supportb", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportp').prop('checked', false);
            }
        });

        $(document).on("click", ".supportp2", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportb2').prop('checked', false);
            }
        });
        $(document).on("click", ".supportb2", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportp2').prop('checked', false);
            }
        });
        $(document).on("click", ".supportp3", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportb3').prop('checked', false);
            }
        });
        $(document).on("click", ".supportb3", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.supportp3').prop('checked', false);
            }
        });

        //==========================================15-Oct-2020
        $(document).on("click", ".integrityCheckbox", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integrityCheckbox2').prop('checked', false);
                $('.integrityCheckbox3').prop('checked', false);
                $('.integrityCheckbox4').prop('checked', false);
                $('.integrityCheckbox5').prop('checked', false);
                $(".awscloudhosting").hide();
                //$('#classic_sys').hide();
            }
        });
        $(document).on("click", ".integrityCheckbox2", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integrityCheckbox').prop('checked', false);
                $('.integrityCheckbox3').prop('checked', false);
                $('.integrityCheckbox4').prop('checked', false);
                $('.integrityCheckbox5').prop('checked', false);
                $(".awscloudhosting").hide();
                $(".cockpitIL").show();
                $('.awscloud').prop('checked', false);
                // $('.integrityCheckbox4').prop('checked', false);
                //$('#classic_sys').hide();
                //$('#classic_sys').show();
            }
        });
        $(document).on("click", ".integrityCheckbox3", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integrityCheckbox').prop('checked', false);
                $('.integrityCheckbox2').prop('checked', false);
                $(".awscloudhosting").hide();
                $(".cockpitIL").show();
                $('.awscloud').prop('checked', false);
                //$('.integrityCheckbox4').prop('checked', false);
                //$('#classic_sys').hide();
                //$('#classic_sys').show();
            }
        });
        $(document).on("click", ".integrityCheckbox4", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integrityCheckbox').prop('checked', false);
                $('.integrityCheckbox5').prop('checked', false);
                $('.integrityCheckbox2').prop('checked', false);
                $('.integrityCheckbox3').prop('checked', false);
                $(".cockpitIL").hide();
                $(".awscloudhosting").show();
                $('.awscloud').prop('checked', true);
                //$('.integrityCheckbox2').prop('checked', false);
                //$('.integrityCheckbox3').prop('checked', false);
                //$('#classic_sys').show();
            }

        });
        $(document).on("click", ".integrityCheckbox5", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integrityCheckbox').prop('checked', false);
                $('.integrityCheckbox2').prop('checked', false);
                $('.integrityCheckbox3').prop('checked', false);
                $('.integrityCheckbox4').prop('checked', false);
                //$('#classic_sys').show();
            }

        });
        $(document).on("click", ".integcheckbox1", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integcheckbox2').prop('checked', false);
                $('.integcheckbox3').prop('checked', false);
                //$('#classic_sys').show();
            }
        });
        $(document).on("click", ".integcheckbox2", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integcheckbox1').prop('checked', false);
                $('.integcheckbox3').prop('checked', false);
                //$('#classic_sys').show();
            }
        });
        $(document).on("click", ".integcheckbox3", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $('.integcheckbox1').prop('checked', false);
                $('.integcheckbox2').prop('checked', false);
                //$('#classic_sys').show();
            }
        });
        // $(document).on("click", ".integrityCheckbox4", function () {
        //     var isChecked = $(this).prop('checked');
        //     if (isChecked) {
        //         $('.integrityCheckbox').prop('checked', false);
        //         //$('.integrityCheckbox2').prop('checked', false);
        //         //$('.integrityCheckbox3').prop('checked', false);
        //         //$('#classic_sys').show();
        //     }

        // });

        $(document).on("focusin", ".subTableFee, .subTableMFee, .subTableYFee, .subTableSupportFee, .subTableHostingFee, .subTableAzureFee", function () {


            var updatedsetuptextboxvalue = $(this).val();

            var obj = RemoveFormattings(updatedsetuptextboxvalue);
            if (DecimalSymbol === ',') {
                obj = obj.replace('.', ',');
            }

            $(this).val(obj);

        });
        $(document).on("focusout", ".subTableFee, .subTableMFee, .subTableYFee, .subTableSupportFee, .subTableHostingFee , .subTableAzureFee", function () {


            var textboxvalue = $(this).val();
            if (DecimalSymbol === ',') {
                textboxvalue = textboxvalue.replace(',', '.');
            }
            //marker 212
            // textboxvalue = Number.parseInt(textboxvalue);

            if (textboxvalue >= 0) {

                var obj = AddFormattings(textboxvalue);

                $(this).val(obj);

            }
        });

        $(document).on("change", ".subTableSupportMFee", function () {

            var textboxvalue = $(this).val();
            if (DecimalSymbol === ',') {
                textboxvalue = textboxvalue.replace(',', '.');
            }
            //marker 212
            // textboxvalue = Number.parseInt(textboxvalue);               
            if (textboxvalue >= 0) {
                var newYFee = AddFormattings(textboxvalue * 12);
                $(this).closest('tr').find('td:eq(4)').find('input[type=text]').val(newYFee);
                var obj = AddFormattings(textboxvalue);
                $(this).val(obj);
            }
        });
        $(document).on("change", ".subTableSupportYFee", function () {

            var textboxvalue = $(this).val();
            if (DecimalSymbol === ',') {
                textboxvalue = textboxvalue.replace(',', '.');
            }
            //marker 212
            // textboxvalue = Number.parseInt(textboxvalue);             
            if (textboxvalue >= 0) {
                var newMFeee = AddFormattings(textboxvalue / 12);
                $(this).closest('tr').find('td:eq(3)').find('input[type=text]').val(newMFeee);
                var obj = AddFormattings(textboxvalue);

                $(this).val(obj);
            }
        });
        //=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=--=-=-=-=-=-=-=-=-=-=-=-=-=-=-
        //=============================================================29-July-2020
        $(document).on("click", ".fieldcheck", function () {
            if ($(this).is(':checked')) {
                $(this).val(1);
            } else {
                $(this).val(0);
            }
        });
        //@18-1
        //  $(document).on("change", ".subTableMFee, .fieldcheck, .ILaddon .numberfield", function () {

        //     var textboxvalue = $(this).val();
        //     var thisclass = $(this).attr("class");
        //     if (DecimalSymbol === ',') 
        //     {
        //         textboxvalue = textboxvalue.replace(',', '.');
        //     }
        //         //marker 212
        //     if(thisclass == "fieldcheck"){
        //         textboxvalue = Number.parseInt(textboxvalue);
        //     }
        //     //textboxvalue = Number.parseInt(textboxvalue);

        //     if (textboxvalue >= 0 && thisclass != "numberfield") {                  
        //         var newYFee = AddFormattings(textboxvalue * 12);
        //         // $(this).closest('tr').find('td:eq(4)').find('input[type=text]').val(newYFee);
        //         $(this).closest('td').next().find('input[type=text]').val(newYFee);
        //         var obj = AddFormattings(textboxvalue);
        //         $(this).val(obj);
        //         calculateSubTableMFee(this);
        //     }
        //     else if(thisclass == "numberfield"){
        //         calculateSubTableMFee(this);
        //     }
        // });
        //  $(document).on("change", ".subTableYFee, .fieldcheck, .ILaddon .numberfield", function () {

        //     var textboxvalue = $(this).val();
        //     var thisclass = $(this).attr("class");
        //     if (DecimalSymbol === ',') 
        //     {
        //         textboxvalue = textboxvalue.replace(',', '.');
        //     }
        //         //marker 212
        //     if(thisclass == "fieldcheck"){
        //         textboxvalue = Number.parseInt(textboxvalue);
        //     }
        //     //textboxvalue = Number.parseInt(textboxvalue);

        //     if (textboxvalue >= 0 && thisclass != "numberfield") {
        //         var newMFeee = AddFormattings(textboxvalue / 12);
        //         // $(this).closest('tr').find('td:eq(3)').find('input[type=text]').val(newMFeee);
        //         $(this).closest('td').prev().find('input[type=text]').val(newMFeee);
        //         var obj = AddFormattings(textboxvalue);

        //         $(this).val(obj);
        //         calculateSubTableYFee(this);

        //     }
        //     else if(thisclass == "numberfield"){
        //         calculateSubTableYFee(this);
        //     }
        // });
        //$(document).on("change", ".subTableFee, .subTableMFee, .subTableYFee, .fieldcheck, .ILaddon, .numberfield",
        $(document).on("change", ".subTableFee, .subTableMFee, .subTableYFee, .ILaddon", function () {
            //console.log("Setup");    
            var textboxvalue = $(this).val();
            var thisclass = $(this).attr("class");
            if (DecimalSymbol === ',') {
                textboxvalue = textboxvalue.replace(',', '.');
            }
            //marker 212
            if (thisclass === "fieldcheck" || thisclass.includes("fieldcheck")) {
                textboxvalue = Number.parseInt(textboxvalue);
            }
            // textboxvalue = Number.parseInt(textboxvalue); 
            if (textboxvalue >= 0 && (thisclass === "subTableFee" || thisclass.includes("subTableFee"))) {
                var obj = AddFormattings(textboxvalue);
                calculateSubTableSetupFee(this);
            }
            else if (textboxvalue >= 0 && (thisclass === "subTableMFee" || thisclass.includes("subTableMFee"))) {
                var newYFee = AddFormattings(textboxvalue * 12);
                // $(this).closest('tr').find('td:eq(4)').find('input[type=text]').val(newYFee);
                $(this).closest('td').next().find('input[type=text]').val(newYFee);
                var obj = AddFormattings(textboxvalue);
                $(this).val(obj);
                calculateSubTableMFee(this);
            }
            else if (textboxvalue >= 0 && (thisclass === "subTableYFee" || thisclass.includes("subTableYFee"))) {
                var newMFeee = AddFormattings(textboxvalue / 12);
                // $(this).closest('tr').find('td:eq(3)').find('input[type=text]').val(newMFeee);
                $(this).closest('td').prev().find('input[type=text]').val(newMFeee);
                var obj = AddFormattings(textboxvalue);
                $(this).val(obj);
                calculateSubTableYFee(this);
            }
            else if (thisclass === "numberfield" || thisclass === "fieldcheck" || thisclass.includes("fieldcheck")) {

                calculateSubTableSetupFee(this);
                calculateSubTableMFee(this);
                calculateSubTableYFee(this);
            }
        });
        function calculateSubTableMFee(MfeeClass) {

            var subtablBody = $(MfeeClass).closest("tbody");
            var totalMFee = 0.00;
            $(subtablBody).find(".subTableMFee").each(function () {

                totalMFee += Number.parseFloat(RemoveFormattings($(this).val()));

            });
            // $(subtablBody).find("td").each(function () {

            //     //totalMFee += Number.parseFloat(RemoveFormattings($(this).val()));
            //     var thistd = $(this);

            //     if ($(thistd).find("input").attr("class") == "numberfield" && $(thistd).find(".numberfield").val() > 0) {
            //         console.log("monthly");
            //         //console.log($(this).nextAll().eq(1).find(".subTableMFee").val());
            //         totalMFee += Number.parseFloat(RemoveFormattings($(this).nextAll().eq(1).find(".subTableMFee").val()));
            //     }
            //     else if ($(thistd).find(".fieldcheck").prop('checked') === true) {
            //         totalMFee += Number.parseFloat(RemoveFormattings($(this).nextAll().find(".subTableMFee").val()));
            //     }

            //     else if ($(thistd).find("input").attr("class") == "subTableMFee" && $(thistd).find(".subTableMFee").val() > 0) {
            //         totalSetupFee += Number.parseFloat(RemoveFormattings($(this).find(".subTableMFee").val()));
            //     }

            // });
            var parentClass = $(subtablBody).closest("table").closest("tr").attr("class");
            var MainRow = "";
            if (parentClass === "OppProducts") {
                MainRow = $(subtablBody).closest(".OppProducts").prev();
            }
            else if (parentClass === "OppProducts2") {
                MainRow = $(subtablBody).closest(".OppProducts2").prev();
            }
            else if (parentClass === "OppProducts3") {
                MainRow = $(subtablBody).closest(".OppProducts3").prev();
            }
            else if (parentClass === "OppProducts4") {
                MainRow = $(subtablBody).closest(".OppProducts4").prev();
            }
            else if (parentClass === "OppProducts5") {
                MainRow = $(subtablBody).closest(".OppProducts5").prev();
            }
            else if (parentClass === "OppProducts6") {
                MainRow = $(subtablBody).closest(".OppProducts6").prev();
            }
            else if (parentClass === "OppProducts7") {
                MainRow = $(subtablBody).closest(".OppProducts7").prev();
            }
            else if (parentClass === "OppProducts8") {
                MainRow = $(subtablBody).closest(".OppProducts8").prev();
            }
            else if (parentClass === "OppProducts10") {
                MainRow = $(subtablBody).closest(".OppProducts10").prev();
            }
            else if (parentClass === "OppProducts11") {
                MainRow = $(subtablBody).closest(".OppProducts11").prev();
            }
            else if (parentClass === "OppProducts12") {
                MainRow = $(subtablBody).closest(".OppProducts12").prev();
            }
            else if (parentClass === "OppProducts13") {
                MainRow = $(subtablBody).closest(".OppProducts13").prev();
            }
            else if (parentClass === "OppProducts20") {
                MainRow = $(subtablBody).closest(".OppProducts20").prev();
            }
            else if (parentClass === "OppProducts24") {
                MainRow = $(subtablBody).closest(".OppProducts24").prev();
            }
            else if (parentClass === "OppProducts25") {
                MainRow = $(subtablBody).closest(".OppProducts25").prev();
            }
            else if (parentClass === "OppProducts26") {
                MainRow = $(subtablBody).closest(".OppProducts26").prev();
            }
            else if (parentClass === "OppProducts27") {
                MainRow = $(subtablBody).closest(".OppProducts27").prev();
            }
            else if (parentClass === "OppProducts28") {
                MainRow = $(subtablBody).closest(".OppProducts28").prev();
            }
            else if (parentClass === "OppProducts29") {
                MainRow = $(subtablBody).closest(".OppProducts29").prev();
            }

            var MfeeTextBox = $(MainRow).find(".mDiscountedLicTextbox");
            var YfeeTextBox = $(MainRow).find(".DiscountedLicTextbox");
            var Mfeeorignal = $(MainRow).find(".moriginalLicense");
            var Yfeeorignal = $(MainRow).find(".originalLicense");
            //$(MfeeTextBox).val(totalMFee);            
            //$(MfeeTextBox).trigger("change");          
            $(MfeeTextBox).val(AddFormattings(totalMFee));
            $(YfeeTextBox).val(AddFormattings(totalMFee * 12));
            $(Mfeeorignal).html(totalMFee);
            $(Yfeeorignal).html(totalMFee * 12);
            calculateFee();
        }
        function calculateSubTableYFee(YfeeClass) {
            var subtablBody = $(YfeeClass).closest("tbody");
            var totalYFee = 0.00;
            $(subtablBody).find(".subTableYFee").each(function () {

                totalYFee += Number.parseFloat(RemoveFormattings($(this).val()));

            });
            //$(subtablBody).find(".subTableYFee").each(function()
            // $(subtablBody).find("td").each(function () {
            //     //var currentTRClass = $(this).closest("tr").attr("class"); 
            //     // var supportIsChecked = false;
            //     // if(currentTRClass === "support")
            //     // {
            //     //     supportIsChecked = $(this).closest("tr").find('td:eq(1)').find('input[type=checkbox]').prop("checked");                   
            //     //     totalYFee += supportIsChecked ? Number.parseFloat(RemoveFormattings($(this).val())) : 0.00;
            //     // }

            //     //totalYFee += Number.parseFloat(RemoveFormattings($(this).val()));
            //     var thistd = $(this);
            //     if ($(thistd).find("input").attr("class") == "numberfield" && $(thistd).find(".numberfield").val() > 0) {
            //         console.log("yearly");
            //         //console.log($(this).nextAll().eq(2).find(".subTableYFee").val());
            //         totalYFee += Number.parseFloat(RemoveFormattings($(this).nextAll().eq(2).find(".subTableYFee").val()));
            //     }
            //     else if ($(thistd).find(".fieldcheck").prop('checked') === true) {
            //         totalYFee += Number.parseFloat(RemoveFormattings($(this).nextAll().eq(2).find(".subTableYFee").val()));
            //     }
            //     else if ($(thistd).find("input").attr("class") == "subTableYFee" && $(thistd).find(".subTableYFee").val() > 0) {
            //         totalSetupFee += Number.parseFloat(RemoveFormattings($(this).find(".subTableYFee").val()));
            //     }



            // });
            var parentClass = $(subtablBody).closest("table").closest("tr").attr("class");
            var MainRow = "";
            if (parentClass === "OppProducts") {
                MainRow = $(subtablBody).closest(".OppProducts").prev();
            }
            else if (parentClass === "OppProducts2") {
                MainRow = $(subtablBody).closest(".OppProducts2").prev();
            }
            else if (parentClass === "OppProducts3") {
                MainRow = $(subtablBody).closest(".OppProducts3").prev();
            }
            else if (parentClass === "OppProducts4") {
                MainRow = $(subtablBody).closest(".OppProducts4").prev();
            }
            else if (parentClass === "OppProducts5") {
                MainRow = $(subtablBody).closest(".OppProducts5").prev();
            }
            else if (parentClass === "OppProducts6") {
                MainRow = $(subtablBody).closest(".OppProducts6").prev();
            }
            else if (parentClass === "OppProducts7") {
                MainRow = $(subtablBody).closest(".OppProducts7").prev();
            }
            else if (parentClass === "OppProducts8") {
                MainRow = $(subtablBody).closest(".OppProducts8").prev();
            }
            else if (parentClass === "OppProducts10") {
                MainRow = $(subtablBody).closest(".OppProducts10").prev();
            }
            else if (parentClass === "OppProducts11") {
                MainRow = $(subtablBody).closest(".OppProducts11").prev();
            }
            else if (parentClass === "OppProducts12") {
                MainRow = $(subtablBody).closest(".OppProducts12").prev();
            }
            else if (parentClass === "OppProducts13") {
                MainRow = $(subtablBody).closest(".OppProducts13").prev();
            }
            else if (parentClass === "OppProducts20") {
                MainRow = $(subtablBody).closest(".OppProducts20").prev();
            }
            else if (parentClass === "OppProducts24") {
                MainRow = $(subtablBody).closest(".OppProducts24").prev();
            }
            else if (parentClass === "OppProducts25") {
                MainRow = $(subtablBody).closest(".OppProducts25").prev();
            }
            else if (parentClass === "OppProducts26") {
                MainRow = $(subtablBody).closest(".OppProducts26").prev();
            }
            else if (parentClass === "OppProducts27") {
                MainRow = $(subtablBody).closest(".OppProducts27").prev();
            }
            else if (parentClass === "OppProducts28") {
                MainRow = $(subtablBody).closest(".OppProducts28").prev();
            }
            else if (parentClass === "OppProducts29") {
                MainRow = $(subtablBody).closest(".OppProducts29").prev();
            }

            var YfeeTextBox = $(MainRow).find(".DiscountedLicTextbox");
            var MfeeTextBox = $(MainRow).find(".mDiscountedLicTextbox");
            var Mfeeorignal = $(MainRow).find(".moriginalLicense");
            var Yfeeorignal = $(MainRow).find(".originalLicense");


            $(MfeeTextBox).val(AddFormattings(totalYFee / 12));
            $(YfeeTextBox).val(AddFormattings(totalYFee));
            $(Mfeeorignal).html(totalYFee / 12);
            $(Yfeeorignal).html(totalYFee);
            calculateFee();
        }
        function calculateSubTableSetupFee(SetupfeeClass) {
            var subtablBody = $(SetupfeeClass).closest("tbody");
            var totalSetupFee = 0.00;
            // $(subtablBody).find("td").each(function () {
            //     var thistd = $(this);
            //     if ($(thistd).find("input").attr("class") == "numberfield" && $(thistd).find(".numberfield").val() > 0) {
            //         totalSetupFee += Number.parseFloat(RemoveFormattings($(this).next().find(".subTableFee").val()));
            //     }
            //     else if ($(thistd).find(".fieldcheck").prop('checked') === true) {
            //         totalSetupFee += Number.parseFloat(RemoveFormattings($(this).nextAll().find(".subTableFee").val()));
            //     }
            //     if ($(thistd).find("input").attr("class") == "subTableFee" && $(thistd).find(".subTableFee").val() > 0) {
            //         totalSetupFee += Number.parseFloat(RemoveFormattings($(this).find(".subTableFee").val()));
            //     }

            // });
            $(subtablBody).find(".subTableFee").each(function () {

                totalSetupFee += Number.parseFloat(RemoveFormattings($(this).val()));

            });
            var parentClass = $(subtablBody).closest("table").closest("tr").attr("class");
            var MainRow = "";
            if (parentClass === "OppProducts") {
                MainRow = $(subtablBody).closest(".OppProducts").prev();
            }
            else if (parentClass === "OppProducts2") {
                MainRow = $(subtablBody).closest(".OppProducts2").prev();
            }
            else if (parentClass === "OppProducts3") {
                MainRow = $(subtablBody).closest(".OppProducts3").prev();
            }
            else if (parentClass === "OppProducts4") {
                MainRow = $(subtablBody).closest(".OppProducts4").prev();
            }
            else if (parentClass === "OppProducts5") {
                MainRow = $(subtablBody).closest(".OppProducts5").prev();
            }
            else if (parentClass === "OppProducts6") {
                MainRow = $(subtablBody).closest(".OppProducts6").prev();
            }
            else if (parentClass === "OppProducts7") {
                MainRow = $(subtablBody).closest(".OppProducts7").prev();
            }
            else if (parentClass === "OppProducts8") {
                MainRow = $(subtablBody).closest(".OppProducts8").prev();
            }
            else if (parentClass === "OppProducts10") {
                MainRow = $(subtablBody).closest(".OppProducts10").prev();
            }
            else if (parentClass === "OppProducts11") {
                MainRow = $(subtablBody).closest(".OppProducts11").prev();
            }
            else if (parentClass === "OppProducts12") {
                MainRow = $(subtablBody).closest(".OppProducts12").prev();
            }
            else if (parentClass === "OppProducts13") {
                MainRow = $(subtablBody).closest(".OppProducts13").prev();
            }
            else if (parentClass === "OppProducts20") {
                MainRow = $(subtablBody).closest(".OppProducts20").prev();
            }
            else if (parentClass === "OppProducts24") {
                MainRow = $(subtablBody).closest(".OppProducts24").prev();
            }
            else if (parentClass === "OppProducts25") {
                MainRow = $(subtablBody).closest(".OppProducts25").prev();
            }
            else if (parentClass === "OppProducts26") {
                MainRow = $(subtablBody).closest(".OppProducts26").prev();
            }
            else if (parentClass === "OppProducts27") {
                MainRow = $(subtablBody).closest(".OppProducts27").prev();
            }
            else if (parentClass === "OppProducts28") {
                MainRow = $(subtablBody).closest(".OppProducts28").prev();
            }
            else if (parentClass === "OppProducts29") {
                MainRow = $(subtablBody).closest(".OppProducts29").prev();
            }
            var SfeeTextBox = $(MainRow).find(".DiscountedSetupTextbox");
            // var Sfeediscounted = Number.parseFloat(RemoveFormattings($(MainRow).find(".DiscountedSetupTextbox").val()));;
            // Sfeediscounted = Sfeediscounted + totalSetupFee;
            var Sfeeoriginal = $(MainRow).find(".originalSetup");


            $(SfeeTextBox).val(AddFormattings(totalSetupFee));

            $(Sfeeoriginal).html(totalSetupFee);

            calculateFee();





        }
        function calculateSubTableSetupDiscount(row) {
            var subtablBody = $(row).closest("tbody");
            var totalSFee = 0.00;
            //  var discount = orignalVal - parseFloat(newVal); 
            $(subtablBody).find(".subTableFee").each(function () {
                // var currentTRClass = $(this).closest("tr").attr("class"); 
                // var supportIsChecked = false;              
                // var tBoxVal = parseFloat(RemoveFormattings($(this).val()));
                // var discountedVal = (tBoxVal/orignalVal) * discount;

                // if(currentTRClass === "support")
                // {
                //     supportIsChecked = $(this).closest("tr").find('td:eq(1)').find('input[type=checkbox]').prop("checked");                   
                //     if(supportIsChecked === true)
                //     {
                //         $(this).val(AddFormattings(discountedVal));
                //     }

                // }

                $(this).val(AddFormattings(totalSFee));

            });
        }
        function calculateSubTableMFeeDiscount(row) {
            var subtablBody = $(row).closest("tbody");
            var totalSFee = 0.00;

            $(subtablBody).find(".subTableMFee").each(function () {

                $(this).val(AddFormattings(totalSFee));
                $(this).closest('tr').find('td:eq(4)').find('input[type=text]').val(AddFormattings(totalSFee));
            });
        }
        function calculateSubTableYFeeDiscount(row) {
            var subtablBody = $(row).closest("tbody");
            var totalSFee = 0.00;

            $(subtablBody).find(".subTableYFee").each(function () {
                $(this).val(AddFormattings(totalSFee));
                $(this).closest('tr').find('td:eq(3)').find('input[type=text]').val(AddFormattings(totalSFee));
            });
        }
        //=========================================nH 
        //=======================================================16-Sep-2020

        //EQS Compliance Cockpit Platform
        function embedSubTableForCockpitPlatform(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            var sBassicDefault = (oportunityproducts.value[OPIndex] === undefined || oportunityproducts.value[OPIndex] === "undefined" || oportunityproducts.value[OPIndex] === null) ? true : false;
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_admin = ss_languages = ss_casemanager = ss_employees = ss_includedimphours_ps = 0;
            var ss_supportbasic = ss_supportprofessional = ss_singlesignon = ss_customdomainurl_ps = ss_datasync = false;
            var ss_integrityessential = ss_integritybestpractice = ss_eqsclassicsystem_ps = ss_integrityenterprise = false;
            var ss_eqsprivatehosting = ss_azurepubliccloud = ss_supportbasic = ss_supportprofessional = false;
            var ss_adminsetup = ss_languagessetup = ss_supportbasicsetup = ss_supportprofessionalsfee = ss_casemanagersetup = ss_employeessetup = ss_eqsphsetupfee = ss_azurepcsetupfee = ss_singlesignonsetup = ss_customdomainurlsfee_ps = ss_datasyncsetupfee = ss_compliancecockpitapplicationsetupfee_ps = AddFormattings(0.00);
            var ss_adminmfee = ss_languagesmfee = ss_supportbasicmfee = ss_supportprofessionalmfee = ss_casemanagermfee = ss_employeesmfee = ss_eqsphmonthlyfee = ss_azurepcmonthlyfee = ss_singlesignonmonthly = ss_customdomainurlmfee_ps = ss_datasyncmonthlyfee = ss_compliancecockpitapplicationmonthlyfee_ps = AddFormattings(0.00);
            var ss_adminyfee = ss_languagesyfee = ss_supportbasicyfee = ss_supportprofessionalyfee = ss_casemanageryfee = ss_employeesyfee = ss_eqsphyearlyfee = ss_azurepcyearlyfee = ss_singlesignonyealry = ss_customdomainurlyfee_ps = ss_datasyncyearlyfee = ss_compliancecockpitapplicationyearlyfee_ps = AddFormattings(0.00);

            if (OPIndex >= 0) {

                //Application Fee
                ss_compliancecockpitapplicationsetupfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationsetupfee_ps"] ? oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationsetupfee_ps"] : 0.00);
                ss_compliancecockpitapplicationmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationmonthlyfee_ps"] : 0.00);
                ss_compliancecockpitapplicationyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_compliancecockpitapplicationyearlyfee_ps"] : 0.00);

                //Eseential - Professional - Enterprise
                ss_integrityessential = oportunityproducts.value[OPIndex]["ss_integrityessential"] ? "checked" : "";
                ss_integritybestpractice = oportunityproducts.value[OPIndex]["ss_integritybestpractice"] ? "checked" : "";
                ss_integrityenterprise = oportunityproducts.value[OPIndex]["ss_integrityenterprise"] ? "checked" : "";

                //Employees
                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;


                //User accounts (Named User) 
                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);

                //Admin Seats (Names User)
                ss_admin = oportunityproducts.value[OPIndex]["ss_admin"] ? oportunityproducts.value[OPIndex]["ss_admin"] : 0;
                ss_adminsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminsetup"] ? oportunityproducts.value[OPIndex]["ss_adminsetup"] : 0.00);
                ss_adminmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminmfee"] ? oportunityproducts.value[OPIndex]["ss_adminmfee"] : 0.00);
                ss_adminyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminyfee"] ? oportunityproducts.value[OPIndex]["ss_adminyfee"] : 0.00);


                // Integrity Hub Languages
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);

                //Implementation Hours
                ss_includedimphours_ps = oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] ? oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] : 0;

                //Support Basic
                ss_supportbasic = oportunityproducts.value[OPIndex]["ss_supportbasic"] ? oportunityproducts.value[OPIndex]["ss_supportbasic"] : false;

                //Support Advanced
                ss_supportprofessional = oportunityproducts.value[OPIndex]["ss_supportprofessional"] ? oportunityproducts.value[OPIndex]["ss_supportprofessional"] : false;

                //Hosting Amazon Web Services (AWS)
                ss_azurepubliccloud = oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] ? oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] : false;

                //Data Sync
                ss_datasync = oportunityproducts.value[OPIndex]["ss_datasync"] ? oportunityproducts.value[OPIndex]["ss_datasync"] : false;
                ss_datasyncsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_datasyncsetupfee"] ? oportunityproducts.value[OPIndex]["ss_datasyncsetupfee"] : 0);
                ss_datasyncmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_datasyncmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_datasyncmonthlyfee"] : 0);
                ss_datasyncyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_datasyncyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_datasyncyearlyfee"] : 0);

                //Single Sign On (SSO)
                ss_singlesignon = oportunityproducts.value[OPIndex]["ss_singlesignon"] ? oportunityproducts.value[OPIndex]["ss_singlesignon"] : false;
                ss_singlesignonsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonsetup"] ? oportunityproducts.value[OPIndex]["ss_singlesignonsetup"] : 0);
                ss_singlesignonmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonmonthly"] ? oportunityproducts.value[OPIndex]["ss_singlesignonmonthly"] : 0);
                ss_singlesignonyealry = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonyealry"] ? oportunityproducts.value[OPIndex]["ss_singlesignonyealry"] : 0);


                //Integrity Hub Languages
                ss_customdomainurl_ps = oportunityproducts.value[OPIndex]["ss_customdomainurl_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurl_ps"] : false;
                ss_customdomainurlsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlsfee_ps"] : 0);
                ss_customdomainurlmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlmfee_ps"] : 0);
                ss_customdomainurlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlyfee_ps"] : 0);



            }
            else {
                display_prop = "style='display:none'";
            }

            var sbassic = (ss_supportbasic || sBassicDefault) ? "checked" : "";
            var sprofessional = (ss_supportprofessional) ? "checked" : "";
            var azurepubliccloud = (ss_azurepubliccloud) ? "checked" : "";
            var datasync = ss_datasync ? "checked" : "";
            var singlesingon = ss_singlesignon ? "checked" : "";
            var customdomainurl = ss_customdomainurl_ps ? "checked" : "";
            var markup = "<tr class='OppProducts28' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody autoheightelement' id='" + opp_prodid + "_p'>"
                + "<tr><td class='subfield elements'> Application Fee: </td><td class='centeredelements'><input type='text'  class='subTableFee' value='" + ss_compliancecockpitapplicationsetupfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableMFee' value='" + ss_compliancecockpitapplicationmonthlyfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableYFee' value='" + ss_compliancecockpitapplicationyearlyfee_ps + "'></td></tr>"
                //irf: add span
                + "<tr><td class='subfield elements'> Feature Tier (All Applications):<span class='required' style='color:red'>*</span> </td><br><td class='centeredelements'><label>Essential</label><input type='checkbox' " + ss_integrityessential + " class='centeredelements integcheckbox1'></td><td><label>Professional</label><input type='checkbox' " + ss_integritybestpractice + " class='centeredelements integcheckbox2'></td><td><label>Enterprise</label><input type='checkbox' " + ss_integrityenterprise + " class='centeredelements integcheckbox3'></td></tr>"

                + "<tr><td class='subfield elemets'>Number of Employees <input type='number' min='0' value='" + ss_employees + "' class='floatelements'></td><td class='centeredelements'></td><td class='centeredelements'></td><td class='centeredelements'></td></tr>"

                + "<tr><td class='subfield'>User Accounts (Named User) <input type='number' min='0' value='" + ss_casemanager + "' class='floatelements'></td><td ><input type='text' at='10' class='subTableFee subfield' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_casemanageryfee + "'></td></tr>"

                + "<tr><td class='subfield'>Admin Seats (Named User) <input type='number' min='0' value='" + ss_admin + "' class='floatelements'></td><td ><input type='text' at='10' class='subTableFee subfield' value='" + ss_adminsetup + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_adminmfee + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_adminyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Integrity Hub Languages <input type='number' min='0' value='" + ss_languages + "' class='floatelements'></td><td ><input type='text' at='10' class='subTableFee subfield' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_languagesyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Implementation Hours <input type='number' min='0' value='" + ss_includedimphours_ps + "' class='floatelements'></td><td></td><td></td><td></td></tr>"

                + "<tr><td class='mainSupportTd' colspan='5'><strong> Support</strong> </td></tr>"

                + "<tr class='support'><td class='subfield'> Standard <input type='checkbox' " + sbassic + " class='supportb subSupportCheckBox floatelements checkboxelement' name=''></td><td class='centeredelements'></td><td class='centeredelements'></td><td class='centeredelements'></td></tr>"

                + "<tr class='support'><td class='subfield'> Advanced <input type='checkbox' " + sprofessional + " class='supportp subSupportCheckBox floatelements checkboxelement'></td><td class='centeredelements'></td><td class='centeredelements'></td><td class='centeredelements'></td></tr>"

                + "<tr><td class='mainSupportTd' colspan='5'><strong> Hosting </strong></td></tr>"

                + "<tr class='support'><td class='subfield'> Amazon Web Services (AWS) <input type='checkbox' " + azurepubliccloud + " class='hostingp subHostingCheckBox floatelements checkboxelement'></td><td class='centeredelements'></td><td class='centeredelements'></td><td class='centeredelements'></td></tr>"

                + "<tr><td class='mainSupportTd' colspan='5'><strong> Additional Options </strong></td></tr>"

                + "<tr class='applicaitonfee ' ><td class='subfield'> Data Sync <input type='checkbox' " + datasync + " class='floatelements checkboxelement'></td><td><input type='text'  class='subTableFee subfield' value='" + ss_datasyncsetupfee + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_datasyncmonthlyfee + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_datasyncyearlyfee + "'></td></tr>"

                + "<tr class='applicaitonfee ' ><td class='subfield'> Single-Sign-On (SSO) <input type='checkbox' " + singlesingon + " class='floatelements checkboxelement'></td><td><input type='text'  class='subTableFee subfield' value='" + ss_singlesignonsetup + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_singlesignonmonthly + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_singlesignonyealry + "'></td></tr>"

                + "<tr class='applicaitonfee ' ><td class='subfield'> Custom URL for Integrity Hub <input type='checkbox' " + customdomainurl + " class='floatelements checkboxelement'></td><td><input type='text'  class='subTableFee subfield' value='" + ss_customdomainurlsfee_ps + "'></td><td><input type='text' class='subTableMFee subfield' value='" + ss_customdomainurlmfee_ps + "'></td><td><input type='text' class='subTableYFee subfield' value='" + ss_customdomainurlyfee_ps + "'></td></tr>"

                + "</tbody></table></td></tr>";

            return markup;

        }
        //Data Table For EQS Compliance Cockpit Platform
        function AddDataTableForEQSComplianceCockpitPlatform(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            var tr4 = $(subTBody).find('tr:eq(4)');
            var tr5 = $(subTBody).find('tr:eq(5)');
            var tr6 = $(subTBody).find('tr:eq(6)');
            var tr8 = $(subTBody).find('tr:eq(8)');
            var tr9 = $(subTBody).find('tr:eq(9)');
            var tr11 = $(subTBody).find('tr:eq(11)');
            var tr13 = $(subTBody).find('tr:eq(13)');
            var tr14 = $(subTBody).find('tr:eq(14)');
            var tr15 = $(subTBody).find('tr:eq(15)');
            //Application Fee
            //entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nApplication Fee: ";
            entity.ss_compliancecockpitapplicationsetupfee_ps = parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_compliancecockpitapplicationmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_compliancecockpitapplicationyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            if ($(tr1).find('td:eq(1)').find('input[type=checkbox]').is(":checked")) {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps = "\nProduct Tier: Essential";
            }
            else if ($(tr1).find('td:eq(2)').find('input[type=checkbox]').is(":checked")) {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps = "\nProduct Tier: Professional";
            }
            else if ($(tr1).find('td:eq(3)').find('input[type=checkbox]').is(":checked")) {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps = "\nProduct Tier: Enterprise";
            }
            else {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps = "\nProduct Tier:";
            }
            //Feature Tier (All Applications)
            entity.ss_integrityessential = $(tr1).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            entity.ss_integritybestpractice = $(tr1).find('td:eq(2)').find('input[type=checkbox]').prop("checked");
            entity.ss_integrityenterprise = $(tr1).find('td:eq(3)').find('input[type=checkbox]').prop("checked");
            //Number of Employee
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\nEmployees: up to ";
            entity.ss_employees = parseInt($(tr2).find('td:eq(0)').find('input[type=number]').val());
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += entity.ss_employees;
            //Admin Seats (Names User)
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\n\nAdmin Seats (Named User): up to ";
            entity.ss_admin = parseInt($(tr4).find('td:eq(0)').find('input[type=number]').val());
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += entity.ss_admin;
            // !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\n(= Compliance Cockpit)";
            entity.ss_adminsetup = parseFloat(RemoveFormattings($(tr4).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_adminmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_adminyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            //User Accounts (Named User)
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\n\nUser accounts for Integrity Hub (Named User): up to ";
            entity.ss_casemanager = parseInt($(tr3).find('td:eq(0)').find('input[type=number]').val());
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += entity.ss_casemanager;
            // !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\n(= Integrity Hub)";
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(tr3).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            //Integriy Hub Languages
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\n\nIntegrity Hub Languages: up to ";
            entity.ss_languages = parseInt($(tr5).find('td:eq(0)').find('input[type=number]').val());
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += entity.ss_languages;
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr5).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            //Implementation Hours
            entity.ss_includedimphours_ps = parseInt($(tr6).find('td:eq(0)').find('input[type=number]').val());
            isLicProduct ? entity.ss_eqsintegrityldata_ps += "\n\nIncludes up to " + entity.ss_includedimphours_ps.toString() + " hours of setup (online kickoff, configuration, testing, online user-training and client handover)" : "";
            //Support Basic
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "\nSupport: ";
            entity.ss_supportbasic = $(tr8).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            if (entity.ss_supportbasic) {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "Standard";
            }
            //Support Advance
            entity.ss_supportprofessional = $(tr9).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            if (entity.ss_supportprofessional) {
                !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps += "Advance";
            }
            //Amazon Web Service (AWS)
            entity.ss_azurepubliccloud = $(tr11).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            //Data Sync 
            entity.ss_datasync = $(tr13).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            entity.ss_datasyncsetupfee = parseFloat(RemoveFormattings($(tr13).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_datasyncmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr13).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_datasyncyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr13).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            //Sigle - Sign-On (SSO)
            entity.ss_singlesignon = $(tr14).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            entity.ss_singlesignonsetup = parseFloat(RemoveFormattings($(tr14).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_singlesignonmonthly = isLicProduct ? parseFloat(RemoveFormattings($(tr14).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_singlesignonyealry = isLicProduct ? parseFloat(RemoveFormattings($(tr14).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            //Custom URL for Integrity Hub
            entity.ss_customdomainurl_ps = $(tr15).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            entity.ss_customdomainurlsfee_ps = parseFloat(RemoveFormattings($(tr15).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_customdomainurlmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr15).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_customdomainurlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr15).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_eqsintegrityldata_ps += "\n\nApplications Included";
            return entity;
        }
        //Risk Manager Sub Table
        function embedSubTableForRiskManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_riskmanagerappsetupfee_ps = ss_riskmanagerappmonthlyfee_ps = ss_riskmanagerappyearlyfee_ps = AddFormattings(0.00);
            if (OPIndex >= 0) {

                ss_riskmanagerappsetupfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_riskmanagerappsetupfee_ps"] ? oportunityproducts.value[OPIndex]["ss_riskmanagerappsetupfee_ps"] : 0.00);
                ss_riskmanagerappmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_riskmanagerappmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_riskmanagerappmonthlyfee_ps"] : 0.00);
                ss_riskmanagerappyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_riskmanagerappyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_riskmanagerappyearlyfee_ps"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts24' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr class=' elements'><td class='subfield'>Application Fee</td><td class='centeredelements'><input type='text' at='10' class='subTableFee' value='" + ss_riskmanagerappsetupfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableMFee' value='" + ss_riskmanagerappmonthlyfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableYFee' value='" + ss_riskmanagerappyearlyfee_ps + "'></td></tr></tbody></table></td></tr>";

            return markup;

        }
        //Risk Manager Data Table
        function AddDataTabeForRiskManager(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nApplication Fee: ";
            //entity.ss_languages = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
            entity.ss_riskmanagerappsetupfee_ps = parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_riskmanagerappmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_riskmanagerappyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            return entity;
        }
        //Approval Manager Sub Table
        function embedSubTableForApprovalManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_approvalmanagerappsetupfee_ps = ss_approvalmanagerappmonthlyfee_ps = ss_approvalmanagerappyearlyfee_ps = AddFormattings(0.00);
            if (OPIndex >= 0) {

                ss_approvalmanagerappsetupfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_approvalmanagerappsetupfee_ps"] ? oportunityproducts.value[OPIndex]["ss_approvalmanagerappsetupfee_ps"] : 0.00);
                ss_approvalmanagerappmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_approvalmanagerappmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_approvalmanagerappmonthlyfee_ps"] : 0.00);
                ss_approvalmanagerappyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_approvalmanagerappyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_approvalmanagerappyearlyfee_ps"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts25' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Application Fee</td><td class='centeredelements'><input type='text' at='10' class='subTableFee' value='" + ss_approvalmanagerappsetupfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableMFee' value='" + ss_approvalmanagerappmonthlyfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableYFee' value='" + ss_approvalmanagerappyearlyfee_ps + "'></td></tr></tbody></table></td></tr>";

            return markup;
        }
        //Approval Manager Data table
        function AddDataTabeForApprovalManager(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');

            //entity.ss_languages = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
            entity.ss_approvalmanagerappsetupfee_ps = parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_approvalmanagerappmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_approvalmanagerappyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            return entity;
            // if(parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val())) !== 0 && parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val())) !== null && parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val())) !== "" && parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val())) !== undefined) {
            //     entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nApplication Fee: ";
            // }
        }
        //Policy Manager Sub Table
        function embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_policymanagerappsetupfee_ps = ss_ss_policymanagerappmonthlyfee_ps = ss_policymanagerappyearlyfee_ps = AddFormattings(0.00);
            if (OPIndex >= 0) {

                ss_policymanagerappsetupfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_policymanagerappsetupfee_ps"] ? oportunityproducts.value[OPIndex]["ss_policymanagerappsetupfee_ps"] : 0.00);
                ss_ss_policymanagerappmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ss_policymanagerappmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ss_policymanagerappmonthlyfee_ps"] : 0.00);
                ss_policymanagerappyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_policymanagerappyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_policymanagerappyearlyfee_ps"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts26' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Application Fee</td><td class='centeredelements'><input type='text' at='10' class='subTableFee' value='" + ss_policymanagerappsetupfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableMFee' value='" + ss_ss_policymanagerappmonthlyfee_ps + "'></td><td class='centeredelements'><input type='text' class='subTableYFee' value='" + ss_policymanagerappyearlyfee_ps + "'></td></tr></tbody></table></td></tr>";

            return markup;
        }
        //Policy Manager Data Table
        function AddDataTabeForPolicyManager(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nApplication Fee: ";
            //entity.ss_languages = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
            entity.ss_policymanagerappsetupfee_ps = parseFloat(RemoveFormattings($(tr0).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_ss_policymanagerappmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_policymanagerappyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            return entity;
        }
        //Sub Table For EQS Integrity Line 640100
        function embedSubTableForIntegrityLine(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            var sBassicDefault = (oportunityproducts.value[OPIndex] === undefined || oportunityproducts.value[OPIndex] === "undefined" || oportunityproducts.value[OPIndex] === null) ? true : false;
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_admin = ss_languages = ss_casemanager = ss_employees = ss_includedimphours_ps = 0;
            var ss_supportbasic = ss_supportprofessional = false;
            var ss_integrityessential = ss_integritybestpractice = ss_eqsclassicsystem_ps = ss_integrityenterprise = ss_compliancecockpitprofessionalcheck = "";
            var ss_eqsprivatehosting = ss_azurepubliccloud = ss_cockpitessential = false;
            var ss_adminsetup = ss_languagessetup = ss_supportbasicsetup = ss_supportprofessionalsfee = ss_casemanagersetup = ss_employeessetup = ss_eqsphsetupfee = ss_azurepcsetupfee = ss_cockpitessentialsetupfee = AddFormattings(0.00);
            var ss_adminmfee = ss_languagesmfee = ss_supportbasicmfee = ss_supportprofessionalmfee = ss_casemanagermfee = ss_employeesmfee = ss_eqsphmonthlyfee = ss_azurepcmonthlyfee = ss_cockpitessentialmonthly = AddFormattings(0.00);
            var ss_adminyfee = ss_languagesyfee = ss_supportbasicyfee = ss_supportprofessionalyfee = ss_casemanageryfee = ss_employeesyfee = ss_eqsphyearlyfee = ss_azurepcyearlyfee = ss_cockpitessentialyearly = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_includedimphours_ps = oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] ? oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] : 0;
                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
                ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);
                ss_eqsclassicsystem_ps = oportunityproducts.value[OPIndex]["ss_eqsclassicsystem_ps"] ? "checked" : "";
                ss_integrityessential = oportunityproducts.value[OPIndex]["ss_integrityessential"] ? "checked" : "";
                ss_integritybestpractice = oportunityproducts.value[OPIndex]["ss_integritybestpractice"] ? "checked" : "";
                ss_compliancecockpitprofessionalcheck = oportunityproducts.value[OPIndex]["ss_compliancecockpitprofessionalcheck"] ? "checked" : "";
                //ss_integrityenterprise = oportunityproducts.value[OPIndex]["ss_integrityenterprise"] ? "checked" : "";
                ss_supportbasic = oportunityproducts.value[OPIndex]["ss_supportbasic"] ? oportunityproducts.value[OPIndex]["ss_supportbasic"] : false;
                ss_supportbasicsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] ? oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] : 0.00);
                ss_supportbasicmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] : 0.00);
                ss_supportbasicyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] : 0.00);
                ss_supportprofessional = oportunityproducts.value[OPIndex]["ss_supportprofessional"] ? oportunityproducts.value[OPIndex]["ss_supportprofessional"] : false;
                ss_supportprofessionalsfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] : 0.00);
                ss_supportprofessionalmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] : 0.00);
                ss_supportprofessionalyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] : 0.00);

                ss_eqsprivatehosting = oportunityproducts.value[OPIndex]["ss_eqsprivatehosting"] ? oportunityproducts.value[OPIndex]["ss_eqsprivatehosting"] : false;
                ss_eqsphsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphsfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphsfee"] : 0.00);
                ss_eqsphmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphmfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphmfee"] : 0.00);
                ss_eqsphyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphyfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphyfee"] : 0.00);

                ss_azurepubliccloud = oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] ? oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] : false;
                ss_azurepcsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcsfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcsfee"] : 0.00);
                ss_azurepcmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcmfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcmfee"] : 0.00);
                ss_azurepcyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcyearlyfee"] : 0.00);

                ss_cockpitessential = oportunityproducts.value[OPIndex]["ss_cockpitessential"] ? oportunityproducts.value[OPIndex]["ss_cockpitessential"] : false;
                ss_cockpitessentialsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_cockpitessentialsetupfee"] ? oportunityproducts.value[OPIndex]["ss_cockpitessentialsetupfee"] : 0.00);
                ss_cockpitessentialmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_cockpitessentialmonthly"] ? oportunityproducts.value[OPIndex]["ss_cockpitessentialmonthly"] : 0.00);
                ss_cockpitessentialyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_cockpitessentialyearly"] ? oportunityproducts.value[OPIndex]["ss_cockpitessentialyearly"] : 0.00);

                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);
                // ss_admin = oportunityproducts.value[OPIndex]["ss_admin"] ? oportunityproducts.value[OPIndex]["ss_admin"] : 0;
                // ss_adminsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminsetup"] ? oportunityproducts.value[OPIndex]["ss_adminsetup"] : 0.00);
                // ss_adminmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminmfee"] ? oportunityproducts.value[OPIndex]["ss_adminmfee"] : 0.00);
                // ss_adminyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminyfee"] ? oportunityproducts.value[OPIndex]["ss_adminyfee"] : 0.00);


            }
            else {
                display_prop = "style='display:none'";
            }


            if (ss_eqsclassicsystem_ps === "checked" || ss_integrityessential === "checked" || ss_integritybestpractice === "checked" || ss_compliancecockpitprofessionalcheck === "checked") {
                display_row = "";
            }
            var disp_sys = "style='display:none'";
            var check = "style='display:none'";
            if (ss_eqsclassicsystem_ps === "checked") {
                disp_sys = "";
            }

            var sbassic = (ss_supportbasic || sBassicDefault) ? "checked" : "";
            var sprofessional = (ss_supportprofessional) ? "checked" : "";
            var eqsphchk = (ss_eqsprivatehosting) ? "checked" : "";
            var azurepubliccloud = (ss_azurepubliccloud) ? "checked" : "";
            var awscloudcheck = (ss_cockpitessential) ? "checked" : "";

            //console.log("integrity Line Sub Table");
            var markup = "<tr class='OppProducts29' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"

                + "<tr><td><div class='itegrityText'>Standalone IL Essential (V2)</div><input type='checkbox' class='integrityCheckbox integ_essential' " + ss_integrityessential + " style='float: left;'></td><td colspan='2'><div class='itegrityText integrityClass3'>Standalone IL Professional (V2)</div><input type='checkbox' class='integrityCheckbox2 integ_essential' " + ss_integritybestpractice + " style='float: left;'></td></tr>"

                + "<tr class = 'trshowhideclass' " + display_row + "><td class='subfield'>Included Implementation hours</td><td><input type='number' id='ss_imphours_ps' min='0' value='" + ss_includedimphours_ps + "' ></td><td></td><td></td><td></td></tr>"
                + "<tr class = 'trshowhideclass' " + display_row + "><td class='subfield'>Employees </td><td><input type='number' class='numberfield' min='0' value='" + ss_employees + "' ></td><td><input type='text' at='10' class='subTableFee' value='" + ss_employeessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "'></td></tr>"
                + "<tr class = 'trshowhideclass' " + display_row + "><td class='subfield'>Languages </td><td><input type='number' class='numberfield' min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"
                + "<tr class = 'trshowhideclass' " + display_row + "><td class='subfield'>Case Manager - Named User </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"
                // + "<tr class = 'trshowhideclass' " + display_row + "><td class='subfield'> Countries </td><td><input type='number' min='0' value='" + ss_admin + "'></td><td><input type='text' class='subTableFee' value='" + ss_adminsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_adminmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_adminyfee + "'></td></tr>"//
                + "<tr class = 'trshowhideclass' " + display_row + "><td class='mainSupportTd' colspan='5'> Support </td></tr>"
                + "<tr class='support trshowhideclass' " + display_row + "><td class='subfield'> Standard </td><td class='supportTd'><input type='checkbox' " + sbassic + " class='supportb subSupportCheckBox' name='" + sBassicDefault + "'></td><td><input type='text' class='subTableSupportFee subTableSupportSFee' value='" + ss_supportbasicsetup + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportbasicmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportbasicyfee + "'></td></tr>"
                + "<tr class='support trshowhideclass' " + display_row + "><td class='subfield'> Advanced </td><td class='supportTd'><input type='checkbox' " + sprofessional + " class='supportp subSupportCheckBox'></td><td><input type='text'  class='subTableSupportFee subTableSupportSFee' value='" + ss_supportprofessionalsfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportprofessionalmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportprofessionalyfee + "'></td></tr>"
                + "<tr class = 'trshowhideclass' " + display_row + "><td class='mainSupportTd' colspan='5'> Hosting </td></tr>"
                + "<tr class='support trshowhideclass cockpitIL' " + (disp_sys === "" || disp_sys === null ? check : display_prop) + "><td class='subfield'> EQS Private Hosting </td><td class='supportTd'><input type='checkbox' " + eqsphchk + " class='hostingp subHostingCheckBox'></td><td><input type='text'  class='subTableHostingFee subTableHostingSFee' value='" + ss_eqsphsetupfee + "'></td><td><input type='text' class='subTableHostingFee subTableHostingMFee' value='" + ss_eqsphmonthlyfee + "'></td><td><input type='text' class='subTableHostingFee subTableHostingYFee' value='" + ss_eqsphyearlyfee + "'></td></tr>"

                + "<tr class='support trshowhideclass cockpitIL' " + (disp_sys === "" || disp_sys === null ? check : display_prop) + "><td class='subfield'> Azure Public Cloud </td><td class='supportTd'><input type='checkbox' " + azurepubliccloud + " class='azurecloud subAzureCheckBox'></td><td><input type='text'  class='subTableAzureFee subTableAzureSFee' value='" + ss_azurepcsetupfee + "'></td><td><input type='text' class='subTableAzureFee subTableAzureMFee' value='" + ss_azurepcmonthlyfee + "'></td><td><input type='text' class='subTableAzureFee subTableAzureYFee' value='" + ss_azurepcyearlyfee + "'></td></tr>"

                + "<tr class='support awscloudhosting' " + disp_sys + "><td class='subfield'> AWS Cloud Hosting </td><td class='supportTd'><input type='checkbox' " + awscloudcheck + " class='azurecloud subAzureCheckBox awscloud'></td><td><input type='text'  class='subTableAzureFee subTableAzureSFee' value='" + ss_cockpitessentialsetupfee + "'></td><td><input type='text' class='subTableAzureFee subTableAzureMFee' value='" + ss_cockpitessentialmonthly + "'></td><td><input type='text' class='subTableAzureFee subTableAzureYFee' value='" + ss_cockpitessentialyearly + "'></td></tr>"

                + "<tr class='ss_productdescriptionROW' style = 'display:none;'><td class = 'ss_productdescriptionTD' colspan='5'>" + ss_productdescription + "</td></tr>"
                + "</tbody></table></td></tr>";

            return markup;


        }
        //EQS Integrity Line 640100 Data Table
        function AddSubTableDataForIntegrityLine(entity, subtable, isLicProduct, oppProdDesc) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            var tr4 = $(subTBody).find('tr:eq(4)');
            //var tr5 = $(subTBody).find('tr:eq(5)');
            var tr6 = $(subTBody).find('tr:eq(6)');
            var tr7 = $(subTBody).find('tr:eq(7)');
            var tr9 = $(subTBody).find('tr:eq(9)');
            var tr10 = $(subTBody).find('tr:eq(10)');
            var tr11 = $(subTBody).find('tr:eq(11)');
            //var tr11 = $(subTBody).find('tr:eq(11)');
            //ss_includedimphours_ps
            //Integrity Line

            entity.ss_eqsclassicsystem_ps = $(tr0).find('td:eq(0)').find('input[type=checkbox]').prop("checked");
            entity.ss_compliancecockpitprofessionalcheck = $(tr0).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            entity.ss_integrityessential = $(tr0).find('td:eq(2)').find('input[type=checkbox]').prop("checked");
            entity.ss_integritybestpractice = $(tr0).find('td:eq(3)').find('input[type=checkbox]').prop("checked");
            //entity.ss_integrityenterprise = $(tr0).find('td:eq(3)').find('input[type=checkbox]').prop("checked");

            //Employees
            if (entity.ss_eqsclassicsystem_ps || entity.ss_integrityessential || entity.ss_integritybestpractice || entity.ss_compliancecockpitprofessionalcheck) {
                // if (entity.ss_integritybestpractice && isLicProduct && ss_eqsclassicsystem_ps) {
                //     entity.ss_eqsintegrityldata_ps = "Professional";
                // }
                // else if (entity.ss_integrityenterprise && isLicProduct && ss_eqsclassicsystem_ps) {
                //     entity.ss_eqsintegrityldata_ps = "Enterprise";
                // }
                // else {
                //     entity.ss_eqsintegrityldata_ps = (entity.ss_integrityessential && isLicProduct) ? "Essential" : ((entity.ss_integritybestpractice && isLicProduct) ? "Professional" : ((entity.ss_integrityenterprise && isLicProduct) ? "Enterprise" : ((entity.ss_eqsclassicsystem_ps && isLicProduct) ? "Product No. 640100" : "")));
                // }
                if (entity.ss_compliancecockpitprofessionalcheck) {
                    entity.ss_compliancecockpitprofessionaltext_ps = "EQS Compliance Cockpit including"
                }
                entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nEmployees: ";
                entity.ss_includedimphours_ps = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
                entity.ss_employees = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_employees;
                entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
                entity.ss_employeesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_employeesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;


                //Languages 
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nLanguages: ";
                entity.ss_languages = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
                entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
                entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Case Manager - Named User
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Named User: ";
                entity.ss_casemanager = parseInt($(tr4).find('td:eq(1)').find('input[type=number]').val());
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
                entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
                entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Countries
                // entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCountries: ";
                // entity.ss_admin = parseInt($(tr5).find('td:eq(1)').find('input[type=number]').val());
                // entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_admin;
                // entity.ss_adminsetup = parseFloat(RemoveFormattings($(tr5).find('td:eq(2)').find('input[type=text]').val()));
                // entity.ss_adminmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                // entity.ss_adminyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Support-Basic
                var sBasic = $(tr6).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                var sprofessional = $(tr7).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                entity.ss_eqsintegrityldata_ps += (sBasic && isLicProduct) ? "\nSupport (SLA): Standard\n" : ((sprofessional && isLicProduct) ? "\nSupport (SLA): Advanced\n" : "");
                entity.ss_supportbasic = sBasic;
                entity.ss_supportbasicsetup = sBasic ? parseFloat(RemoveFormattings($(tr6).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
                entity.ss_supportbasicmfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_supportbasicyfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Support-professional
                entity.ss_supportprofessional = sprofessional;
                entity.ss_supportprofessionalsfee = sprofessional ? parseFloat(RemoveFormattings($(tr7).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
                entity.ss_supportprofessionalmfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr7).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_supportprofessionalyfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr7).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Private Hositng & Azure Public Cloud
                var privatehosting = $(tr9).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                var azure_public_cloud = $(tr10).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                entity.ss_eqsintegrityldata_ps += (privatehosting && isLicProduct) ? "\n EQS Private Hosting:" : "";
                entity.ss_eqsintegrityldata_ps += (azure_public_cloud && isLicProduct) ? "\n Azure Public Cloud:" : "";
                //EQS Private Hosting
                entity.ss_eqsprivatehosting = privatehosting;
                entity.ss_eqsphsfee = privatehosting ? parseFloat(RemoveFormattings($(tr9).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
                entity.ss_eqsphmfee = (privatehosting && isLicProduct) ? parseFloat(RemoveFormattings($(tr9).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_eqsphyfee = (privatehosting && isLicProduct) ? parseFloat(RemoveFormattings($(tr9).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
                //Azure Public Cloud
                entity.ss_azurepubliccloud = azure_public_cloud;
                entity.ss_azurepcsfee = azure_public_cloud ? parseFloat(RemoveFormattings($(tr10).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
                entity.ss_azurepcmfee = (azure_public_cloud && isLicProduct) ? parseFloat(RemoveFormattings($(tr10).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_azurepcyfee = (azure_public_cloud && isLicProduct) ? parseFloat(RemoveFormattings($(tr10).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

                //AWS Cloud Hosting
                var aws = $(tr11).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
                entity.ss_eqsintegrityldata_ps += (aws && isLicProduct) ? "\n AWS Cloud Hosting:" : "";
                entity.ss_cockpitessential = aws;
                entity.ss_cockpitessentialsetupfee = aws ? parseFloat(RemoveFormattings($(tr11).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
                entity.ss_cockpitessentialmonthly = (aws && isLicProduct) ? parseFloat(RemoveFormattings($(tr11).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
                entity.ss_cockpitessentialyearly = (aws && isLicProduct) ? parseFloat(RemoveFormattings($(tr11).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

                //Discription ss_productdescription
                //var  prodDiscription = $(tr9).find('td:eq(0)').text();
                //entity.ss_eqsintegrityldata_ps += (prodDiscription === null || prodDiscription === "" || prodDiscription === undefined || prodDiscription === "undefined" || !isLicProduct) ? "" : "\n" + prodDiscription;
            }
            else {
                entity.ss_includedimphours_ps = 0;
                entity.ss_employees = 0;

                entity.ss_employeessetup = parseFloat(0);
                entity.ss_employeesmfee = parseFloat(0);
                entity.ss_employeesyfee = parseFloat(0);


                //Languages 

                entity.ss_languages = 0;

                entity.ss_languagessetup = parseFloat(0);
                entity.ss_languagesmfee = parseFloat(0);
                entity.ss_languagesyfee = parseFloat(0);
                //Case Manager - Named User

                entity.ss_casemanager = 0;

                entity.ss_casemanagersetup = parseFloat(0);
                entity.ss_casemanagermfee = parseFloat(0);
                entity.ss_casemanageryfee = parseFloat(0);
                //Countries

                // entity.ss_admin = 0;

                // entity.ss_adminsetup = parseFloat(0);
                // entity.ss_adminmfee = parseFloat(0);
                // entity.ss_adminyfee = parseFloat(0);
                //Support-Basic

                entity.ss_supportbasic = true;
                entity.ss_supportbasicsetup = parseFloat(0);
                entity.ss_supportbasicmfee = parseFloat(0);
                entity.ss_supportbasicyfee = parseFloat(0);
                //Support-professional
                entity.ss_supportprofessional = false;
                entity.ss_supportprofessionalsfee = parseFloat(0);
                entity.ss_supportprofessionalmfee = parseFloat(0);
                entity.ss_supportprofessionalyfee = parseFloat(0);
                //EQS Private Hosting
                entity.ss_eqsprivatehosting = false;
                entity.ss_eqsphsfee = parseFloat(0);
                entity.ss_eqsphmfee = parseFloat(0);
                entity.ss_eqsphyfee = parseFloat(0);
                //Azure Public Cloud
                ss_azurepubliccloud = false;
                ss_azurepcsfee = parseFloat(0);
                ss_azurepcmfee = parseFloat(0);
                ss_azurepcyfee = parseFloat(0);

                //AWS Cloud Hosing
                ss_cockpitessential = false;
                ss_cockpitessentialsetupfee = parseFloat(0);
                ss_cockpitessentialmonthly = parseFloat(0);
                ss_cockpitessentialyearly = parseFloat(0);

                //Discription ss_productdescription
                entity.ss_eqsintegrityldata_ps = "";

            }
            if (isLicProduct && (oppProdDesc === undefined || oppProdDesc === null || oppProdDesc === "undefined")) {
                entity.ss_customdescription = "";
            }
            else {
                ////entity.ss_customdescription = "\n" + oppProdDesc.replace("20", entity.ss_includedimphours_ps.toString());
                entity.ss_customdescription = "\r\n Including up to " + entity.ss_includedimphours_ps.toString() + "\r\n hours implementation \n - Online kickoff \r\n- System configuration \r\n - Testing \r\n - Online user training";
            }
            //Setup Text Value
            entity.ss_stval_ps = isLicProduct ? "" : "Setup";
            return entity;
        }
        // function returning sub table for specific products
        function embedSubTableforPAKCheck(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var ss_pakcheck = false;
            var display_prop = "";
            var display_Pak = "style='width:250px;'";
            var ss_pakquantity = "";
            if (OPIndex > 0) {
                ss_pakcheck = oportunityproducts.value[OPIndex]["ss_pakcheck"] ? oportunityproducts.value[OPIndex]["ss_pakcheck"] : false;
                ss_pakquantity = oportunityproducts.value[OPIndex]["ss_pakquantity"] ? oportunityproducts.value[OPIndex]["ss_pakquantity"] : 0;

            }
            else {
                display_prop = "style='display:none'";
            }
            var pakcheck = ss_pakcheck ? "checked" : "";
            if (!ss_pakcheck) {
                display_Pak = "style='display:none;width:200px;'";
            }
            var TableMainClass = "OppProducts19";
            var regulatoryandnews = `<tr class=${TableMainClass} ${display_prop}><td style='background: transparent;'></td><td class='text-center' colspan='4'>
                <table class='table table-responsive table-sm text-center border-0 removetable ' id= ${Prod_Id}_pt>  
                <tbody class='subtableBody' id=${Prod_Id} +'_p'>

                    <tr> <td class ='subfield' style="width:100px;"><input type ='checkbox' id ='pak_chkbox' class ='fieldcheck_pak' ${pakcheck}>&nbsp;&nbsp;PAK</td>

                        <td id =${Prod_Id}_pak ${display_Pak} >Quantity:<input type ='number' id ='pak_quantity' class ='kap_pak' value = ${ss_pakquantity}></td>
                        <td style="width:200px;"></td>
                    </tr>


                </tbody></table></td></tr>`;

            return regulatoryandnews;
        }
        function AddSubTableDataForPAKCheck(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var pak_chk = false;
            var allRows = [];
            for (var i = 0; i < 2; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }
            entity.ss_pakcheck = $(allRows[0]).find('.fieldcheck_pak').prop("checked");
            pak_chk = $(allRows[0]).find('.fieldcheck_pak').prop("checked");
            entity.ss_pakquantity = pak_chk ? parseInt($(allRows[0]).find('#pak_quantity').val()) : 0;

            return entity;
        }
        //Integrity Line Sub Table
        function embedSubTableForIntegrityLineComplianceCockpit(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var ss_integritylineappsetupfee_ps = ss_integritylineappmonthlyfee_ps = ss_integritylineappyearlyfee_ps = AddFormattings(0.00);
            var ss_languages = 0;
            var display_prop = "";
            if (OPIndex >= 0) {
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_integritylineappsetupfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_integritylineappsetupfee_ps"] ? oportunityproducts.value[OPIndex]["ss_integritylineappsetupfee_ps"] : 0.00);
                ss_integritylineappmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_integritylineappmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_integritylineappmonthlyfee_ps"] : 0.00);
                ss_integritylineappyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_integritylineappyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_integritylineappyearlyfee_ps"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }
            var markup = "<tr class='OppProducts27'" + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody autoheightelement' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield  elements'>Additional reporter languages <input type='number'  min='0' value='" + ss_languages + "' class='floatelements'></td><td></td><td></td><td></td></tr>"
                + "<tr class=' '><td class='subfield elements'> Application fee: </td><td class='subfield centeredelements'><input type='text'  class='subTableFee' value='" + ss_integritylineappsetupfee_ps + "' ></td><td class='subfield centeredelements'><input type='text' class='subTableMFee' value='" + ss_integritylineappmonthlyfee_ps + "'></td><td class='subfield centeredelements'><input type='text' class='subTableYFee' value='" + ss_integritylineappyearlyfee_ps + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;


        }

        //Sub Table for Integrity Line Class Product 
        function embedSubTableForIntegrityClassic(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            var sBassicDefault = (oportunityproducts.value[OPIndex] === undefined || oportunityproducts.value[OPIndex] === "undefined" || oportunityproducts.value[OPIndex] === null) ? true : false;
            var display_prop = display_support = "";
            var display_row = "style='display:none'";
            var ss_admin = ss_languages = ss_casemanager = ss_employees = ss_includedimphours_ps = 0;
            var ss_supportbasic = ss_supportprofessional = false;
            //var ss_integrityessential = ss_integritybestpractice = ss_eqsclassicsystem_ps = ss_integrityenterprise = "";
            var ss_eqsprivatehosting = ss_azurepubliccloud = false;
            var ss_adminsetup = ss_languagessetup = ss_supportbasicsetup = ss_supportprofessionalsfee = ss_casemanagersetup = ss_employeessetup = ss_eqsphsetupfee = ss_azurepcsetupfee = AddFormattings(0.00);
            var ss_adminmfee = ss_languagesmfee = ss_supportbasicmfee = ss_supportprofessionalmfee = ss_casemanagermfee = ss_employeesmfee = ss_eqsphmonthlyfee = ss_azurepcmonthlyfee = AddFormattings(0.00);
            var ss_adminyfee = ss_languagesyfee = ss_supportbasicyfee = ss_supportprofessionalyfee = ss_casemanageryfee = ss_employeesyfee = ss_eqsphyearlyfee = ss_azurepcyearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_includedimphours_ps = oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] ? oportunityproducts.value[OPIndex]["ss_includedimphours_ps"] : 0;
                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
                ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);
                // ss_eqsclassicsystem_ps = oportunityproducts.value[OPIndex]["ss_eqsclassicsystem_ps"] ? "checked" : "";
                // ss_integrityessential = oportunityproducts.value[OPIndex]["ss_integrityessential"] ? "checked" : "";
                // ss_integritybestpractice = oportunityproducts.value[OPIndex]["ss_integritybestpractice"] ? "checked" : "";
                // ss_integrityenterprise = oportunityproducts.value[OPIndex]["ss_integrityenterprise"] ? "checked" : "";
                ss_supportbasic = oportunityproducts.value[OPIndex]["ss_supportbasic"] ? oportunityproducts.value[OPIndex]["ss_supportbasic"] : false;
                ss_supportbasicsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] ? oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] : 0.00);
                ss_supportbasicmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] : 0.00);
                ss_supportbasicyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] : 0.00);
                ss_supportprofessional = oportunityproducts.value[OPIndex]["ss_supportprofessional"] ? oportunityproducts.value[OPIndex]["ss_supportprofessional"] : false;
                ss_supportprofessionalsfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] : 0.00);
                ss_supportprofessionalmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] : 0.00);
                ss_supportprofessionalyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] : 0.00);

                ss_eqsprivatehosting = oportunityproducts.value[OPIndex]["ss_eqsprivatehosting"] ? oportunityproducts.value[OPIndex]["ss_eqsprivatehosting"] : false;
                ss_eqsphsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphsfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphsfee"] : 0.00);
                ss_eqsphmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphmfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphmfee"] : 0.00);
                ss_eqsphyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_eqsphyfee"] ? oportunityproducts.value[OPIndex]["ss_eqsphyfee"] : 0.00);

                ss_azurepubliccloud = oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] ? oportunityproducts.value[OPIndex]["ss_azurepubliccloud"] : false;
                ss_azurepcsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcsfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcsfee"] : 0.00);
                ss_azurepcmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcmfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcmfee"] : 0.00);
                ss_azurepcyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_azurepcyfee"] ? oportunityproducts.value[OPIndex]["ss_azurepcyfee"] : 0.00);


                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);
                // ss_admin = oportunityproducts.value[OPIndex]["ss_admin"] ? oportunityproducts.value[OPIndex]["ss_admin"] : 0;
                // ss_adminsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminsetup"] ? oportunityproducts.value[OPIndex]["ss_adminsetup"] : 0.00);
                // ss_adminmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminmfee"] ? oportunityproducts.value[OPIndex]["ss_adminmfee"] : 0.00);
                // ss_adminyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminyfee"] ? oportunityproducts.value[OPIndex]["ss_adminyfee"] : 0.00);


            }
            else {
                display_prop = "style='display:none'";
            }

            var sbassic = (ss_supportbasic || sBassicDefault) ? "checked" : "";
            var sprofessional = (ss_supportprofessional) ? "checked" : "";
            var eqsphchk = (ss_eqsprivatehosting) ? "checked" : "";
            var azurepubliccloud = (ss_azurepubliccloud) ? "checked" : "";

            var markup = "<tr class='OppProducts6' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"
                + "<tr><td class='subfield'>Included Implementation hours</td><td><input type='number' id='ss_imphours_ps' min='0' value='" + ss_includedimphours_ps + "' ></td><td></td><td></td><td></td></tr>"

                + "<tr><td class='subfield'>Employees </td><td><input type='number' min='0' value='" + ss_employees + "' ></td><td><input type='text' at='10' class='subTableFee' value='" + ss_employeessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Languages </td><td><input type='number'  min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Named User </td><td><input type='number' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"

                // + "<tr><td class='subfield'> Countries </td><td><input type='number' min='0' value='" + ss_admin + "'></td><td><input type='text' class='subTableFee' value='" + ss_adminsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_adminmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_adminyfee + "'></td></tr>"//
                + "<tr><td class='mainSupportTd' colspan='5'> Support </td></tr>"

                + "<tr class='support'><td class='subfield'> Standard </td><td class='supportTd'><input type='checkbox' " + sbassic + " class='supportb subSupportCheckBox' name='" + sBassicDefault + "'></td><td><input type='text' class='subTableSupportFee subTableSupportSFee' value='" + ss_supportbasicsetup + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportbasicmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportbasicyfee + "'></td></tr>"

                + "<tr class='support'><td class='subfield'> Advanced </td><td class='supportTd'><input type='checkbox' " + sprofessional + " class='supportp subSupportCheckBox'></td><td><input type='text'  class='subTableSupportFee subTableSupportSFee' value='" + ss_supportprofessionalsfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportprofessionalmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportprofessionalyfee + "'></td></tr>"

                + "<tr><td class='mainSupportTd' colspan='5'> Hosting </td></tr>"

                + "<tr class='support'><td class='subfield'> EQS Private Hosting </td><td class='supportTd'><input type='checkbox' " + eqsphchk + " class='hostingp subHostingCheckBox'></td><td><input type='text'  class='subTableHostingFee subTableHostingSFee' value='" + ss_eqsphsetupfee + "'></td><td><input type='text' class='subTableHostingFee subTableHostingMFee' value='" + ss_eqsphmonthlyfee + "'></td><td><input type='text' class='subTableHostingFee subTableHostingYFee' value='" + ss_eqsphyearlyfee + "'></td></tr>"

                + "<tr class='support'><td class='subfield'> Azure Public Cloud </td><td class='supportTd'><input type='checkbox' " + azurepubliccloud + " class='azurecloud subAzureCheckBox'></td><td><input type='text'  class='subTableAzureFee subTableAzureSFee' value='" + ss_azurepcsetupfee + "'></td><td><input type='text' class='subTableAzureFee subTableAzureMFee' value='" + ss_azurepcmonthlyfee + "'></td><td><input type='text' class='subTableAzureFee subTableAzureYFee' value='" + ss_azurepcyearlyfee + "'></td></tr>"

                + "<tr class='ss_productdescriptionROW' style = 'display:none;'><td class = 'ss_productdescriptionTD' colspan='5'>" + ss_productdescription + "</td></tr>"
                + "</tbody></table></td></tr>";

            return markup;

        }
        function AddSubTableDataForIntegrityLineComplianceCockpit(entity, subtable, isLicProduct, oppProdDesc) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');


            //Languages 
            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nLanguages: ";
            entity.ss_languages = parseInt($(tr0).find('td:eq(0)').find('input[type=number]').val());
            !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps = "\nAdditional reporter languages: " + entity.ss_languages
            entity.ss_integritylineappsetupfee_ps = parseFloat(RemoveFormattings($(tr1).find('td:eq(1)').find('input[type=text]').val()));
            entity.ss_integritylineappmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_integritylineappyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;

            //entity.ss_eqsintegrityldata_ps += !isLicProduct ? "":"\n_________________________________";
            return entity;
        }

        //Sub Table For BKMS System
        function embedSubTableForBKMS(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            var display_prop = "";
            var ss_languages = ss_casemanager = ss_employees = ss_casemanagerfloatinguser = ss_bkmsadditionallanguagecredits = ss_bkmsphoneinterviewnewreport = ss_bkmsphoneinterviewreferencereport = ss_bkmsphoneinterviewnumberlicense = ss_bkmcvoiceintakeincludedpackage = ss_bkmsvoiceintakeimplementationcountrynum = ss_bkmsvoiceintakelanguage = ss_bkmsvoiceintakelicensecountrynumber = ss_gmrecordingcost = 0;

            var ss_languagessetup = ss_casemanagersetup = ss_employeessetup = ss_casemanagerfloatusersetupfee = ss_bkmsadditionallanguagesetupfee = ss_bkmsphonesystemsetupfee = ss_bkmsvoiceintakesetupfee = ss_bkmsphoneinterviewnewreportsetupfee = ss_bkmsphoneinterviewreferencereportsetupfee = ss_bkmsphoneinterviewlicensenumbersetupfee = ss_bkmsvoiceintakecallincludedpackagesetupfe = ss_bkmsvoiceintakeimplementationsetupfee = ss_bkmsvoiceintakelanguagesetupfee = ss_bkmsvoiceintakelicensecountrynumsetupfee = ss_gmrecordingcostsetupfee = AddFormattings(0.00);

            var ss_languagesmfee = ss_casemanagermfee = ss_employeesmfee = ss_casemanagerfloatusermonthlyfee = ss_bkmsadditionallanguagemonthlyfee = ss_bkmsphonesystemmonthlyfee = ss_bkmsvoiceintakesmonthlyfee = ss_bkmsphoneinterviewnewreportmonthlyfee = ss_bkmsphoneinterviewreferencereportmonfee = ss_bkmsphoneinterviewlicensenumbermonthlyfee = ss_bkmsvoiceintakecallincludedpackagemonthly = ss_bkmsvoiceintakeimplementationmonthlyfee = ss_bkmsvoiceintakelanguagemonthlyfee = ss_bkmsvoiceintakelicensecountrynummonthlyfe = ss_gmrecordingcostsmonthlyfee = AddFormattings(0.00);

            var ss_languagesyfee = ss_casemanageryfee = ss_employeesyfee = ss_casemanagerfloatuseryearlyfee = ss_bkmsadditionallanguageyearlyfee = ss_bkmsphonesystemyearlyfee = ss_bkmsvoiceintakesyearlyfee = ss_bkmsphoneinterviewnewreportyearlyfee = ss_bkmsphoneinterviewreferencereportyearlyfe = ss_bkmsphoneinterviewlicensenumberyearlyfee = ss_bkmsvoiceintakecallincludedpackageyearlyf = ss_bkmsvoiceintakeimplementationyearlyfee = ss_bkmsvoiceintakelanguageyearlyfee = ss_bkmsvoiceintakelicensecountrynumyearlyfee = ss_gmrecordingcostyearlyfee = AddFormattings(0.00);

            var ss_casemanagerfloatusercheck = ss_bkmsphonesystem = ss_bkmsvoiceintake = false;

            if (OPIndex >= 0) {
                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
                ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);

                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);

                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);

                ss_casemanagerfloatinguser = oportunityproducts.value[OPIndex]["ss_casemanagerfloatinguser"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatinguser"] : 0;
                ss_casemanagerfloatusersetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] : 0.00);
                ss_casemanagerfloatusermonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] : 0.00);
                ss_casemanagerfloatuseryearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] : 0.00);
                ss_casemanagerfloatusercheck = oportunityproducts.value[OPIndex]["ss_casemanagerfloatusercheck"] ? true : false;

                //BKMS
                ss_bkmsadditionallanguagecredits = oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagecredits"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagecredits"] : 0;
                ss_bkmsadditionallanguagesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagesetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagesetupfee"] : 0.00);
                ss_bkmsadditionallanguagemonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagemonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagemonthlyfee"] : 0.00);
                ss_bkmsadditionallanguageyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguageyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguageyearlyfee"] : 0.00);

                ss_bkmsphonesystem = oportunityproducts.value[OPIndex]["ss_bkmsphonesystem"] ? oportunityproducts.value[OPIndex]["ss_bkmsphonesystem"] : false;
                ss_bkmsphonesystemsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphonesystemsetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphonesystemsetupfee"] : 0.00);
                ss_bkmsphonesystemmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphonesystemmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphonesystemmonthlyfee"] : 0.00);
                ss_bkmsphonesystemyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphonesystemyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphonesystemyearlyfee"] : 0.00);

                ss_bkmsvoiceintake = oportunityproducts.value[OPIndex]["ss_bkmsvoiceintake"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintake"] : false;
                ss_bkmsvoiceintakesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesetupfee"] : 0.00);
                ss_bkmsvoiceintakesmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesmonthlyfee"] : 0.00);
                ss_bkmsvoiceintakesyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakesyearlyfee"] : 0.00);

                ss_bkmsphoneinterviewnewreport = oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreport"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreport"] : 0;
                ss_bkmsphoneinterviewnewreportsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportsetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportsetupfee"] : 0.00);
                ss_bkmsphoneinterviewnewreportmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportmonthlyfee"] : 0.00);
                ss_bkmsphoneinterviewnewreportyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnewreportyearlyfee"] : 0.00);

                ss_bkmsphoneinterviewreferencereport = oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereport"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereport"] : 0;
                ss_bkmsphoneinterviewreferencereportsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportsetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportsetupfee"] : 0.00);
                ss_bkmsphoneinterviewreferencereportmonfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportmonfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportmonfee"] : 0.00);
                ss_bkmsphoneinterviewreferencereportyearlyfe = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportyearlyfe"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewreferencereportyearlyfe"] : 0.00);

                ss_bkmsphoneinterviewnumberlicense = oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnumberlicense"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewnumberlicense"] : 0;
                ss_bkmsphoneinterviewlicensenumbersetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumbersetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumbersetupfee"] : 0.00);
                ss_bkmsphoneinterviewlicensenumbermonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumbermonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumbermonthlyfee"] : 0.00);
                ss_bkmsphoneinterviewlicensenumberyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumberyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsphoneinterviewlicensenumberyearlyfee"] : 0.00);

                ss_bkmcvoiceintakeincludedpackage = oportunityproducts.value[OPIndex]["ss_bkmcvoiceintakeincludedpackage"] ? oportunityproducts.value[OPIndex]["ss_bkmcvoiceintakeincludedpackage"] : 0;
                ss_bkmsvoiceintakecallincludedpackagesetupfe = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackagesetupfe"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackagesetupfe"] : 0.00);
                ss_bkmsvoiceintakecallincludedpackagemonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackagemonthly"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackagemonthly"] : 0.00);
                ss_bkmsvoiceintakecallincludedpackageyearlyf = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackageyearlyf"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakecallincludedpackageyearlyf"] : 0.00);

                ss_bkmsvoiceintakeimplementationcountrynum = oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationcountrynum"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationcountrynum"] : 0;
                ss_bkmsvoiceintakeimplementationsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationsetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationsetupfee"] : 0.00);
                ss_bkmsvoiceintakeimplementationmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationmonthlyfee"] : 0.00);
                ss_bkmsvoiceintakeimplementationyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakeimplementationyearlyfee"] : 0.00);

                ss_bkmsvoiceintakelanguage = oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguage"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguage"] : 0;
                ss_bkmsvoiceintakelanguagesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguagesetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguagesetupfee"] : 0.00);
                ss_bkmsvoiceintakelanguagemonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguagemonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguagemonthlyfee"] : 0.00);
                ss_bkmsvoiceintakelanguageyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguageyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelanguageyearlyfee"] : 0.00);

                ss_bkmsvoiceintakelicensecountrynumber = oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumber"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumber"] : 0;
                ss_bkmsvoiceintakelicensecountrynumsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumsetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumsetupfee"] : 0.00);
                ss_bkmsvoiceintakelicensecountrynummonthlyfe = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynummonthlyfe"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynummonthlyfe"] : 0.00);
                ss_bkmsvoiceintakelicensecountrynumyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsvoiceintakelicensecountrynumyearlyfee"] : 0.00);

                ss_gmrecordingcost = oportunityproducts.value[OPIndex]["ss_gmrecordingcost"] ? oportunityproducts.value[OPIndex]["ss_gmrecordingcost"] : 0;
                ss_gmrecordingcostsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_gmrecordingcostsetupfee"] ? oportunityproducts.value[OPIndex]["ss_gmrecordingcostsetupfee"] : 0.00);
                ss_gmrecordingcostsmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_gmrecordingcostsmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_gmrecordingcostsmonthlyfee"] : 0.00);
                ss_gmrecordingcostyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_gmrecordingcostyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_gmrecordingcostyearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var displayfields = "style='display:none'";
            if (ss_bkmsphonesystem) {
                displayfields = "";
            }
            var showhidefields = "style='display:none'";
            if (ss_bkmsvoiceintake) {
                showhidefields = "";
            }
            var bkmsphonesystem = ss_bkmsphonesystem ? "checked" : "";
            var bkmsvoiceintake = ss_bkmsvoiceintake ? "checked" : "";

            var markup = "<tr class='OppProducts7' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"
                + "<tr><td class='subfield'>Employees </td><td><input type='number' class='numberfield' min='0' value='" + ss_employees + "'></td><td><input type='text' at='10' class='subTableFee' value='" + ss_employeessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Languages </td><td><input type='number' class='numberfield' min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Named </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Floating </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanagerfloatinguser + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagerfloatusersetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagerfloatusermonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagerfloatuseryearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS addtl. <br>Language credits </td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsadditionallanguagecredits + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsadditionallanguagesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsadditionallanguagemonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsadditionallanguageyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS Phone System</td><td><input type='checkbox' class='fieldcheck phonesystem' " + bkmsphonesystem + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmsphonesystemsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsphonesystemmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsphonesystemyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphone' " + displayfields + "><td class='subfield'>BKMS Phone Interview Hotline<br>Calls New Report</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsphoneinterviewnewreport + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsphoneinterviewnewreportsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsphoneinterviewnewreportmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsphoneinterviewnewreportyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphone' " + displayfields + "><td class='subfield'>BKMS Phone Interview Hotline<br>Calls Reference Report</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsphoneinterviewreferencereport + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsphoneinterviewreferencereportsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsphoneinterviewreferencereportmonfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsphoneinterviewreferencereportyearlyfe + "'></td></tr>"

                + "<tr class='showhidebkmsphone' " + displayfields + "><td class='subfield'>BKMS Phone Interview<br>Number License</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsphoneinterviewnumberlicense + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsphoneinterviewlicensenumbersetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsphoneinterviewlicensenumbermonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsphoneinterviewlicensenumberyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS Voice Intake</td><td><input type='checkbox' class='fieldcheck voiceintake' " + bkmsvoiceintake + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmsvoiceintakesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsvoiceintakesmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsvoiceintakesyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphonevoice' " + showhidefields + "><td class='subfield'>BKMS VoiceIntake Calls Exceeding<br>Included Package</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmcvoiceintakeincludedpackage + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsvoiceintakecallincludedpackagesetupfe + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsvoiceintakecallincludedpackagemonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsvoiceintakecallincludedpackageyearlyf + "'></td></tr>"

                + "<tr class='showhidebkmsphonevoice' " + showhidefields + "><td class='subfield'>BKMS VoiceIntake Implementation<br>Country Number</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsvoiceintakeimplementationcountrynum + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsvoiceintakeimplementationsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsvoiceintakeimplementationmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsvoiceintakeimplementationyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphonevoice' " + showhidefields + "><td class='subfield'>BKMS VoiceIntake<br>Language</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsvoiceintakelanguage + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsvoiceintakelanguagesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsvoiceintakelanguagemonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsvoiceintakelanguageyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphonevoice' " + showhidefields + "><td class='subfield'>BKMS VoiceIntake License<br>Country Number</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsvoiceintakelicensecountrynumber + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsvoiceintakelicensecountrynumsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsvoiceintakelicensecountrynummonthlyfe + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsvoiceintakelicensecountrynumyearlyfee + "'></td></tr>"

                + "<tr class='showhidebkmsphonevoice' " + showhidefields + "><td class='subfield'>GM Recording Cost</td><td><input type='number' class='numberfield' min='0' value='" + ss_gmrecordingcost + "'></td><td><input type='text' class='subTableFee' value='" + ss_gmrecordingcostsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_gmrecordingcostsmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_gmrecordingcostyearlyfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;


        }

        //Sub Table For BKMS Case Management 
        function embedSubTableForBKMSCaseManagement(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            var display_prop = "";
            var ss_bkmstabs = ss_bkmsformblocks = ss_casemanagerexaminernamed = ss_casemanagerexaminerfloating = ss_casemanagementreporting = 0;
            var ss_bkmstabssetupfee = ss_bkmsformblockssetupfee = ss_casemanagerexaminernamedsetupfee = ss_casemanagerexaminerfloatingsetupfee = ss_casemanagementreportingsetupfee = AddFormattings(0.00);
            var ss_bkmstabsmonthlyfee = ss_bkmsformblocksmonthlyfee = ss_casemanagerexaminernamedmonthlyfee = ss_casemanagerexaminerfloatingmonthlyfee = ss_casemanagementreportingmonthlyfee = AddFormattings(0.00);
            var ss_bkmstabsyearlyfee = ss_bkmsformblocksyearlyfee = ss_casemanagerexaminernamedyearlyfee = ss_casemanagerexaminerfloatingyearlyfee = ss_casemanagementreportingyearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {

                ss_bkmstabs = oportunityproducts.value[OPIndex]["ss_bkmstabs"] ? oportunityproducts.value[OPIndex]["ss_bkmstabs"] : 0;
                ss_bkmstabssetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstabssetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmstabssetupfee"] : 0.00);
                ss_bkmstabsmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstabsmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmstabsmonthlyfee"] : 0.00);
                ss_bkmstabsyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstabsyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmstabsyearlyfee"] : 0.00);

                ss_bkmsformblocks = oportunityproducts.value[OPIndex]["ss_bkmsformblocks"] ? oportunityproducts.value[OPIndex]["ss_bkmsformblocks"] : 0;
                ss_bkmsformblockssetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsformblockssetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsformblockssetupfee"] : 0.00);
                ss_bkmsformblocksmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsformblocksmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsformblocksmonthlyfee"] : 0.00);
                ss_bkmsformblocksyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsformblocksyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsformblocksyearlyfee"] : 0.00);

                ss_casemanagerexaminernamed = oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamed"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamed"] : 0;
                ss_casemanagerexaminernamedsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedsetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedsetupfee"] : 0.00);
                ss_casemanagerexaminernamedmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedmonthlyfee"] : 0.00);
                ss_casemanagerexaminernamedyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedyearlyfee"] : 0.00);

                ss_casemanagerexaminerfloating = oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloating"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloating"] : 0;
                ss_casemanagerexaminerfloatingsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingsetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingsetupfee"] : 0.00);
                ss_casemanagerexaminerfloatingmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingmonthlyfee"] : 0.00);
                ss_casemanagerexaminerfloatingyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingyearlyfee"] : 0.00);

                ss_casemanagementreporting = oportunityproducts.value[OPIndex]["ss_casemanagementreporting"] ? oportunityproducts.value[OPIndex]["ss_casemanagementreporting"] : 0;
                ss_casemanagementreportingsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagementreportingsetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagementreportingsetupfee"] : 0.00);
                ss_casemanagementreportingmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagementreportingmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagementreportingmonthlyfee"] : 0.00);
                ss_casemanagementreportingyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagementreportingyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagementreportingyearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts8' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"

                + "<tr><td class='subfield'>Tabs </td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmstabs + "'></td><td><input type='text' at='10' class='subTableFee' value='" + ss_bkmstabssetupfee + "' readonly='readonly'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmstabsmonthlyfee + "' readonly='readonly'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmstabsyearlyfee + "' readonly='readonly'></td></tr>"

                + "<tr><td class='subfield'>Form Blocks </td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsformblocks + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsformblockssetupfee + "' readonly='readonly'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsformblocksmonthlyfee + "' readonly='readonly'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsformblocksyearlyfee + "' readonly='readonly'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Named </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanagerexaminernamed + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagerexaminernamedsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagerexaminernamedmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagerexaminernamedyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Floating </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanagerexaminerfloating + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagerexaminerfloatingsetupfee + "' ></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagerexaminerfloatingmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagerexaminerfloatingyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Management Reporting </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanagementreporting + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagementreportingsetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagementreportingmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagementreportingyearlyfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;

        }

        //Sub Table For BKMS Case Management 
        function AddSubTableForBKMSCaseManagement(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            var tr4 = $(subTBody).find('tr:eq(4)');

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Case Management: ";
            entity.ss_bkmstabs = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmstabs;
            entity.ss_bkmstabssetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmstabsmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmstabsyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Case Management: Form Block";
            entity.ss_bkmsformblocks = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsformblocks;
            entity.ss_bkmsformblockssetupfee = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsformblocksmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsformblocksyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Case Management: Case Manager (Named)";
            entity.ss_casemanagerexaminernamed = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanagerexaminernamed;
            entity.ss_casemanagerexaminernamedsetupfee = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagerexaminernamedmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanagerexaminernamedyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Case Management: Case Manager (Floating)";
            entity.ss_casemanagerexaminerfloating = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanagerexaminerfloating;
            entity.ss_casemanagerexaminerfloatingsetupfee = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagerexaminerfloatingmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanagerexaminerfloatingyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Case Management: Case Management Reporting";
            entity.ss_casemanagementreporting = parseInt($(tr4).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanagementreporting;
            entity.ss_casemanagementreportingsetupfee = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagementreportingmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanagementreportingyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        //Sub Table for BKMS System DATA
        function AddSubTableForBKMS(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            var tr4 = $(subTBody).find('tr:eq(4)');
            var tr5 = $(subTBody).find('tr:eq(5)');
            var tr6 = $(subTBody).find('tr:eq(6)');
            var tr7 = $(subTBody).find('tr:eq(7)');
            var tr8 = $(subTBody).find('tr:eq(8)');
            var tr9 = $(subTBody).find('tr:eq(9)');
            var tr10 = $(subTBody).find('tr:eq(10)');
            var tr11 = $(subTBody).find('tr:eq(11)');
            var tr12 = $(subTBody).find('tr:eq(12)');
            var tr13 = $(subTBody).find('tr:eq(13)');
            var tr14 = $(subTBody).find('tr:eq(14)');

            entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nEmployees: ";
            entity.ss_employees = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_employees;
            entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_employeesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_employeesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nLanguages: ";
            entity.ss_languages = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Named User: ";
            entity.ss_casemanager = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Floating User: ";
            entity.ss_casemanagerfloatinguser = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
            entity.ss_casemanagerfloatusersetupfee = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagerfloatusermonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanagerfloatuseryearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS addtl. Language credits: ";
            entity.ss_bkmsadditionallanguagecredits = parseInt($(tr4).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsadditionallanguagecredits;
            entity.ss_bkmsadditionallanguagesetupfee = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsadditionallanguagemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsadditionallanguageyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Phone System: ";
            entity.ss_bkmsphonesystem = $(tr5).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsphonesystem;
            entity.ss_bkmsphonesystemsetupfee = parseFloat(RemoveFormattings($(tr5).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsphonesystemmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsphonesystemyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Phone Interview Hotline Calls New Report: ";
            entity.ss_bkmsphoneinterviewnewreport = parseInt($(tr6).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsphoneinterviewnewreport;
            entity.ss_bkmsphoneinterviewnewreportsetupfee = parseFloat(RemoveFormattings($(tr6).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsphoneinterviewnewreportmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr6).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsphoneinterviewnewreportyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr6).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Phone Interview Hotline Calls Reference Report: ";
            entity.ss_bkmsphoneinterviewreferencereport = parseInt($(tr7).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsphoneinterviewreferencereport;
            entity.ss_bkmsphoneinterviewreferencereportsetupfee = parseFloat(RemoveFormattings($(tr7).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsphoneinterviewreferencereportmonfee = isLicProduct ? parseFloat(RemoveFormattings($(tr7).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsphoneinterviewreferencereportyearlyfe = isLicProduct ? parseFloat(RemoveFormattings($(tr7).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Phone Interview Number License: ";
            entity.ss_bkmsphoneinterviewnumberlicense = parseInt($(tr8).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsphoneinterviewnumberlicense;
            entity.ss_bkmsphoneinterviewlicensenumbersetupfee = parseFloat(RemoveFormattings($(tr8).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsphoneinterviewlicensenumbermonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr8).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsphoneinterviewlicensenumberyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr8).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Voice Intake: ";
            entity.ss_bkmsvoiceintake = $(tr9).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsvoiceintake;
            entity.ss_bkmsvoiceintakesetupfee = parseFloat(RemoveFormattings($(tr9).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsvoiceintakesmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr9).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsvoiceintakesyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr9).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS VoiceIntake Calls Exceeding Included Package: ";
            entity.ss_bkmcvoiceintakeincludedpackage = parseInt($(tr10).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmcvoiceintakeincludedpackage;
            entity.ss_bkmsvoiceintakecallincludedpackagesetupfe = parseFloat(RemoveFormattings($(tr10).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsvoiceintakecallincludedpackagemonthly = isLicProduct ? parseFloat(RemoveFormattings($(tr10).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsvoiceintakecallincludedpackageyearlyf = isLicProduct ? parseFloat(RemoveFormattings($(tr10).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS VoiceIntake Implementation Country Number: ";
            entity.ss_bkmsvoiceintakeimplementationcountrynum = parseInt($(tr11).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsvoiceintakeimplementationcountrynum;
            entity.ss_bkmsvoiceintakeimplementationsetupfee = parseFloat(RemoveFormattings($(tr11).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsvoiceintakeimplementationmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr11).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsvoiceintakeimplementationyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr11).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS VoiceIntake Language: ";
            entity.ss_bkmsvoiceintakelanguage = parseInt($(tr12).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsvoiceintakelanguage;
            entity.ss_bkmsvoiceintakelanguagesetupfee = parseFloat(RemoveFormattings($(tr12).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsvoiceintakelanguagemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr12).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsvoiceintakelanguageyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr12).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS VoiceIntake License Country Number: ";
            entity.ss_bkmsvoiceintakelicensecountrynumber = parseInt($(tr13).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsvoiceintakelicensecountrynumber;
            entity.ss_bkmsvoiceintakelicensecountrynumsetupfee = parseFloat(RemoveFormattings($(tr13).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsvoiceintakelicensecountrynummonthlyfe = isLicProduct ? parseFloat(RemoveFormattings($(tr13).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsvoiceintakelicensecountrynumyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr13).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nGM Recording Cost: ";
            entity.ss_gmrecordingcost = parseInt($(tr14).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_gmrecordingcost;
            entity.ss_gmrecordingcostsetupfee = parseFloat(RemoveFormattings($(tr14).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_gmrecordingcostsmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr14).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_gmrecordingcostyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr14).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }


        //Sub Table for BKMS Compliance System Add on
        function embedsubtableforBKMScompliancesystemaddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_bkmscompliancesystemtrainingonsite = ss_bkmscompliancesystemtrainingonweb = ss_sso = 0;
            var ss_bkmscompliancesystemtrainingonsitesetupfe = ss_bkmscompliancesystemtrainingonwebsfee = ss_ssosetupfee = AddFormattings(0.00);
            var ss_bkmscompliancesystemtrainingonsitemfee = ss_bkmscompliancesystemtrainingonwebmfee = ss_ssomonthlyfee = AddFormattings(0.00);
            var ss_bkmscompliancesystemtrainingonsiteyfee = ss_bkmscompliancesystemtrainingonwebyfee = ss_ssoyearlyfee = AddFormattings(0.00);

            if (OPIndex > 0) {
                ss_bkmscompliancesystemtrainingonsite = oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsite"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsite"] : false;
                ss_bkmscompliancesystemtrainingonweb = oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonweb"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonweb"] : false;
                ss_sso = oportunityproducts.value[OPIndex]["ss_sso"] ? oportunityproducts.value[OPIndex]["ss_sso"] : false;

                //setup fee
                ss_bkmscompliancesystemtrainingonsitesetupfe = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsitesetupfe"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsitesetupfe"] : 0.00);
                ss_bkmscompliancesystemtrainingonwebsfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebsfee"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebsfee"] : 0.00);
                ss_ssosetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssosetupfee"] ? oportunityproducts.value[OPIndex]["ss_ssosetupfee"] : 0.00);

                //monthly fee
                ss_bkmscompliancesystemtrainingonsitemfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsitemfee"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsitemfee"] : 0.00);
                ss_bkmscompliancesystemtrainingonwebmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebmfee"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebmfee"] : 0.00);
                ss_ssomonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssomonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_ssomonthlyfee"] : 0.00);

                //YEarly Fee
                ss_bkmscompliancesystemtrainingonsiteyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsiteyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonsiteyfee"] : 0.00);
                ss_bkmscompliancesystemtrainingonwebyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmscompliancesystemtrainingonwebyfee"] : 0.00);
                ss_ssoyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssoyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_ssoyearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var bkmstrainingonsite = ss_bkmscompliancesystemtrainingonsite ? "checked" : "";
            var bkmstrainingonweb = ss_bkmscompliancesystemtrainingonweb ? "checked" : "";
            var ssocheck = ss_sso ? "checked" : "";

            var markup = "<tr class='OppProducts10' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive ILaddon table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield' >BKMS Training Onsite</td><td><input type='checkbox' class='fieldcheck' " + bkmstrainingonsite + " ></td><td><input type='text' class='subTableFee' value='" + ss_bkmscompliancesystemtrainingonsitesetupfe + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmscompliancesystemtrainingonsitemfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmscompliancesystemtrainingonsiteyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS Training Web</td><td><input type='checkbox' class='fieldcheck' " + bkmstrainingonweb + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmscompliancesystemtrainingonwebsfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmscompliancesystemtrainingonwebmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmscompliancesystemtrainingonwebyfee + "'></td></tr>"

                + "<tr><td class='subfield' >SSO</td><td><input type='checkbox' class='fieldcheck' " + ssocheck + "></td><td><input type='text' class='subTableFee' value='" + ss_ssosetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_ssomonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_ssoyearlyfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }

        //Sub Table for BKMS Compliance System Add On
        function AddSubTableForBKMSSystemAddOn(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            // var tr0 = $(subTBody).find('tr:eq(0)');
            // var tr1 = $(subTBody).find('tr:eq(1)');
            // var tr2 = $(subTBody).find('tr:eq(2)');
            var allRows = [];
            for (var i = 0; i < 3; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }

            entity.ss_bkmscompliancesystemtrainingonsite = $(allRows[0]).find('.fieldcheck').prop("checked");
            entity.ss_bkmscompliancesystemtrainingonweb = $(allRows[1]).find('.fieldcheck').prop("checked");
            entity.ss_sso = $(allRows[2]).find('.fieldcheck').prop("checked");

            //Adding Setup Fee      
            entity.ss_bkmscompliancesystemtrainingonsitesetupfe = parseFloat(RemoveFormattings($(allRows[0]).find('.subTableFee').val()));
            entity.ss_bkmscompliancesystemtrainingonwebsfee = parseFloat(RemoveFormattings($(allRows[1]).find('.subTableFee').val()));
            entity.ss_ssosetupfee = parseFloat(RemoveFormattings($(allRows[2]).find('.subTableFee').val()));
            //monthly fee
            entity.ss_bkmscompliancesystemtrainingonsitemfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableMFee').val())) : 0.00;
            entity.ss_bkmscompliancesystemtrainingonwebmfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00;
            entity.ss_ssomonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableMFee').val())) : 0.00;

            //yearly fee
            entity.ss_bkmscompliancesystemtrainingonsiteyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableYFee').val())) : 0.00;
            entity.ss_bkmscompliancesystemtrainingonwebyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableYFee').val())) : 0.00;
            entity.ss_ssoyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableYFee').val())) : 0.00;

            return entity;


        }

        //Embed Table For BKMS Case Management Addon
        function EmbedSubTableForBKMSCaseManagementAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {

            var display_prop = "";
            var ss_casemanagerexaminerfloatingcheck = ss_casemanagerexaminernamedcheck = false;
            var ss_casemanagersetup = ss_casemanagerfloatusersetupfee = AddFormattings(0.00);
            var ss_casemanagermfee = ss_casemanagerfloatusermonthlyfee = AddFormattings(0.00);
            var ss_casemanageryfee = ss_casemanagerfloatuseryearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {

                ss_casemanagerexaminernamedcheck = oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedcheck"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminernamedcheck"] : false;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);

                ss_casemanagerexaminerfloatingcheck = oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingcheck"] ? oportunityproducts.value[OPIndex]["ss_casemanagerexaminerfloatingcheck"] : false;
                ss_casemanagerfloatusersetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] : 0.00);
                ss_casemanagerfloatusermonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] : 0.00);
                ss_casemanagerfloatuseryearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var nameduser = ss_casemanagerexaminernamedcheck ? "checked" : "";
            var floatingcheck = ss_casemanagerexaminerfloatingcheck ? "checked" : "";

            var markup = "<tr class='OppProducts11' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive ILaddon table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield' >Case Manager <br> Examiner Named</td><td><input type='checkbox' class='fieldcheck' " + nameduser + " ></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager <br> Examiner Floating</td><td><input type='checkbox' class='fieldcheck' " + floatingcheck + "></td><td><input type='text' class='subTableFee' value='" + ss_casemanagerfloatusersetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagerfloatusermonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagerfloatuseryearlyfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }

        //Add Sub Table Data For BKMS Case Managemente Addon 
        function AddSubTableForBKMSCaseManagementAddon(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var allRows = [];
            for (var i = 0; i < 2; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }

            entity.ss_casemanagerexaminernamedcheck = $(allRows[0]).find('.fieldcheck').prop("checked");
            entity.ss_casemanagerexaminerfloatingcheck = $(allRows[1]).find('.fieldcheck').prop("checked");

            //Adding Setup Fee      
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(allRows[0]).find('.subTableFee').val()));
            entity.ss_casemanagerfloatusersetupfee = parseFloat(RemoveFormattings($(allRows[1]).find('.subTableFee').val()));
            //monthly fee
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableMFee').val())) : 0.00;
            entity.ss_casemanagerfloatusermonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00;

            //yearly fee
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableYFee').val())) : 0.00;
            entity.ss_casemanagerfloatuseryearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableYFee').val())) : 0.00;

            return entity;
        }

        //Add Table For BKMS Third Party
        function BKMSThirdParty(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";

            //Flag Fields
            var ss_additionallicensescheck = ss_databasecheck = ss_languagecheck = ss_questionnairecheck = false;
            //Number Fields
            var ss_additionallicensesnumber = ss_databasenumber = ss_languages = ss_questionnairenumber = 0;
            //Setup Fee Fee Fields
            var ss_additionallicensessetupfee = ss_databasesetupfee = ss_languagessetup = ss_questionnairesetupfee = AddFormattings(0);
            //Monthly Fee
            var ss_additionallicensesmonthlyfee = ss_databasemonthlyfee = ss_languagesmfee = ss_questionnairemonthlyfee = AddFormattings(0);
            //Yearly Fee
            var ss_additionallicensesyearlyfee = ss_databaseyearlyfee = ss_languagesyfee = ss_questionnaireyearlyfee = AddFormattings(0);

            if (OPIndex >= 0) {
                //Flag Fields
                ss_additionallicensescheck = oportunityproducts.value[OPIndex]["ss_additionallicensescheck"] ? oportunityproducts.value[OPIndex]["ss_additionallicensescheck"] : false;
                ss_databasecheck = oportunityproducts.value[OPIndex]["ss_databasecheck"] ? oportunityproducts.value[OPIndex]["ss_databasecheck"] : false;
                ss_languagecheck = oportunityproducts.value[OPIndex]["ss_languagecheck"] ? oportunityproducts.value[OPIndex]["ss_languagecheck"] : false;
                ss_questionnairecheck = oportunityproducts.value[OPIndex]["ss_questionnairecheck"] ? oportunityproducts.value[OPIndex]["ss_questionnairecheck"] : false;

                //Number Fields
                ss_additionallicensesnumber = oportunityproducts.value[OPIndex]["ss_additionallicensesnumber"] ? oportunityproducts.value[OPIndex]["ss_additionallicensesnumber"] : 0;
                ss_databasenumber = oportunityproducts.value[OPIndex]["ss_databasenumber"] ? oportunityproducts.value[OPIndex]["ss_databasenumber"] : 0;
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_questionnairenumber = oportunityproducts.value[OPIndex]["ss_questionnairenumber"] ? oportunityproducts.value[OPIndex]["ss_questionnairenumber"] : 0;

                //Setup Fee
                ss_additionallicensessetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallicensessetupfee"] ? oportunityproducts.value[OPIndex]["ss_additionallicensessetupfee"] : 0);
                ss_databasesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_databasesetupfee"] ? oportunityproducts.value[OPIndex]["ss_databasesetupfee"] : 0);
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0);
                ss_questionnairesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_questionnairesetupfee"] ? oportunityproducts.value[OPIndex]["ss_questionnairesetupfee"] : 0);

                //Monthly Fee
                ss_additionallicensesmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallicensesmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_additionallicensesmonthlyfee"] : 0);
                ss_databasemonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_databasemonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_databasemonthlyfee"] : 0);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0);
                ss_questionnairemonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_questionnairemonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_questionnairemonthlyfee"] : 0);

                //Yearly Fee
                ss_additionallicensesyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallicensesyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_additionallicensesyearlyfee"] : 0);
                ss_databaseyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_databaseyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_databaseyearlyfee"] : 0);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0);
                ss_questionnaireyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_questionnaireyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_questionnaireyearlyfee"] : 0);
            }
            else {
                display_prop = "style='display:none'";
            }

            var additionallicensescheck = ss_additionallicensescheck ? "checked" : "";
            var databasecheck = ss_databasecheck ? "checked" : "";
            var languagecheck = ss_languagecheck ? "checked" : "";
            var questionnairecheck = ss_questionnairecheck ? "checked" : "";

            var markup = "<tr class='OppProducts12' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive ILaddon table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Additional Licenses</td><td><input type='checkbox' class='fieldcheck' " + additionallicensescheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_additionallicensesnumber + "'></td><td><input type='text' class='subTableFee' value='" + ss_additionallicensessetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionallicensesmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionallicensesyearlyfee + "'></td></tr>"
                + "<tr><td class='subfield'>Database</td><td><input type='checkbox' class='fieldcheck' " + databasecheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_databasenumber + "'></td><td><input type='text' class='subTableFee' value='" + ss_databasesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_databasemonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_databaseyearlyfee + "'></td></tr>"
                + "<tr><td class='subfield'>Language</td><td><input type='checkbox' class='fieldcheck' " + languagecheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"
                + "<tr><td class='subfield'>Questionnaire</td><td><input type='checkbox' class='fieldcheck' " + questionnairecheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_questionnairenumber + "'></td><td><input type='text' class='subTableFee' value='" + ss_questionnairesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_questionnairemonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_questionnaireyearlyfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }

        //Add Data Table for BKMS Third Party
        function BKMSThirdPartyData(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');

            var allRows = [];
            for (var i = 0; i < 4; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }
            //flag fields
            entity.ss_additionallicensescheck = $(allRows[0]).find('.fieldcheck').prop("checked");
            entity.ss_databasecheck = $(allRows[1]).find('.fieldcheck').prop("checked");
            entity.ss_languagecheck = $(allRows[2]).find('.fieldcheck').prop("checked");
            entity.ss_questionnairecheck = $(allRows[3]).find('.fieldcheck').prop("checked");

            //Number Fields
            entity.ss_additionallicensesnumber = $(allRows[0]).find('.numberfield').val();
            entity.ss_databasenumber = $(allRows[1]).find('.numberfield').val();
            entity.ss_languages = $(allRows[2]).find('.numberfield').val();
            entity.ss_questionnairenumber = $(allRows[3]).find('.numberfield').val();

            //Setup Fields
            entity.ss_additionallicensessetupfee = parseFloat(RemoveFormattings($(allRows[0]).find('.subTableFee').val()));
            entity.ss_databasesetupfee = parseFloat(RemoveFormattings($(allRows[1]).find('.subTableFee').val()));
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(allRows[2]).find('.subTableFee').val()));
            entity.ss_questionnairesetupfee = parseFloat(RemoveFormattings($(allRows[3]).find('.subTableFee').val()));

            //Monthly Fee
            entity.ss_additionallicensesmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableMFee').val())) : 0.00;
            entity.ss_databasemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00;
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableMFee').val())) : 0.00;
            entity.ss_questionnairemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[3]).find('.subTableMFee').val())) : 0.00;

            //Yearly Fee
            entity.ss_additionallicensesyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableYFee').val())) : 0.00;
            entity.ss_databaseyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableYFee').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableYFee').val())) : 0.00;
            entity.ss_questionnaireyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[3]).find('.subTableYFee').val())) : 0.00;

            return entity;
        }

        //Sub Table For BKMS System Add-on Compliance Cockpit Add-On
        function EmbedSubTableForBKMSSystemAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_bkmsincidentreportingchannelpagecheck = ss_bkmsincidentreportingtranslationactcheck = ss_bkmsincidentreportingwbprocesscheck = ss_bkmstranslationcostsactcheck = false;

            var ss_casemanager = ss_casemanagerfloatinguser = ss_bkmsadditionallanguagecredits = ss_bkmssystemtranslationsystemact = 0;

            var ss_casemanagersetup = ss_casemanagerfloatusersetupfee = ss_bkmsadditionallanguagesetupfee = ss_bkmsincidentreportingchannelpagesetupfee = ss_bkmsincidentreportingtranslationactsetupf = ss_bkmsincidentreportingwbprocesssetupfee = ss_bkmstranslationcostactsetup_ps = ss_bkmssystemaddtlreportingcategorysetupfee_ = AddFormattings(0);

            var ss_casemanagermfee = ss_casemanagerfloatusermonthlyfee = ss_bkmsadditionallanguagemonthlyfee = ss_bkmsincidentreportingchannelpagemonthlyfe = ss_bkmsincidentreportingtranslationactmonthl = ss_bkmsincidentreportingwbprocessmonthlyfee = ss_bkmstranslationcostsactmonthlyfee_ps = AddFormattings(0);
            
            var ss_casemanageryfee = ss_casemanagerfloatuseryearlyfee = ss_bkmsadditionallanguageyearlyfee = ss_bkmsincidentreportingchannelpageyearlyfee = ss_bkmsincidentreportingtranslationactyearly = ss_bkmsincidentreportingwbprocessyearlyfee = ss_bkmstranslationcostyearlyfee_ps = ss_bkmssystemaddtlreportingcategoryyearly_ps = AddFormattings(0);

            if (OPIndex >= 0) {

                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);

                ss_casemanagerfloatinguser = oportunityproducts.value[OPIndex]["ss_casemanagerfloatinguser"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatinguser"] : 0;
                ss_casemanagerfloatusersetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusersetupfee"] : 0.00);
                ss_casemanagerfloatusermonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatusermonthlyfee"] : 0.00);
                ss_casemanagerfloatuseryearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagerfloatuseryearlyfee"] : 0.00);

                ss_bkmsadditionallanguagecredits = oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagecredits"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagecredits"] : 0;
                ss_bkmsadditionallanguagesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagesetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagesetupfee"] : 0.00);
                ss_bkmsadditionallanguagemonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagemonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguagemonthlyfee"] : 0.00);
                ss_bkmsadditionallanguageyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguageyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsadditionallanguageyearlyfee"] : 0.00);

                ss_bkmsincidentreportingchannelpagecheck = oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagecheck"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagecheck"] : false;
                ss_bkmsincidentreportingchannelpagesetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagesetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagesetupfee"] : 0.00);
                ss_bkmsincidentreportingchannelpagemonthlyfe = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagemonthlyfe"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpagemonthlyfe"] : 0.00);
                ss_bkmsincidentreportingchannelpageyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpageyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingchannelpageyearlyfee"] : 0.00);

                ss_bkmsincidentreportingtranslationactcheck = oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactcheck"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactcheck"] : false;
                ss_bkmsincidentreportingtranslationactsetupf = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactsetupf"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactsetupf"] : 0.00);
                ss_bkmsincidentreportingtranslationactmonthl = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactmonthl"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactmonthl"] : 0.00);
                ss_bkmsincidentreportingtranslationactyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactyearly"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactyearly"] : 0.00);

                ss_bkmsincidentreportingwbprocesscheck = oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocesscheck"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocesscheck"] : false;
                ss_bkmsincidentreportingwbprocesssetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocesssetupfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocesssetupfee"] : 0.00);
                ss_bkmsincidentreportingwbprocessmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocessmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocessmonthlyfee"] : 0.00);
                ss_bkmsincidentreportingwbprocessyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingwbprocessyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_bkmsincidentreportingtranslationactyearly"] : 0.00);

                ss_bkmstranslationcostsactcheck = oportunityproducts.value[OPIndex]["ss_bkmstranslationcostsactcheck"] ? oportunityproducts.value[OPIndex]["ss_bkmstranslationcostsactcheck"] : false;
                ss_bkmstranslationcostactsetup_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstranslationcostactsetup_ps"] ? oportunityproducts.value[OPIndex]["ss_bkmstranslationcostactsetup_ps"] : 0.00);
                ss_bkmstranslationcostsactmonthlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstranslationcostsactmonthlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_bkmstranslationcostsactmonthlyfee_ps"] : 0.00);
                ss_bkmstranslationcostyearlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmstranslationcostyearlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_bkmstranslationcostyearlyfee_ps"] : 0.00);

                ss_bkmssystemtranslationsystemact = oportunityproducts.value[OPIndex]["ss_bkmssystemtranslationsystemact"] ? oportunityproducts.value[OPIndex]["ss_bkmssystemtranslationsystemact"] : 0;
                ss_bkmssystemaddtlreportingcategorysetupfee_ = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmssystemaddtlreportingcategorysetupfee_"] ? oportunityproducts.value[OPIndex]["ss_bkmssystemaddtlreportingcategorysetupfee_"] : 0.00);
                ss_bkmsystemaddtlreportingcategorymonthlyee_ = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmsystemaddtlreportingcategorymonthlyee_"] ? oportunityproducts.value[OPIndex]["ss_bkmsystemaddtlreportingcategorymonthlyee_"] : 0.00);
                ss_bkmssystemaddtlreportingcategoryyearly_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_bkmssystemaddtlreportingcategoryyearly_ps"] ? oportunityproducts.value[OPIndex]["ss_bkmssystemaddtlreportingcategoryyearly_ps"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var bkmsincidentreportingchannelpagecheck = ss_bkmsincidentreportingchannelpagecheck ? "checked" : "";
            var bkmsincidentreportingtranslationactcheck = ss_bkmsincidentreportingtranslationactcheck ? "checked" : "";
            var bkmsincidentreportingwbprocesscheck = ss_bkmsincidentreportingwbprocesscheck ? "checked" : "";
            var bkmstranslationcostscheck = ss_bkmstranslationcostsactcheck ? "checked" : "";

            var markup = "<tr class='OppProducts13' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>BKMS addtl. <br>Language credits </td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmsadditionallanguagecredits + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmsadditionallanguagesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsadditionallanguagemonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsadditionallanguageyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Named </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"

                + "<tr><td class='subfield'>Case Manager - Examiner Floating </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanagerfloatinguser + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagerfloatusersetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagerfloatusermonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanagerfloatuseryearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS System<br>Channel Page</td><td><input type='checkbox' class='fieldcheck' " + bkmsincidentreportingchannelpagecheck + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmsincidentreportingchannelpagesetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsincidentreportingchannelpagemonthlyfe + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsincidentreportingchannelpageyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS System<br>Translation Module ACT</td><td><input type='checkbox' class='fieldcheck' " + bkmsincidentreportingtranslationactcheck + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmsincidentreportingtranslationactsetupf + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsincidentreportingtranslationactmonthl + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsincidentreportingtranslationactyearly + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS System<br>WB Process</td><td><input type='checkbox' class='fieldcheck' " + bkmsincidentreportingwbprocesscheck + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmsincidentreportingwbprocesssetupfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsincidentreportingwbprocessmonthlyfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmsincidentreportingwbprocessyearlyfee + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS System - Translation Costs<br>(ACT)</td><td><input type='checkbox' class='fieldcheck' " + bkmstranslationcostscheck + "></td><td><input type='text' class='subTableFee' value='" + ss_bkmstranslationcostactsetup_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmstranslationcostsactmonthlyfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmstranslationcostyearlyfee_ps + "'></td></tr>"

                + "<tr><td class='subfield'>BKMS System - Addtl Reporting<br>Category</td><td><input type='number' class='numberfield' min='0' value='" + ss_bkmssystemtranslationsystemact + "'></td><td><input type='text' class='subTableFee' value='" + ss_bkmssystemaddtlreportingcategorysetupfee_ + "'></td><td><input type='text' class='subTableMFee' value='" + ss_bkmsystemaddtlreportingcategorymonthlyee_ + "'></td><td><input type='text' class='subTableYFee' value='" + ss_bkmssystemaddtlreportingcategoryyearly_ps + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;


        }

        //Sub Table Data For BKMS System Add-on Compliance Cockpit Add-On
        function AddSubTableForBKMSSystemAddOnComplianceAddon(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            var tr4 = $(subTBody).find('tr:eq(4)');
            var tr5 = $(subTBody).find('tr:eq(5)');
            var tr6 = $(subTBody).find('tr:eq(6)');
            var tr7 = $(subTBody).find('tr:eq(7)');

            entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nBKMS addtl. Language credits: ";
            entity.ss_bkmsadditionallanguagecredits = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsadditionallanguagecredits;
            entity.ss_bkmsadditionallanguagesetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsadditionallanguagemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsadditionallanguageyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Named User: ";
            entity.ss_casemanager = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Floating User: ";
            entity.ss_casemanagerfloatinguser = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
            entity.ss_casemanagerfloatusersetupfee = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagerfloatusermonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanagerfloatuseryearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Incident Reporting Channel Page: ";
            entity.ss_bkmsincidentreportingchannelpagecheck = $(tr3).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsincidentreportingchannelpagecheck;
            entity.ss_bkmsincidentreportingchannelpagesetupfee = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsincidentreportingchannelpagemonthlyfe = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsincidentreportingchannelpageyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Incident Reporting Translation Module ACT: ";
            entity.ss_bkmsincidentreportingtranslationactcheck = $(tr4).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsincidentreportingtranslationactcheck;
            entity.ss_bkmsincidentreportingtranslationactsetupf = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsincidentreportingtranslationactmonthl = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsincidentreportingtranslationactyearly = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS Incident Reporting WB Process: ";
            entity.ss_bkmsincidentreportingwbprocesscheck = $(tr5).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmsincidentreportingwbprocesscheck;
            entity.ss_bkmsincidentreportingwbprocesssetupfee = parseFloat(RemoveFormattings($(tr5).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsincidentreportingwbprocessmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmsincidentreportingwbprocessyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr5).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS System - Translation Costs (ACT): ";
            entity.ss_bkmstranslationcostsactcheck = $(tr6).find('td:eq(1)').find('.fieldcheck').prop("checked");
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmstranslationcostsactcheck;
            entity.ss_bkmstranslationcostactsetup_ps = parseFloat(RemoveFormattings($(tr6).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmstranslationcostsactmonthlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr6).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmstranslationcostyearlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr6).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nBKMS System - Addtl Reporting Category: ";
            entity.ss_bkmssystemtranslationsystemact = parseInt($(tr7).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_bkmssystemtranslationsystemact;
            entity.ss_bkmssystemaddtlreportingcategorysetupfee_ = parseFloat(RemoveFormattings($(tr7).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_bkmsystemaddtlreportingcategorymonthlyee_ = isLicProduct ? parseFloat(RemoveFormattings($(tr7).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_bkmssystemaddtlreportingcategoryyearly_ps = isLicProduct ? parseFloat(RemoveFormattings($(tr7).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        //Sub Table for Integrity Line Class Data
        function AddSubTableForIntegrityClassic(entity, subtable, isLicProduct, oppProdDesc) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');
            var tr3 = $(subTBody).find('tr:eq(3)');
            //var tr4 = $(subTBody).find('tr:eq(4)');
            //var tr5 = $(subTBody).find('tr:eq(5)');
            var tr5 = $(subTBody).find('tr:eq(5)');
            var tr6 = $(subTBody).find('tr:eq(6)');
            //var tr8 = $(subTBody).find('tr:eq(8)');
            var tr8 = $(subTBody).find('tr:eq(8)');
            var tr9 = $(subTBody).find('tr:eq(9)');

            entity.ss_includedimphours_ps = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());

            entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nEmployees: ";
            entity.ss_employees = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_employees;
            entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_employeesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_employeesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nLanguages: ";
            entity.ss_languages = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            //Case Manager - Named User
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Named User: ";
            entity.ss_casemanager = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            //Countries
            // entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCountries: ";
            // entity.ss_admin = parseInt($(tr4).find('td:eq(1)').find('input[type=number]').val());
            // entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_admin;
            // entity.ss_adminsetup = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
            // entity.ss_adminmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            // entity.ss_adminyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            //Support-Basic
            var sBasic = $(tr5).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            var sprofessional = $(tr6).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            entity.ss_eqsintegrityldata_ps += (sBasic && isLicProduct) ? "\nSupport: Standard\n" : ((sprofessional && isLicProduct) ? "\nSupport: Advance\n" : "");
            entity.ss_supportbasic = sBasic;
            entity.ss_supportbasicsetup = sBasic ? parseFloat(RemoveFormattings($(tr5).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportbasicmfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr5).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportbasicyfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr5).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Support-professional
            entity.ss_supportprofessional = sprofessional;
            entity.ss_supportprofessionalsfee = sprofessional ? parseFloat(RemoveFormattings($(tr6).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportprofessionalmfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportprofessionalyfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            //Private Hositng & Azure Public Cloud
            var privatehosting = $(tr8).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            var azure_public_cloud = $(tr9).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            entity.ss_eqsintegrityldata_ps += (privatehosting && isLicProduct) ? "\n EQS Private Hosting:" : "";
            entity.ss_eqsintegrityldata_ps += (azure_public_cloud && isLicProduct) ? "\n Azure Public Cloud:" : "";
            //EQS Private Hosting
            entity.ss_eqsprivatehosting = privatehosting;
            entity.ss_eqsphsfee = privatehosting ? parseFloat(RemoveFormattings($(tr8).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_eqsphmfee = (privatehosting && isLicProduct) ? parseFloat(RemoveFormattings($(tr8).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_eqsphyfee = (privatehosting && isLicProduct) ? parseFloat(RemoveFormattings($(tr8).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Azure Public Cloud
            entity.ss_azurepubliccloud = azure_public_cloud;
            entity.ss_azurepcsfee = azure_public_cloud ? parseFloat(RemoveFormattings($(tr9).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_azurepcmfee = (azure_public_cloud && isLicProduct) ? parseFloat(RemoveFormattings($(tr9).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_azurepcyfee = (azure_public_cloud && isLicProduct) ? parseFloat(RemoveFormattings($(tr9).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            if (isLicProduct || oppProdDesc === undefined || oppProdDesc === null || oppProdDesc === "undefined") {
                entity.ss_customdescription = "";
            }
            else {
                entity.ss_customdescription = "\n" + oppProdDesc.replace("20", entity.ss_includedimphours_ps.toString());
            }
            //Setup Text Value
            entity.ss_stval_ps = isLicProduct ? "" : "Setup";

            return entity;
        }
        function embedSubTableForIntegrityAdd_On(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
            // Variables initialization 
            var display_prop = "";
            var display_AdditionalDetails = "";
            var checkAdditionalDetails = "";
            var ss_additionalfeaturesaddon_ps = "";
            var ss_admintab_ps = ss_journaltab_ps = ss_reportingstat_ps = ss_reminderalert_ps = ss_casechat_ps = false;
            var ss_deepsearch_ps = ss_anonymizationpdf_ps = ss_translationto_ps = ss_translationmt_ps = false;
            var ss_2factorauth_ps = ss_ipwhitelisting_ps = ss_caseimporterfun_ps = ss_customdomainurl_ps = ss_ssointegration_ps = false;
            var ss_apiintegration_ps = ss_phoneintakecc_ps = ss_phoneintakeams_ps = ss_emailintake_ps = ss_securecommunicationcftp_ps = ss_additionalfeatures_ps = false;

            //new fields
            var ss_integritylineclassiccheck = ss_newintegritylineclassiccheck = ss_fullfeaturepack = ss_singlesignon = ss_additionalfrontends = ss_additionalreportingform = ss_emailintakeintegrity = ss_callcenterintakephone = ss_automatedmessageservice = ss_professionalsupportinc = false;

            var ss_admintabsfee_ps = ss_journaltabsfee_ps = ss_reportingstatsfee_ps = ss_reminderalertsfee_ps = ss_casechatsfee_ps = ss_deepsearchsfee_ps = ss_anonymizationpdfsfee_ps = AddFormattings(0);
            var ss_translationtosfee_ps = ss_translationmtsfee_ps = ss_2factorauthsfee_ps = ss_ipwhitelistingsfee_ps = ss_emailintakesfee_ps = ss_securecommunicationcftpsfee_ps = ss_additionalfeaturessfee_ps = AddFormattings(0);
            //new setup fields 
            var ss_fullfeaturepacksetup = ss_singlesignonsetup = ss_additionalfrontendssetup = ss_additionalreportingformsetup = ss_emailintakeintegritysetup = ss_callcenterintakephonesetup = ss_automatedmessageservicesetup = ss_professionalsupportincsetup = AddFormattings(0);

            var ss_caseimporterfunsfee_ps = ss_customdomainurlsfee_ps = AddFormattings(0);
            var ss_ssointegrationsfee_ps = AddFormattings(0);
            var ss_apiintegrationsfee_ps = AddFormattings(0);
            var ss_phoneintakeccsfee_ps = AddFormattings(0);
            var ss_phoneintakeamssfee_ps = AddFormattings(0);
            var ss_admintabmfee_ps = ss_journaltabmfee_ps = ss_reportingstatmfee_ps = ss_reminderalertmfee_ps = ss_casechatmfee_ps = ss_deepsearchmfee_ps = ss_anonymizationpdfmfee_ps = ss_securecommunicationcftpmfee_ps = AddFormattings(0);

            //new fields monthly
            var ss_fullfeaturepackmonthly = ss_singlesignonmonthly = ss_additionalfrontendsmonthly = ss_additionalreportingformmonthly = ss_emailintakeintegritymonthly = ss_callcenterintakephonemonthly = ss_automatedmessageservicemonthly = ss_professionalsupportincmonthly = AddFormattings(0);

            var ss_translationtomfee_ps = ss_translationmtmfee_ps = ss_2factorauthmfee_ps = ss_ipwhitelistingmfee_ps = ss_caseimporterfunmfee_ps = ss_phoneintakeamsmfee_ps = ss_emailintakemfee_ps = AddFormattings(0);
            var ss_customdomainurlmfee_ps = ss_additionalfeaturesmfee_ps = AddFormattings(0);
            var ss_apiintegrationmfee_ps = AddFormattings(0);
            var ss_ssointegrationmfee_ps = ss_phoneintakeccmfee_ps = AddFormattings(0);
            var ss_admintabyfee_ps = ss_journaltabyfee_ps = ss_reportingstatyfee_ps = ss_reminderalertyfee_ps = ss_casechatyfee_ps = ss_deepsearchyfee_ps = ss_anonymizationpdfyfee_ps = ss_securecommunicationcftpyfee_ps = AddFormattings(0);
            var ss_translationtoyfee_ps = ss_translationmtyfee_ps = ss_2factorauthyfee_ps = ss_ipwhitelistingyfee_ps = ss_caseimporterfunyfee_ps = ss_phoneintakeamsyfee_ps = ss_emailintakeyfee_ps = AddFormattings(0);
            //new fields yearly
            var ss_fullfeaturepackyearly = ss_singlesignonyealry = ss_additionalfrontendsyearly = ss_additionalreportingformyearly = ss_emailintakeintegrityyearly = ss_callcenterintakephoneyearly = ss_automatedmessageserviceyearly = ss_professionalsupportincyearly = AddFormattings(0);

            var ss_customdomainurlyfee_ps = ss_additionalfeaturesyfee_ps = AddFormattings(0);
            var ss_apiintegrationyfee_ps = AddFormattings(3600);
            var ss_ssointegrationyfee_ps = ss_phoneintakeccyfee_ps = AddFormattings(0);
            //========
            var ss_admin = ss_languages = ss_casemanager = ss_phonelang = 0;
            var ss_adminsetup = ss_languagessetup = ss_casemanagersetup = ss_phonelangsfee = AddFormattings(0.00);
            var ss_adminmfee = ss_languagesmfee = ss_casemanagermfee = ss_phonelangmfee = AddFormattings(0.00);
            var ss_adminyfee = ss_languagesyfee = ss_casemanageryfee = ss_phonelangyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                // Flags fields
                ss_admintab_ps = oportunityproducts.value[OPIndex]["ss_admintab_ps"] ? oportunityproducts.value[OPIndex]["ss_admintab_ps"] : false;
                ss_journaltab_ps = oportunityproducts.value[OPIndex]["ss_journaltab_ps"] ? oportunityproducts.value[OPIndex]["ss_journaltab_ps"] : false;
                ss_reportingstat_ps = oportunityproducts.value[OPIndex]["ss_reportingstat_ps"] ? oportunityproducts.value[OPIndex]["ss_reportingstat_ps"] : false;
                ss_reminderalert_ps = oportunityproducts.value[OPIndex]["ss_reminderalert_ps"] ? oportunityproducts.value[OPIndex]["ss_reminderalert_ps"] : false;
                ss_casechat_ps = oportunityproducts.value[OPIndex]["ss_casechat_ps"] ? oportunityproducts.value[OPIndex]["ss_casechat_ps"] : false;
                ss_deepsearch_ps = oportunityproducts.value[OPIndex]["ss_deepsearch_ps"] ? oportunityproducts.value[OPIndex]["ss_deepsearch_ps"] : false;
                ss_anonymizationpdf_ps = oportunityproducts.value[OPIndex]["ss_anonymizationpdf_ps"] ? oportunityproducts.value[OPIndex]["ss_anonymizationpdf_ps"] : false;
                ss_translationto_ps = oportunityproducts.value[OPIndex]["ss_translationto_ps"] ? oportunityproducts.value[OPIndex]["ss_translationto_ps"] : false;
                ss_translationmt_ps = oportunityproducts.value[OPIndex]["ss_translationmt_ps"] ? oportunityproducts.value[OPIndex]["ss_translationmt_ps"] : false;
                ss_2factorauth_ps = oportunityproducts.value[OPIndex]["ss_2factorauth_ps"] ? oportunityproducts.value[OPIndex]["ss_2factorauth_ps"] : false;
                ss_ipwhitelisting_ps = oportunityproducts.value[OPIndex]["ss_ipwhitelisting_ps"] ? oportunityproducts.value[OPIndex]["ss_ipwhitelisting_ps"] : false;
                ss_caseimporterfun_ps = oportunityproducts.value[OPIndex]["ss_caseimporterfun_ps"] ? oportunityproducts.value[OPIndex]["ss_caseimporterfun_ps"] : false;
                ss_customdomainurl_ps = oportunityproducts.value[OPIndex]["ss_customdomainurl_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurl_ps"] : false;
                ss_ssointegration_ps = oportunityproducts.value[OPIndex]["ss_ssointegration_ps"] ? oportunityproducts.value[OPIndex]["ss_ssointegration_ps"] : false;
                ss_apiintegration_ps = oportunityproducts.value[OPIndex]["ss_apiintegration_ps"] ? oportunityproducts.value[OPIndex]["ss_apiintegration_ps"] : false;
                ss_phoneintakecc_ps = oportunityproducts.value[OPIndex]["ss_phoneintakecc_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakecc_ps"] : false;
                ss_phoneintakeams_ps = oportunityproducts.value[OPIndex]["ss_phoneintakeams_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeams_ps"] : false;
                ss_emailintake_ps = oportunityproducts.value[OPIndex]["ss_emailintake_ps"] ? oportunityproducts.value[OPIndex]["ss_emailintake_ps"] : false;
                ss_securecommunicationcftp_ps = oportunityproducts.value[OPIndex]["ss_securecommunicationcftp_ps"] ? oportunityproducts.value[OPIndex]["ss_securecommunicationcftp_ps"] : false;
                ss_additionalfeatures_ps = oportunityproducts.value[OPIndex]["ss_additionalfeatures_ps"] ? oportunityproducts.value[OPIndex]["ss_additionalfeatures_ps"] : false;
                //=============
                // ss_languages = oportunityproducts.value[OPIndex]["ss_languagescheck_ps"] ? oportunityproducts.value[OPIndex]["ss_languagescheck_ps"] : 0;
                // ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanagercheck_ps"] ? oportunityproducts.value[OPIndex]["ss_casemanagercheck_ps"] : 0;
                // ss_admin = oportunityproducts.value[OPIndex]["ss_admincheck_ps"] ? oportunityproducts.value[OPIndex]["ss_admincheck_ps"] : 0;
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_casemanager = oportunityproducts.value[OPIndex]["ss_casemanager"] ? oportunityproducts.value[OPIndex]["ss_casemanager"] : 0;
                ss_admin = oportunityproducts.value[OPIndex]["ss_admin"] ? oportunityproducts.value[OPIndex]["ss_admin"] : 0;
                ss_phonelang = oportunityproducts.value[OPIndex]["ss_phonelang"] ? oportunityproducts.value[OPIndex]["ss_phonelang"] : 0;
                //new fields two option
                ss_fullfeaturepack = oportunityproducts.value[OPIndex]["ss_fullfeaturepack"] ? oportunityproducts.value[OPIndex]["ss_fullfeaturepack"] : false;
                ss_singlesignon = oportunityproducts.value[OPIndex]["ss_singlesignon"] ? oportunityproducts.value[OPIndex]["ss_singlesignon"] : false;
                ss_additionalfrontends = oportunityproducts.value[OPIndex]["ss_additionalfrontends"] ? oportunityproducts.value[OPIndex]["ss_additionalfrontends"] : false;
                ss_additionalreportingform = oportunityproducts.value[OPIndex]["ss_additionalreportingform"] ? oportunityproducts.value[OPIndex]["ss_additionalreportingform"] : false;
                ss_emailintakeintegrity = oportunityproducts.value[OPIndex]["ss_emailintakeintegrity"] ? oportunityproducts.value[OPIndex]["ss_emailintakeintegrity"] : false;
                ss_callcenterintakephone = oportunityproducts.value[OPIndex]["ss_callcenterintakephone"] ? oportunityproducts.value[OPIndex]["ss_callcenterintakephone"] : false;
                ss_automatedmessageservice = oportunityproducts.value[OPIndex]["ss_automatedmessageservice"] ? oportunityproducts.value[OPIndex]["ss_automatedmessageservice"] : false;
                ss_professionalsupportinc = oportunityproducts.value[OPIndex]["ss_professionalsupportinc"] ? oportunityproducts.value[OPIndex]["ss_professionalsupportinc"] : false;
                //Classic Check
                ss_integritylineclassiccheck = oportunityproducts.value[OPIndex]["ss_integritylineclassiccheck"] ? oportunityproducts.value[OPIndex]["ss_integritylineclassiccheck"] : false;
                //Integrity Check
                ss_newintegritylineclassiccheck = oportunityproducts.value[OPIndex]["ss_newintegritylineclassiccheck"] ? oportunityproducts.value[OPIndex]["ss_newintegritylineclassiccheck"] : false;
                //==============

                //Setup Fee attributes
                ss_admintabsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_admintabsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_admintabsfee_ps"] : 0.00);
                ss_journaltabsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_journaltabsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_journaltabsfee_ps"] : 0);
                ss_reportingstatsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reportingstatsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reportingstatsfee_ps"] : 0);
                ss_reminderalertsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reminderalertsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reminderalertsfee_ps"] : 0);
                ss_casechatsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_casechatsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_casechatsfee_ps"] : 0);
                ss_deepsearchsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_deepsearchsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_deepsearchsfee_ps"] : 0);
                ss_anonymizationpdfsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_anonymizationpdfsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_anonymizationpdfsfee_ps"] : 0);
                ss_translationtosfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationtosfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationtosfee_ps"] : 0);
                ss_translationmtsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationmtsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationmtsfee_ps"] : 0);
                ss_2factorauthsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_2factorauthsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_2factorauthsfee_ps"] : 0);
                ss_ipwhitelistingsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ipwhitelistingsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ipwhitelistingsfee_ps"] : 0);
                ss_caseimporterfunsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_caseimporterfunsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_caseimporterfunsfee_ps"] : 0);
                ss_customdomainurlsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlsfee_ps"] : 0);
                ss_ssointegrationsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssointegrationsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ssointegrationsfee_ps"] : 0);
                ss_apiintegrationsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_apiintegrationsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_apiintegrationsfee_ps"] : 0);
                ss_phoneintakeccsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeccsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeccsfee_ps"] : 0);
                ss_phoneintakeamssfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeamssfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeamssfee_ps"] : 0);
                ss_emailintakesfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakesfee_ps"] ? oportunityproducts.value[OPIndex]["ss_emailintakesfee_ps"] : 0);
                ss_securecommunicationcftpsfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_securecommunicationcftpsfee_ps"] ? oportunityproducts.value[OPIndex]["ss_securecommunicationcftpsfee_ps"] : 0);
                ss_additionalfeaturessfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalfeaturessfee_ps"] ? oportunityproducts.value[OPIndex]["ss_additionalfeaturessfee_ps"] : 0);

                //==============
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_casemanagersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagersetup"] ? oportunityproducts.value[OPIndex]["ss_casemanagersetup"] : 0.00);
                ss_adminsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminsetup"] ? oportunityproducts.value[OPIndex]["ss_adminsetup"] : 0.00);
                ss_phonelangsfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_phonelangsfee"] ? oportunityproducts.value[OPIndex]["ss_phonelangsfee"] : 0.00);
                //new fields setup
                ss_fullfeaturepacksetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_fullfeaturepacksetup"] ? oportunityproducts.value[OPIndex]["ss_fullfeaturepacksetup"] : 0);
                console.log("Setup Fee is => " + ss_fullfeaturepacksetup);
                ss_singlesignonsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonsetup"] ? oportunityproducts.value[OPIndex]["ss_singlesignonsetup"] : 0);
                ss_additionalfrontendssetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalfrontendssetup"] ? oportunityproducts.value[OPIndex]["ss_additionalfrontendssetup"] : 0);
                ss_additionalreportingformsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalreportingformsetup"] ? oportunityproducts.value[OPIndex]["ss_additionalreportingformsetup"] : 0);
                ss_emailintakeintegritysetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakeintegritysetup"] ? oportunityproducts.value[OPIndex]["ss_emailintakeintegritysetup"] : 0);
                ss_callcenterintakephonesetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_callcenterintakephonesetup"] ? oportunityproducts.value[OPIndex]["ss_callcenterintakephonesetup"] : 0);
                ss_automatedmessageservicesetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_automatedmessageservicesetup"] ? oportunityproducts.value[OPIndex]["ss_automatedmessageservicesetup"] : 0);
                ss_professionalsupportincsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_professionalsupportincsetup"] ? oportunityproducts.value[OPIndex]["ss_professionalsupportincsetup"] : 0);
                //Monthly Fee attributes
                ss_admintabmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_admintabmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_admintabmfee_ps"] : 0.00);
                ss_journaltabmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_journaltabmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_journaltabmfee_ps"] : 0);
                ss_reportingstatmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reportingstatmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reportingstatmfee_ps"] : 0);
                ss_reminderalertmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reminderalertmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reminderalertmfee_ps"] : 0);
                ss_casechatmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_casechatmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_casechatmfee_ps"] : 0);
                ss_deepsearchmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_deepsearchmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_deepsearchmfee_ps"] : 0);
                ss_anonymizationpdfmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_anonymizationpdfmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_anonymizationpdfmfee_ps"] : 0);
                ss_translationtomfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationtomfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationtomfee_ps"] : 0);
                ss_translationmtmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationmtmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationmtmfee_ps"] : 0);
                ss_2factorauthmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_2factorauthmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_2factorauthmfee_ps"] : 0);
                ss_ipwhitelistingmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ipwhitelistingmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ipwhitelistingmfee_ps"] : 0);
                ss_caseimporterfunmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_caseimporterfunmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_caseimporterfunmfee_ps"] : 0);
                ss_customdomainurlmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlmfee_ps"] : 0);
                ss_ssointegrationmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssointegrationmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ssointegrationmfee_ps"] : 0);
                ss_apiintegrationmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_apiintegrationmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_apiintegrationmfee_ps"] : 0);
                ss_phoneintakeccmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeccmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeccmfee_ps"] : 0);
                ss_phoneintakeamsmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeamsmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeamsmfee_ps"] : 0);
                ss_emailintakemfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakemfee_ps"] ? oportunityproducts.value[OPIndex]["ss_emailintakemfee_ps"] : 0);
                ss_securecommunicationcftpmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_securecommunicationcftpmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_securecommunicationcftpmfee_ps"] : 0);
                ss_additionalfeaturesmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalfeaturesmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_additionalfeaturesmfee_ps"] : 0);

                //================
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_casemanagermfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanagermfee"] ? oportunityproducts.value[OPIndex]["ss_casemanagermfee"] : 0.00);
                ss_adminmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminmfee"] ? oportunityproducts.value[OPIndex]["ss_adminmfee"] : 0.00);
                ss_phonelangmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_phonelangmfee"] ? oportunityproducts.value[OPIndex]["ss_phonelangmfee"] : 0.00);
                //new fields monthly  
                ss_fullfeaturepackmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_fullfeaturepackmonthly"] ? oportunityproducts.value[OPIndex]["ss_fullfeaturepackmonthly"] : 0);
                ss_singlesignonmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonmonthly"] ? oportunityproducts.value[OPIndex]["ss_singlesignonmonthly"] : 0);
                ss_additionalreportingformmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalreportingformmonthly"] ? oportunityproducts.value[OPIndex]["ss_additionalreportingformmonthly"] : 0)
                ss_emailintakeintegritymonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakeintegritymonthly"] ? oportunityproducts.value[OPIndex]["ss_emailintakeintegritymonthly"] : 0);
                ss_callcenterintakephonemonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_callcenterintakephonemonthly"] ? oportunityproducts.value[OPIndex]["ss_callcenterintakephonemonthly"] : 0);
                ss_automatedmessageservicemonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_automatedmessageservicemonthly"] ? oportunityproducts.value[OPIndex]["ss_automatedmessageservicemonthly"] : 0);
                ss_professionalsupportincmonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_professionalsupportincmonthly"] ? oportunityproducts.value[OPIndex]["ss_professionalsupportincmonthly"] : 0);
                //Yearly Fee attributes
                ss_admintabyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_admintabyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_admintabyfee_ps"] : 0.00);
                ss_journaltabyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_journaltabyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_journaltabyfee_ps"] : 0);
                ss_reportingstatyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reportingstatyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reportingstatyfee_ps"] : 0);
                ss_reminderalertyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_reminderalertyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_reminderalertyfee_ps"] : 0);
                ss_casechatyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_casechatyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_casechatyfee_ps"] : 0);
                ss_deepsearchyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_deepsearchyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_deepsearchyfee_ps"] : 0);
                ss_anonymizationpdfyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_anonymizationpdfyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_anonymizationpdfyfee_ps"] : 0);
                ss_translationtoyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationtoyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationtoyfee_ps"] : 0);
                ss_translationmtyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_translationmtyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_translationmtyfee_ps"] : 0);
                ss_2factorauthyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_2factorauthyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_2factorauthyfee_ps"] : 0);
                ss_ipwhitelistingyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ipwhitelistingyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ipwhitelistingyfee_ps"] : 0);
                ss_caseimporterfunyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_caseimporterfunyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_caseimporterfunyfee_ps"] : 0);
                ss_customdomainurlyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_customdomainurlyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_customdomainurlyfee_ps"] : 0);
                ss_ssointegrationyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_ssointegrationyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_ssointegrationyfee_ps"] : 0);
                ss_apiintegrationyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_apiintegrationmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_apiintegrationmfee_ps"] : 0);
                ss_phoneintakeccyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeccyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeccyfee_ps"] : 0);
                ss_phoneintakeamsyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_phoneintakeamsyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_phoneintakeamsyfee_ps"] : 0);
                ss_emailintakeyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakeyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_emailintakeyfee_ps"] : 0);
                ss_securecommunicationcftpyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_securecommunicationcftpyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_securecommunicationcftpyfee_ps"] : 0);
                ss_additionalfeaturesyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalfeaturesyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_additionalfeaturesyfee_ps"] : 0);
                //new fields yearly
                //new fields 
                ss_fullfeaturepackyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_fullfeaturepackyearly"] ? oportunityproducts.value[OPIndex]["ss_fullfeaturepackyearly"] : 0);
                console.log("Yearly Fee is => " + ss_fullfeaturepackyearly);
                ss_singlesignonyealry = AddFormattings(oportunityproducts.value[OPIndex]["ss_singlesignonyealry"] ? oportunityproducts.value[OPIndex]["ss_singlesignonyealry"] : 0);
                ss_additionalfrontendsyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalfrontendsyearly"] ? oportunityproducts.value[OPIndex]["ss_additionalfrontendsyearly"] : 0);
                ss_additionalreportingformyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalreportingformyearly"] ? oportunityproducts.value[OPIndex]["ss_additionalreportingformyearly"] : 0);
                ss_additionalreportingformyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_emailintakeintegrityyearly"] ? oportunityproducts.value[OPIndex]["ss_emailintakeintegrityyearly"] : 0);
                ss_callcenterintakephoneyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_callcenterintakephoneyearly"] ? oportunityproducts.value[OPIndex]["ss_callcenterintakephoneyearly"] : 0);
                ss_automatedmessageserviceyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_automatedmessageserviceyearly"] ? oportunityproducts.value[OPIndex]["ss_automatedmessageserviceyearly"] : 0);
                ss_professionalsupportincyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_professionalsupportincyearly"] ? oportunityproducts.value[OPIndex]["ss_professionalsupportincyearly"] : 0);
                //====================
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);
                ss_casemanageryfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_casemanageryfee"] ? oportunityproducts.value[OPIndex]["ss_casemanageryfee"] : 0.00);
                ss_adminyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminyfee"] ? oportunityproducts.value[OPIndex]["ss_adminyfee"] : 0.00);
                ss_phonelangyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_phonelangyfee"] ? oportunityproducts.value[OPIndex]["ss_phonelangyfee"] : 0.00);
                // Additional Details 
                ss_additionalfeaturesaddon_ps = oportunityproducts.value[OPIndex]["ss_additionalfeaturesaddon_ps"] ? oportunityproducts.value[OPIndex]["ss_additionalfeaturesaddon_ps"] : "";
            }
            else {
                display_prop = "style='display:none'";
            }
            if (!ss_additionalfeatures_ps) {
                display_AdditionalDetails = "style='display:none'";
            }


            var ss_admintab = ss_admintab_ps ? "checked" : "";
            var ss_journaltab = ss_journaltab_ps ? "checked" : "";
            var ss_reportingstat = ss_reportingstat_ps ? "checked" : "";
            var ss_reminderalert = ss_reminderalert_ps ? "checked" : "";
            var ss_casechat = ss_casechat_ps ? "checked" : "";
            var ss_deepsearch = ss_deepsearch_ps ? "checked" : "";
            var ss_anonymizationpdf = ss_anonymizationpdf_ps ? "checked" : "";
            var ss_translationfunoffice = ss_translationto_ps ? "checked" : "";
            var ss_translationfundeepl = ss_translationmt_ps ? "checked" : "";
            var ss_2factorauth = ss_2factorauth_ps ? "checked" : "";
            var ss_ipwhitelisting = ss_ipwhitelisting_ps ? "checked" : "";
            var ss_caseimporterfun = ss_caseimporterfun_ps ? "checked" : "";
            var ss_customdomainurl = ss_customdomainurl_ps ? "checked" : "";
            var ss_ssointegration = ss_ssointegration_ps ? "checked" : "";
            var ss_apiintegration = ss_apiintegration_ps ? "checked" : "";
            var ss_callcenterpi = ss_phoneintakecc_ps ? "checked" : "";
            var ss_automatedmessagesi = ss_phoneintakeams_ps ? "checked" : "";
            var ss_emailintake = ss_emailintake_ps ? "checked" : "";
            var ss_securecommunicationcftp = ss_securecommunicationcftp_ps ? "checked" : "";
            var ss_additionalfeatures = ss_additionalfeatures_ps ? "checked" : "";
            //new fields
            var ss_integritylineclassic = ss_integritylineclassiccheck ? "checked" : "";
            var ss_integrityclassicline = ss_newintegritylineclassiccheck ? "checked" : "";
            var fullfeaturepack = ss_fullfeaturepack ? "checked" : "";
            var singlesignon = ss_singlesignon ? "checked" : "";
            var additionalfrontends = ss_additionalfrontends ? "checked" : "";
            var additionalreportingform = ss_additionalreportingform ? "checked" : "";
            var emailintakeintegrity = ss_emailintakeintegrity ? "checked" : "";
            var callcenteritakephone = ss_callcenterintakephone ? "checked" : "";
            var automatedservices = ss_automatedmessageservice ? "checked" : "";
            var professionsupportinc = ss_professionalsupportinc ? "checked" : "";
            //==========
            //   var ss_languagescheck = ss_languages ? "checked" : "";
            //   var ss_casemanagercheck = ss_casemanager ? "checked" : "";
            //   var ss_admincheck = ss_admin ? "checked" : "";


            var displayrow = "style='display:none'";

            if (ss_integritylineclassiccheck) {
                displayrow = "";
            }
            var diplayrowintegrity = "style='display:none'";
            if (ss_newintegritylineclassiccheck) {
                diplayrowintegrity = "";
            }
            //New Subtable for EQS IntergrityLine Add-On, @18-12 
            var markup = "<tr class='OppProducts2' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive ILaddon table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
                + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"
                //new
                + "<tr><td class='subfield integrityClass'></td><td class='integrityClass2'></td><td><div class='itegrityText'>Classic</div><input type='checkbox' class='classiccheckbox Integ_CheckBox' " + ss_integritylineclassic + "></td><td><div class='itegrityText integrityClass3'>Integrity</div><input type='checkbox' class='integritycheckbox Integ_CheckBox' " + ss_integrityclassicline + " ></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Admin Tab</td><td><input type='checkbox' class='fieldcheck' " + ss_admintab + "></td><td><input type='text' class='subTableFee' value='" + ss_admintabsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_admintabmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_admintabyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Journal Tab</td><td><input type='checkbox' class='fieldcheck' " + ss_journaltab + "></td><td><input type='text' class='subTableFee' value='" + ss_journaltabsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_journaltabmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_journaltabyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Reporting & Statistics (Charts)</td><td><input type='checkbox' class='fieldcheck' " + ss_reportingstat + "></td><td><input type='text' class='subTableFee' value='" + ss_reportingstatsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_reportingstatmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_reportingstatyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Reminders & Alerts</td><td><input type='checkbox' class='fieldcheck' " + ss_reminderalert + "></td><td><input type='text' class='subTableFee' value='" + ss_reminderalertsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_reminderalertmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_reminderalertyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Case Chat</td><td><input type='checkbox' class='fieldcheck' " + ss_casechat + "></td><td><input type='text' class='subTableFee' value='" + ss_casechatsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casechatmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casechatyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Deep Search (in all cases and case details)</td><td><input type='checkbox' class='fieldcheck' " + ss_deepsearch + "></td><td><input type='text' class='subTableFee' value='" + ss_deepsearchsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_deepsearchmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_deepsearchyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Anonymization in PDFs (add on to anoymization function)</td><td><input type='checkbox' class='fieldcheck' " + ss_anonymizationpdf + "></td><td><input type='text' class='subTableFee' value='" + ss_anonymizationpdfsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_anonymizationpdfmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_anonymizationpdfyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Translation (translation office)</td><td><input type='checkbox' class='fieldcheck' " + ss_translationfunoffice + "></td><td><input type='text' class='subTableFee' value='" + ss_translationtosfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_translationtomfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_translationtoyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Translation (machine translation)</td><td><input type='checkbox' class='fieldcheck' " + ss_translationfundeepl + "></td><td><input type='text' class='subTableFee' value='" + ss_translationmtsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_translationmtmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_translationmtyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >2 factor Authentication (Backend)</td><td><input type='checkbox' class='fieldcheck' " + ss_2factorauth + "></td><td><input type='text' class='subTableFee' value='" + ss_2factorauthsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_2factorauthmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_2factorauthyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >IP Whitelisting (Backend)</td><td><input type='checkbox' class='fieldcheck' " + ss_ipwhitelisting + "></td><td><input type='text' class='subTableFee' value='" + ss_ipwhitelistingsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_ipwhitelistingmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_ipwhitelistingyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Case Importer function (via xls upload)</td><td><input type='checkbox' class='fieldcheck' " + ss_caseimporterfun + "></td><td><input type='text' class='subTableFee' value='" + ss_caseimporterfunsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_caseimporterfunmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_caseimporterfunyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Custom Domain/URL</td><td><input type='checkbox' class='fieldcheck' " + ss_customdomainurl + "></td><td><input type='text' class='subTableFee' value='" + ss_customdomainurlsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_customdomainurlmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_customdomainurlyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >SSO integration (single sign on via SAML2)</td><td><input type='checkbox' class='fieldcheck' " + ss_ssointegration + "></td><td><input type='text' class='subTableFee' value='" + ss_ssointegrationsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_ssointegrationmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_ssointegrationyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >API integration (via RESTful)</td><td><input type='checkbox' class='fieldcheck' " + ss_apiintegration + "></td><td><input type='text' class='subTableFee' value='" + ss_apiintegrationsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_apiintegrationmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_apiintegrationyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Phone Intake (call center)</td><td><input type='checkbox' class='fieldcheck' " + ss_callcenterpi + "></td><td><input type='text' class='subTableFee' value='" + ss_phoneintakeccsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_phoneintakeccmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_phoneintakeccyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Phone Intake (automated message service)</td><td><input type='checkbox' class='fieldcheck' " + ss_automatedmessagesi + "></td><td><input type='text' class='subTableFee' value='" + ss_phoneintakeamssfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_phoneintakeamsmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_phoneintakeamsyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Email Intake</td><td><input type='checkbox' class='fieldcheck' " + ss_emailintake + "></td><td><input type='text' class='subTableFee' value='" + ss_emailintakesfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_emailintakemfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_emailintakeyfee_ps + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Secure communication channel for third parties</td><td><input type='checkbox' class='fieldcheck' " + ss_securecommunicationcftp + "></td><td><input type='text' class='subTableFee' value='" + ss_securecommunicationcftpsfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_securecommunicationcftpmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_securecommunicationcftpyfee_ps + "'></td></tr>"

                // + "<tr><td class='subfield' >Add. Languages </td><td><input type='checkbox' class='fieldcheck' "+ss_languagescheck+"></td><td><input type='text' class='subTableFee' value='"+ss_languagessetup+"'></td><td><input type='text' class='subTableMFee' value='"+ss_languagesmfee+"'></td><td><input type='text' class='subTableYFee' value='"+ss_languagesyfee+"'></td></tr>"
                // + "<tr><td class='subfield' >Add. Case Manager - Named User </td><td><input type='checkbox' class='fieldcheck' "+ss_casemanagercheck+"></td><td><input type='text' class='subTableFee' value='"+ss_casemanagersetup+"'></td><td><input type='text' class='subTableMFee' value='"+ss_casemanagermfee+"'></td><td><input type='text' class='subTableYFee' value='"+ss_casemanageryfee+"'></td></tr>"
                // + "<tr><td class='subfield' >Add. Admin - Named User </td><td><input type='checkbox' class='fieldcheck' "+ss_admincheck+"></td><td><input type='text' class='subTableFee' value='"+ss_adminsetup+"'></td><td><input type='text' class='subTableMFee' value='"+ss_adminmfee+"'></td><td><input type='text' class='subTableYFee' value='"+ss_adminyfee+"'></td></tr>"

                + "<tr class = 'subfield trshowhideclassic' " + displayrow + "><td class='subfield'>Languages </td><td><input type='number' class='numberfield' min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"

                + "<tr class = 'subfield trshowhideclassic' " + displayrow + "><td class='subfield'>Case Manager - Named User </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"

                + "<tr class = 'subfield trshowhideclassic' " + displayrow + "><td class='subfield'>Admin - Named User </td><td><input type='number' class='numberfield' min='0' value='" + ss_admin + "'></td><td><input type='text' class='subTableFee' value='" + ss_adminsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_adminmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_adminyfee + "'></td></tr>"

                + "<tr class = 'subfield trshowhideclassic' " + displayrow + "><td class='subfield'>Phone Number/Language</td><td><input type='number' class='numberfield' min='0' value='" + ss_phonelang + "'></td><td><input type='text' class='subTableFee' value='" + ss_phonelangsfee + "'></td><td><input type='text' class='subTableMFee' value='" + ss_phonelangmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_phonelangyfee + "'></td></tr>"

                + "<tr class ='trshowhideclassic' " + displayrow + "><td class='subfield' >Additional Features </td><td><input type='checkbox' value='' id='additionaldetails' class='fieldcheck' " + ss_additionalfeatures + "></td><td><input type='text' class='subTableFee' value='" + ss_additionalfeaturessfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionalfeaturesmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionalfeaturesyfee_ps + "'></td></tr>"

                + "<tr class='additionaldetailsRow trshowhideclassic' " + display_AdditionalDetails + "><td class='subfield' colspan='2'>Enter Details</td><td colspan='3'><textarea class='additionaldetailsField' rows='3' style='width:400px;'>" + ss_additionalfeaturesaddon_ps + "</textarea></td></tr>"

                //New fields For Integrity Option
                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Full Feature Pack</td><td><input type='checkbox' class='fieldcheck' " + fullfeaturepack + " ></td><td><input type='text' class='subTableFee' value='" + ss_fullfeaturepacksetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_fullfeaturepackmonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_fullfeaturepackyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Single Sign On</td><td><input type='checkbox' class='fieldcheck' " + singlesignon + "></td><td><input type='text' class='subTableFee' value='" + ss_singlesignonsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_singlesignonmonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_singlesignonyealry + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Additional Frontends</td><td><input type='checkbox' class='fieldcheck' " + additionalfrontends + "></td><td><input type='text' class='subTableFee' value='" + ss_additionalfrontendssetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionalfrontendsmonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionalfrontendsyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + " ><td class='subfield' >Additional Reporting Form</td><td><input type='checkbox' class='fieldcheck' " + additionalreportingform + "></td><td><input type='text' class='subTableFee' value='" + ss_additionalreportingformsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionalreportingformmonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionalreportingformyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Email Intake (integrity)</td><td><input type='checkbox' class='fieldcheck' " + emailintakeintegrity + "></td><td><input type='text' class='subTableFee' value='" + ss_emailintakeintegritysetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_emailintakeintegritymonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_emailintakeintegrityyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Automated Message Service / Voice Intake</td><td><input type='checkbox' class='fieldcheck' " + automatedservices + "></td><td><input type='text' class='subTableFee' value='" + ss_automatedmessageservicesetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_automatedmessageservicemonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_automatedmessageserviceyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Professional Support (inc. 10)</td><td><input type='checkbox' class='fieldcheck' " + professionsupportinc + "></td><td><input type='text' class='subTableFee' value='" + ss_professionalsupportincsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_professionalsupportincmonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_professionalsupportincyearly + "'></td></tr>"

                + "<tr class ='trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield' >Call Center Intake / Phone Interview</td><td><input type='checkbox' class='fieldcheck' " + callcenteritakephone + "></td><td><input type='text' class='subTableFee' value='" + ss_callcenterintakephonesetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_callcenterintakephonemonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_callcenterintakephoneyearly + "'></td></tr>"

                + "<tr class = 'subfield trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield'>Languages </td><td><input type='number' class='numberfield' min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"

                + "<tr class = 'subfield trshowhideintegrity' " + diplayrowintegrity + "><td class='subfield'>Case Manager - Named User </td><td><input type='number' class='numberfield' min='0' value='" + ss_casemanager + "'></td><td><input type='text' class='subTableFee' value='" + ss_casemanagersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_casemanagermfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_casemanageryfee + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;


        }

        function AddSubTableDataForIntegrityAdd_On(entity, subtable, isLicProduct) {
            console.log("In Intergrity Line Add-On Table");
            console.log("Is License product => " + isLicProduct);
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var allRows = [];
            var isAdditionalDetailsChecked = false;
            for (var i = 1; i < 38; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }
            entity.ss_integritylineclassiccheck = $(tr0).find('td:eq(2)').find('input[type=checkbox]').prop("checked");
            entity.ss_newintegritylineclassiccheck = $(tr0).find('td:eq(3)').find('input[type=checkbox]').prop("checked");
            if (entity.ss_integritylineclassiccheck) {
                entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nClassic: ";
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_integritylineclassiccheck;
            }
            else if (entity.ss_newintegritylineclassiccheck) {
                entity.ss_eqsintegrityldata_ps = !isLicProduct ? "" : "\nIntegrity: ";
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_newintegritylineclassiccheck;
            }
            // Flag fields
            if (entity.ss_integritylineclassiccheck) {
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAdmin Tab: ";
                entity.ss_admintab_ps = $(allRows[1]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_admintab_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nJournal Tab: ";
                entity.ss_journaltab_ps = $(allRows[2]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_journaltab_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nReporting & Statistics (Charts): ";
                entity.ss_reportingstat_ps = $(allRows[3]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_reportingstat_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nReminders & Alerts: ";
                entity.ss_reminderalert_ps = $(allRows[4]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_reminderalert_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Chat: ";
                entity.ss_casechat_ps = $(allRows[5]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casechat_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nDeep Search: ";
                entity.ss_deepsearch_ps = $(allRows[6]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_deepsearch_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAnonymization in PDFs: ";
                entity.ss_anonymizationpdf_ps = $(allRows[7]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_anonymizationpdf_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nTranslation (translation office): ";
                entity.ss_translationto_ps = $(allRows[8]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_translationto_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nTranslation (machine translation): ";
                entity.ss_translationmt_ps = $(allRows[9]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_translationmt_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\n2 factor Authentication: ";
                entity.ss_2factorauth_ps = $(allRows[10]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_2factorauth_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nIP Whitelisting: ";
                entity.ss_ipwhitelisting_ps = $(allRows[11]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_ipwhitelisting_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Importer function: ";
                entity.ss_caseimporterfun_ps = $(allRows[12]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_caseimporterfun_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCustom Domain/URL: ";
                entity.ss_customdomainurl_ps = $(allRows[13]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_eqsintegrityldata_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nSSO integration: ";
                entity.ss_ssointegration_ps = $(allRows[14]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_ssointegration_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAPI integration: ";
                entity.ss_apiintegration_ps = $(allRows[15]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_apiintegration_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nPhone Intake (call center): ";
                entity.ss_phoneintakecc_ps = $(allRows[16]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_phoneintakecc_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nPhone Intake (automated message service): ";
                entity.ss_phoneintakeams_ps = $(allRows[17]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_phoneintakeams_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nEmail Intake: ";
                entity.ss_emailintake_ps = $(allRows[18]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_emailintake_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nSecure communication channel: ";
                entity.ss_securecommunicationcftp_ps = $(allRows[19]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_securecommunicationcftp_ps;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAdditional Features: ";
                entity.ss_additionalfeatures_ps = $(allRows[24]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : ss_additionalfeatures_ps;

                // entity.ss_languagescheck_ps = $(allRows[19]).find('.fieldcheck').prop("checked");
                // entity.ss_casemanagercheck_ps = $(allRows[20]).find('.fieldcheck').prop("checked");
                // entity.ss_admincheck_ps = $(allRows[21]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nLanguages: ";
                entity.ss_languages = $(allRows[20]).find('.numberfield').val();
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_languages;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCase Manager - Named User: ";
                entity.ss_casemanager = $(allRows[21]).find('.numberfield').val();
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_casemanager;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAdmin - Named User: ";
                entity.ss_admin = $(allRows[22]).find('.numberfield').val();
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_admin;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nPhone Number/Language: ";
                entity.ss_phonelang = $(allRows[23]).find('.numberfield').val();
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_phonelang;
            }

            //new fields
            else if (entity.ss_newintegritylineclassiccheck) {
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nFull Feature Pack: ";
                entity.ss_fullfeaturepack = $(allRows[26]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_fullfeaturepack;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nSingle Sign On: ";
                entity.ss_singlesignon = $(allRows[27]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_singlesignon;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAdditional Frontends: ";
                entity.ss_additionalfrontends = $(allRows[28]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_additionalfrontends;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAdditional Reporting Form: ";
                entity.ss_additionalreportingform = $(allRows[29]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_additionalreportingform;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nEmail Intake (integrity): ";
                entity.ss_emailintakeintegrity = $(allRows[30]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_emailintakeintegrity;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nAutomated Message Service / Voice Intake: ";
                entity.ss_automatedmessageservice = $(allRows[31]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_automatedmessageservice;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nProfessional Support (inc. 10): ";
                entity.ss_professionalsupportinc = $(allRows[32]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_professionalsupportinc;

                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : "\nCall Center Intake / Phone Interview: ";
                entity.ss_callcenterintakephone = $(allRows[33]).find('.fieldcheck').prop("checked");
                entity.ss_eqsintegrityldata_ps += !isLicProduct ? "" : entity.ss_callcenterintakephone;
            }
            isAdditionalDetailsChecked = $(allRows[24]).find('.fieldcheck').prop('checked');
            //Adding Setup Fee      
            entity.ss_admintabsfee_ps = parseFloat(RemoveFormattings($(allRows[1]).find('.subTableFee').val()));
            entity.ss_journaltabsfee_ps = parseFloat(RemoveFormattings($(allRows[2]).find('.subTableFee').val()));
            entity.ss_reportingstatsfee_ps = parseFloat(RemoveFormattings($(allRows[3]).find('.subTableFee').val()));
            entity.ss_reminderalertsfee_ps = parseFloat(RemoveFormattings($(allRows[4]).find('.subTableFee').val()));
            entity.ss_casechatsfee_ps = parseFloat(RemoveFormattings($(allRows[5]).find('.subTableFee').val()));
            entity.ss_deepsearchsfee_ps = parseFloat(RemoveFormattings($(allRows[6]).find('.subTableFee').val()));
            entity.ss_anonymizationpdfsfee_ps = parseFloat(RemoveFormattings($(allRows[7]).find('.subTableFee').val()));
            entity.ss_translationtosfee_ps = parseFloat(RemoveFormattings($(allRows[8]).find('.subTableFee').val()));
            entity.ss_translationmtsfee_ps = parseFloat(RemoveFormattings($(allRows[9]).find('.subTableFee').val()));
            entity.ss_2factorauthsfee_ps = parseFloat(RemoveFormattings($(allRows[10]).find('.subTableFee').val()));
            entity.ss_ipwhitelistingsfee_ps = parseFloat(RemoveFormattings($(allRows[11]).find('.subTableFee').val()));
            entity.ss_caseimporterfunsfee_ps = parseFloat(RemoveFormattings($(allRows[12]).find('.subTableFee').val()));
            entity.ss_customdomainurlsfee_ps = parseFloat(RemoveFormattings($(allRows[13]).find('.subTableFee').val()));
            entity.ss_ssointegrationsfee_ps = parseFloat(RemoveFormattings($(allRows[14]).find('.subTableFee').val()));
            entity.ss_apiintegrationsfee_ps = parseFloat(RemoveFormattings($(allRows[15]).find('.subTableFee').val()));
            entity.ss_phoneintakeccsfee_ps = parseFloat(RemoveFormattings($(allRows[16]).find('.subTableFee').val()));
            entity.ss_phoneintakeamssfee_ps = parseFloat(RemoveFormattings($(allRows[17]).find('.subTableFee').val()));
            entity.ss_emailintakesfee_ps = parseFloat(RemoveFormattings($(allRows[18]).find('.subTableFee').val()));
            entity.ss_securecommunicationcftpsfee_ps = parseFloat(RemoveFormattings($(allRows[19]).find('.subTableFee').val()));

            entity.ss_languagessetup = parseFloat(RemoveFormattings($(allRows[20]).find('.subTableFee').val()));
            entity.ss_casemanagersetup = parseFloat(RemoveFormattings($(allRows[21]).find('.subTableFee').val()));
            entity.ss_adminsetup = parseFloat(RemoveFormattings($(allRows[22]).find('.subTableFee').val()));
            entity.ss_phonelangsfee = parseFloat(RemoveFormattings($(allRows[23]).find('.subTableFee').val()));
            entity.ss_additionalfeaturessfee_ps = isAdditionalDetailsChecked ? parseFloat(RemoveFormattings($(allRows[24]).find('.subTableFee').val())) : 0.00;
            //new fields
            entity.ss_fullfeaturepacksetup = parseFloat(RemoveFormattings($(allRows[26]).find('.subTableFee').val()));
            entity.ss_singlesignonsetup = parseFloat(RemoveFormattings($(allRows[27]).find('.subTableFee').val()));
            entity.ss_additionalfrontendssetup = parseFloat(RemoveFormattings($(allRows[28]).find('.subTableFee').val()));
            entity.ss_additionalreportingformsetup = parseFloat(RemoveFormattings($(allRows[29]).find('.subTableFee').val()));
            entity.ss_emailintakeintegritysetup = parseFloat(RemoveFormattings($(allRows[30]).find('.subTableFee').val()));
            entity.ss_automatedmessageservicesetup = parseFloat(RemoveFormattings($(allRows[31]).find('.subTableFee').val()));
            entity.ss_professionalsupportincsetup = parseFloat(RemoveFormattings($(allRows[32]).find('.subTableFee').val()));
            entity.ss_callcenterintakephonesetup = parseFloat(RemoveFormattings($(allRows[33]).find('.subTableFee').val()));

            //Adding Monthly Fee                  
            console.log("Admin Tab Monthly fee is => " + isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00);
            entity.ss_admintabmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00;
            entity.ss_journaltabmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableMFee').val())) : 0.00;
            entity.ss_reportingstatmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[3]).find('.subTableMFee').val())) : 0.00;
            entity.ss_reminderalertmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[4]).find('.subTableMFee').val())) : 0.00;
            entity.ss_casechatmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[5]).find('.subTableMFee').val())) : 0.00;
            entity.ss_deepsearchmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[6]).find('.subTableMFee').val())) : 0.00;
            entity.ss_anonymizationpdfmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[7]).find('.subTableMFee').val())) : 0.00;
            entity.ss_translationtomfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[8]).find('.subTableMFee').val())) : 0.00;
            entity.ss_translationmtmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[9]).find('.subTableMFee').val())) : 0.00;
            entity.ss_2factorauthmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[10]).find('.subTableMFee').val())) : 0.00;
            entity.ss_ipwhitelistingmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[11]).find('.subTableMFee').val())) : 0.00;
            entity.ss_caseimporterfunmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[12]).find('.subTableMFee').val())) : 0.00;
            entity.ss_customdomainurlmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[13]).find('.subTableMFee').val())) : 0.00;
            entity.ss_ssointegrationmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[14]).find('.subTableMFee').val())) : 0.00;
            entity.ss_apiintegrationmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[15]).find('.subTableMFee').val())) : 0.00;
            entity.ss_phoneintakeccmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[16]).find('.subTableMFee').val())) : 0.00;
            entity.ss_phoneintakeamsmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[17]).find('.subTableMFee').val())) : 0.00;
            entity.ss_emailintakemfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[18]).find('.subTableMFee').val())) : 0.00;
            entity.ss_securecommunicationcftpmfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[19]).find('.subTableMFee').val())) : 0.00;

            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[20]).find('.subTableMFee').val())) : 0.00;
            entity.ss_casemanagermfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[21]).find('.subTableMFee').val())) : 0.00;
            entity.ss_adminmfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[22]).find('.subTableMFee').val())) : 0.00;
            entity.ss_phonelangmfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[23]).find('.subTableMFee').val())) : 0.00;
            entity.ss_additionalfeaturesmfee_ps = (isLicProduct && isAdditionalDetailsChecked) ? parseFloat(RemoveFormattings($(allRows[24]).find('.subTableMFee').val())) : 0.00;
            //new fields
            entity.ss_fullfeaturepackmonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[26]).find('.subTableMFee').val())) : 0.00;
            entity.ss_singlesignonmonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[27]).find('.subTableMFee').val())) : 0.00;
            entity.ss_additionalfrontendsmonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[28]).find('.subTableMFee').val())) : 0.00;
            entity.ss_additionalreportingformmonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[29]).find('.subTableMFee').val())) : 0.00;
            entity.ss_emailintakeintegritymonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[30]).find('.subTableMFee').val())) : 0.00;

            entity.ss_automatedmessageservicemonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[31]).find('.subTableMFee').val())) : 0.00;
            entity.ss_professionalsupportincmonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[32]).find('.subTableMFee').val())) : 0.00;
            entity.ss_callcenterintakephonemonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[33]).find('.subTableMFee').val())) : 0.00;
            //Adding Yealy Fee
            entity.ss_admintabyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableYFee').val())) : 0.00;
            entity.ss_journaltabyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableYFee').val())) : 0.00;
            entity.ss_reportingstatyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[3]).find('.subTableYFee').val())) : 0.00;
            entity.ss_reminderalertyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[4]).find('.subTableYFee').val())) : 0.00;
            entity.ss_casechatyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[5]).find('.subTableYFee').val())) : 0.00;
            entity.ss_deepsearchyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[6]).find('.subTableYFee').val())) : 0.00;
            entity.ss_anonymizationpdfyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[7]).find('.subTableYFee').val())) : 0.00;
            entity.ss_translationtoyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[8]).find('.subTableYFee').val())) : 0.00;
            entity.ss_translationmtyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[9]).find('.subTableYFee').val())) : 0.00;
            entity.ss_2factorauthyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[10]).find('.subTableYFee').val())) : 0.00;
            entity.ss_ipwhitelistingyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[11]).find('.subTableYFee').val())) : 0.00;
            entity.ss_caseimporterfunyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[12]).find('.subTableYFee').val())) : 0.00;
            entity.ss_customdomainurlyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[13]).find('.subTableYFee').val())) : 0.00;
            entity.ss_ssointegrationyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[14]).find('.subTableYFee').val())) : 0.00;
            entity.ss_apiintegrationyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[15]).find('.subTableYFee').val())) : 0.00;
            entity.ss_phoneintakeccyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[16]).find('.subTableYFee').val())) : 0.00;
            entity.ss_phoneintakeamsyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[17]).find('.subTableYFee').val())) : 0.00;
            entity.ss_emailintakeyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[18]).find('.subTableYFee').val())) : 0.00;
            entity.ss_securecommunicationcftpyfee_ps = isLicProduct ? parseFloat(RemoveFormattings($(allRows[19]).find('.subTableYFee').val())) : 0.00;

            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[20]).find('.subTableYFee').val())) : 0.00;
            entity.ss_casemanageryfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[21]).find('.subTableYFee').val())) : 0.00;
            entity.ss_adminyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[22]).find('.subTableYFee').val())) : 0.00;
            entity.ss_phonelangyfee = isLicProduct ? parseFloat(RemoveFormattings($(allRows[23]).find('.subTableYFee').val())) : 0.00;
            //new fields
            entity.ss_fullfeaturepackyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[26]).find('.subTableYFee').val())) : 0.00;
            entity.ss_singlesignonyealry = isLicProduct ? parseFloat(RemoveFormattings($(allRows[27]).find('.subTableYFee').val())) : 0.00;
            entity.ss_additionalfrontendsyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[28]).find('.subTableYFee').val())) : 0.00;
            entity.ss_additionalreportingformyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[29]).find('.subTableYFee').val())) : 0.00;
            entity.ss_emailintakeintegrityyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[30]).find('.subTableYFee').val())) : 0.00;

            entity.ss_automatedmessageserviceyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[31]).find('.subTableYFee').val())) : 0.00;
            entity.ss_professionalsupportincyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[32]).find('.subTableYFee').val())) : 0.00;
            entity.ss_callcenterintakephoneyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[33]).find('.subTableYFee').val())) : 0.00;

            entity.ss_additionalfeaturesyfee_ps = (isLicProduct && isAdditionalDetailsChecked) ? parseFloat(RemoveFormattings($(allRows[23]).find('.subTableYFee').val())) : 0.00;
            entity.ss_additionalfeaturesaddon_ps = isAdditionalDetailsChecked ? $(allRows[25]).find('.additionaldetailsField').val() : "";

            //console.log(entity);
            return entity;
        }

        // Sub Table For License Rule Bot
        function embedSubTableForLicenseRuleBot(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_employees = 0;
            var ss_employeessetup = AddFormattings(0.00);
            var ss_employeesmfee = AddFormattings(0.00);
            var ss_employeesyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
                // ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                // ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                // ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts14' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Employees </td><td><input type='number' min='0' value='" + ss_employees + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_employeessetup + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "' disabled></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }

        // embed sub table data from License RuleBOt 
        function AddSubTableForLicenseRulebot(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');

            entity.ss_employees = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_employeesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_employeesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }

        //embed sub table for license addition rule book client
        function embedSubTableForLicensAdditionalRulebookClient(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_clients = 0;
            var ss_clientsetupfee = AddFormattings(0.00);
            var ss_clientmonthlyfee = AddFormattings(0.00);
            var ss_clientyearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_clients = oportunityproducts.value[OPIndex]["ss_clients"] ? oportunityproducts.value[OPIndex]["ss_clients"] : 0;
                // ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                // ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                // ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts15' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Client </td><td><input type='number' min='0' value='" + ss_clients + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_clientsetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_clientmonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_clientyearlyfee + "' disabled></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }
        //embed sub table data for license addition rule book client
        function AddSubTableForLicensAdditionalRulebookClient(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');

            entity.ss_clients = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_clientsetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_clientmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_clientyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        //embed sub table for Initization and Update Rulebook 
        function embedSubTableForInitialDigitizationandUpdateRulebook(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_languages = ss_usecases = ss_contentset = 0;
            var ss_languagessetup = ss_usecasessetupfee = ss_contentsetsetupfee = AddFormattings(0.00);
            var ss_languagesmfee = ss_usecasesmonthlyfee = ss_contentsetmonthlyfee = AddFormattings(0.00);
            var ss_languagesyfee = ss_usecasesyearlyfee = ss_contentsetyearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
                ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
                ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
                ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);

                ss_usecases = oportunityproducts.value[OPIndex]["ss_usecases"] ? oportunityproducts.value[OPIndex]["ss_usecases"] : 0;
                ss_usecasessetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] ? oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] : 0.00);
                ss_usecasesmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] : 0.00);
                ss_usecasesyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] : 0.00);

                ss_contentset = oportunityproducts.value[OPIndex]["ss_contentset"] ? oportunityproducts.value[OPIndex]["ss_contentset"] : 0;
                ss_contentsetsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetsetupfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetsetupfee"] : 0.00);
                ss_contentsetmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetmonthlyfee"] : 0.00);
                ss_contentsetyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetyearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts16' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Use Cases </td><td><input type='number' min='0' value='" + ss_usecases + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_usecasessetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_usecasesmonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_usecasesyearlyfee + "' disabled></td></tr>"
                + "<tr><td class='subfield'>Languages </td><td><input type='number' min='0' value='" + ss_languages + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_languagessetup + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "' disabled></td></tr>"
                + "<tr><td class='subfield'>Content Set</td><td><input type='number' min='0' value='" + ss_contentset + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_contentsetsetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_contentsetmonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_contentsetyearlyfee + "' disabled></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }
        //add sub table data for Initization and Update Rulebook 
        function AddSubTableDataForInitizationandUpdateRulebook(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');
            var tr2 = $(subTBody).find('tr:eq(2)');

            entity.ss_usecases = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_usecasessetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_usecasesmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_usecasesyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_languages = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_contentset = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_contentsetsetupfee = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_contentsetmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_contentsetyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        //embed sub table for Onboarding - One-off services Rulebook
        function embedSubTableForIOnboardingOneoffservicesRulebook(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_time = ss_material = 0;
            var ss_timesetupfee = ss_metrialsetupfee = AddFormattings(0.00);
            var ss_timemonthlyfee = ss_materialmonthlyfee = AddFormattings(0.00);
            var ss_timeyearlyfee = ss_materialyearlyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {
                ss_time = oportunityproducts.value[OPIndex]["ss_time"] ? oportunityproducts.value[OPIndex]["ss_time"] : 0;
                // ss_usecasessetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] ? oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] : 0.00);
                // ss_usecasesmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] : 0.00);
                // ss_usecasesyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] : 0.00);

                ss_material = oportunityproducts.value[OPIndex]["ss_material"] ? oportunityproducts.value[OPIndex]["ss_material"] : 0;
                // ss_contentsetsetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetsetupfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetsetupfee"] : 0.00);
                // ss_contentsetmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetmonthlyfee"] : 0.00);
                // ss_contentsetyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_contentsetyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_contentsetyearlyfee"] : 0.00);
            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts17' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Time </td><td><input type='number' min='0' value='" + ss_time + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_timesetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_timemonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_timeyearlyfee + "' disabled></td></tr>"
                + "<tr><td class='subfield'>Material </td><td><input type='number' min='0' value='" + ss_material + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_metrialsetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_materialmonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_materialyearlyfee + "' disabled></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }
        //Add Sub table data forOnboarding - One-off services Rulebook
        function AddSubTableForOnboardingOneoffservicesRulebook(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');

            entity.ss_time = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_timesetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_timemonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_timeyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_material = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_metrialsetupfee = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_materialmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_materialyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        //embed sub table for License Rulebook Platform
        function embedSubTableForLicenseRulebookPlatform(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";
            var ss_usecases = 0;
            var ss_usecasessetupfee = AddFormattings(0.00);
            var ss_usecasesmonthlyfee = AddFormattings(0.00);
            var ss_usecasesyearlyfee = AddFormattings(0.00);
            var ss_employees = 0;
            var ss_employeessetup = AddFormattings(0.00);
            var ss_employeesmfee = AddFormattings(0.00);
            var ss_employeesyfee = AddFormattings(0.00);

            if (OPIndex >= 0) {

                ss_usecases = oportunityproducts.value[OPIndex]["ss_usecases"] ? oportunityproducts.value[OPIndex]["ss_usecases"] : 0;
                // ss_usecasessetupfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] ? oportunityproducts.value[OPIndex]["ss_usecasessetupfee"] : 0.00);
                // ss_usecasesmonthlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesmonthlyfee"] : 0.00);
                // ss_usecasesyearlyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] ? oportunityproducts.value[OPIndex]["ss_usecasesyearlyfee"] : 0.00);

                ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
                // ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
                // ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
                // ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);

            }
            else {
                display_prop = "style='display:none'";
            }

            var markup = "<tr class='OppProducts18' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Employees </td><td><input type='number' min='0' value='" + ss_employees + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_employeessetup + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "' disabled></td></tr>"
                + "<tr><td class='subfield'>Use Cases </td><td><input type='number' min='0' value='" + ss_usecases + "' ></td><td ><input type='text' at='10' class='subTableFee' value='" + ss_usecasessetupfee + "' disabled></td><td><input type='text' class='subTableMFee' value='" + ss_usecasesmonthlyfee + "' disabled></td><td><input type='text' class='subTableYFee' value='" + ss_usecasesyearlyfee + "' disabled></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }
        //add sub table data for License Rulebook Platform
        function AddDataTableForLicenseRulebookPlatform(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr0 = $(subTBody).find('tr:eq(0)');
            var tr1 = $(subTBody).find('tr:eq(1)');

            entity.ss_employees = parseInt($(tr0).find('td:eq(1)').find('input[type=number]').val());
            // entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            // entity.ss_employeesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            // entity.ss_employeesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            entity.ss_usecases = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            // entity.ss_usecasessetupfee = parseFloat(RemoveFormattings($(tr0).find('td:eq(2)').find('input[type=text]').val()));
            // entity.ss_usecasesmonthlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            // entity.ss_usecasesyearlyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr0).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            return entity;
        }
        // function embedSubTableForPolicyManager(productname, OPIndex, oportunityproducts, opp_prodid, ss_productdescription) {
        //     var sBassicDefault = (oportunityproducts.value[OPIndex] === undefined || oportunityproducts.value[OPIndex] === "undefined" || oportunityproducts.value[OPIndex] === null) ? true : false;
        //     var display_prop = display_support = "";

        //     var ss_admin = ss_employees = ss_languages = ss_activepolicies_ps = 0;
        //     var ss_supportbasic = ss_supportprofessional = false;

        //     var ss_adminsetup = ss_languagessetup = ss_activepoliciessfee_ps = ss_supportbasicsetup = ss_supportprofessionalsfee = ss_employeessetup = AddFormattings(0.00);
        //     var ss_adminmfee = ss_languagesmfee = ss_activepoliciesmfee_ps = ss_supportbasicmfee = ss_supportprofessionalmfee = ss_employeesmfee = AddFormattings(0.00);
        //     var ss_adminyfee = ss_languagesyfee = ss_activepoliciesyfee_ps = ss_supportbasicyfee = ss_supportprofessionalyfee = ss_employeesyfee = AddFormattings(0.00);

        //     if (OPIndex >= 0) {

        //         ss_employees = oportunityproducts.value[OPIndex]["ss_employees"] ? oportunityproducts.value[OPIndex]["ss_employees"] : 0;
        //         ss_employeessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeessetup"] ? oportunityproducts.value[OPIndex]["ss_employeessetup"] : 0.00);
        //         ss_employeesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesmfee"] ? oportunityproducts.value[OPIndex]["ss_employeesmfee"] : 0.00);
        //         ss_employeesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_employeesyfee"] ? oportunityproducts.value[OPIndex]["ss_employeesyfee"] : 0.00);

        //         ss_activepolicies_ps = oportunityproducts.value[OPIndex]["ss_activepolicies_ps"] ? oportunityproducts.value[OPIndex]["ss_activepolicies_ps"] : 0;
        //         ss_activepoliciessfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_activepoliciessfee_ps"] ? oportunityproducts.value[OPIndex]["ss_activepoliciessfee_ps"] : 0.00);
        //         ss_activepoliciesmfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_activepoliciesmfee_ps"] ? oportunityproducts.value[OPIndex]["ss_activepoliciesmfee_ps"] : 0.00);
        //         ss_activepoliciesyfee_ps = AddFormattings(oportunityproducts.value[OPIndex]["ss_activepoliciesyfee_ps"] ? oportunityproducts.value[OPIndex]["ss_activepoliciesyfee_ps"] : 0.00);

        //         ss_languages = oportunityproducts.value[OPIndex]["ss_languages"] ? oportunityproducts.value[OPIndex]["ss_languages"] : 0;
        //         ss_languagessetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagessetup"] ? oportunityproducts.value[OPIndex]["ss_languagessetup"] : 0.00);
        //         ss_languagesmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesmfee"] ? oportunityproducts.value[OPIndex]["ss_languagesmfee"] : 0.00);
        //         ss_languagesyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_languagesyfee"] ? oportunityproducts.value[OPIndex]["ss_languagesyfee"] : 0.00);

        //         ss_supportbasic = oportunityproducts.value[OPIndex]["ss_supportbasic"] ? oportunityproducts.value[OPIndex]["ss_supportbasic"] : false;
        //         ss_supportbasicsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] ? oportunityproducts.value[OPIndex]["ss_supportbasicsetup"] : 0.00);
        //         ss_supportbasicmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicmfee"] : 0.00);
        //         ss_supportbasicyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] ? oportunityproducts.value[OPIndex]["ss_supportbasicyfee"] : 0.00);
        //         ss_supportprofessional = oportunityproducts.value[OPIndex]["ss_supportprofessional"] ? oportunityproducts.value[OPIndex]["ss_supportprofessional"] : false;
        //         ss_supportprofessionalsfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalsfee"] : 0.00);
        //         ss_supportprofessionalmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalmfee"] : 0.00);
        //         ss_supportprofessionalyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] ? oportunityproducts.value[OPIndex]["ss_supportprofessionalyfee"] : 0.00);

        //         ss_admin = oportunityproducts.value[OPIndex]["ss_admin"] ? oportunityproducts.value[OPIndex]["ss_admin"] : 0;
        //         ss_adminsetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminsetup"] ? oportunityproducts.value[OPIndex]["ss_adminsetup"] : 0.00);
        //         ss_adminmfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminmfee"] ? oportunityproducts.value[OPIndex]["ss_adminmfee"] : 0.00);
        //         ss_adminyfee = AddFormattings(oportunityproducts.value[OPIndex]["ss_adminyfee"] ? oportunityproducts.value[OPIndex]["ss_adminyfee"] : 0.00);


        //     }
        //     else {
        //         display_prop = "style='display:none'";
        //     }


        //     var sbassic = (ss_supportbasic || sBassicDefault) ? "checked" : "";
        //     var sprofessional = (ss_supportprofessional) ? "checked" : "";
        //     var ActivePName = "Active Policies ";
        //     var TableMainClass = "OppProducts3";
        //     var supportBClass = "supportb2";
        //     var supportPClass = "supportp2";
        //     if (productname === "EQS Approval Manager") {
        //         ActivePName = "Requests per Year ";
        //         TableMainClass = "OppProducts4";
        //         supportBClass = "supportb3";
        //         supportPClass = "supportp3";
        //     }



        //     var markup = "<tr class='" + TableMainClass + "' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
        //         + "<table class='table table-responsive table-sm text-center border-0 removetable ' id='" + opp_prodid + "_pt'  >"
        //         + "<tbody class='subtableBody' id='" + opp_prodid + "_p'>"
        //         + "<tr><td class='subfield'>User/Employees </td><td><input type='number' min='0' value='" + ss_employees + "' ></td><td><input type='text' class='subTableFee' value='" + ss_employeessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_employeesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_employeesyfee + "'></td></tr>"
        //         + "<tr><td class='subfield'>" + ActivePName + "</td><td><input type='number' min='0' value='" + ss_activepolicies_ps + "' ></td><td><input type='text' class='subTableFee' value='" + ss_activepoliciessfee_ps + "'></td><td><input type='text' class='subTableMFee' value='" + ss_activepoliciesmfee_ps + "'></td><td><input type='text' class='subTableYFee' value='" + ss_activepoliciesyfee_ps + "'></td></tr>"
        //         + "<tr><td class='subfield'>Admin - Named User</td><td><input type='number' min='0' value='" + ss_admin + "'></td><td><input type='text' class='subTableFee' value='" + ss_adminsetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_adminmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_adminyfee + "'></td></tr>"
        //         + "<tr><td class='subfield'>Languages </td><td><input type='number'  min='0' value='" + ss_languages + "'></td><td><input type='text' class='subTableFee' value='" + ss_languagessetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_languagesmfee + "'></td><td><input type='text' class='subTableYFee' value='" + ss_languagesyfee + "'></td></tr>"
        //         + "<tr><td class='mainSupportTd' colspan='5'> Support </td></tr>"
        //         + "<tr class='support ' ><td class='subfield'> Standard </td><td class='supportTd'><input type='checkbox' " + sbassic + " class='" + supportBClass + " subSupportCheckBox' name='" + sBassicDefault + "'></td><td><input type='text' class='subTableSupportFee subTableSupportSFee' value='" + ss_supportbasicsetup + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportbasicmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportbasicyfee + "'></td></tr>"
        //         + "<tr class='support ' ><td class='subfield'> Advanced </td><td class='supportTd'><input type='checkbox' " + sprofessional + " class='" + supportPClass + " subSupportCheckBox'></td><td><input type='text'  class='subTableSupportFee subTableSupportSFee' value='" + ss_supportprofessionalsfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportMFee' value='" + ss_supportprofessionalmfee + "'></td><td><input type='text' class='subTableSupportFee subTableSupportYFee' value='" + ss_supportprofessionalyfee + "'></td></tr>"
        //         + "</tbody></table></td></tr>";

        //     return markup;
        // }
        //new
        function embedSubTableforRegulatoryandNews(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var ss_pakcheck = false;
            var ss_kapcheck = false;
            var display_prop = "";
            var display_Pak = "style='width:250px;'";
            var display_Kap = "style='width:250px;'";
            var ss_pakquantity = ss_kapamount = ss_kapquantity = "";
            if (OPIndex > 0) {
                ss_pakcheck = oportunityproducts.value[OPIndex]["ss_pakcheck"] ? oportunityproducts.value[OPIndex]["ss_pakcheck"] : false;
                ss_kapcheck = oportunityproducts.value[OPIndex]["ss_kapcheck"] ? oportunityproducts.value[OPIndex]["ss_kapcheck"] : false;
                ss_pakquantity = oportunityproducts.value[OPIndex]["ss_pakquantity"] ? oportunityproducts.value[OPIndex]["ss_pakquantity"] : 0;
                ss_kapamount = oportunityproducts.value[OPIndex]["ss_kapamount"] ? oportunityproducts.value[OPIndex]["ss_kapamount"] : 0;
                ss_kapquantity = oportunityproducts.value[OPIndex]["ss_kapquantity"] ? oportunityproducts.value[OPIndex]["ss_kapquantity"] : 0;
            }
            else {
                display_prop = "style='display:none'";
            }
            var pakcheck = ss_pakcheck ? "checked" : "";
            var kapcheck = ss_kapcheck ? "checked" : "";
            if (!ss_pakcheck) {
                display_Pak = "style='display:none;width:200px;'";
            }
            if (!ss_kapcheck) {
                display_Kap = "style='display:none;width:200px;'";
            }
            var TableMainClass = "OppProducts5";
            var regulatoryandnews = `<tr class=${TableMainClass} ${display_prop}><td style='background: transparent;'></td><td class='text-center' colspan='4'>
                <table class='table table-responsive table-sm text-center border-0 removetable ' id= ${Prod_Id}_pt>  
                <tbody class='subtableBody' id=${Prod_Id} +'_p'>

                    <tr> <td class ='subfield' style="width:100px;"><input type ='checkbox' id ='pak_chkbox' class ='fieldcheck_pak' ${pakcheck}>&nbsp;&nbsp;PAK</td>

                        <td id =${Prod_Id}_pak ${display_Pak} >Quantity:<input type ='number' id ='pak_quantity' class ='kap_pak' value = ${ss_pakquantity}></td>
                        <td style="width:200px;"></td>
                    </tr>

                    <tr> <td class ='subfield' style="width:100px;"><input type ='checkbox' id ='kap_chkbox' class = 'fieldcheck_kap' ${kapcheck}>&nbsp;&nbsp;KAP</td>

                        <td id =${Prod_Id}_kap_q ${display_Kap} class ='td'>Quantity:<input type ='number' id ='kap_quantity' class ='kap_pak' value = ${ss_kapquantity}></td>

                        <td id =${Prod_Id}_kap_am ${display_Kap} class ='td'>Amount:<input type ='number' id ='kap_amount' class ='kap_pak' value = ${ss_kapamount}></td>
                    </tr>

                </tbody></table></td></tr>`;

            return regulatoryandnews;
        }
        function AddSubTableDataForRegulatoryNews(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var pak_chk = false;
            var kap_chk = false;
            var allRows = [];
            for (var i = 0; i < 2; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }
            entity.ss_pakcheck = $(allRows[0]).find('.fieldcheck_pak').prop("checked");
            entity.ss_kapcheck = $(allRows[1]).find('.fieldcheck_kap').prop("checked");
            pak_chk = $(allRows[0]).find('.fieldcheck_pak').prop("checked");
            kap_chk = $(allRows[1]).find('.fieldcheck_kap').prop("checked");
            entity.ss_pakquantity = pak_chk ? parseInt($(allRows[0]).find('#pak_quantity').val()) : 0;
            entity.ss_kapamount = kap_chk ? parseInt($(allRows[1]).find('#kap_amount').val()) : 0;
            entity.ss_kapquantity = kap_chk ? parseInt($(allRows[1]).find('#kap_quantity').val()) : 0;

            return entity;
        }
        function AddSubTableDataForPolicyManager(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');
            var tr1 = $(subTBody).find('tr:eq(0)');
            var tr2 = $(subTBody).find('tr:eq(1)');
            var tr3 = $(subTBody).find('tr:eq(2)');
            var tr4 = $(subTBody).find('tr:eq(3)');
            var tr5 = $(subTBody).find('tr:eq(4)');
            var tr6 = $(subTBody).find('tr:eq(5)');
            var tr7 = $(subTBody).find('tr:eq(6)');


            //Employees
            entity.ss_eqspolicymdata_ps = !isLicProduct ? "" : "User/Employees: ";
            entity.ss_employees = parseInt($(tr1).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqspolicymdata_ps += !isLicProduct ? "" : entity.ss_employees;
            entity.ss_employeessetup = parseFloat(RemoveFormattings($(tr1).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_employeesmfee = !isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_employeesyfee = !isLicProduct ? parseFloat(RemoveFormattings($(tr1).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Active Policies
            entity.ss_eqspolicymdata_ps += !isLicProduct ? "" : "\nActive Policies: ";
            entity.ss_activepolicies_ps = parseInt($(tr2).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqspolicymdata_ps += !isLicProduct ? "" : entity.ss_activepolicies_ps;
            entity.ss_activepoliciessfee_ps = parseFloat(RemoveFormattings($(tr2).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_activepoliciesmfee_ps = !isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_activepoliciesyfee_ps = !isLicProduct ? parseFloat(RemoveFormattings($(tr2).find('td:eq(4)').find('input[type=text]').val())) : 0.00;

            //Admin - Named User
            entity.ss_eqspolicymdata_ps += !isLicProduct ? "" : "\nAdmin - Named User: ";
            entity.ss_admin = parseInt($(tr3).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_eqspolicymdata_ps += !isLicProduct ? "" : entity.ss_admin;
            entity.ss_adminsetup = parseFloat(RemoveFormattings($(tr3).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_adminmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_adminyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr3).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Languages 
            entity.ss_languages = parseInt($(tr4).find('td:eq(1)').find('input[type=number]').val());
            entity.ss_languagessetup = parseFloat(RemoveFormattings($(tr4).find('td:eq(2)').find('input[type=text]').val()));
            entity.ss_languagesmfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_languagesyfee = isLicProduct ? parseFloat(RemoveFormattings($(tr4).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Support-Basic
            var sBasic = $(tr6).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            var sprofessional = $(tr7).find('td:eq(1)').find('input[type=checkbox]').prop("checked");
            entity.ss_eqspolicymdata_ps += (sBasic && isLicProduct) ? "\nSupport (SLA): Standard\n\n" : ((sprofessional && isLicProduct) ? "\nSupport (SLA): Advance\n\n" : "");
            entity.ss_supportbasic = sBasic;
            entity.ss_supportbasicsetup = sBasic ? parseFloat(RemoveFormattings($(tr6).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportbasicmfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportbasicyfee = (sBasic && isLicProduct) ? parseFloat(RemoveFormattings($(tr6).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Support-professional
            entity.ss_supportprofessional = sprofessional;
            entity.ss_supportprofessionalsfee = sprofessional ? parseFloat(RemoveFormattings($(tr7).find('td:eq(2)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportprofessionalmfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr7).find('td:eq(3)').find('input[type=text]').val())) : 0.00;
            entity.ss_supportprofessionalyfee = (sprofessional && isLicProduct) ? parseFloat(RemoveFormattings($(tr7).find('td:eq(4)').find('input[type=text]').val())) : 0.00;
            //Setup Text Value
            entity.ss_stval_ps = isLicProduct ? "" : "Setup";
            return entity;
        }
        //Add Table For BKMS Third Party
        function EQSApprovalManagerAddon(productname, OPIndex, oportunityproducts, Prod_Id, ss_productdescription) {
            var display_prop = "";

            //Flag Fields
            var ss_additionalusercb = ss_addtionalemployeescb = ss_additionallanguagecb = false;
            //Number Fields
            var ss_additionaluserno = ss_additionalemployeeno = ss_additionallanguageno = 0;
            //Setup Fee Fee Fields
            var ss_additionalusersetup = ss_additionalemployeesetup = ss_additionallanguagesetup = AddFormattings(0);
            //Monthly Fee
            var ss_additionalusermonthly = ss_additionalemployeemonthly = ss_additionallanguagemonthly = AddFormattings(0);
            //Yearly Fee
            var ss_additionaluseryearly = ss_additionalemployeeyearly = ss_additionallanguageyearly = AddFormattings(0);

            if (OPIndex >= 0) {
                //Flag Fields
                ss_additionalusercb = oportunityproducts.value[OPIndex]["ss_additionalusercb"] ? oportunityproducts.value[OPIndex]["ss_additionalusercb"] : false;
                ss_addtionalemployeescb = oportunityproducts.value[OPIndex]["ss_addtionalemployeescb"] ? oportunityproducts.value[OPIndex]["ss_addtionalemployeescb"] : false;
                ss_additionallanguagecb = oportunityproducts.value[OPIndex]["ss_additionallanguagecb"] ? oportunityproducts.value[OPIndex]["ss_additionallanguagecb"] : false;

                //Number Fields
                ss_additionaluserno = oportunityproducts.value[OPIndex]["ss_additionaluserno"] ? oportunityproducts.value[OPIndex]["ss_additionaluserno"] : 0;
                ss_additionalemployeeno = oportunityproducts.value[OPIndex]["ss_additionalemployeeno"] ? oportunityproducts.value[OPIndex]["ss_additionalemployeeno"] : 0;
                ss_additionallanguageno = oportunityproducts.value[OPIndex]["ss_additionallanguageno"] ? oportunityproducts.value[OPIndex]["ss_additionallanguageno"] : 0;

                //Setup Fee
                ss_additionalusersetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalusersetup"] ? oportunityproducts.value[OPIndex]["ss_additionalusersetup"] : 0);
                ss_additionalemployeesetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalemployeesetup"] ? oportunityproducts.value[OPIndex]["ss_additionalemployeesetup"] : 0);
                ss_additionallanguagesetup = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallanguagesetup"] ? oportunityproducts.value[OPIndex]["ss_additionallanguagesetup"] : 0);

                //Monthly Fee
                ss_additionalusermonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalusermonthly"] ? oportunityproducts.value[OPIndex]["ss_additionalusermonthly"] : 0);
                ss_additionalemployeemonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalemployeemonthly"] ? oportunityproducts.value[OPIndex]["ss_additionalemployeemonthly"] : 0);
                ss_additionallanguagemonthly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallanguagemonthly"] ? oportunityproducts.value[OPIndex]["ss_additionallanguagemonthly"] : 0);

                //Yearly Fee
                ss_additionaluseryearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionaluseryearly"] ? oportunityproducts.value[OPIndex]["ss_additionaluseryearly"] : 0);
                ss_additionalemployeeyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionalemployeeyearly"] ? oportunityproducts.value[OPIndex]["ss_additionalemployeeyearly"] : 0);
                ss_additionallanguageyearly = AddFormattings(oportunityproducts.value[OPIndex]["ss_additionallanguageyearly"] ? oportunityproducts.value[OPIndex]["ss_additionallanguageyearly"] : 0);
            }
            else {
                display_prop = "style='display:none'";
            }

            var additionallicensescheck = ss_additionalusercb ? "checked" : "";
            var databasecheck = ss_addtionalemployeescb ? "checked" : "";
            var languagecheck = ss_additionallanguagecb ? "checked" : "";

            var markup = "<tr class='OppProducts20' " + display_prop + "><td style='background: transparent;'></td><td class='class='text-center' colspan='4'>"
                + "<table class='table table-responsive ILaddon table-sm text-center border-0 removetable ' id='" + Prod_Id + "_pt'  >"
                + "<tbody class='subtableBody' id='" + Prod_Id + "_p'>"
                + "<tr><td class='subfield'>Additional Users</td><td><input type='checkbox' class='fieldcheck' " + additionallicensescheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_additionaluserno + "'></td><td><input type='text' class='subTableFee' value='" + ss_additionalusersetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionalusermonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionaluseryearly + "'></td></tr>"
                + "<tr><td class='subfield'>Additional Employees</td><td><input type='checkbox' class='fieldcheck' " + databasecheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_additionalemployeeno + "'></td><td><input type='text' class='subTableFee' value='" + ss_additionalemployeesetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionalemployeemonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionalemployeeyearly + "'></td></tr>"
                + "<tr><td class='subfield'>Additional Languages</td><td><input type='checkbox' class='fieldcheck' " + languagecheck + "></td><td><input type='number' class='numberfield' min='0' value='" + ss_additionallanguageno + "'></td><td><input type='text' class='subTableFee' value='" + ss_additionallanguagesetup + "'></td><td><input type='text' class='subTableMFee' value='" + ss_additionallanguagemonthly + "'></td><td><input type='text' class='subTableYFee' value='" + ss_additionallanguageyearly + "'></td></tr>"
                + "</tbody></table></td></tr>";

            return markup;
        }
        //Add Data Table for BKMS Third Party
        function EQSApprovalManagerAddonData(entity, subtable, isLicProduct) {
            var subTBody = $(subtable).find('td:eq(1)').find('.subtableBody');

            var allRows = [];
            for (var i = 0; i <= 3; i++) {
                allRows[i] = $(subTBody).find('tr:eq(' + i + ')');
            }
            //flag fields
            entity.ss_additionalusercb = $(allRows[0]).find('.fieldcheck').prop("checked");
            entity.ss_addtionalemployeescb = $(allRows[1]).find('.fieldcheck').prop("checked");
            entity.ss_additionallanguagecb = $(allRows[2]).find('.fieldcheck').prop("checked");

            //Number Fields
            entity.ss_additionaluserno = $(allRows[0]).find('.numberfield').val();
            entity.ss_additionalemployeeno = $(allRows[1]).find('.numberfield').val();
            entity.ss_additionallanguageno = $(allRows[2]).find('.numberfield').val();

            //Setup Fields
            entity.ss_additionalusersetup = parseFloat(RemoveFormattings($(allRows[0]).find('.subTableFee').val()));
            entity.ss_additionalemployeesetup = parseFloat(RemoveFormattings($(allRows[1]).find('.subTableFee').val()));
            entity.ss_additionallanguagesetup = parseFloat(RemoveFormattings($(allRows[2]).find('.subTableFee').val()));

            //Monthly Fee
            entity.ss_additionalusermonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableMFee').val())) : 0.00;
            entity.ss_additionalemployeemonthly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableMFee').val())) : 0.00;
            entity.ss_additionallanguagemonthly = !isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableMFee').val())) : 0.00;

            //Yearly Fee
            entity.ss_additionaluseryearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[0]).find('.subTableYFee').val())) : 0.00;
            entity.ss_additionalemployeeyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[1]).find('.subTableYFee').val())) : 0.00;
            entity.ss_additionallanguageyearly = isLicProduct ? parseFloat(RemoveFormattings($(allRows[2]).find('.subTableYFee').val())) : 0.00;

            return entity;
        }
        function CalculateImplementationHours(SFee) {
            if (SFee <= 800) {
                return 3;
            }
            else if (SFee >= 801 && SFee <= 1500) {
                return 5;
            }
            else if (SFee >= 1501 && SFee <= 3000) {
                return 10;
            }
            else if (SFee > 3000) {
                return 15;
            }
        }
        $(document).on("change", ".contract_val", function () {
            var currentrow = $(this).closest('tr');
            var contractlength = $(currentrow).find('.contract_val').val();
            var startdate = $(currentrow).find('.start_Date').val();

            if (startdate !== null && startdate !== undefined && contractlength !== '7' && contractlength !== 7) {
                var date = new Date(startdate);
                var month = moment(date).add(contractlength, 'months').format('YYYY-MM-DD');
                month = moment(month).subtract(1, "days").format('YYYY-MM-DD');
                // date.setMonth(date.getMonth()+ parseInt(contractlength));
                // var day = ("0" + date.getDate()).slice(-2);
                // var month = ("0" + (date.getMonth() + 1)).slice(-2);
                // var formatedSDate = date.getFullYear()+"-"+(month)+"-"+(day) ;
                $(currentrow).find('.end_Date').val(month);

            }
            else if (contractlength === 7 || contractlength === '7') {

                $(currentrow).find('.end_Date').val('');
            }

        });
        // function checkbox_click(current) {
        //     var rowid = $(current).closest('tr').attr('id');
        //     var currentrow = $(current).closest('tr');
        //     var ischecked = $(current).prop('checked');
        //     if (ischecked) {
        //         $(currentrow).find('td.contract_field').show();
        //     }
        //     else {
        //         $(currentrow).find('td.contract_field').hide();
        //     }
        // }
        //new 
        $(document).on("click", ".classiccheckbox", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $(".integritycheckbox").prop('checked', false);
                $(".trshowhideintegrity").hide();
                $(".trshowhideclassic").show();
                //$(".additionaldetailsRow").show();
            }
            else {
                $(".trshowhideclassic").hide();
                $(".additionaldetailsRow").hide();
            }
        });
        $(document).on("click", ".integritycheckbox", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $(".trshowhideintegrity").show();
                $(".classiccheckbox").prop('checked', false);
                $(".fieldcheck").prop('checked', false);
                $(".trshowhideclassic").hide();
                $(".additionaldetails").prop("checked", false);
                $(".additionaldetailsRow").hide();
                $(".awscloudhosting").hide();
                //$(".additionaldetails").hide();
            }
            else {
                $(".trshowhideintegrity").hide();
            }
        });
        $(document).on("click", ".phonesystem", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $(".showhidebkmsphone").show();
            }
            else {
                $(".showhidebkmsphone").hide();
            }
        });
        $(document).on("click", ".voiceintake", function () {
            var isChecked = $(this).prop('checked');
            if (isChecked) {
                $(".showhidebkmsphonevoice").show();
            }
            else {
                $(".showhidebkmsphonevoice").hide();
            }
        })
    </script>
</body></html>