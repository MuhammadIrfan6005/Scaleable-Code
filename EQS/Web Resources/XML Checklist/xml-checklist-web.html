<html><head></head><body onfocusout="parent.setEmailRange();" style="word-wrap: break-word;">﻿



    <meta charset="utf-8">
    <meta charset="utf-8">
    <title>CRM FORM</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script src="ss_excelParsingjsZip"></script>
    <script src="ss_excelParsingxlsx.core.min"></script>
    <script src="ss_excelParsingxlsx"></script>
    <script src="new_FileSaver"></script>


    <style>
        small {
            font-size: 9px;
        }

        .right-form {
            font-weight: bold;
        }

        .del-btn {
            margin-bottom: 30px;
            margin-top: 30px;
        }

        .loder-text {
            position: absolute;
            top: 65%;
            left: 45%;
            display: block;
            width: 270px;
            height: 50px;
            margin-top: -50px;
            margin-left: -50px;
            background-color: #ddd;
            color: black;
            border-radius: 40px;
        }

            .loder-text p {
                padding: 5%;
                text-align: center;
                font-weight: bold;
            }

        .form-style {
            border: 1px solid black;
            margin: 20px 0;
            padding: 20px 20px;
        }

        .xmlhead-background {
            background: #389638;
            margin: 20px 0;
        }

        .newsroomhead-background {
            background: #337ab7;
            margin: 20px 0;
        }

        .accountinghead-background {
            background: rgba(234, 96, 120, 0.88);
            margin: 20px 0;
        }

        .fixed-height {
            max-height: 900px;
        }

        .uploadbtnbox {
            margin: 10px 0 10px 0;
            padding: 10px 0 10px 0;
            border: 1px solid black;
        }

        .uploadbtn {
            margin: 10px 0;
        }

        .styleHiddenRow {
            margin: 0 0 0 20px;
        }

        .checkbox-lg {
            width: 30px;
            height: 30px;
            float: right;
        }

        .form-accounting {
            border: 1px solid black;
            padding: 20px 20px;
        }

        .searchResult {
            height: 200px;
            overflow-y: scroll;
            padding-left: 7px;
        }

        #msgDiv img {
            width: 300px;
        }

        #accountList {
            overflow-y: scroll;
            height: 800px;
        }

        tr:hover {
            background-color: #0095ff;
            color: white;
        }

        .loaderStyle {
            text-align: center;
            cursor: wait;
            background: transparent;
            font-size: 12px;
            position: absolute;
            display: none;
            left: 45%;
            top: 120%;
            width: 200px;
            height: 50px;
        }

            .loaderStyle img {
                margin-top: 10px;
                border: none;
            }

        /*E*/
        .preloaderjs .spinner {
            display: none !important;
        }

        .preloaderjs#page-preloader {
            background: rgba(46, 46, 46, 0.99) !important;
        }

        #page-preloader {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #2e2e2e;
            z-index: 100500;
        }

            #page-preloader .spinner {
                position: absolute;
                top: 50%;
                left: 50%;
                display: block;
                width: 100px;
                height: 100px;
                margin-top: -50px;
                margin-left: -50px;
                border: 3px solid transparent;
                border-top-color: #e7e4d7;
                border-radius: 50%;
                z-index: 1001;
                -webkit-animation: spin 2.5s infinite linear;
                animation: spin 2.5s infinite linear;
            }

                #page-preloader .spinner:before, #page-preloader .spinner:after {
                    position: absolute;
                    border-radius: 50%;
                    content: '';
                }

                #page-preloader .spinner:before {
                    top: 5px;
                    right: 5px;
                    bottom: 5px;
                    left: 5px;
                    border: 3px solid transparent;
                    border-top-color: #71383e;
                    -webkit-animation: spin 2s infinite linear;
                    animation: spin 2s infinite linear;
                }

                #page-preloader .spinner:after {
                    top: 15px;
                    right: 15px;
                    bottom: 15px;
                    left: 15px;
                    border: 3px solid transparent;
                    border-top-color: #efa96b;
                    -webkit-animation: spin 1s infinite linear;
                    animation: spin 1s infinite linear;
                }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0);
                transform: rotate(0);
            }

            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                -webkit-transform: rotate(0);
                transform: rotate(0);
            }

            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
    </style>
    <script type="text/javascript">

		$(document).ready(function () {

			$('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').click(function () {

				if ($(this).prop("checked") == false) {
					$(this).prop('checked', true)
				}

				if ($(this).prop("checked") == true) {
					$('.vertragHiddenRow').show();
				}
				else if ($(this).prop("checked") == false) {
					$('.vertragHiddenRow').hide();

					$("#searchCompany").val("");
					$("#NotizenId").val("");
					$("#contacts").html("");

				}


			});

			$('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').click(function () {
				if ($(this).prop("checked") == true) {
					$('.vertragHiddenRow').hide();
					$("#searchCompany").val("");
					$("#NotizenId").val("");
					$("#contacts").html("");

				}
			});


			$('input:checkbox[id=ja_VATID]').click(function () {
				if ($(this).prop("checked") == false) {
					$(this).prop('checked', true)
				}

				if ($(this).prop("checked") == true) {
					$('.vatHiddenRow').show();
				}
				else if ($(this).prop("checked") == false) {
					$('.vatHiddenRow').hide();
				}
			});

			$('input:checkbox[id=Nein_VATID]').click(function () {
				if ($(this).prop("checked") == true) {
					$('.vatHiddenRow').hide();

				}
			});
		});
		var accoundIDS = [];
		var accountname = [];
		var accountRetrieveIds = [];
		var fileInput = "";
		var parts = "";
		var fileName = "";
		var processName = "ss_ActionXMLChecklistIntegrationFileUploadingtoSharepoint";
		var companiesName = [];
		var ChicklistEnitityId = "";
		var MuttergesellschaftId = "";
		var SelectedAccountIdinDropdown = "";
		var prevSelectedAccount = ""
		var excelFiletoParse = null;
		var verifiedByxml = false;
		var request = 0;
		var fileuploaded = false;
		var firmnlistDestinationUrl = "";
		var SharepointFolder = "";
		var opportunityId = "";
		var xmlcontinue = false;
		var ss_newsroomcontinue = false;
		var similaraccountName = [];
		var similarAccountId = [];
		var similaraccountRetrieveFromDummyentity = "";
		var StammdatenblattVorhandenFileUploaded = false;
		var continueRequest = 0;
		var varifiedByXMLRequest = 0;
		var disabledAccountForms = false;
		var ss_salesrepxmlid = "";
		var ss_verifiedbyxml_UpdateOwner = "";

		//added by saad

		var createUpdateAccountsCallResult = "";
		var retrieveXmlCheclistIntegrationObj = "";
		var retrieveXmlTempAccountObj = "";
		var retrieveOpportunitiesObj = "";
		var retrieveXmlTempAccountToUpdateRealAccountObj = "";
		var retrieveSystemUserObj = "";
		var saveActivityAttachmentsObj = "";
		var sendemailresponse = "";
		var updateXMLChecklistIntegrationResponse = "";
		var saveEmailsEmailId = "";


		var companyTypeOptionSet = [];
	    companyTypeOptionSet = {"Kreditinstitut":1,"Pensionsfonds":2,"Finanzdienstleister":3,"Versicherung":4,"Rückversicherungsgesellschaft":5,"Kapitalverwaltungsgesellschaft":6,"OGAW-Investmentaktiengesellschaft":7,"AIF-Investmentaktiengesellschaft":8,"Geschlossene Publikumsinvestmentkommanditgesellschaft":9,"Offene Investmentkommanditgesellschaft":10,"Emittent von Vermögensanlagen":11,"Externe Kapitalverwaltungsgesellschaft":12,"Geschlossene Spezial-Investmentkommanditgesellschaft":13,"Unternehmensbeteiligungsgesellschaft":14,"Beteiligungsgesellschaft":15,"Eisenbahnunternehmen":16,"keine der genannten Gesellschaftsarten":17};
		var registerartOptionSet = [];
		registerartOptionSet = {"HRA": 1, "HRB": 2, "VR": 3, "GnR": 4, "PR": 5 };
		var rechtsformOptionSet = [];
		rechtsformOptionSet = {"Aktiengesellschaft": 1, "eingetragene Genossenschaft": 2, "Einzelkaufmann": 3, "Europäische wirtschaftliche Interessenvereinigung": 4, "Gesellschaft mit beschränkter Haftung": 5, "GmbH & Co. KG": 6, "Gmbh & Co. OHG": 7, "Kommanditgesellschaft": 8, "Kommanditgesellschaft auf Aktien": 9, "Offene Handelsgesellschaft": 10, "Partner": 11, "Rechtsform ausländischen Rechts HRA": 12, "Rechtsform ausländischen Rechts HRB": 13, "Rechtsform ausländischen Rechts GnR": 14, "Rechtsform ausländischen Rechts PR": 15, "Societas Europaea (SE)": 16, "Sonstiges (z.B. Behörde, Kommunde, etc.)": 17, "Stiftung (bürgerlichen Rechts)": 18, "Verein": 19, "Versicherungsverein auf Gegenseitigkeit": 20 };
		var steuerschluesseloptionset = [];
		steuerschluesseloptionset = {"Deutschland": 1, "Freihafen; Zollausschlussgebiet": 2, "EU-Ausland": 3, "Nicht-EU-Ausland": 4, "internationale Institutionen": 5, "NATO-Truppen": 6 };
		var ss_registergerichtoptionset = [];
		ss_registergerichtoptionset = { "Aachen": 1, "Altenburg": 2, "Amberg": 3, "Ansbach": 4, "Apolda": 5, "Arnsberg": 6, "Arnstadt": 7, "Arnstadt Zweigstelle Ilmenau": 8, "Aschaffenburg": 9, "Augsburg": 10, "Aurich": 11, "Bad Hersfeld": 12, "Bad Homburg v.d.H.": 13, "Bad Kreuznach": 14, "Bad Oeynhausen": 15, "Bad Salzungen": 16, "Bamberg": 17, "Bayreuth": 18, "Berlin (Charlottenburg)": 19, "Bielefeld": 20, "Bochum": 21, "Bonn": 22, "Braunschweig": 23, "Bremen": 24, "Chemnitz": 25, "Coburg": 26, "Coesfeld": 27, "Cottbus": 28, "Darmstadt": 29, "Deggendorf": 30, "Dortmund": 31, "Dresden": 32, "Duisburg": 33, "Düren": 34, "Düsseldorf": 35, "Eisenach": 36, "Erfurt": 37, "Eschwege": 38, "Essen": 39, "Flensburg": 40, "Frankfurt am Main": 41, "Frankfurt/Oder": 42, "Freiburg": 43, "Friedberg": 44, "Fritzlar": 45, "Fulda": 46, "Fürth": 47, "Gelsenkirchen": 48, "Gera": 49, "Gießen": 50, "Gotha": 51, "Greiz": 52, "Göttingen": 53, "Gütersloh": 54, "Hagen": 55, "Hamburg": 56, "Hamm": 57, "Hanau": 58, "Hannover": 59, "Heilbad Heiligenstadt": 60, "Hildburghausen": 61, "Hildesheim": 62, "Hof": 63, "Homburg": 64, "Ingolstadt": 65, "Iserlohn": 66, "Jena": 67, "Kaiserslautern": 68, "Kassel": 69, "Kempten (Allgäu)": 70, "Kiel": 71, "Kleve": 72, "Koblenz": 73, "Korbach": 74, "Krefeld": 75, "Köln": 76, "Königstein": 77, "Landau": 78, "Landshut": 79, "Langenfeld": 80, "Lebach": 81, "Leipzig": 82, "Lemgo": 83, "Limburg": 84, "Ludwigshafen a.Rhein (Ludwigshafen)": 85, "Lübeck": 85, "Lüneburg": 87, "Mainz": 88, "Mannheim": 89, "Marburg": 90, "Meiningen": 91, "Memmingen": 92, "Merzig": 93, "Montabaur": 94, "Mönchengladbach": 95, "Mühlhausen": 96, "München": 97, "Münster": 98, "Neubrandenburg": 99, "Neunkirchen": 100, "Neuruppin": 101, "Neuss": 102, "Nordhausen": 103, "Nürnberg": 104, "Offenbach am Main": 105, "Oldenburg (Oldenburg)": 106, "Osnabrück": 107, "Ottweiler": 108, "Paderborn": 109, "Passau": 110, "Pinneberg": 111, "Potsdam": 112, "Pößneck": 113, "Pößneck Zweigstelle Bad Lobenstein": 114, "Recklinghausen": 115, "Regensburg": 116, "Rostock": 117, "Rudolstadt": 118, "Rudolstadt Zweigstelle Saalfeld": 119, "Saarbrücken": 120, "Saarlouis": 121, "Schweinfurt": 122, "Schwerin": 123, "Siegburg": 124, "Siegen": 125, "Sondershausen": 126, "Sonneberg": 127, "St. Ingbert (St Ingbert)": 128, "St. Wendel (St Wendel)": 129, "Stadthagen": 130, "Stadtroda": 131, "Steinfurt": 132, "Stendal": 133, "Stralsund": 134, "Straubing": 135, "Stuttgart": 136, "Suhl": 137, "Sömmerda": 138, "Tostedt": 139, "Traunstein": 140, "Ulm": 141, "Völklingen": 142, "Walsrode": 143, "Weiden i. d. OPf.": 144, "Weimar": 145, "Wetzlar": 146, "Wiesbaden": 147, "Wittlich": 148, "Wuppertal": 149, "Würzburg": 150, "Zweibrücken": 151 };

		//saad


		//Method to retrieve data from CRM and Display
		function PopulateCrmData() {
			try {
				opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var ss_firmenlisturl = "";

				showLoadingMessage();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations?$select=ss_euauslnder,ss_sharepointfolder,ss_xmlclienttype,ss_firmenlisturl,_ss_newsroom_value,ss_notes,ss_notizen,ss_stammdatenblattvorhanden,ss_vatid,ss_vertragberwirtschaftsprfer,_ss_wpkontakt_value,ss_xmlchecklistintegrationid,_ss_wirtschaftsprfer_value,ss_workflowfinished,ss_verifiedbynewsroom,ss_verifiedbyxml,_ss_kundenbetreueraccounting_value,ss_newsroomcontinue,ss_anlegenderunternehmensdatenimcompanyadmin,ss_companyidimcrmeintragenevtlverknpfungmit,ss_xmlcontinue,_ss_xmluser_value&$filter=_ss_opportunity_value eq " + opportunityId, false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							for (var i = 0; i < results.value.length; i++) {
								var ss_euauslnder = results.value[i]["ss_euauslnder"];
								SharepointFolder = results.value[i]["ss_sharepointfolder"]
								var ss_workflowfinished = results.value[i]["ss_workflowfinished"];
								var ss_workflowfinished_formatted = results.value[i]["ss_workflowfinished@OData.Community.Display.V1.FormattedValue"];

								xmlcontinue = results.value[i]["ss_xmlcontinue"];
								var ss_xmlcontinue_formatted = results.value[i]["ss_xmlcontinue@OData.Community.Display.V1.FormattedValue"];

								if (ss_workflowfinished == true) {
									$("input.container").attr("disabled", true);
									$("#XMLFORM :input").attr("disabled", true);
									//  $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									$("#accountingCheckbox").prop('checked', true);
									$("#sideForm :input").attr("disabled", true);
									disabledAccountForms = true;
									document.getElementById("finishBtn").disabled = true;
								}
								var ss_verifiedbynewsroom = results.value[i]["ss_verifiedbynewsroom"];
								var ss_verifiedbynewsroom_formatted = results.value[i]["ss_verifiedbynewsroom@OData.Community.Display.V1.FormattedValue"];
								var ss_verifiedbyxml = results.value[i]["ss_verifiedbyxml"];
								var ss_verifiedbyxml_formatted = results.value[i]["ss_verifiedbyxml@OData.Community.Display.V1.FormattedValue"];

								if (ss_verifiedbyxml == true) {
									document.getElementById("verifiedByXMLtxt").disabled = true;
								}

								if (ss_verifiedbynewsroom == true) {
									document.getElementById("verifiedByNewsroomtxt").disabled = true;
									// $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}
								if (ss_verifiedbyxml == true && ss_verifiedbynewsroom == false) {
									document.getElementById("verifiedByNewsroomtxt").disabled = false;
								}
								if (ss_verifiedbynewsroom == true && ss_workflowfinished == false) {
									document.getElementById("finishBtn").disabled = false;
									$("#sideForm :input").attr("disabled", true);
									//  $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}

								var _ss_kundenbetreueraccounting_value = results.value[i]["_ss_kundenbetreueraccounting_value"];
								var _ss_kundenbetreueraccounting_value_formatted = results.value[i]["_ss_kundenbetreueraccounting_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_kundenbetreueraccounting_value_lookuplogicalname = results.value[i]["_ss_kundenbetreueraccounting_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_kundenbetreueraccounting_value != null) {
									document.getElementById("continuebtn").disabled = true;
								}
								if (ss_euauslnder == true) {
									$('.vatHiddenRow').show();
									$("#ja_VATID").prop('checked', true)
								}
								else {
									$("#Nein_VATID").prop('checked', true)
								}
								ss_firmenlisturl = results.value[i]["ss_firmenlisturl"];
								firmnlistDestinationUrl = ss_firmenlisturl;
								if (xmlcontinue == false) {
									document.getElementById("verifiedByXMLtxt").disabled = true;
								}
								var _ss_newsroom_value = results.value[i]["_ss_newsroom_value"];
								var _ss_newsroom_value_formatted = results.value[i]["_ss_newsroom_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_newsroom_value_lookuplogicalname = results.value[i]["_ss_newsroom_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_newsroom_value != null) {
									$("#KundenbetreuerLookup").val(_ss_newsroom_value_formatted);
								}
								var ss_notes = results.value[i]["ss_notes"];
								if (ss_notes != "" && ss_notes != null) {
									$("#noteId").val(ss_notes);
								}
								var ss_notizen = results.value[i]["ss_notizen"];

								if (ss_notizen != "" && ss_notizen != null) {
									$("#NotizenId").val(ss_notizen);
								}
								// var ss_stammdatenblattvorhanden = results.value[i]["ss_stammdatenblattvorhanden"];

								//if (ss_stammdatenblattvorhanden == true) {
								//    $("#ja_StammdatenblattVorhanden").prop('checked', true)
								//}
								//else {
								//    $("#Nein_StammdatenblattVorhanden").prop('checked', true)
								//}



								// changed asim
								var Kundengruppe = results.value[0]["ss_xmlclienttype@OData.Community.Display.V1.FormattedValue"];
								var KundengruppeValue = results.value[0]["ss_xmlclienttype"];

								if (Kundengruppe == "PR Kunde") {
									$("input:radio[id=KundengruppePR]").prop("checked", true);
								}
								if (Kundengruppe == "Tochter") {
									$("input:radio[id=KundengruppeTo]").prop("checked", true);
								}


								var ss_vatid = results.value[i]["ss_vatid"];

								if (ss_vatid != null) {
									$("#VATIDId").val(ss_vatid);
								}

								var ss_vertragberwirtschaftsprfer = results.value[i]["ss_vertragberwirtschaftsprfer"];
								if (ss_vertragberwirtschaftsprfer == true) {
									$("#ja_VertraguberWirtschaftsprufer").prop('checked', true)
									$('.vertragHiddenRow').show();
								}
								else {
									$("#Nein_VertraguberWirtschaftsprufer").prop('checked', true)
								}

								var _ss_wirtschaftsprfer_value = results.value[i]["_ss_wirtschaftsprfer_value"];
								var _ss_wirtschaftsprfer_value_formatted = results.value[i]["_ss_wirtschaftsprfer_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_wirtschaftsprfer_value_lookuplogicalname = results.value[i]["_ss_wirtschaftsprfer_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_wirtschaftsprfer_value_formatted != null) {
									$("#searchCompany").val(_ss_wirtschaftsprfer_value_formatted);

								}
								var _ss_wpkontakt_value = results.value[i]["_ss_wpkontakt_value"];
								var _ss_wpkontakt_value_formatted = results.value[i]["_ss_wpkontakt_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_wpkontakt_value_lookuplogicalname = results.value[i]["_ss_wpkontakt_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_wpkontakt_value != null) {
									$('#contacts').append($("<option selected='selected'></option>").attr("value", _ss_wpkontakt_value).text(_ss_wpkontakt_value_formatted));
								}


								ChicklistEnitityId = results.value[i]["ss_xmlchecklistintegrationid"];
								var _ss_xmluser_value = results.value[i]["_ss_xmluser_value"];
								var _ss_xmluser_value_formatted = results.value[i]["_ss_xmluser_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_xmluser_value_lookuplogicalname = results.value[i]["_ss_xmluser_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_xmluser_value != null) {
									//$("#verifiedByXMLtxt").css("display", "none");
									//document.getElementById("verifiedByXMLtxt").disabled = true;
									$("#verifiedByXMLLookup").val(_ss_xmluser_value_formatted);
								}

								var ss_anlegenderunternehmensdatenimcompanyadmin = results.value[i]["ss_anlegenderunternehmensdatenimcompanyadmin"];
								var ss_anlegenderunternehmensdatenimcompanyadmin_formatted = results.value[i]["ss_anlegenderunternehmensdatenimcompanyadmin@OData.Community.Display.V1.FormattedValue"];
								var ss_companyidimcrmeintragenevtlverknpfungmit = results.value[i]["ss_companyidimcrmeintragenevtlverknpfungmit"];
								var ss_companyidimcrmeintragenevtlverknpfungmit_formatted = results.value[i]["ss_companyidimcrmeintragenevtlverknpfungmit@OData.Community.Display.V1.FormattedValue"];

								//if (ss_anlegenderunternehmensdatenimcompanyadmin == true) {
								//    $("#CompanyAdminCheckBox").prop('checked', true);
								//    $("#CompanyAdminCheckBox").attr("disabled", true)
								//}
								if (ss_companyidimcrmeintragenevtlverknpfungmit == true) {
									$("#CompanyIDimCRMCheckBox").prop('checked', true);
									$("#CompanyIDimCRMCheckBox").attr("disabled", true)
								}
								if (xmlcontinue) {
									$("#XMLFORM :input").attr("disabled", true);
								}

								ss_newsroomcontinue = results.value[i]["ss_newsroomcontinue"];
								var ss_newsroomcontinue_formatted = results.value[i]["ss_newsroomcontinue@OData.Community.Display.V1.FormattedValue"];

								if (ss_newsroomcontinue == true && _ss_kundenbetreueraccounting_value == null) {
									document.getElementById("accountingCheckbox").disabled = false;
									//   $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}
								if (ss_verifiedbynewsroom == true && ss_newsroomcontinue == false) {
									document.getElementById("continuebtn").disabled = false;
									document.getElementById("accountingCheckbox").disabled = true;
									document.getElementById("finishBtn").disabled = true;
								}
								if ((ss_workflowfinished != true && ss_newsroomcontinue == true) && _ss_kundenbetreueraccounting_value == null) {
									document.getElementById("accountingCheckbox").disabled = false;
									document.getElementById("finishBtn").disabled = true;
								}
								if ((ss_workflowfinished != true && ss_newsroomcontinue == true) && _ss_kundenbetreueraccounting_value != null) {
									document.getElementById("accountingCheckbox").disabled = true;

									$("#accountingCheckbox").prop('checked', true);
									document.getElementById("finishBtn").disabled = false;
								}

							}
						} else {

							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;

							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "Onload First request");
							// Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
				var fetchXml = '<fetch>' +
								  '<entity name="account" >' +
									'<attribute name="ss_salesrepxml" />' +
									'<attribute name="ss_xmlclienttype" />' +
									'<attribute name="name" />' +
									'<attribute name="parentaccountid" />' +
									//'<attribute name="new_registergericht" />' +

                                    //added by saad for amtsgericht field
                                    '<attribute name="ss_registergericht" />' +
                                    //

									'<attribute name="new_xmlvertragstyp" />' +
									'<attribute name="new_registrierungsnummer" />' +
									'<link-entity name="opportunity" from="customerid" to="accountid" >' +
									' <attribute name="ss_xmlvertragstyp" />' +
									  '<attribute name="name" />' +
									  '<attribute name="ownerid"/>' +
									  '<attribute name="owneridname" />' +
									  '<filter>' +
										'<condition attribute="opportunityid" operator="eq" value="' + opportunityId + '" />' +
									  '</filter>' +
									  '<link-entity name="systemuser" from="systemuserid" to="owninguser" link-type="inner" >' +
										'<attribute name="fullname" />' +
										 '<attribute name="systemuserid" />' +
									  '</link-entity>' +
									'</link-entity>' +
								 ' </entity>' +
								'</fetch>';
				request++

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?fetchXml=" + fetchXml, false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);

							var Kundenname = results.value[0]["name"];
							var kundenbetreuer = results.value[0]["systemuser2_x002e_fullname"];
							ss_salesrepxmlid = results.value[0]["systemuser2_x002e_systemuserid"];
							var Amtsgericht = results.value[0]["new_registergericht"]; //changed asim
							var Handelsregisternummer = results.value[0]["new_registrierungsnummer"];
							var preismodell = results.value[0]["new_xmlvertragstyp"];
							var Kundengruppe = results.value[0]["ss_xmlclienttype@OData.Community.Display.V1.FormattedValue"];
							var KundengruppeValue = results.value[0]["ss_xmlclienttype"];
							var Muttergeselleschaft = results.value[0]["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
							var ss_xmlvertragstyp = results.value[0]["opportunity1_x002e_ss_xmlvertragstyp"]
							var ss_xmlvertragstypFormated = results.value[0]["opportunity1_x002e_ss_xmlvertragstyp@OData.Community.Display.V1.FormattedValue"]
							var ss_registergericht = results.value[0]["ss_registergericht"];
							var ss_registergericht_formatted = results.value[0]["ss_registergericht@OData.Community.Display.V1.FormattedValue"];

							MuttergesellschaftId = results.value[0]["_parentaccountid_value"];

							if (Kundengruppe == "PR Kunde") {
								$("input:radio[id=KundengruppePR]").prop("checked", true);
							}
							if (Kundengruppe == "Tochter") {
								$("input:radio[id=KundengruppeTo]").prop("checked", true);
							}
							$('#KundennameId').val(Kundenname);
							$('#KundenbetreuerId').val(kundenbetreuer);
                            //changed by saad based on client's requirement to set registergericht's text in amtsgericht field
							//$('#AmtsgerichtId').val(Amtsgericht);
							$('#AmtsgerichtId').val(ss_registergericht_formatted);
                            //
							$('#HandelsregisternummerId').val(Handelsregisternummer);
							if (ss_xmlvertragstypFormated != null) {
								$('#PreismodellId').val(ss_xmlvertragstypFormated);
							}
							$('#MuttergesellschaftId').val(Muttergeselleschaft);

							request--;
							if (request == 0) {
								hideLoadingMessage();
								$(".loder-text p").html("");

							}
						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "retrieving account request in onoad function");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();

				if (ss_firmenlisturl != "" && ss_firmenlisturl != null) {

					document.getElementById("FirmenlisteFile").disabled = true;
					// var base64ofFile = soapCallToDownloadFile(ss_firmenlisturl);
					//var byteString = atob(base64ofFile);
					//var ab = new ArrayBuffer(byteString.length);
					//var ia = new Uint8Array(ab);
					//for (var i = 0; i < byteString.length; i++) {
					//    ia[i] = byteString.charCodeAt(i);
					//}

					//  var bb = new Blob([ab]);
					//  ExcelParsing(bb);
					// hideLoadingMessage();
					if (xmlcontinue == true && ss_newsroomcontinue == false) {
						request++;
						$(".loder-text p").html("Loading ... ");
						retrieveDummyRecords();
					}
					if (ss_newsroomcontinue) {
						retrievedataFromAccounts();
					}
					if (request > 0) {
						request--;
						hideLoadingMessage();
					}
				}
				else if (ChicklistEnitityId == "") {
					request++;
					var entity = {};
					$(".loder-text p").html("Creating Sharepoint Folder");
					debugger;

					//if (destFlder != "" && destFlder != undefined) {
					//    SharepointFolder = destFlder;
					//    entity.ss_sharepointfolder = destFlder;
					//}
					$(".loder-text p").html("Updating Workflow..");

					document.getElementById("verifiedByXMLtxt").disabled = true;
					entity["ss_Opportunity@odata.bind"] = "/opportunities(" + opportunityId + ")";
					if (ss_salesrepxmlid != "" && ss_salesrepxmlid != null) {
						entity["ss_salesrep@odata.bind"] = "/systemusers(" + ss_salesrepxmlid + ")";
					}

					if ($('input:radio[id=KundengruppePR]:checked').val() == "PR Kunde") {
						entity.ss_xmlclienttype = 3;
					}

					else if ($('input:radio[id=KundengruppePR]:checked').val() == "Tochter") {
						entity.ss_xmlclienttype = 2;
					}

					var req = new XMLHttpRequest();
					req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {

								var uri = this.getResponseHeader("OData-EntityId");
								var regExp = /\(([^)]+)\)/;
								var matches = regExp.exec(uri);
								ChicklistEnitityId = matches[1];
								var destFlder = createSharepointFolder();
								request--;
								if (request == 0) {
									hideLoadingMessage();
									$(".loder-text p").html("");

								}
							} else {
								hideLoadingMessage();
								$(".loder-text p").html("");
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "create ss_xmlchecklistintegrations record");
								//  opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in PopulateCrmData");
			}

		}

		function createSharepointFolder() {
			try {
				debugger;
				var DistinationUrl = "";
				var opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/opportunities(" + opportunityId + ")?$select=name,_parentaccountid_value", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							var name = result["name"];
							var _parentaccountid_value = result["_parentaccountid_value"];
							var _parentaccountid_value_formatted = result["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
							var _parentaccountid_value_lookuplogicalname = result["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

							var opportunityFolder = name + "_" + opportunityId;

							opportunityFolder = opportunityFolder.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");



							// Creating the request XML for calling the Action
							var processName = "ss_ActionXMLChecklistIntegrationFolderCreationinSP";

							var requestXML = "";

							requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
							requestXML += "<s:Body>";
							requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
							requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

							requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";

							requestXML += "<a:KeyValuePairOfstringanyType>";
							requestXML += "<b:key>OpportunityFolder</b:key>";
							requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + opportunityFolder + "</b:value>";
							requestXML += "</a:KeyValuePairOfstringanyType>";

							requestXML += "</a:Parameters>";
							requestXML += "<a:RequestId i:nil=\"true\" />";
							requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
							requestXML += "</request>";
							requestXML += "</Execute>";
							requestXML += "</s:Body>";
							requestXML += "</s:Envelope>";

							var req1 = new XMLHttpRequest();
							req1.open("POST", GetClientUrl(), false)
							req1.setRequestHeader("Accept", "application/xml, text/xml, */*");
							req1.setRequestHeader("Content-Type", "text/xml; charset=utf-8");

							//req.setRequestHeader("Accept", "application/json");
							//req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

							req1.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
							req1.send(requestXML);
							if (req1.status == 200) {
								var result = JSON.stringify(req1.response);


								fileuploaded == true;
								if ($(req1.responseXML).find('ExecuteResult')[0].textContent != undefined && $(req1.responseXML).find('ExecuteResult')[0].textContent != null && $(req1.responseXML).find('ExecuteResult')[0].textContent != "") {
									var a = $(req1.responseXML).find('ExecuteResult')[0].textContent;
									DistinationUrl = a.replace("ss_ActionXMLChecklistIntegrationFolderCreationinSPFolderURL", "");
								}

								if (DistinationUrl != "" && DistinationUrl != null) {
									updateSharepointUrl(DistinationUrl);
								}
							}
							else {
								var errorText = $(req1.responseText).find("Message")[0].innerHTML;
								// var errorText = JSON.parse(req1.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "creating sharepoint folder request in createSharepointFolder");

							}

						}
						else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "opportunity retrieve in createSharepointFolder");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();

				return DistinationUrl;
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in createSharepointFolder");
			}
		}
		function updateSharepointUrl(DistinationUrl) {
			try {
				var entity = {};
				entity.ss_sharepointfolder = DistinationUrl;
				SharepointFolder = DistinationUrl;
				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							//Success - No Return Data - Do Something
						} else {
							// opener.Xrm.Utility.alertDialog(this.responseText);

							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "updating Sharepoint Url in updateSharepointUrl function");
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateSharepointUrl");
			}
		}
		function SaveXMLData() {
			try {
				if (firmnlistDestinationUrl == "" || firmnlistDestinationUrl == undefined) {
					alert("Please upload file Firmenliste File");
					return;
				}
				document.getElementById("accountList").style.visibility = "visible";

				//var fileselected = $("#FirmenlisteFile").val();
				//if (fileselected == "") {
				//    alert("Please upload file Firmenliste File");
				//    return;
				//}

				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") != true && $('input:checkbox[id=Nein_StammdatenblattVorhanden]').prop("checked") != true) {
				//    alert("Please provide value for Stammdatenblatt vorhanden checkbox");
				//    return;
				//}
				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") != true && $('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').prop("checked") != true) {
					alert("Please provide value for Vertrag über Wirtschaftsprüfer checkbox");
					return;
				}
				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") == true && StammdatenblattVorhandenFileUploaded != true) {
				//    alert("Please Upload Stammdatenblatt vorhanden File");
				//    return;
				//}

				//if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") == true)
				//{
				//    if ($('#searchCompany').val() == "")
				//    {
				//        alert("Please provide value Wirtschaftspr�fer");
				//        return;
				//    }
				//    else if ($("#XMLFORM").find("#contacts").find('option:selected').val() == "")
				//    {
				//        alert("Please provide value WP Kontakt");
				//        return;
				//    }
				//}

				if ($('input:checkbox[id=ja_VATID]').prop("checked") != true && $('input:checkbox[id=Nein_VATID]').prop("checked") != true) {
					alert("Please provide value for EU-Ausländer Umsatzsteuer ID-NR. (VAT-ID) eingeholt checkbox");
					return;
				}
				var selectedContact = "";
				var accountid = "";
				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked")) {
					selectedContact = $("#XMLFORM").find("#contacts").find('option:selected').val();
					accountid = SelectedAccountIdinDropdown;
				}
				var Notizen = $("#XMLFORM").find("#NotizenId").val();
				var notes = $("#XMLFORM").find("#noteId").val();
				var vatid = $("#XMLFORM").find("#VATIDId").val();

				var entity = {};
				entity.ss_xmlcontinue = true;
				if ($('input:checkbox[id=ja_VATID]').prop("checked") == true) {
					entity.ss_euauslnder = true;
				}
				else {
					entity.ss_euauslnder = false;
				}

				if (MuttergesellschaftId != "" && MuttergesellschaftId != undefined) {
					entity["ss_Muttergesellschaft@odata.bind"] = "/accounts(" + MuttergesellschaftId + ")";
				}

				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") == true) {
				//    entity.ss_stammdatenblattvorhanden = true;
				//}
				//else {
				//    entity.ss_stammdatenblattvorhanden = false;
				//}

				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") == true) {
					entity.ss_vertragberwirtschaftsprfer = true;
				}
				else {
					entity.ss_vertragberwirtschaftsprfer = false;
				}

				if (accountid != "") {
					entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts(" + accountid + ")";
				}
				if (selectedContact != undefined && selectedContact != "") {
					entity["ss_WPKontakt@odata.bind"] = "/contacts(" + selectedContact + ")";
				}
				if (Notizen != undefined && Notizen != "") {
					entity.ss_notizen = Notizen;
				}

				if (vatid != undefined && vatid != "") {
					entity.ss_vatid = vatid;
				}
				// entity.ss_fondsberichte = "";

				if (notes != undefined && notes != "") {
					entity.ss_notes = notes;
				}

				request++;
				showLoadingMessage();
				$(".loder-text p").html("Updating Workflow...");

				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							request++;
							$(".loder-text p").html("Populating Data.. ");
							// ExcelParsing(excelFiletoParse);
							retrieveDummyRecords();
							document.getElementById("cntBtnsaveXml").disabled = true;
							$("#XMLFORM :input").attr("disabled", true);
							document.getElementById("verifiedByXMLtxt").disabled = false;

							//hideLoadingMessage();
							//alert("Daten wurden gespeichert");
							request--;
							if (request == 0) {
								hideLoadingMessage();
								$(".loder-text p").html("");
								updateOpportunityAccount(ChicklistEnitityId);

							}
						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in SaveXMLData function");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));


			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in SaveXMLData");
			}
		}
		function uncheckotherBoxIncaseofStammdatenblattVorhanden(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_VertraguberWirtschaftsprufer" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_VertraguberWirtschaftsprufer" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop('checked', false);
			}
			//updateRealAccount(checkbox);
		}
		function uncheckotherBoxIncaseofVATID(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_VATID" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_VATID]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_VATID" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_VATID]').prop('checked', false);
			}
			//updateRealAccount(checkbox);
		}
		function uncheckotherCheckBoxIncaseofStammdatenblattVorhanden(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_StammdatenblattVorhanden" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_StammdatenblattVorhanden]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_StammdatenblattVorhanden" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_StammdatenblattVorhanden]').prop('checked', false);
			}
		}
		//Method to look for the searched account in the crm
		function SearchAccount() {
			try {
				showLoadingMessage();
				var accounttobeSearch = $('#searchCompany').val();
				$('#contacts').find('option').remove();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?$select=accountid,name&$filter=contains(name, '" + accounttobeSearch + "')", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							var html = "";
							if (results.value.length > 0) {
								for (var i = 0; i < results.value.length; i++) {
									var accountid = results.value[i]["accountid"];
									var name = results.value[i]["name"];

									html += "<tr id='" + accountid + "' onclick='selectAccount(this)'><td>" + name + "</td></tr>";

								}
							}
							else {
								html += "<tr id='norecordfound' onclick='selectAccount(this)'><td>No similar Account Found </td></tr>";

							}

							$("#tblsearchResult").css("display", "block")

							$("#dataTable").html(html);
							hideLoadingMessage();
							$(".loder-text p").html("");


						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in SearchAccount function");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in SearchAccount");
			}
		}
		//Method to set the selected account in the seach box from list of accounts when user search account
		function selectAccount(row) {
			try {
				SelectedAccountIdinDropdown = $(row).attr('id')
				if (SelectedAccountIdinDropdown != "norecordfound") {


					var accountName = $(row).closest('tr').children('td:eq(0)').text();
					$("#tblsearchResult").css("display", "none")
					$('#searchCompany').val(accountName)

					var req = new XMLHttpRequest();
					req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/contacts?$select=contactid,fullname&$filter=_parentcustomerid_value eq " + SelectedAccountIdinDropdown, true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 200) {
								var results = JSON.parse(this.response);
								if (results != null) {
									$('#contacts').find('option').remove();

									$("#contacts").append("<option value='' selected='selected'></option>");
									for (var i = 0; i < results.value.length; i++) {
										var contactid = results.value[i]["contactid"];
										var fullname = results.value[i]["fullname"];

										$('#contacts').append($("<option></option>").attr("value", contactid).text(fullname));
									}
								}

								//added by saad
								//updateRealAccount(row);
								//saad

							} else {
								hideLoadingMessage();
								$(".loder-text p").html("");
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "selectAccount");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send();
				}
				else {
					$("#tblsearchResult").css("display", "none")
					$('#contacts').find('option').remove();
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in selectAccount");
			}
		}
		function uploadStammdatenblattFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					fileInput = "";
					fileName = "";
					var filecounter = 0;
					//fileInput = jQuery('#StammdatenblattFile');
					var files = document.getElementById('StammdatenblattFile').files;
					if (files.length > 0) {
						showLoadingMessage();
						$(".loder-text p").html("Uploading Files to Sharepoint.. ");

						for (var i = 0; i < files.length; i++) {
							f = files[i];
							// fileName = f.name
							var reader = new FileReader();

							reader.onload = function (evt) {
								fileName = evt.target.fileName
								var str = _arrayBufferToBase64(evt.target.result);
								var DistinationUrl = soapCall(str);
								StammdatenblattVorhandenFileUploaded = true;
								var entity = {};

								var req1 = new XMLHttpRequest();
								req1.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=ss_stammdatenblatturl", false);
								req1.setRequestHeader("OData-MaxVersion", "4.0");
								req1.setRequestHeader("OData-Version", "4.0");
								req1.setRequestHeader("Accept", "application/json");
								req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req1.onreadystatechange = function () {
									if (this.readyState === 4) {
										req1.onreadystatechange = null;
										if (this.status === 200) {
											var result = JSON.parse(this.response);
											var ss_stammdatenblatturl = result["ss_stammdatenblatturl"];
											if (ss_stammdatenblatturl == null) {
												entity.ss_stammdatenblatturl = DistinationUrl;
											}
											else {
												entity.ss_stammdatenblatturl = ss_stammdatenblatturl + " " + DistinationUrl;
											}

											var req = new XMLHttpRequest();
											req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
											req.setRequestHeader("OData-MaxVersion", "4.0");
											req.setRequestHeader("OData-Version", "4.0");
											req.setRequestHeader("Accept", "application/json");
											req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
											req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
											req.onreadystatechange = function () {
												if (this.readyState === 4) {
													req.onreadystatechange = null;
													if (this.status === 204) {
														//Success - No Return Data - Do Something

													} else {
														hideLoadingMessage();
														$(".loder-text p").html("");
														var errorText = JSON.parse(this.responseText).error.message;
														exceptionMessage(errorText);
														LogExceptioninCRM(errorText, this.status, "error in uploadStammdatenblattFile function");
														// opener.Xrm.Utility.alertDialog(this.responseText);
														window.close();
													}
												}
											};
											req.send(JSON.stringify(entity));

										} else {
											hideLoadingMessage();
											$(".loder-text p").html("");
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadStammdatenblattFile function 2");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
											return;
										}
									}
								};
								req1.send();
							}
							reader.onloadend = function () {
								filecounter++;

								if (filecounter == files.length) {
									hideLoadingMessage();
									$(".loder-text p").html("");

									alert("Datei wurde zum Sharepoint hochgeladen");
								}
							}

							reader.fileName = f.name;
							reader.count = i;
							reader.readAsArrayBuffer(f);
						}


					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadStammdatenblattFile");
			}
		}

		//Method for uploading Vertrag File into sharepoint
		function uploadVertragFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				var filecounter = 0;
				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					fileInput = "";
					parts = "";
					fileName = "";
					fileInput = jQuery('#VertragFile');
					var files = document.getElementById('VertragFile').files;
					if (files.length > 0) {
						showLoadingMessage();
						$(".loder-text p").html("Uploading Files to Sharepoint.. ");

						for (var i = 0; i < files.length; i++) {
							f = files[i];
							var reader = new FileReader();

							reader.onload = function (evt) {
								fileName = evt.target.fileName
								var str = _arrayBufferToBase64(evt.target.result);
								var DistinationUrl = soapCall(str);


								var entity = {};

								var req1 = new XMLHttpRequest();
								req1.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=ss_vertragurl", false);
								req1.setRequestHeader("OData-MaxVersion", "4.0");
								req1.setRequestHeader("OData-Version", "4.0");
								req1.setRequestHeader("Accept", "application/json");
								req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req1.onreadystatechange = function () {
									if (this.readyState === 4) {
										req1.onreadystatechange = null;
										if (this.status === 200) {
											var result = JSON.parse(this.response);
											var ss_vertragurl = result["ss_vertragurl"];
											if (ss_vertragurl == null) {
												entity.ss_vertragurl = DistinationUrl;
											}
											else {
												entity.ss_vertragurl = ss_vertragurl + " " + DistinationUrl;
											}

											var req = new XMLHttpRequest();
											req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
											req.setRequestHeader("OData-MaxVersion", "4.0");
											req.setRequestHeader("OData-Version", "4.0");
											req.setRequestHeader("Accept", "application/json");
											req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
											req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
											req.onreadystatechange = function () {
												if (this.readyState === 4) {
													req.onreadystatechange = null;
													if (this.status === 204) {
														//Success - No Return Data - Do Something

													} else {
														hideLoadingMessage();
														$(".loder-text p").html("");
														var errorText = JSON.parse(this.responseText).error.message;
														exceptionMessage(errorText);
														LogExceptioninCRM(errorText, this.status, "error in uploadVertragFile");
														//opener.Xrm.Utility.alertDialog(this.responseText);
														window.close();
														return;
													}
												}
											};
											req.send(JSON.stringify(entity));

										}
										else {
											hideLoadingMessage();
											$(".loder-text p").html("");
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadVertragFile 2");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
											return;
										}
									}
								};
								req1.send();
							}
							reader.onloadend = function () {
								filecounter++;
								if (filecounter == files.length) {
									hideLoadingMessage();
									$(".loder-text p").html("");

									alert("Datei wurde zum Sharepoint hochgeladen");
								}
							}

							reader.fileName = f.name;
							reader.count = i;
							reader.readAsArrayBuffer(f);
						}
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadVertragFile");
			}
		}

		//Method for uploading Firmenliste File into sharepoint
		function uploadFirmenlisteFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				fileuploaded = false;
				fileInput = jQuery('#FirmenlisteFile');
				if (fileInput[0].files.length > 0) {
					parts = fileInput[0].value.split('\\');
					fileName = parts[parts.length - 1];
					var ext = fileName.split(".");
					if (ext[1] != 'xls' && ext[1] != 'xlsx') {
						alert("Please upload a FirmaList file of type xls or xlsx");
						return;
					}
				}

				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					showLoadingMessage();
					$(".loder-text p").html("Please Wait.. ");
					fileInput = "";
					parts = "";
					fileName = "";
					fileInput = jQuery('#FirmenlisteFile');
					if (fileInput[0].files.length > 0) {

						parts = fileInput[0].value.split('\\');
						fileName = parts[parts.length - 1];
						var reader = new FileReader();

						reader.onload = function (evt) {

							var data = reader.result;
							var result;
							var arr = fixdata(data);
							var workbook = XLSX.read(btoa(arr), { type: 'base64' });
							var loopCount = 0;
							var sheet_name_list = workbook.SheetNames;
							sheet_name_list.forEach(function (y) { /* iterate through sheets */
								//Convert the cell value to Json
								loopCount = loopCount + 1;
								var roa = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
								if (roa.length > 0) {
									if (loopCount == 1) {
										result = roa;
									}
								}
							});


							if (result[0]["Firmenname"] == undefined && result[0]["Strasse, Hausnummer"] == undefined && result[0]["PLZ"] == undefined && result[0]["Ort"] == undefined) {
								alert("The uploaded Firmenliste File is invalid. Please upload a valid File.");

								$(".loder-text p").html("");
								hideLoadingMessage();
								return;
							}


							$(".loder-text p").html("Uploading Files to Sharepoint.. ");

							var str = _arrayBufferToBase64(reader.result);
                            //need to test this statement
							firmnlistDestinationUrl = soapCall(str);

							if (firmnlistDestinationUrl) {
								document.getElementById("FirmenlisteFile").disabled = true;

								var entity = {};
								entity.ss_firmenlisturl = firmnlistDestinationUrl;

								var req = new XMLHttpRequest();
								req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
								req.setRequestHeader("OData-MaxVersion", "4.0");
								req.setRequestHeader("OData-Version", "4.0");
								req.setRequestHeader("Accept", "application/json");
								req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req.onreadystatechange = function () {
									if (this.readyState === 4) {
										req.onreadystatechange = null;
										if (this.status === 204) {
											//   hideLoadingMessage();
											//   $(".loder-text p").html("");
											// if (fileuploaded == true) {
											// alert("Datei wurde zum Sharepoint hochgeladen");
											//   }
										} else {
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadFirmenlisteFile");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
										}
									}
								};
								req.send(JSON.stringify(entity));
							}

							excelFiletoParse = fileInput[0].files[0];
							// ExcelParsing(fileInput[0].files[0])
						}
						reader.onloadend = function () {
							createDummyAccountsAndContact();

						}
						reader.readAsArrayBuffer(fileInput[0].files[0]);
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadFirmenlisteFile");
			}
		}
		function createDummyAccountsAndContact() {

			$(".loder-text p").html("Saving the file records");
			document.getElementById("accountList").style.visibility = "hidden";
			ExcelParsing(excelFiletoParse);

		}
		//Making a soap call to request the Action
		function soapCall(str) {
			fileuploaded == false;
			var errorcounter = 0;
			try {


				SharepointFolder = SharepointFolder.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");
				// Creating the request XML for calling the Action
				var requestXML = "";
				requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
				requestXML += "<s:Body>";
				requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
				requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

				requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";
				requestXML += "<a:KeyValuePairOfstringanyType>";
				requestXML += "<b:key>FileName</b:key>";
				requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + SharepointFolder + "/" + fileName + "</b:value>";
				requestXML += "</a:KeyValuePairOfstringanyType>";

				requestXML += "<a:KeyValuePairOfstringanyType>";
				requestXML += "<b:key>FileStream</b:key>";
				requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + str + "</b:value>";
				requestXML += "</a:KeyValuePairOfstringanyType>";

				requestXML += "</a:Parameters>";
				requestXML += "<a:RequestId i:nil=\"true\" />";
				requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
				requestXML += "</request>";
				requestXML += "</Execute>";
				requestXML += "</s:Body>";
				requestXML += "</s:Envelope>";

				var req = new XMLHttpRequest();
				req.open("POST", GetClientUrl(), false)
				req.setRequestHeader("Accept", "application/xml, text/xml, */*");
				req.setRequestHeader("Content-Type", "text/xml; charset=utf-8");

				//req.setRequestHeader("Accept", "application/json");
				//req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

				req.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
				req.send(requestXML);
				if (req.status == 200) {
					var result = JSON.stringify(req.response);
					fileuploaded == true;
					//var DistinationUrl = $(req.responseXML).find('ExecuteResult').find('KeyValuePairOfstringanyType').find('value')[0].innerHTML;
					//$(req.responseXML).find('ExecuteResult')[0].textContent
					var DistinationUrl = "";
					if ($(req.responseXML).find('ExecuteResult')[0].textContent != undefined && $(req.responseXML).find('ExecuteResult')[0].textContent != null && $(req.responseXML).find('ExecuteResult')[0].textContent != "") {
						var a = $(req.responseXML).find('ExecuteResult')[0].textContent;
						DistinationUrl = a.replace("ss_ActionXMLChecklistIntegrationFileUploadingtoSharepointFileUrl", "");

					}

                    //commented this lane for testing purpose
					return DistinationUrl;
				}
				else if (req.status != 200) {


					var errorText = $(req.responseText).find("Message")[0].innerHTML;
					// var errorText = JSON.parse(req1.responseText).error.message;
					exceptionMessage(errorText);
					LogExceptioninCRM(errorText, this.status, "error in soapCall");

					errorcounter++;
					if (errorcounter <= 2) {
						$(".loder-text p").html("Retrying ..." + errorcounter);
						soapCall(str);
					}
					else {
						hideLoadingMessage();
						$(".loder-text p").html("");

						alert("file Could not be uploaded please try again");
						var errorText = $(req.responseText).find("Message")[0].innerHTML;
						// var errorText = JSON.parse(req1.responseText).error.message;
						exceptionMessage(errorText);
						LogExceptioninCRM(errorText, this.status, "error in soapCall 2");
						//var errorText = JSON.parse(this.responseText).error.message;
						//exceptionMessage(errorText);
						window.close();
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in soapCall 3");
				console.log(e.message);
				window.close();
			}
		}

		function GetClientUrl() {
			if (typeof opener.Xrm.Page.context == "object") {
				clientUrl = opener.Xrm.Page.context.getClientUrl();
			}
			var ServicePath = "/XRMServices/2011/Organization.svc/web";
			return clientUrl + ServicePath;
		}

		function getBase64() {

			var reader = new FileReader();
			reader.onload = function (evt) {
				var str = _arrayBufferToBase64(reader.result);
				return str;
			}
			reader.readAsArrayBuffer(fileInput[0].files[0]);
		}

		// Convert Array Buffer to Base 64 string
		function _arrayBufferToBase64(buffer) {
			var binary = '';
			var bytes = new Uint8Array(buffer);
			var len = bytes.byteLength;
			for (var i = 0; i < len; i++) {
				binary += String.fromCharCode(bytes[i]);
			}
			return window.btoa(binary);
		}

		//parsing method of excel file which contains the list of company
		function ExcelParsing(file) {
			try {
				var i, f;
				f = file;
				var counter = 0;
				var reader = new FileReader();
				// var name = f.name;
				reader.onload = function (e) {
					var data = e.target.result;

					var result;
					var arr = fixdata(data);
					var workbook = XLSX.read(btoa(arr), { type: 'base64' });
					var loopCount = 0;
					var sheet_name_list = workbook.SheetNames;
					sheet_name_list.forEach(function (y) { /* iterate through sheets */
						//Convert the cell value to Json
						loopCount = loopCount + 1;
						var roa = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
						if (roa.length > 0) {
							if (loopCount == 1) {
								result = roa;
							}
						}
					});
					//Get the first column first cell value

					var COLOR1 = "#A9A9A9";
					var COLOR2 = "#FFA500";
					var bgcolor = "#A9A9A9";
					// showLoadingMessage();
					var AbweichendeRechnungsanschrift = false;

					for (var x = 0; x < result.length; x++) {
						if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "") {
							bgcolor = bgcolor == COLOR1 ? COLOR2 : COLOR1;
							counter += 1;
							var account = '<form style="background-color:' + bgcolor + '" id="form' + counter + '" class="form-style fixed-height">' +
							'<div class="row form-inline form-group">' +
								' <div class="col-md-3">' +
									'<label class="control-label">Firma' + counter + ':</label>' +
									'<label class="checkbox-inline">' +
										'   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" value="">Mutter' +
									' </label>' +
								' </div>' +
								'<div class="col-md-4">' +
									' <label class="control-label">EQS-ID:</label>' +
									'<input name="EQS-ID" type="text" class="form-control input-sm" readonly/>' +
									//'<p class="text-muted text-center"> "Account" [bbo_equitystoryid]</p>'+
								'</div>' +
								'<div class="col-md-5">' +
									' <label class="control-label">Kunden-Nr:</label>' +
									'<input name="Kunden-Nr" type="text" class="form-control input-sm" />' +
									//'<p class="text-muted text-center"> "Account" [ss_companyadminid]</p>'+
								' </div>' +
							' </div>' +
							'<div class="row form-group">' +
								'<div class="col-md-5">' +
									' <label class="control-label">Firmenname:</label>';

							if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "") {
								companiesName.push(result[x]["Firmenname"]);
								account += ' <input type="text" name="FirmennameId" value = "' + result[x]["Firmenname"] + '" maxlength="160" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="FirmennameId" maxlength="160" class="form-control input-sm" />';
							}

							account += '</div>' +
										'<div class="col-md-2">' +
											' <label class="control-label">Strasse:</label>';


							if (result[x]["Strasse, Hausnummer"] != undefined && result[x]["Strasse, Hausnummer"] != null && result[x]["Strasse, Hausnummer"] != "") {
								var names = "";
								var firstDigit = result[x]["Strasse, Hausnummer"].match(/\d/); //will give you the first digit in the string
								var index = result[x]["Strasse, Hausnummer"].indexOf(firstDigit);
								names = result[x]["Strasse, Hausnummer"].substring(0, index);
								var numberss = result[x]["Strasse, Hausnummer"].substring(index, result[x]["Strasse, Hausnummer"].length);

								account += ' <input type="text" name="StrasseId" value = "' + names + '" maxlength="180" class="form-control input-sm" />';
								account += ' </div>' +
									   '<div class="col-md-2">' +
										   '  <label class="control-label">Nr.:</label>' +
										   '  <input type="text" name="NrId" value = "' + numberss + '" maxlength="75" class="form-control input-sm"  />' +
									   '  </div>';
							}
							else {
								account += ' <input type="text" name="StrasseId" maxlength="180" class="form-control input-sm"  />';
								account += ' </div>' +
									   '<div class="col-md-2">' +
										   '  <label class="control-label">Nr.:</label>' +
										   '  <input type="text" name="NrId" maxlength="75" class="form-control input-sm"  />' +
									   '  </div>';

							}

							account += ' <div class="col-md-2">' +
											' <label class="control-label">PLZ:</label>';

							if (result[x]["PLZ"] != undefined && result[x]["PLZ"] != null && result[x]["PLZ"] != "") {
								account += ' <input type="text" name="PLZId" value = "' + result[x]["PLZ"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="PLZId" maxlength="10" class="form-control input-sm"  />';

							}
							account += '  </div>' +
										 ' <div class="col-md-2">' +
											 ' <label class="control-label">Ort:</label>';

							if (result[x]["Ort"] != undefined && result[x]["Ort"] != null && result[x]["Ort"] != "") {
								account += ' <input type="text" name="OrtId" value = "' + result[x]["Ort"] + '" maxlength="30" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="OrtId" maxlength="30" class="form-control input-sm"  />';

							}
							account += '</div>' +
										'</div> <div class="row form-group"> </div>';


							account += '<div class="row form-group">' +
											' <div class="col-md-3">' +
												'<label class="control-label">Gesellschaftsgröße.:</label>';
							if (result[x]["Gesellschaftsgröße"] != undefined && result[x]["Gesellschaftsgröße"] != null && result[x]["Gesellschaftsgröße"] != "") {
								account += ' <input type="text" name="GesellschatsgrId" value="' + result[x]["Gesellschaftsgröße"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="GesellschatsgrId" maxlength="10" class="form-control input-sm" />';
							}
							'</div>' +
							' <div class="col-md-4">' +
								' <label class="control-label">Homepage:</label>';

							if (result[x]["Homepage"] != undefined && result[x]["Homepage"] != null && result[x]["Homepage"] != "") {
								account += ' <input type="text" name="HomepageId" value = "' + result[x]["Homepage"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="HomepageId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										' <div class="col-md-4">' +
											' <label class="control-label">Allgemeine Email:</label>';

							if (result[x]["Allg. Email z.B. info@..."] != undefined && result[x]["Allg. Email z.B. info@..."] != null && result[x]["Allg. Email z.B. info@..."] != "") {
								account += ' <input type="text" name="AllgemeineEmailId" value = "' + result[x]["Allg. Email z.B. info@..."] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="AllgemeineEmailId" class="form-control input-sm"  />';

							}


							account += ' </div>' +
										  '  </div>' +
										  '<div class="row form-group">' +
											  ' <div class="col-md-2">' +
												  '<label class="control-label">Anrede</label>';
							if (result[x]["Ansprechpartner Anrede: Frau/Herr"] != undefined && result[x]["Ansprechpartner Anrede: Frau/Herr"] != null && result[x]["Ansprechpartner Anrede: Frau/Herr"] != "") {
								account += ' <input type="text" name="AnredeId" value = "' + result[x]["Ansprechpartner Anrede: Frau/Herr"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="AnredeId" maxlength="10" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 ' <label class="control-label">Vorname</label>';

							if (result[x]["Vorname"] != undefined && result[x]["Vorname"] != null && result[x]["Vorname"] != "") {
								account += ' <input type="text" name="VornameId" value = "' + result[x]["Vorname"] + '" maxlength="32" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="VornameId" maxlength="32" class="form-control input-sm"  />';

							}
							account += ' </div>' +
										' <div class="col-md-2">' +
											'  <label class="control-label">Nachname</label>';
							if (result[x]["Name"] != undefined && result[x]["Name"] != null && result[x]["Name"] != "") {
								account += ' <input type="text" name="NachnameId" value = "' + result[x]["Name"] + '" maxlength="32" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="NachnameId" maxlength="32" class="form-control input-sm"  />';

							}


							account += ' </div>' +
										'  <div class="col-md-2">' +
											'  <label class="control-label">Telefon</label>';
							if (result[x]["Telefon"] != undefined && result[x]["Telefon"] != null && result[x]["Telefon"] != "") {
								account += ' <input type="text" name="TelefonId" value = "' + result[x]["Telefon"] + '" maxlength="22" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="TelefonId" maxlength="22" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										' <div class="col-md-2">' +
											' <label class="control-label">Fax</label>';
							if (result[x]["Fax"] != undefined && result[x]["Fax"] != null && result[x]["Fax"] != "") {
								account += ' <input type="text" name="FaxId" value = "' + result[x]["Fax"] + '" maxlength="22" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="FaxId" maxlength="22" class="form-control input-sm"  />';

							}


							account += ' </div>' +
							 ' <div class="col-md-2">' +
								 ' <label class="control-label">Email</label>';
							if (result[x]["Email"] != undefined && result[x]["Email"] != null && result[x]["Email"] != "") {
								account += ' <input type="text" name="EmailId" value = "' + result[x]["Email"] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="EmailId" class="form-control input-sm"  />';

							}

							account += '  </div>' +
										 ' </div>' +
										 ' <div class="row form-group">' +
											 '<div class="col-md-3">' +
												 ' <label class="control-label">Art der Gesellschaft</label>';
							if (result[x]["Art der Gesellschaft"] != undefined && result[x]["Art der Gesellschaft"] != null && result[x]["Art der Gesellschaft"] != "") {
								account += ' <input type="text" name="ArtderGesellschaftId" value = "' + result[x]["Art der Gesellschaft"] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="ArtderGesellschaftId" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 '<div class="col-md-2">' +
											 '  <label class="control-label">Registerart</label>';
							if (result[x]["Registerart"] != undefined && result[x]["Registerart"] != null && result[x]["Registerart"] != "") {
								account += ' <input type="text" name="RegisterartId" value = "' + result[x]["Registerart"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="RegisterartId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 '  <label class="control-label">R-Nr.:</label>';

							if (result[x]["Reg.-Nr."] != undefined && result[x]["Reg.-Nr."] != null && result[x]["Reg.-Nr."] != "") {
								account += ' <input type="text" name="R-NrId" value = "' + result[x]["Reg.-Nr."] + '" maxlength="50" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="R-NrId" maxlength="50"  class="form-control input-sm"  />';

							}

							account += ' </div>' +
							  ' <div class="col-md-2">' +
								  '  <label class="control-label">Ort:</label>';

							if (result[x]["Amtsgericht"] != undefined && result[x]["Amtsgericht"] != null && result[x]["Amtsgericht"] != "") {
								account += ' <input type="text" name="Ort1Id" value = "' + result[x]["Amtsgericht"] + '" maxlength="50" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="Ort1Id" maxlength="50" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 '  <label class="control-label">Rechtsform</label>';
							if (result[x]["Rechtsform"] != undefined && result[x]["Rechtsform"] != null && result[x]["Rechtsform"] != "") {
								account += ' <input type="text" name="RechtsformId" value = "' + result[x]["Rechtsform"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="RechtsformId" maxlength="100" class="form-control input-sm"  />';

							}

							account += '  </div>' +
										' <div class="col-md-3">' +
											' <label class="control-label">Steuerschlüssel</label>';
							if (result[x]["Steuerschlüssel"] != undefined && result[x]["Steuerschlüssel"] != null && result[x]["Steuerschlüssel"] != "") {
								account += ' <input type="text" name="SteuerschlüsselId" value = "' + result[x]["Steuerschlüssel"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="SteuerschlüsselId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
									  ' </div>' +
									  '  <div class="row form-group">' +
										  '  <div class="col-md-12">' +
											  ' <label class="control-label">Abweichende Rechnungsanschrift:</label>';

							if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "" && result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "" && result[x]["Strasse, Hausnummer"] != undefined && result[x]["Strasse, Hausnummer"] != null && result[x]["Strasse, Hausnummer"] != "" && result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "" && result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "" && result[x]["Ort"] != undefined && result[x]["Ort"] != null && result[x]["Ort"] != "" && result[x]["PLZ"] != undefined && result[x]["PLZ"] != null && result[x]["PLZ"] != "" && result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
								if (result[x]["Firmenname"].toString().trim() == result[x]["Firmenname1"].toString().trim() && result[x]["Strasse, Hausnummer"].toString().trim() == result[x]["Strasse, Hausnummer1"].toString().trim() && result[x]["Ort1"].toString().trim() == result[x]["Ort"].toString().trim() && result[x]["PLZ"].toString().trim() == result[x]["PLZ1"].toString().trim()) {
									AbweichendeRechnungsanschrift = false;

									account += ' <label class="radio-inline">' +
								  ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" disabled="disabled">Ja' +
								  ' </label>' +
								  ' <label class="radio-inline">' +
									  '<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" checked="checked" disabled="disabled">Nein' +
								  '  </label>';

								}
								else {
									AbweichendeRechnungsanschrift = true;
									account += ' <label class="radio-inline">' +
									' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
									' </label>' +
									' <label class="radio-inline">' +
										'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
									'  </label>';
								}
							}
							else {
								AbweichendeRechnungsanschrift = true;
								account += ' <label class="radio-inline">' +
								' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
								' </label>' +
								' <label class="radio-inline">' +
									'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
								'  </label>';
							}

							if (AbweichendeRechnungsanschrift == true) {
								account += '  </div>' +
											 '  </div>' +
										 ' <div class="row form-group">' +
											 '  <div class="col-md-4">' +
												 ' <label class="control-label">Firmenname</label>';

								if (result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "") {
									account += ' <input type="text" name="Firmenname1Id" value = "' + result[x]["Firmenname1"] + '" maxlength="155" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Firmenname1Id" maxlength="155" class="form-control input-sm"  />';

								}

								account += ' </div>' +
														' <div class="col-md-2">' +
															' <label class="control-label">Vorname</label>';

								if (result[x]["Vorname1"] != undefined && result[x]["Vorname1"] != null && result[x]["Vorname1"] != "") {
									account += ' <input type="text" name="Vorname1Id" value = "' + result[x]["Vorname1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Vorname1Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += ' </div>' +
																	' <div class="col-md-2">' +
																		' <label class="control-label">Nachname</label>';

								if (result[x]["Name1"] != undefined && result[x]["Name1"] != null && result[x]["Name1"] != "") {
									account += ' <input type="text" name="NameId" value = "' + result[x]["Name1"] + '" maxlength="100" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="NameId" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Abteilung</label>';

								if (result[x]["Abteilung1"] != undefined && result[x]["Abteilung1"] != null && result[x]["Abteilung1"] != "") {
									account += ' <input type="text" name="AbteilungId" value = "' + result[x]["Abteilung1"] + '" maxlength="100" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="AbteilungId" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
								 ' <div class="col-md-3">' +
									 ' <label class="control-label">Strasse:</label>';
								if (result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "") {

									var names = "";
									var firstDigit = result[x]["Strasse, Hausnummer1"].match(/\d/); //will give you the first digit in the string
									var index = result[x]["Strasse, Hausnummer1"].indexOf(firstDigit);
									names = result[x]["Strasse, Hausnummer1"].substring(0, index);
									var numberss = result[x]["Strasse, Hausnummer1"].substring(index, result[x]["Strasse, Hausnummer1"].length);

									account += ' <input type="text" name="Strasse1Id" value = "' + names + '" maxlength="60" class="form-control input-sm" />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id" value = "' + numberss + '" maxlength="40" class="form-control input-sm" />' +
											' </div>';
								}
								else {
									account += ' <input type="text" name="Strasse1Id" maxlength="60" class="form-control input-sm"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id"  maxlength="40" class="form-control input-sm" />' +
											' </div>';

								}

								account += ' <div class="col-md-2">' +
										   ' <label class="control-label">PLZ:</label>';
								if (result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
									account += ' <input type="text" name="PLZ1Id" value = "' + result[x]["PLZ1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="PLZ1Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += '   </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Ort:</label>';
								if (result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "") {
									account += ' <input type="text" name="Ort2Id" value = "' + result[x]["Ort1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Ort2Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += '  </div>' +
										  '   </div>' +
										  '  <div class="row form-group">' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label">Telefon:</label>';
								if (result[x]["Telefon1"] != undefined && result[x]["Telefon1"] != null && result[x]["Telefon1"] != "") {
									account += ' <input type="text" name="Telefon1Id" value = "' + result[x]["Telefon1"] + '" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Telefon1Id" maxlength="22" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label">Fax:</label>';
								if (result[x]["Fax1"] != undefined && result[x]["Fax1"] != null && result[x]["Fax1"] != "") {
									account += ' <input type="text" name="Fax1Id" value = "' + result[x]["Fax1"] + '" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Fax1Id" maxlength="22" class="form-control input-sm"  />';

								}
								account += ' </div>' +
										   ' <div class="col-md-4">' +
											   ' <label class="control-label">Email:</label>';
								if (result[x]["E-Mail"] != undefined && result[x]["E-Mail"] != null && result[x]["E-Mail"] != "") {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["E-Mail"] + '" class="form-control input-sm" />';
								}
								else if (result[x]["Email"]) {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["Email"] + '" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Email1Id" class="form-control input-sm"  />';

								}

								account += '</div>' +
											 ' </div>' +
											  '<hr style="border-top: dotted 2px;" />' +
											  '<div class="row form-group">' +
														  ' <div class="col-md-4">' +
															  '<label class="control-label">UREG</label>' +
																  '   <input name="UREGId" onchange="" maxlength="15" class="form-control input-sm" type="text">' +
														  ' </div>' +
														  '<div class="col-md-4">' +
															  ' <label class="control-label">Cockpit Type:</label>' +
															  '<select id="CockpitTypeDrp" class="form-control"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>' +

														  '</div>' +
														  '<div class="col-md-4">' +
															  ' <label class="control-label">Anzeige im Cockpit-Admin:</label>' +
															  '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
															  '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>' +
														  ' </div>' +
													  ' </div>' +
							  '  </form>';
							}
							else {
								account += '  </div>' +
										 '  </div>' +
									 ' <div class="row form-group">' +
										 '  <div class="col-md-4">' +
											 ' <label class="control-label" style="display:none" >Firmenname</label>';

								if (result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "") {
									account += ' <input type="text" name="Firmenname1Id" value = "' + result[x]["Firmenname1"] + '" maxlength="155" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Firmenname1Id" maxlength="155" class="form-control input-sm"  style="display:none" />';

								}


								account += ' </div>' +
														' <div class="col-md-2">' +
															' <label class="control-label" style="display:none" >Vorname</label>';

								if (result[x]["Vorname1"] != undefined && result[x]["Vorname1"] != null && result[x]["Vorname1"] != "") {
									account += ' <input type="text" name="Vorname1Id" value = "' + result[x]["Vorname1"] + '" maxlength="32" class="form-control input-sm" style="display:none" />';
								}
								else {
									account += ' <input type="text" name="Vorname1Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += ' </div>' +
																	' <div class="col-md-2">' +
																		' <label class="control-label" style="display:none" >Nachname</label>';

								if (result[x]["Name1"] != undefined && result[x]["Name1"] != null && result[x]["Name1"] != "") {
									account += ' <input type="text" name="NameId" value = "' + result[x]["Name1"] + '" maxlength="100" class="form-control input-sm"style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="NameId" maxlength="100" class="form-control input-sm"  style="display:none" />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Abteilung</label>';

								if (result[x]["Abteilung1"] != undefined && result[x]["Abteilung1"] != null && result[x]["Abteilung1"] != "") {
									account += ' <input type="text" name="AbteilungId" value = "' + result[x]["Abteilung1"] + '" maxlength="100" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="AbteilungId" maxlength="100" class="form-control input-sm" style="display:none"   />';

								}

								account += ' </div>' +
								 ' <div class="col-md-3">' +
									 ' <label class="control-label" style="display:none" >Strasse:</label>';
								if (result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "") {

									var names = "";
									var firstDigit = result[x]["Strasse, Hausnummer1"].match(/\d/); //will give you the first digit in the string
									var index = result[x]["Strasse, Hausnummer1"].indexOf(firstDigit);
									names = result[x]["Strasse, Hausnummer1"].substring(0, index);
									var numberss = result[x]["Strasse, Hausnummer1"].substring(index, result[x]["Strasse, Hausnummer1"].length);

									account += ' <input type="text" name="Strasse1Id" value = "' + names + '"  maxlength="60" class="form-control input-sm" style="display:none"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Nr.:</label>' +
												' <input type="text" name="Nr1Id" value = "' + numberss + '"  maxlength="40" class="form-control input-sm" style="display:none"  />' +
											' </div>';
								}
								else {
									account += ' <input type="text" name="Strasse1Id"  maxlength="60" class="form-control input-sm" style="display:none"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id" maxlength="40" class="form-control input-sm" style="display:none"  />' +
											' </div>';

								}

								account += ' <div class="col-md-2">' +
										   ' <label class="control-label" style="display:none" >PLZ:</label>';
								if (result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
									account += ' <input type="text" name="PLZ1Id" value = "' + result[x]["PLZ1"] + '" maxlength="32" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="PLZ1Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += '   </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Ort:</label>';
								if (result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "") {
									account += ' <input type="text" name="Ort2Id" value = "' + result[x]["Ort1"] + '" maxlength="32" class="form-control input-sm" style="display:none" />';
								}
								else {
									account += ' <input type="text" name="Ort2Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += '  </div>' +
										  '   </div>' +
										  '  <div class="row form-group">' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label" style="display:none" >Telefon:</label>';
								if (result[x]["Telefon1"] != undefined && result[x]["Telefon1"] != null && result[x]["Telefon1"] != "") {
									account += ' <input type="text" name="Telefon1Id" value = "' + result[x]["Telefon1"] + '" maxlength="22" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Telefon1Id" maxlength="22" class="form-control input-sm" style="display:none"  />';

								}


								account += ' </div>' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label" style="display:none" >Fax:</label>';
								if (result[x]["Fax1"] != undefined && result[x]["Fax1"] != null && result[x]["Fax1"] != "") {
									account += ' <input type="text" name="Fax1Id" value = "' + result[x]["Fax1"] + '"  maxlength="22" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Fax1Id"  maxlength="22" class="form-control input-sm"  />';

								}
								account += ' </div>' +
										   ' <div class="col-md-4">' +
											   ' <label class="control-label" style="display:none" >Email:</label>';
								if (result[x]["E-Mail"] != undefined && result[x]["E-Mail"] != null && result[x]["E-Mail"] != "") {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["E-Mail"] + '" class="form-control input-sm" style="display:none" />';
								}
								else if (result[x]["Email"]) {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["Email"] + '" class="form-control input-sm" style="display:none"/>';
								}
								else {
									account += ' <input type="text" name="Email1Id" class="form-control input-sm"  style="display:none"/>';

								}

								account += '</div>' +
											' </div>' +
											 '<hr style="border-top: dotted 2px;" />' +
											 '<div class="row form-group">' +
														 ' <div class="col-md-4">' +
															 '<label class="control-label">UREG</label>' +
																 '   <input name="UREGId" onchange="" maxlength="15" class="form-control input-sm" type="text">' +
														 ' </div>' +
														 '<div class="col-md-4">' +
															 ' <label class="control-label">Cockpit Type:</label>' +
															 '<select id="CockpitTypeDrp" class="form-control"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>' +

														 '</div>' +
														 '<div class="col-md-4">' +
															 ' <label class="control-label">Anzeige im Cockpit-Admin:</label>' +
															 '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
															 '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>' +
														 ' </div>' +
													 ' </div>' +
							 '  </form>';
							}


							document.getElementById("accountList").innerHTML += account;

						}
					}
					if (companiesName.length > 0) {
						SimilarAccounts();
					}
					else {
						request</script></body></html>