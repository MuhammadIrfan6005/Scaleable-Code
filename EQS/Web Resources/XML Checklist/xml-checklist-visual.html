<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta charset="utf-8" />
    <title>CRM FORM</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" />
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script src="ss_excelParsingjsZip"></script>
    <script src="ss_excelParsingxlsx.core.min"></script>
    <script src="ss_excelParsingxlsx"></script>
    <script src="new_FileSaver"></script>


    <style>
        small {
            font-size: 9px;
        }

        .right-form {
            font-weight: bold;
        }

        .del-btn {
            margin-bottom: 30px;
            margin-top: 30px;
        }

        .loder-text {
            position: absolute;
            top: 65%;
            left: 45%;
            display: block;
            width: 270px;
            height: 50px;
            margin-top: -50px;
            margin-left: -50px;
            background-color: #ddd;
            color: black;
            border-radius: 40px;
        }

            .loder-text p {
                padding: 5%;
                text-align: center;
                font-weight: bold;
            }

        .form-style {
            border: 1px solid black;
            margin: 20px 0;
            padding: 20px 20px;
        }

        .xmlhead-background {
            background: #389638;
            margin: 20px 0;
        }

        .newsroomhead-background {
            background: #337ab7;
            margin: 20px 0;
        }

        .accountinghead-background {
            background: rgba(234, 96, 120, 0.88);
            margin: 20px 0;
        }

        .fixed-height {
            max-height: 900px;
        }

        .uploadbtnbox {
            margin: 10px 0 10px 0;
            padding: 10px 0 10px 0;
            border: 1px solid black;
        }

        .uploadbtn {
            margin: 10px 0;
        }

        .styleHiddenRow {
            margin: 0 0 0 20px;
        }

        .checkbox-lg {
            width: 30px;
            height: 30px;
            float: right;
        }

        .form-accounting {
            border: 1px solid black;
            padding: 20px 20px;
        }

        .searchResult {
            height: 200px;
            overflow-y: scroll;
            padding-left: 7px;
        }

        #msgDiv img {
            width: 300px;
        }

        #accountList {
            overflow-y: scroll;
            height: 800px;
        }

        tr:hover {
            background-color: #0095ff;
            color: white;
        }

        .loaderStyle {
            text-align: center;
            cursor: wait;
            background: transparent;
            font-size: 12px;
            position: absolute;
            display: none;
            left: 45%;
            top: 120%;
            width: 200px;
            height: 50px;
        }

            .loaderStyle img {
                margin-top: 10px;
                border: none;
            }

        /*E*/
        .preloaderjs .spinner {
            display: none !important;
        }

        .preloaderjs#page-preloader {
            background: rgba(46, 46, 46, 0.99) !important;
        }

        #page-preloader {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #2e2e2e;
            z-index: 100500;
        }

            #page-preloader .spinner {
                position: absolute;
                top: 50%;
                left: 50%;
                display: block;
                width: 100px;
                height: 100px;
                margin-top: -50px;
                margin-left: -50px;
                border: 3px solid transparent;
                border-top-color: #e7e4d7;
                border-radius: 50%;
                z-index: 1001;
                -webkit-animation: spin 2.5s infinite linear;
                animation: spin 2.5s infinite linear;
            }

                #page-preloader .spinner:before, #page-preloader .spinner:after {
                    position: absolute;
                    border-radius: 50%;
                    content: '';
                }

                #page-preloader .spinner:before {
                    top: 5px;
                    right: 5px;
                    bottom: 5px;
                    left: 5px;
                    border: 3px solid transparent;
                    border-top-color: #71383e;
                    -webkit-animation: spin 2s infinite linear;
                    animation: spin 2s infinite linear;
                }

                #page-preloader .spinner:after {
                    top: 15px;
                    right: 15px;
                    bottom: 15px;
                    left: 15px;
                    border: 3px solid transparent;
                    border-top-color: #efa96b;
                    -webkit-animation: spin 1s infinite linear;
                    animation: spin 1s infinite linear;
                }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0);
                transform: rotate(0);
            }

            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                -webkit-transform: rotate(0);
                transform: rotate(0);
            }

            100% {
                -webkit-transform: rotate(360deg);
                transform: rotate(360deg);
            }
        }
    </style>
    <script type="text/javascript">

		$(document).ready(function () {

			$('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').click(function () {

				if ($(this).prop("checked") == false) {
					$(this).prop('checked', true)
				}

				if ($(this).prop("checked") == true) {
					$('.vertragHiddenRow').show();
				}
				else if ($(this).prop("checked") == false) {
					$('.vertragHiddenRow').hide();

					$("#searchCompany").val("");
					$("#NotizenId").val("");
					$("#contacts").html("");

				}


			});

			$('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').click(function () {
				if ($(this).prop("checked") == true) {
					$('.vertragHiddenRow').hide();
					$("#searchCompany").val("");
					$("#NotizenId").val("");
					$("#contacts").html("");

				}
			});


			$('input:checkbox[id=ja_VATID]').click(function () {
				if ($(this).prop("checked") == false) {
					$(this).prop('checked', true)
				}

				if ($(this).prop("checked") == true) {
					$('.vatHiddenRow').show();
				}
				else if ($(this).prop("checked") == false) {
					$('.vatHiddenRow').hide();
				}
			});

			$('input:checkbox[id=Nein_VATID]').click(function () {
				if ($(this).prop("checked") == true) {
					$('.vatHiddenRow').hide();

				}
			});
		});
		var accoundIDS = [];
		var accountname = [];
		var accountRetrieveIds = [];
		var fileInput = "";
		var parts = "";
		var fileName = "";
		var processName = "ss_ActionXMLChecklistIntegrationFileUploadingtoSharepoint";
		var companiesName = [];
		var ChicklistEnitityId = "";
		var MuttergesellschaftId = "";
		var SelectedAccountIdinDropdown = "";
		var prevSelectedAccount = ""
		var excelFiletoParse = null;
		var verifiedByxml = false;
		var request = 0;
		var fileuploaded = false;
		var firmnlistDestinationUrl = "";
		var SharepointFolder = "";
		var opportunityId = "";
		var xmlcontinue = false;
		var ss_newsroomcontinue = false;
		var similaraccountName = [];
		var similarAccountId = [];
		var similaraccountRetrieveFromDummyentity = "";
		var StammdatenblattVorhandenFileUploaded = false;
		var continueRequest = 0;
		var varifiedByXMLRequest = 0;
		var disabledAccountForms = false;
		var ss_salesrepxmlid = "";
		var ss_verifiedbyxml_UpdateOwner = "";

		//added by saad

		var createUpdateAccountsCallResult = "";
		var retrieveXmlCheclistIntegrationObj = "";
		var retrieveXmlTempAccountObj = "";
		var retrieveOpportunitiesObj = "";
		var retrieveXmlTempAccountToUpdateRealAccountObj = "";
		var retrieveSystemUserObj = "";
		var saveActivityAttachmentsObj = "";
		var sendemailresponse = "";
		var updateXMLChecklistIntegrationResponse = "";
		var saveEmailsEmailId = "";


		var companyTypeOptionSet = [];
	    companyTypeOptionSet = {"Kreditinstitut":1,"Pensionsfonds":2,"Finanzdienstleister":3,"Versicherung":4,"Rückversicherungsgesellschaft":5,"Kapitalverwaltungsgesellschaft":6,"OGAW-Investmentaktiengesellschaft":7,"AIF-Investmentaktiengesellschaft":8,"Geschlossene Publikumsinvestmentkommanditgesellschaft":9,"Offene Investmentkommanditgesellschaft":10,"Emittent von Vermögensanlagen":11,"Externe Kapitalverwaltungsgesellschaft":12,"Geschlossene Spezial-Investmentkommanditgesellschaft":13,"Unternehmensbeteiligungsgesellschaft":14,"Beteiligungsgesellschaft":15,"Eisenbahnunternehmen":16,"keine der genannten Gesellschaftsarten":17};
		var registerartOptionSet = [];
		registerartOptionSet = {"HRA": 1, "HRB": 2, "VR": 3, "GnR": 4, "PR": 5 };
		var rechtsformOptionSet = [];
		rechtsformOptionSet = {"Aktiengesellschaft": 1, "eingetragene Genossenschaft": 2, "Einzelkaufmann": 3, "Europäische wirtschaftliche Interessenvereinigung": 4, "Gesellschaft mit beschränkter Haftung": 5, "GmbH & Co. KG": 6, "Gmbh & Co. OHG": 7, "Kommanditgesellschaft": 8, "Kommanditgesellschaft auf Aktien": 9, "Offene Handelsgesellschaft": 10, "Partner": 11, "Rechtsform ausländischen Rechts HRA": 12, "Rechtsform ausländischen Rechts HRB": 13, "Rechtsform ausländischen Rechts GnR": 14, "Rechtsform ausländischen Rechts PR": 15, "Societas Europaea (SE)": 16, "Sonstiges (z.B. Behörde, Kommunde, etc.)": 17, "Stiftung (bürgerlichen Rechts)": 18, "Verein": 19, "Versicherungsverein auf Gegenseitigkeit": 20 };
		var steuerschluesseloptionset = [];
		steuerschluesseloptionset = {"Deutschland": 1, "Freihafen; Zollausschlussgebiet": 2, "EU-Ausland": 3, "Nicht-EU-Ausland": 4, "internationale Institutionen": 5, "NATO-Truppen": 6 };
		var ss_registergerichtoptionset = [];
		ss_registergerichtoptionset = { "Aachen": 1, "Altenburg": 2, "Amberg": 3, "Ansbach": 4, "Apolda": 5, "Arnsberg": 6, "Arnstadt": 7, "Arnstadt Zweigstelle Ilmenau": 8, "Aschaffenburg": 9, "Augsburg": 10, "Aurich": 11, "Bad Hersfeld": 12, "Bad Homburg v.d.H.": 13, "Bad Kreuznach": 14, "Bad Oeynhausen": 15, "Bad Salzungen": 16, "Bamberg": 17, "Bayreuth": 18, "Berlin (Charlottenburg)": 19, "Bielefeld": 20, "Bochum": 21, "Bonn": 22, "Braunschweig": 23, "Bremen": 24, "Chemnitz": 25, "Coburg": 26, "Coesfeld": 27, "Cottbus": 28, "Darmstadt": 29, "Deggendorf": 30, "Dortmund": 31, "Dresden": 32, "Duisburg": 33, "Düren": 34, "Düsseldorf": 35, "Eisenach": 36, "Erfurt": 37, "Eschwege": 38, "Essen": 39, "Flensburg": 40, "Frankfurt am Main": 41, "Frankfurt/Oder": 42, "Freiburg": 43, "Friedberg": 44, "Fritzlar": 45, "Fulda": 46, "Fürth": 47, "Gelsenkirchen": 48, "Gera": 49, "Gießen": 50, "Gotha": 51, "Greiz": 52, "Göttingen": 53, "Gütersloh": 54, "Hagen": 55, "Hamburg": 56, "Hamm": 57, "Hanau": 58, "Hannover": 59, "Heilbad Heiligenstadt": 60, "Hildburghausen": 61, "Hildesheim": 62, "Hof": 63, "Homburg": 64, "Ingolstadt": 65, "Iserlohn": 66, "Jena": 67, "Kaiserslautern": 68, "Kassel": 69, "Kempten (Allgäu)": 70, "Kiel": 71, "Kleve": 72, "Koblenz": 73, "Korbach": 74, "Krefeld": 75, "Köln": 76, "Königstein": 77, "Landau": 78, "Landshut": 79, "Langenfeld": 80, "Lebach": 81, "Leipzig": 82, "Lemgo": 83, "Limburg": 84, "Ludwigshafen a.Rhein (Ludwigshafen)": 85, "Lübeck": 85, "Lüneburg": 87, "Mainz": 88, "Mannheim": 89, "Marburg": 90, "Meiningen": 91, "Memmingen": 92, "Merzig": 93, "Montabaur": 94, "Mönchengladbach": 95, "Mühlhausen": 96, "München": 97, "Münster": 98, "Neubrandenburg": 99, "Neunkirchen": 100, "Neuruppin": 101, "Neuss": 102, "Nordhausen": 103, "Nürnberg": 104, "Offenbach am Main": 105, "Oldenburg (Oldenburg)": 106, "Osnabrück": 107, "Ottweiler": 108, "Paderborn": 109, "Passau": 110, "Pinneberg": 111, "Potsdam": 112, "Pößneck": 113, "Pößneck Zweigstelle Bad Lobenstein": 114, "Recklinghausen": 115, "Regensburg": 116, "Rostock": 117, "Rudolstadt": 118, "Rudolstadt Zweigstelle Saalfeld": 119, "Saarbrücken": 120, "Saarlouis": 121, "Schweinfurt": 122, "Schwerin": 123, "Siegburg": 124, "Siegen": 125, "Sondershausen": 126, "Sonneberg": 127, "St. Ingbert (St Ingbert)": 128, "St. Wendel (St Wendel)": 129, "Stadthagen": 130, "Stadtroda": 131, "Steinfurt": 132, "Stendal": 133, "Stralsund": 134, "Straubing": 135, "Stuttgart": 136, "Suhl": 137, "Sömmerda": 138, "Tostedt": 139, "Traunstein": 140, "Ulm": 141, "Völklingen": 142, "Walsrode": 143, "Weiden i. d. OPf.": 144, "Weimar": 145, "Wetzlar": 146, "Wiesbaden": 147, "Wittlich": 148, "Wuppertal": 149, "Würzburg": 150, "Zweibrücken": 151 };

		//saad


		//Method to retrieve data from CRM and Display
		function PopulateCrmData() {
			try {
				opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var ss_firmenlisturl = "";

				showLoadingMessage();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations?$select=ss_euauslnder,ss_sharepointfolder,ss_xmlclienttype,ss_firmenlisturl,_ss_newsroom_value,ss_notes,ss_notizen,ss_stammdatenblattvorhanden,ss_vatid,ss_vertragberwirtschaftsprfer,_ss_wpkontakt_value,ss_xmlchecklistintegrationid,_ss_wirtschaftsprfer_value,ss_workflowfinished,ss_verifiedbynewsroom,ss_verifiedbyxml,_ss_kundenbetreueraccounting_value,ss_newsroomcontinue,ss_anlegenderunternehmensdatenimcompanyadmin,ss_companyidimcrmeintragenevtlverknpfungmit,ss_xmlcontinue,_ss_xmluser_value&$filter=_ss_opportunity_value eq " + opportunityId, false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							for (var i = 0; i < results.value.length; i++) {
								var ss_euauslnder = results.value[i]["ss_euauslnder"];
								SharepointFolder = results.value[i]["ss_sharepointfolder"]
								var ss_workflowfinished = results.value[i]["ss_workflowfinished"];
								var ss_workflowfinished_formatted = results.value[i]["ss_workflowfinished@OData.Community.Display.V1.FormattedValue"];

								xmlcontinue = results.value[i]["ss_xmlcontinue"];
								var ss_xmlcontinue_formatted = results.value[i]["ss_xmlcontinue@OData.Community.Display.V1.FormattedValue"];

								if (ss_workflowfinished == true) {
									$("input.container").attr("disabled", true);
									$("#XMLFORM :input").attr("disabled", true);
									//  $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									$("#accountingCheckbox").prop('checked', true);
									$("#sideForm :input").attr("disabled", true);
									disabledAccountForms = true;
									document.getElementById("finishBtn").disabled = true;
								}
								var ss_verifiedbynewsroom = results.value[i]["ss_verifiedbynewsroom"];
								var ss_verifiedbynewsroom_formatted = results.value[i]["ss_verifiedbynewsroom@OData.Community.Display.V1.FormattedValue"];
								var ss_verifiedbyxml = results.value[i]["ss_verifiedbyxml"];
								var ss_verifiedbyxml_formatted = results.value[i]["ss_verifiedbyxml@OData.Community.Display.V1.FormattedValue"];

								if (ss_verifiedbyxml == true) {
									document.getElementById("verifiedByXMLtxt").disabled = true;
								}

								if (ss_verifiedbynewsroom == true) {
									document.getElementById("verifiedByNewsroomtxt").disabled = true;
									// $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}
								if (ss_verifiedbyxml == true && ss_verifiedbynewsroom == false) {
									document.getElementById("verifiedByNewsroomtxt").disabled = false;
								}
								if (ss_verifiedbynewsroom == true && ss_workflowfinished == false) {
									document.getElementById("finishBtn").disabled = false;
									$("#sideForm :input").attr("disabled", true);
									//  $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}

								var _ss_kundenbetreueraccounting_value = results.value[i]["_ss_kundenbetreueraccounting_value"];
								var _ss_kundenbetreueraccounting_value_formatted = results.value[i]["_ss_kundenbetreueraccounting_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_kundenbetreueraccounting_value_lookuplogicalname = results.value[i]["_ss_kundenbetreueraccounting_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_kundenbetreueraccounting_value != null) {
									document.getElementById("continuebtn").disabled = true;
								}
								if (ss_euauslnder == true) {
									$('.vatHiddenRow').show();
									$("#ja_VATID").prop('checked', true)
								}
								else {
									$("#Nein_VATID").prop('checked', true)
								}
								ss_firmenlisturl = results.value[i]["ss_firmenlisturl"];
								firmnlistDestinationUrl = ss_firmenlisturl;
								if (xmlcontinue == false) {
									document.getElementById("verifiedByXMLtxt").disabled = true;
								}
								var _ss_newsroom_value = results.value[i]["_ss_newsroom_value"];
								var _ss_newsroom_value_formatted = results.value[i]["_ss_newsroom_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_newsroom_value_lookuplogicalname = results.value[i]["_ss_newsroom_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_newsroom_value != null) {
									$("#KundenbetreuerLookup").val(_ss_newsroom_value_formatted);
								}
								var ss_notes = results.value[i]["ss_notes"];
								if (ss_notes != "" && ss_notes != null) {
									$("#noteId").val(ss_notes);
								}
								var ss_notizen = results.value[i]["ss_notizen"];

								if (ss_notizen != "" && ss_notizen != null) {
									$("#NotizenId").val(ss_notizen);
								}
								// var ss_stammdatenblattvorhanden = results.value[i]["ss_stammdatenblattvorhanden"];

								//if (ss_stammdatenblattvorhanden == true) {
								//    $("#ja_StammdatenblattVorhanden").prop('checked', true)
								//}
								//else {
								//    $("#Nein_StammdatenblattVorhanden").prop('checked', true)
								//}



								// changed asim
								var Kundengruppe = results.value[0]["ss_xmlclienttype@OData.Community.Display.V1.FormattedValue"];
								var KundengruppeValue = results.value[0]["ss_xmlclienttype"];

								if (Kundengruppe == "PR Kunde") {
									$("input:radio[id=KundengruppePR]").prop("checked", true);
								}
								if (Kundengruppe == "Tochter") {
									$("input:radio[id=KundengruppeTo]").prop("checked", true);
								}


								var ss_vatid = results.value[i]["ss_vatid"];

								if (ss_vatid != null) {
									$("#VATIDId").val(ss_vatid);
								}

								var ss_vertragberwirtschaftsprfer = results.value[i]["ss_vertragberwirtschaftsprfer"];
								if (ss_vertragberwirtschaftsprfer == true) {
									$("#ja_VertraguberWirtschaftsprufer").prop('checked', true)
									$('.vertragHiddenRow').show();
								}
								else {
									$("#Nein_VertraguberWirtschaftsprufer").prop('checked', true)
								}

								var _ss_wirtschaftsprfer_value = results.value[i]["_ss_wirtschaftsprfer_value"];
								var _ss_wirtschaftsprfer_value_formatted = results.value[i]["_ss_wirtschaftsprfer_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_wirtschaftsprfer_value_lookuplogicalname = results.value[i]["_ss_wirtschaftsprfer_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_wirtschaftsprfer_value_formatted != null) {
									$("#searchCompany").val(_ss_wirtschaftsprfer_value_formatted);

								}
								var _ss_wpkontakt_value = results.value[i]["_ss_wpkontakt_value"];
								var _ss_wpkontakt_value_formatted = results.value[i]["_ss_wpkontakt_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_wpkontakt_value_lookuplogicalname = results.value[i]["_ss_wpkontakt_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_wpkontakt_value != null) {
									$('#contacts').append($("<option selected='selected'></option>").attr("value", _ss_wpkontakt_value).text(_ss_wpkontakt_value_formatted));
								}


								ChicklistEnitityId = results.value[i]["ss_xmlchecklistintegrationid"];
								var _ss_xmluser_value = results.value[i]["_ss_xmluser_value"];
								var _ss_xmluser_value_formatted = results.value[i]["_ss_xmluser_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_xmluser_value_lookuplogicalname = results.value[i]["_ss_xmluser_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

								if (_ss_xmluser_value != null) {
									//$("#verifiedByXMLtxt").css("display", "none");
									//document.getElementById("verifiedByXMLtxt").disabled = true;
									$("#verifiedByXMLLookup").val(_ss_xmluser_value_formatted);
								}

								var ss_anlegenderunternehmensdatenimcompanyadmin = results.value[i]["ss_anlegenderunternehmensdatenimcompanyadmin"];
								var ss_anlegenderunternehmensdatenimcompanyadmin_formatted = results.value[i]["ss_anlegenderunternehmensdatenimcompanyadmin@OData.Community.Display.V1.FormattedValue"];
								var ss_companyidimcrmeintragenevtlverknpfungmit = results.value[i]["ss_companyidimcrmeintragenevtlverknpfungmit"];
								var ss_companyidimcrmeintragenevtlverknpfungmit_formatted = results.value[i]["ss_companyidimcrmeintragenevtlverknpfungmit@OData.Community.Display.V1.FormattedValue"];

								//if (ss_anlegenderunternehmensdatenimcompanyadmin == true) {
								//    $("#CompanyAdminCheckBox").prop('checked', true);
								//    $("#CompanyAdminCheckBox").attr("disabled", true)
								//}
								if (ss_companyidimcrmeintragenevtlverknpfungmit == true) {
									$("#CompanyIDimCRMCheckBox").prop('checked', true);
									$("#CompanyIDimCRMCheckBox").attr("disabled", true)
								}
								if (xmlcontinue) {
									$("#XMLFORM :input").attr("disabled", true);
								}

								ss_newsroomcontinue = results.value[i]["ss_newsroomcontinue"];
								var ss_newsroomcontinue_formatted = results.value[i]["ss_newsroomcontinue@OData.Community.Display.V1.FormattedValue"];

								if (ss_newsroomcontinue == true && _ss_kundenbetreueraccounting_value == null) {
									document.getElementById("accountingCheckbox").disabled = false;
									//   $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									disabledAccountForms = true;
								}
								if (ss_verifiedbynewsroom == true && ss_newsroomcontinue == false) {
									document.getElementById("continuebtn").disabled = false;
									document.getElementById("accountingCheckbox").disabled = true;
									document.getElementById("finishBtn").disabled = true;
								}
								if ((ss_workflowfinished != true && ss_newsroomcontinue == true) && _ss_kundenbetreueraccounting_value == null) {
									document.getElementById("accountingCheckbox").disabled = false;
									document.getElementById("finishBtn").disabled = true;
								}
								if ((ss_workflowfinished != true && ss_newsroomcontinue == true) && _ss_kundenbetreueraccounting_value != null) {
									document.getElementById("accountingCheckbox").disabled = true;

									$("#accountingCheckbox").prop('checked', true);
									document.getElementById("finishBtn").disabled = false;
								}

							}
						} else {

							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;

							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "Onload First request");
							// Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
				var fetchXml = '<fetch>' +
								  '<entity name="account" >' +
									'<attribute name="ss_salesrepxml" />' +
									'<attribute name="ss_xmlclienttype" />' +
									'<attribute name="name" />' +
									'<attribute name="parentaccountid" />' +
									//'<attribute name="new_registergericht" />' +

                                    //added by saad for amtsgericht field
                                    '<attribute name="ss_registergericht" />' +
                                    //

									'<attribute name="new_xmlvertragstyp" />' +
									'<attribute name="new_registrierungsnummer" />' +
									'<link-entity name="opportunity" from="customerid" to="accountid" >' +
									' <attribute name="ss_xmlvertragstyp" />' +
									  '<attribute name="name" />' +
									  '<attribute name="ownerid"/>' +
									  '<attribute name="owneridname" />' +
									  '<filter>' +
										'<condition attribute="opportunityid" operator="eq" value="' + opportunityId + '" />' +
									  '</filter>' +
									  '<link-entity name="systemuser" from="systemuserid" to="owninguser" link-type="inner" >' +
										'<attribute name="fullname" />' +
										 '<attribute name="systemuserid" />' +
									  '</link-entity>' +
									'</link-entity>' +
								 ' </entity>' +
								'</fetch>';
				request++

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?fetchXml=" + fetchXml, false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);

							var Kundenname = results.value[0]["name"];
							var kundenbetreuer = results.value[0]["systemuser2_x002e_fullname"];
							ss_salesrepxmlid = results.value[0]["systemuser2_x002e_systemuserid"];
							var Amtsgericht = results.value[0]["new_registergericht"]; //changed asim
							var Handelsregisternummer = results.value[0]["new_registrierungsnummer"];
							var preismodell = results.value[0]["new_xmlvertragstyp"];
							var Kundengruppe = results.value[0]["ss_xmlclienttype@OData.Community.Display.V1.FormattedValue"];
							var KundengruppeValue = results.value[0]["ss_xmlclienttype"];
							var Muttergeselleschaft = results.value[0]["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
							var ss_xmlvertragstyp = results.value[0]["opportunity1_x002e_ss_xmlvertragstyp"]
							var ss_xmlvertragstypFormated = results.value[0]["opportunity1_x002e_ss_xmlvertragstyp@OData.Community.Display.V1.FormattedValue"]
							var ss_registergericht = results.value[0]["ss_registergericht"];
							var ss_registergericht_formatted = results.value[0]["ss_registergericht@OData.Community.Display.V1.FormattedValue"];

							MuttergesellschaftId = results.value[0]["_parentaccountid_value"];

							if (Kundengruppe == "PR Kunde") {
								$("input:radio[id=KundengruppePR]").prop("checked", true);
							}
							if (Kundengruppe == "Tochter") {
								$("input:radio[id=KundengruppeTo]").prop("checked", true);
							}
							$('#KundennameId').val(Kundenname);
							$('#KundenbetreuerId').val(kundenbetreuer);
                            //changed by saad based on client's requirement to set registergericht's text in amtsgericht field
							//$('#AmtsgerichtId').val(Amtsgericht);
							$('#AmtsgerichtId').val(ss_registergericht_formatted);
                            //
							$('#HandelsregisternummerId').val(Handelsregisternummer);
							if (ss_xmlvertragstypFormated != null) {
								$('#PreismodellId').val(ss_xmlvertragstypFormated);
							}
							$('#MuttergesellschaftId').val(Muttergeselleschaft);

							request--;
							if (request == 0) {
								hideLoadingMessage();
								$(".loder-text p").html("");

							}
						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "retrieving account request in onoad function");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();

				if (ss_firmenlisturl != "" && ss_firmenlisturl != null) {

					document.getElementById("FirmenlisteFile").disabled = true;
					// var base64ofFile = soapCallToDownloadFile(ss_firmenlisturl);
					//var byteString = atob(base64ofFile);
					//var ab = new ArrayBuffer(byteString.length);
					//var ia = new Uint8Array(ab);
					//for (var i = 0; i < byteString.length; i++) {
					//    ia[i] = byteString.charCodeAt(i);
					//}

					//  var bb = new Blob([ab]);
					//  ExcelParsing(bb);
					// hideLoadingMessage();
					if (xmlcontinue == true && ss_newsroomcontinue == false) {
						request++;
						$(".loder-text p").html("Loading ... ");
						retrieveDummyRecords();
					}
					if (ss_newsroomcontinue) {
						retrievedataFromAccounts();
					}
					if (request > 0) {
						request--;
						hideLoadingMessage();
					}
				}
				else if (ChicklistEnitityId == "") {
					request++;
					var entity = {};
					$(".loder-text p").html("Creating Sharepoint Folder");
					debugger;

					//if (destFlder != "" && destFlder != undefined) {
					//    SharepointFolder = destFlder;
					//    entity.ss_sharepointfolder = destFlder;
					//}
					$(".loder-text p").html("Updating Workflow..");

					document.getElementById("verifiedByXMLtxt").disabled = true;
					entity["ss_Opportunity@odata.bind"] = "/opportunities(" + opportunityId + ")";
					if (ss_salesrepxmlid != "" && ss_salesrepxmlid != null) {
						entity["ss_salesrep@odata.bind"] = "/systemusers(" + ss_salesrepxmlid + ")";
					}

					if ($('input:radio[id=KundengruppePR]:checked').val() == "PR Kunde") {
						entity.ss_xmlclienttype = 3;
					}

					else if ($('input:radio[id=KundengruppePR]:checked').val() == "Tochter") {
						entity.ss_xmlclienttype = 2;
					}

					var req = new XMLHttpRequest();
					req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {

								var uri = this.getResponseHeader("OData-EntityId");
								var regExp = /\(([^)]+)\)/;
								var matches = regExp.exec(uri);
								ChicklistEnitityId = matches[1];
								var destFlder = createSharepointFolder();
								request--;
								if (request == 0) {
									hideLoadingMessage();
									$(".loder-text p").html("");

								}
							} else {
								hideLoadingMessage();
								$(".loder-text p").html("");
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "create ss_xmlchecklistintegrations record");
								//  opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in PopulateCrmData");
			}

		}

		function createSharepointFolder() {
			try {
				debugger;
				var DistinationUrl = "";
				var opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/opportunities(" + opportunityId + ")?$select=name,_parentaccountid_value", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							var name = result["name"];
							var _parentaccountid_value = result["_parentaccountid_value"];
							var _parentaccountid_value_formatted = result["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
							var _parentaccountid_value_lookuplogicalname = result["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

							var opportunityFolder = name + "_" + opportunityId;

							opportunityFolder = opportunityFolder.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");



							// Creating the request XML for calling the Action
							var processName = "ss_ActionXMLChecklistIntegrationFolderCreationinSP";

							var requestXML = "";

							requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
							requestXML += "<s:Body>";
							requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
							requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

							requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";

							requestXML += "<a:KeyValuePairOfstringanyType>";
							requestXML += "<b:key>OpportunityFolder</b:key>";
							requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + opportunityFolder + "</b:value>";
							requestXML += "</a:KeyValuePairOfstringanyType>";

							requestXML += "</a:Parameters>";
							requestXML += "<a:RequestId i:nil=\"true\" />";
							requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
							requestXML += "</request>";
							requestXML += "</Execute>";
							requestXML += "</s:Body>";
							requestXML += "</s:Envelope>";

							var req1 = new XMLHttpRequest();
							req1.open("POST", GetClientUrl(), false)
							req1.setRequestHeader("Accept", "application/xml, text/xml, */*");
							req1.setRequestHeader("Content-Type", "text/xml; charset=utf-8");

							//req.setRequestHeader("Accept", "application/json");
							//req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

							req1.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
							req1.send(requestXML);
							if (req1.status == 200) {
								var result = JSON.stringify(req1.response);


								fileuploaded == true;
								if ($(req1.responseXML).find('ExecuteResult')[0].textContent != undefined && $(req1.responseXML).find('ExecuteResult')[0].textContent != null && $(req1.responseXML).find('ExecuteResult')[0].textContent != "") {
									var a = $(req1.responseXML).find('ExecuteResult')[0].textContent;
									DistinationUrl = a.replace("ss_ActionXMLChecklistIntegrationFolderCreationinSPFolderURL", "");
								}

								if (DistinationUrl != "" && DistinationUrl != null) {
									updateSharepointUrl(DistinationUrl);
								}
							}
							else {
								var errorText = $(req1.responseText).find("Message")[0].innerHTML;
								// var errorText = JSON.parse(req1.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "creating sharepoint folder request in createSharepointFolder");

							}

						}
						else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "opportunity retrieve in createSharepointFolder");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();

				return DistinationUrl;
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in createSharepointFolder");
			}
		}
		function updateSharepointUrl(DistinationUrl) {
			try {
				var entity = {};
				entity.ss_sharepointfolder = DistinationUrl;
				SharepointFolder = DistinationUrl;
				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							//Success - No Return Data - Do Something
						} else {
							// opener.Xrm.Utility.alertDialog(this.responseText);

							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "updating Sharepoint Url in updateSharepointUrl function");
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateSharepointUrl");
			}
		}
		function SaveXMLData() {
			try {
				if (firmnlistDestinationUrl == "" || firmnlistDestinationUrl == undefined) {
					alert("Please upload file Firmenliste File");
					return;
				}
				document.getElementById("accountList").style.visibility = "visible";

				//var fileselected = $("#FirmenlisteFile").val();
				//if (fileselected == "") {
				//    alert("Please upload file Firmenliste File");
				//    return;
				//}

				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") != true && $('input:checkbox[id=Nein_StammdatenblattVorhanden]').prop("checked") != true) {
				//    alert("Please provide value for Stammdatenblatt vorhanden checkbox");
				//    return;
				//}
				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") != true && $('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').prop("checked") != true) {
					alert("Please provide value for Vertrag über Wirtschaftsprüfer checkbox");
					return;
				}
				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") == true && StammdatenblattVorhandenFileUploaded != true) {
				//    alert("Please Upload Stammdatenblatt vorhanden File");
				//    return;
				//}

				//if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") == true)
				//{
				//    if ($('#searchCompany').val() == "")
				//    {
				//        alert("Please provide value Wirtschaftspr�fer");
				//        return;
				//    }
				//    else if ($("#XMLFORM").find("#contacts").find('option:selected').val() == "")
				//    {
				//        alert("Please provide value WP Kontakt");
				//        return;
				//    }
				//}

				if ($('input:checkbox[id=ja_VATID]').prop("checked") != true && $('input:checkbox[id=Nein_VATID]').prop("checked") != true) {
					alert("Please provide value for EU-Ausländer Umsatzsteuer ID-NR. (VAT-ID) eingeholt checkbox");
					return;
				}
				var selectedContact = "";
				var accountid = "";
				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked")) {
					selectedContact = $("#XMLFORM").find("#contacts").find('option:selected').val();
					accountid = SelectedAccountIdinDropdown;
				}
				var Notizen = $("#XMLFORM").find("#NotizenId").val();
				var notes = $("#XMLFORM").find("#noteId").val();
				var vatid = $("#XMLFORM").find("#VATIDId").val();

				var entity = {};
				entity.ss_xmlcontinue = true;
				if ($('input:checkbox[id=ja_VATID]').prop("checked") == true) {
					entity.ss_euauslnder = true;
				}
				else {
					entity.ss_euauslnder = false;
				}

				if (MuttergesellschaftId != "" && MuttergesellschaftId != undefined) {
					entity["ss_Muttergesellschaft@odata.bind"] = "/accounts(" + MuttergesellschaftId + ")";
				}

				//if ($('input:checkbox[id=ja_StammdatenblattVorhanden]').prop("checked") == true) {
				//    entity.ss_stammdatenblattvorhanden = true;
				//}
				//else {
				//    entity.ss_stammdatenblattvorhanden = false;
				//}

				if ($('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop("checked") == true) {
					entity.ss_vertragberwirtschaftsprfer = true;
				}
				else {
					entity.ss_vertragberwirtschaftsprfer = false;
				}

				if (accountid != "") {
					entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts(" + accountid + ")";
				}
				if (selectedContact != undefined && selectedContact != "") {
					entity["ss_WPKontakt@odata.bind"] = "/contacts(" + selectedContact + ")";
				}
				if (Notizen != undefined && Notizen != "") {
					entity.ss_notizen = Notizen;
				}

				if (vatid != undefined && vatid != "") {
					entity.ss_vatid = vatid;
				}
				// entity.ss_fondsberichte = "";

				if (notes != undefined && notes != "") {
					entity.ss_notes = notes;
				}

				request++;
				showLoadingMessage();
				$(".loder-text p").html("Updating Workflow...");

				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							request++;
							$(".loder-text p").html("Populating Data.. ");
							// ExcelParsing(excelFiletoParse);
							retrieveDummyRecords();
							document.getElementById("cntBtnsaveXml").disabled = true;
							$("#XMLFORM :input").attr("disabled", true);
							document.getElementById("verifiedByXMLtxt").disabled = false;

							//hideLoadingMessage();
							//alert("Daten wurden gespeichert");
							request--;
							if (request == 0) {
								hideLoadingMessage();
								$(".loder-text p").html("");
								updateOpportunityAccount(ChicklistEnitityId);

							}
						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in SaveXMLData function");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));


			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in SaveXMLData");
			}
		}
		function uncheckotherBoxIncaseofStammdatenblattVorhanden(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_VertraguberWirtschaftsprufer" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_VertraguberWirtschaftsprufer]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_VertraguberWirtschaftsprufer" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_VertraguberWirtschaftsprufer]').prop('checked', false);
			}
			//updateRealAccount(checkbox);
		}
		function uncheckotherBoxIncaseofVATID(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_VATID" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_VATID]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_VATID" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_VATID]').prop('checked', false);
			}
			//updateRealAccount(checkbox);
		}
		function uncheckotherCheckBoxIncaseofStammdatenblattVorhanden(checkbox) {
			if ($(checkbox).prop("checked") == false) {
				$(checkbox).prop('checked', true)
			}
			if ($(checkbox).attr("id") == "ja_StammdatenblattVorhanden" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=Nein_StammdatenblattVorhanden]').prop('checked', false);
			}
			else if ($(checkbox).attr("id") == "Nein_StammdatenblattVorhanden" && $(checkbox).prop("checked") == true) {
				$('input:checkbox[id=ja_StammdatenblattVorhanden]').prop('checked', false);
			}
		}
		//Method to look for the searched account in the crm
		function SearchAccount() {
			try {
				showLoadingMessage();
				var accounttobeSearch = $('#searchCompany').val();
				$('#contacts').find('option').remove();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?$select=accountid,name&$filter=contains(name, '" + accounttobeSearch + "')", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							var html = "";
							if (results.value.length > 0) {
								for (var i = 0; i < results.value.length; i++) {
									var accountid = results.value[i]["accountid"];
									var name = results.value[i]["name"];

									html += "<tr id='" + accountid + "' onclick='selectAccount(this)'><td>" + name + "</td></tr>";

								}
							}
							else {
								html += "<tr id='norecordfound' onclick='selectAccount(this)'><td>No similar Account Found </td></tr>";

							}

							$("#tblsearchResult").css("display", "block")

							$("#dataTable").html(html);
							hideLoadingMessage();
							$(".loder-text p").html("");


						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in SearchAccount function");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in SearchAccount");
			}
		}
		//Method to set the selected account in the seach box from list of accounts when user search account
		function selectAccount(row) {
			try {
				SelectedAccountIdinDropdown = $(row).attr('id')
				if (SelectedAccountIdinDropdown != "norecordfound") {


					var accountName = $(row).closest('tr').children('td:eq(0)').text();
					$("#tblsearchResult").css("display", "none")
					$('#searchCompany').val(accountName)

					var req = new XMLHttpRequest();
					req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/contacts?$select=contactid,fullname&$filter=_parentcustomerid_value eq " + SelectedAccountIdinDropdown, true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 200) {
								var results = JSON.parse(this.response);
								if (results != null) {
									$('#contacts').find('option').remove();

									$("#contacts").append("<option value='' selected='selected'></option>");
									for (var i = 0; i < results.value.length; i++) {
										var contactid = results.value[i]["contactid"];
										var fullname = results.value[i]["fullname"];

										$('#contacts').append($("<option></option>").attr("value", contactid).text(fullname));
									}
								}

								//added by saad
								//updateRealAccount(row);
								//saad

							} else {
								hideLoadingMessage();
								$(".loder-text p").html("");
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "selectAccount");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send();
				}
				else {
					$("#tblsearchResult").css("display", "none")
					$('#contacts').find('option').remove();
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in selectAccount");
			}
		}
		function uploadStammdatenblattFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					fileInput = "";
					fileName = "";
					var filecounter = 0;
					//fileInput = jQuery('#StammdatenblattFile');
					var files = document.getElementById('StammdatenblattFile').files;
					if (files.length > 0) {
						showLoadingMessage();
						$(".loder-text p").html("Uploading Files to Sharepoint.. ");

						for (var i = 0; i < files.length; i++) {
							f = files[i];
							// fileName = f.name
							var reader = new FileReader();

							reader.onload = function (evt) {
								fileName = evt.target.fileName
								var str = _arrayBufferToBase64(evt.target.result);
								var DistinationUrl = soapCall(str);
								StammdatenblattVorhandenFileUploaded = true;
								var entity = {};

								var req1 = new XMLHttpRequest();
								req1.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=ss_stammdatenblatturl", false);
								req1.setRequestHeader("OData-MaxVersion", "4.0");
								req1.setRequestHeader("OData-Version", "4.0");
								req1.setRequestHeader("Accept", "application/json");
								req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req1.onreadystatechange = function () {
									if (this.readyState === 4) {
										req1.onreadystatechange = null;
										if (this.status === 200) {
											var result = JSON.parse(this.response);
											var ss_stammdatenblatturl = result["ss_stammdatenblatturl"];
											if (ss_stammdatenblatturl == null) {
												entity.ss_stammdatenblatturl = DistinationUrl;
											}
											else {
												entity.ss_stammdatenblatturl = ss_stammdatenblatturl + " " + DistinationUrl;
											}

											var req = new XMLHttpRequest();
											req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
											req.setRequestHeader("OData-MaxVersion", "4.0");
											req.setRequestHeader("OData-Version", "4.0");
											req.setRequestHeader("Accept", "application/json");
											req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
											req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
											req.onreadystatechange = function () {
												if (this.readyState === 4) {
													req.onreadystatechange = null;
													if (this.status === 204) {
														//Success - No Return Data - Do Something

													} else {
														hideLoadingMessage();
														$(".loder-text p").html("");
														var errorText = JSON.parse(this.responseText).error.message;
														exceptionMessage(errorText);
														LogExceptioninCRM(errorText, this.status, "error in uploadStammdatenblattFile function");
														// opener.Xrm.Utility.alertDialog(this.responseText);
														window.close();
													}
												}
											};
											req.send(JSON.stringify(entity));

										} else {
											hideLoadingMessage();
											$(".loder-text p").html("");
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadStammdatenblattFile function 2");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
											return;
										}
									}
								};
								req1.send();
							}
							reader.onloadend = function () {
								filecounter++;

								if (filecounter == files.length) {
									hideLoadingMessage();
									$(".loder-text p").html("");

									alert("Datei wurde zum Sharepoint hochgeladen");
								}
							}

							reader.fileName = f.name;
							reader.count = i;
							reader.readAsArrayBuffer(f);
						}


					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadStammdatenblattFile");
			}
		}

		//Method for uploading Vertrag File into sharepoint
		function uploadVertragFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				var filecounter = 0;
				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					fileInput = "";
					parts = "";
					fileName = "";
					fileInput = jQuery('#VertragFile');
					var files = document.getElementById('VertragFile').files;
					if (files.length > 0) {
						showLoadingMessage();
						$(".loder-text p").html("Uploading Files to Sharepoint.. ");

						for (var i = 0; i < files.length; i++) {
							f = files[i];
							var reader = new FileReader();

							reader.onload = function (evt) {
								fileName = evt.target.fileName
								var str = _arrayBufferToBase64(evt.target.result);
								var DistinationUrl = soapCall(str);


								var entity = {};

								var req1 = new XMLHttpRequest();
								req1.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=ss_vertragurl", false);
								req1.setRequestHeader("OData-MaxVersion", "4.0");
								req1.setRequestHeader("OData-Version", "4.0");
								req1.setRequestHeader("Accept", "application/json");
								req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req1.onreadystatechange = function () {
									if (this.readyState === 4) {
										req1.onreadystatechange = null;
										if (this.status === 200) {
											var result = JSON.parse(this.response);
											var ss_vertragurl = result["ss_vertragurl"];
											if (ss_vertragurl == null) {
												entity.ss_vertragurl = DistinationUrl;
											}
											else {
												entity.ss_vertragurl = ss_vertragurl + " " + DistinationUrl;
											}

											var req = new XMLHttpRequest();
											req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
											req.setRequestHeader("OData-MaxVersion", "4.0");
											req.setRequestHeader("OData-Version", "4.0");
											req.setRequestHeader("Accept", "application/json");
											req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
											req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
											req.onreadystatechange = function () {
												if (this.readyState === 4) {
													req.onreadystatechange = null;
													if (this.status === 204) {
														//Success - No Return Data - Do Something

													} else {
														hideLoadingMessage();
														$(".loder-text p").html("");
														var errorText = JSON.parse(this.responseText).error.message;
														exceptionMessage(errorText);
														LogExceptioninCRM(errorText, this.status, "error in uploadVertragFile");
														//opener.Xrm.Utility.alertDialog(this.responseText);
														window.close();
														return;
													}
												}
											};
											req.send(JSON.stringify(entity));

										}
										else {
											hideLoadingMessage();
											$(".loder-text p").html("");
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadVertragFile 2");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
											return;
										}
									}
								};
								req1.send();
							}
							reader.onloadend = function () {
								filecounter++;
								if (filecounter == files.length) {
									hideLoadingMessage();
									$(".loder-text p").html("");

									alert("Datei wurde zum Sharepoint hochgeladen");
								}
							}

							reader.fileName = f.name;
							reader.count = i;
							reader.readAsArrayBuffer(f);
						}
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadVertragFile");
			}
		}

		//Method for uploading Firmenliste File into sharepoint
		function uploadFirmenlisteFile() {
			try {
				if (SharepointFolder == null || SharepointFolder == "") {
					SharepointFolder = createSharepointFolder();
				}
				fileuploaded = false;
				fileInput = jQuery('#FirmenlisteFile');
				if (fileInput[0].files.length > 0) {
					parts = fileInput[0].value.split('\\');
					fileName = parts[parts.length - 1];
					var ext = fileName.split(".");
					if (ext[1] != 'xls' && ext[1] != 'xlsx') {
						alert("Please upload a FirmaList file of type xls or xlsx");
						return;
					}
				}

				if (confirm('Sind Sie sicher, diese Datei hochzuladen ?')) {
					showLoadingMessage();
					$(".loder-text p").html("Please Wait.. ");
					fileInput = "";
					parts = "";
					fileName = "";
					fileInput = jQuery('#FirmenlisteFile');
					if (fileInput[0].files.length > 0) {

						parts = fileInput[0].value.split('\\');
						fileName = parts[parts.length - 1];
						var reader = new FileReader();

						reader.onload = function (evt) {

							var data = reader.result;
							var result;
							var arr = fixdata(data);
							var workbook = XLSX.read(btoa(arr), { type: 'base64' });
							var loopCount = 0;
							var sheet_name_list = workbook.SheetNames;
							sheet_name_list.forEach(function (y) { /* iterate through sheets */
								//Convert the cell value to Json
								loopCount = loopCount + 1;
								var roa = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
								if (roa.length > 0) {
									if (loopCount == 1) {
										result = roa;
									}
								}
							});


							if (result[0]["Firmenname"] == undefined && result[0]["Strasse, Hausnummer"] == undefined && result[0]["PLZ"] == undefined && result[0]["Ort"] == undefined) {
								alert("The uploaded Firmenliste File is invalid. Please upload a valid File.");

								$(".loder-text p").html("");
								hideLoadingMessage();
								return;
							}


							$(".loder-text p").html("Uploading Files to Sharepoint.. ");

							var str = _arrayBufferToBase64(reader.result);
                            //need to test this statement
							firmnlistDestinationUrl = soapCall(str);

							if (firmnlistDestinationUrl) {
								document.getElementById("FirmenlisteFile").disabled = true;

								var entity = {};
								entity.ss_firmenlisturl = firmnlistDestinationUrl;

								var req = new XMLHttpRequest();
								req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
								req.setRequestHeader("OData-MaxVersion", "4.0");
								req.setRequestHeader("OData-Version", "4.0");
								req.setRequestHeader("Accept", "application/json");
								req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req.onreadystatechange = function () {
									if (this.readyState === 4) {
										req.onreadystatechange = null;
										if (this.status === 204) {
											//   hideLoadingMessage();
											//   $(".loder-text p").html("");
											// if (fileuploaded == true) {
											// alert("Datei wurde zum Sharepoint hochgeladen");
											//   }
										} else {
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in uploadFirmenlisteFile");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
										}
									}
								};
								req.send(JSON.stringify(entity));
							}

							excelFiletoParse = fileInput[0].files[0];
							// ExcelParsing(fileInput[0].files[0])
						}
						reader.onloadend = function () {
							createDummyAccountsAndContact();

						}
						reader.readAsArrayBuffer(fileInput[0].files[0]);
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in uploadFirmenlisteFile");
			}
		}
		function createDummyAccountsAndContact() {

			$(".loder-text p").html("Saving the file records");
			document.getElementById("accountList").style.visibility = "hidden";
			ExcelParsing(excelFiletoParse);

		}
		//Making a soap call to request the Action
		function soapCall(str) {
			fileuploaded == false;
			var errorcounter = 0;
			try {


				SharepointFolder = SharepointFolder.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");
				// Creating the request XML for calling the Action
				var requestXML = "";
				requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
				requestXML += "<s:Body>";
				requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
				requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

				requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";
				requestXML += "<a:KeyValuePairOfstringanyType>";
				requestXML += "<b:key>FileName</b:key>";
				requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + SharepointFolder + "/" + fileName + "</b:value>";
				requestXML += "</a:KeyValuePairOfstringanyType>";

				requestXML += "<a:KeyValuePairOfstringanyType>";
				requestXML += "<b:key>FileStream</b:key>";
				requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + str + "</b:value>";
				requestXML += "</a:KeyValuePairOfstringanyType>";

				requestXML += "</a:Parameters>";
				requestXML += "<a:RequestId i:nil=\"true\" />";
				requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
				requestXML += "</request>";
				requestXML += "</Execute>";
				requestXML += "</s:Body>";
				requestXML += "</s:Envelope>";

				var req = new XMLHttpRequest();
				req.open("POST", GetClientUrl(), false)
				req.setRequestHeader("Accept", "application/xml, text/xml, */*");
				req.setRequestHeader("Content-Type", "text/xml; charset=utf-8");

				//req.setRequestHeader("Accept", "application/json");
				//req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

				req.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
				req.send(requestXML);
				if (req.status == 200) {
					var result = JSON.stringify(req.response);
					fileuploaded == true;
					//var DistinationUrl = $(req.responseXML).find('ExecuteResult').find('KeyValuePairOfstringanyType').find('value')[0].innerHTML;
					//$(req.responseXML).find('ExecuteResult')[0].textContent
					var DistinationUrl = "";
					if ($(req.responseXML).find('ExecuteResult')[0].textContent != undefined && $(req.responseXML).find('ExecuteResult')[0].textContent != null && $(req.responseXML).find('ExecuteResult')[0].textContent != "") {
						var a = $(req.responseXML).find('ExecuteResult')[0].textContent;
						DistinationUrl = a.replace("ss_ActionXMLChecklistIntegrationFileUploadingtoSharepointFileUrl", "");

					}

                    //commented this lane for testing purpose
					return DistinationUrl;
				}
				else if (req.status != 200) {


					var errorText = $(req.responseText).find("Message")[0].innerHTML;
					// var errorText = JSON.parse(req1.responseText).error.message;
					exceptionMessage(errorText);
					LogExceptioninCRM(errorText, this.status, "error in soapCall");

					errorcounter++;
					if (errorcounter <= 2) {
						$(".loder-text p").html("Retrying ..." + errorcounter);
						soapCall(str);
					}
					else {
						hideLoadingMessage();
						$(".loder-text p").html("");

						alert("file Could not be uploaded please try again");
						var errorText = $(req.responseText).find("Message")[0].innerHTML;
						// var errorText = JSON.parse(req1.responseText).error.message;
						exceptionMessage(errorText);
						LogExceptioninCRM(errorText, this.status, "error in soapCall 2");
						//var errorText = JSON.parse(this.responseText).error.message;
						//exceptionMessage(errorText);
						window.close();
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in soapCall 3");
				console.log(e.message);
				window.close();
			}
		}

		function GetClientUrl() {
			if (typeof opener.Xrm.Page.context == "object") {
				clientUrl = opener.Xrm.Page.context.getClientUrl();
			}
			var ServicePath = "/XRMServices/2011/Organization.svc/web";
			return clientUrl + ServicePath;
		}

		function getBase64() {

			var reader = new FileReader();
			reader.onload = function (evt) {
				var str = _arrayBufferToBase64(reader.result);
				return str;
			}
			reader.readAsArrayBuffer(fileInput[0].files[0]);
		}

		// Convert Array Buffer to Base 64 string
		function _arrayBufferToBase64(buffer) {
			var binary = '';
			var bytes = new Uint8Array(buffer);
			var len = bytes.byteLength;
			for (var i = 0; i < len; i++) {
				binary += String.fromCharCode(bytes[i]);
			}
			return window.btoa(binary);
		}

		//parsing method of excel file which contains the list of company
		function ExcelParsing(file) {
			try {
				var i, f;
				f = file;
				var counter = 0;
				var reader = new FileReader();
				// var name = f.name;
				reader.onload = function (e) {
					var data = e.target.result;

					var result;
					var arr = fixdata(data);
					var workbook = XLSX.read(btoa(arr), { type: 'base64' });
					var loopCount = 0;
					var sheet_name_list = workbook.SheetNames;
					sheet_name_list.forEach(function (y) { /* iterate through sheets */
						//Convert the cell value to Json
						loopCount = loopCount + 1;
						var roa = XLSX.utils.sheet_to_json(workbook.Sheets[y]);
						if (roa.length > 0) {
							if (loopCount == 1) {
								result = roa;
							}
						}
					});
					//Get the first column first cell value

					var COLOR1 = "#A9A9A9";
					var COLOR2 = "#FFA500";
					var bgcolor = "#A9A9A9";
					// showLoadingMessage();
					var AbweichendeRechnungsanschrift = false;

					for (var x = 0; x < result.length; x++) {
						if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "") {
							bgcolor = bgcolor == COLOR1 ? COLOR2 : COLOR1;
							counter += 1;
							var account = '<form style="background-color:' + bgcolor + '" id="form' + counter + '" class="form-style fixed-height">' +
							'<div class="row form-inline form-group">' +
								' <div class="col-md-3">' +
									'<label class="control-label">Firma' + counter + ':</label>' +
									'<label class="checkbox-inline">' +
										'   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" value="">Mutter' +
									' </label>' +
								' </div>' +
								'<div class="col-md-4">' +
									' <label class="control-label">EQS-ID:</label>' +
									'<input name="EQS-ID" type="text" class="form-control input-sm" readonly/>' +
									//'<p class="text-muted text-center"> "Account" [bbo_equitystoryid]</p>'+
								'</div>' +
								'<div class="col-md-5">' +
									' <label class="control-label">Kunden-Nr:</label>' +
									'<input name="Kunden-Nr" type="text" class="form-control input-sm" />' +
									//'<p class="text-muted text-center"> "Account" [ss_companyadminid]</p>'+
								' </div>' +
							' </div>' +
							'<div class="row form-group">' +
								'<div class="col-md-5">' +
									' <label class="control-label">Firmenname:</label>';

							if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "") {
								companiesName.push(result[x]["Firmenname"]);
								account += ' <input type="text" name="FirmennameId" value = "' + result[x]["Firmenname"] + '" maxlength="160" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="FirmennameId" maxlength="160" class="form-control input-sm" />';
							}

							account += '</div>' +
										'<div class="col-md-2">' +
											' <label class="control-label">Strasse:</label>';


							if (result[x]["Strasse, Hausnummer"] != undefined && result[x]["Strasse, Hausnummer"] != null && result[x]["Strasse, Hausnummer"] != "") {
								var names = "";
								var firstDigit = result[x]["Strasse, Hausnummer"].match(/\d/); //will give you the first digit in the string
								var index = result[x]["Strasse, Hausnummer"].indexOf(firstDigit);
								names = result[x]["Strasse, Hausnummer"].substring(0, index);
								var numberss = result[x]["Strasse, Hausnummer"].substring(index, result[x]["Strasse, Hausnummer"].length);

								account += ' <input type="text" name="StrasseId" value = "' + names + '" maxlength="180" class="form-control input-sm" />';
								account += ' </div>' +
									   '<div class="col-md-2">' +
										   '  <label class="control-label">Nr.:</label>' +
										   '  <input type="text" name="NrId" value = "' + numberss + '" maxlength="75" class="form-control input-sm"  />' +
									   '  </div>';
							}
							else {
								account += ' <input type="text" name="StrasseId" maxlength="180" class="form-control input-sm"  />';
								account += ' </div>' +
									   '<div class="col-md-2">' +
										   '  <label class="control-label">Nr.:</label>' +
										   '  <input type="text" name="NrId" maxlength="75" class="form-control input-sm"  />' +
									   '  </div>';

							}

							account += ' <div class="col-md-2">' +
											' <label class="control-label">PLZ:</label>';

							if (result[x]["PLZ"] != undefined && result[x]["PLZ"] != null && result[x]["PLZ"] != "") {
								account += ' <input type="text" name="PLZId" value = "' + result[x]["PLZ"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="PLZId" maxlength="10" class="form-control input-sm"  />';

							}
							account += '  </div>' +
										 ' <div class="col-md-2">' +
											 ' <label class="control-label">Ort:</label>';

							if (result[x]["Ort"] != undefined && result[x]["Ort"] != null && result[x]["Ort"] != "") {
								account += ' <input type="text" name="OrtId" value = "' + result[x]["Ort"] + '" maxlength="30" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="OrtId" maxlength="30" class="form-control input-sm"  />';

							}
							account += '</div>' +
										'</div> <div class="row form-group"> </div>';


							account += '<div class="row form-group">' +
											' <div class="col-md-3">' +
												'<label class="control-label">Gesellschaftsgröße.:</label>';
							if (result[x]["Gesellschaftsgröße"] != undefined && result[x]["Gesellschaftsgröße"] != null && result[x]["Gesellschaftsgröße"] != "") {
								account += ' <input type="text" name="GesellschatsgrId" value="' + result[x]["Gesellschaftsgröße"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="GesellschatsgrId" maxlength="10" class="form-control input-sm" />';
							}
							'</div>' +
							' <div class="col-md-4">' +
								' <label class="control-label">Homepage:</label>';

							if (result[x]["Homepage"] != undefined && result[x]["Homepage"] != null && result[x]["Homepage"] != "") {
								account += ' <input type="text" name="HomepageId" value = "' + result[x]["Homepage"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="HomepageId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										' <div class="col-md-4">' +
											' <label class="control-label">Allgemeine Email:</label>';

							if (result[x]["Allg. Email z.B. info@..."] != undefined && result[x]["Allg. Email z.B. info@..."] != null && result[x]["Allg. Email z.B. info@..."] != "") {
								account += ' <input type="text" name="AllgemeineEmailId" value = "' + result[x]["Allg. Email z.B. info@..."] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="AllgemeineEmailId" class="form-control input-sm"  />';

							}


							account += ' </div>' +
										  '  </div>' +
										  '<div class="row form-group">' +
											  ' <div class="col-md-2">' +
												  '<label class="control-label">Anrede</label>';
							if (result[x]["Ansprechpartner Anrede: Frau/Herr"] != undefined && result[x]["Ansprechpartner Anrede: Frau/Herr"] != null && result[x]["Ansprechpartner Anrede: Frau/Herr"] != "") {
								account += ' <input type="text" name="AnredeId" value = "' + result[x]["Ansprechpartner Anrede: Frau/Herr"] + '" maxlength="10" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="AnredeId" maxlength="10" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 ' <label class="control-label">Vorname</label>';

							if (result[x]["Vorname"] != undefined && result[x]["Vorname"] != null && result[x]["Vorname"] != "") {
								account += ' <input type="text" name="VornameId" value = "' + result[x]["Vorname"] + '" maxlength="32" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="VornameId" maxlength="32" class="form-control input-sm"  />';

							}
							account += ' </div>' +
										' <div class="col-md-2">' +
											'  <label class="control-label">Nachname</label>';
							if (result[x]["Name"] != undefined && result[x]["Name"] != null && result[x]["Name"] != "") {
								account += ' <input type="text" name="NachnameId" value = "' + result[x]["Name"] + '" maxlength="32" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="NachnameId" maxlength="32" class="form-control input-sm"  />';

							}


							account += ' </div>' +
										'  <div class="col-md-2">' +
											'  <label class="control-label">Telefon</label>';
							if (result[x]["Telefon"] != undefined && result[x]["Telefon"] != null && result[x]["Telefon"] != "") {
								account += ' <input type="text" name="TelefonId" value = "' + result[x]["Telefon"] + '" maxlength="22" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="TelefonId" maxlength="22" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										' <div class="col-md-2">' +
											' <label class="control-label">Fax</label>';
							if (result[x]["Fax"] != undefined && result[x]["Fax"] != null && result[x]["Fax"] != "") {
								account += ' <input type="text" name="FaxId" value = "' + result[x]["Fax"] + '" maxlength="22" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="FaxId" maxlength="22" class="form-control input-sm"  />';

							}


							account += ' </div>' +
							 ' <div class="col-md-2">' +
								 ' <label class="control-label">Email</label>';
							if (result[x]["Email"] != undefined && result[x]["Email"] != null && result[x]["Email"] != "") {
								account += ' <input type="text" name="EmailId" value = "' + result[x]["Email"] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="EmailId" class="form-control input-sm"  />';

							}

							account += '  </div>' +
										 ' </div>' +
										 ' <div class="row form-group">' +
											 '<div class="col-md-3">' +
												 ' <label class="control-label">Art der Gesellschaft</label>';
							if (result[x]["Art der Gesellschaft"] != undefined && result[x]["Art der Gesellschaft"] != null && result[x]["Art der Gesellschaft"] != "") {
								account += ' <input type="text" name="ArtderGesellschaftId" value = "' + result[x]["Art der Gesellschaft"] + '" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="ArtderGesellschaftId" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 '<div class="col-md-2">' +
											 '  <label class="control-label">Registerart</label>';
							if (result[x]["Registerart"] != undefined && result[x]["Registerart"] != null && result[x]["Registerart"] != "") {
								account += ' <input type="text" name="RegisterartId" value = "' + result[x]["Registerart"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="RegisterartId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 '  <label class="control-label">R-Nr.:</label>';

							if (result[x]["Reg.-Nr."] != undefined && result[x]["Reg.-Nr."] != null && result[x]["Reg.-Nr."] != "") {
								account += ' <input type="text" name="R-NrId" value = "' + result[x]["Reg.-Nr."] + '" maxlength="50" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="R-NrId" maxlength="50"  class="form-control input-sm"  />';

							}

							account += ' </div>' +
							  ' <div class="col-md-2">' +
								  '  <label class="control-label">Ort:</label>';

							if (result[x]["Amtsgericht"] != undefined && result[x]["Amtsgericht"] != null && result[x]["Amtsgericht"] != "") {
								account += ' <input type="text" name="Ort1Id" value = "' + result[x]["Amtsgericht"] + '" maxlength="50" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="Ort1Id" maxlength="50" class="form-control input-sm"  />';

							}

							account += ' </div>' +
										 ' <div class="col-md-2">' +
											 '  <label class="control-label">Rechtsform</label>';
							if (result[x]["Rechtsform"] != undefined && result[x]["Rechtsform"] != null && result[x]["Rechtsform"] != "") {
								account += ' <input type="text" name="RechtsformId" value = "' + result[x]["Rechtsform"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="RechtsformId" maxlength="100" class="form-control input-sm"  />';

							}

							account += '  </div>' +
										' <div class="col-md-3">' +
											' <label class="control-label">Steuerschlüssel</label>';
							if (result[x]["Steuerschlüssel"] != undefined && result[x]["Steuerschlüssel"] != null && result[x]["Steuerschlüssel"] != "") {
								account += ' <input type="text" name="SteuerschlüsselId" value = "' + result[x]["Steuerschlüssel"] + '" maxlength="100" class="form-control input-sm" />';
							}
							else {
								account += ' <input type="text" name="SteuerschlüsselId" maxlength="100" class="form-control input-sm"  />';

							}

							account += ' </div>' +
									  ' </div>' +
									  '  <div class="row form-group">' +
										  '  <div class="col-md-12">' +
											  ' <label class="control-label">Abweichende Rechnungsanschrift:</label>';

							if (result[x]["Firmenname"] != undefined && result[x]["Firmenname"] != null && result[x]["Firmenname"] != "" && result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "" && result[x]["Strasse, Hausnummer"] != undefined && result[x]["Strasse, Hausnummer"] != null && result[x]["Strasse, Hausnummer"] != "" && result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "" && result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "" && result[x]["Ort"] != undefined && result[x]["Ort"] != null && result[x]["Ort"] != "" && result[x]["PLZ"] != undefined && result[x]["PLZ"] != null && result[x]["PLZ"] != "" && result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
								if (result[x]["Firmenname"].toString().trim() == result[x]["Firmenname1"].toString().trim() && result[x]["Strasse, Hausnummer"].toString().trim() == result[x]["Strasse, Hausnummer1"].toString().trim() && result[x]["Ort1"].toString().trim() == result[x]["Ort"].toString().trim() && result[x]["PLZ"].toString().trim() == result[x]["PLZ1"].toString().trim()) {
									AbweichendeRechnungsanschrift = false;

									account += ' <label class="radio-inline">' +
								  ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" disabled="disabled">Ja' +
								  ' </label>' +
								  ' <label class="radio-inline">' +
									  '<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" checked="checked" disabled="disabled">Nein' +
								  '  </label>';

								}
								else {
									AbweichendeRechnungsanschrift = true;
									account += ' <label class="radio-inline">' +
									' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
									' </label>' +
									' <label class="radio-inline">' +
										'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
									'  </label>';
								}
							}
							else {
								AbweichendeRechnungsanschrift = true;
								account += ' <label class="radio-inline">' +
								' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
								' </label>' +
								' <label class="radio-inline">' +
									'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
								'  </label>';
							}

							if (AbweichendeRechnungsanschrift == true) {
								account += '  </div>' +
											 '  </div>' +
										 ' <div class="row form-group">' +
											 '  <div class="col-md-4">' +
												 ' <label class="control-label">Firmenname</label>';

								if (result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "") {
									account += ' <input type="text" name="Firmenname1Id" value = "' + result[x]["Firmenname1"] + '" maxlength="155" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Firmenname1Id" maxlength="155" class="form-control input-sm"  />';

								}

								account += ' </div>' +
														' <div class="col-md-2">' +
															' <label class="control-label">Vorname</label>';

								if (result[x]["Vorname1"] != undefined && result[x]["Vorname1"] != null && result[x]["Vorname1"] != "") {
									account += ' <input type="text" name="Vorname1Id" value = "' + result[x]["Vorname1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Vorname1Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += ' </div>' +
																	' <div class="col-md-2">' +
																		' <label class="control-label">Nachname</label>';

								if (result[x]["Name1"] != undefined && result[x]["Name1"] != null && result[x]["Name1"] != "") {
									account += ' <input type="text" name="NameId" value = "' + result[x]["Name1"] + '" maxlength="100" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="NameId" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Abteilung</label>';

								if (result[x]["Abteilung1"] != undefined && result[x]["Abteilung1"] != null && result[x]["Abteilung1"] != "") {
									account += ' <input type="text" name="AbteilungId" value = "' + result[x]["Abteilung1"] + '" maxlength="100" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="AbteilungId" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
								 ' <div class="col-md-3">' +
									 ' <label class="control-label">Strasse:</label>';
								if (result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "") {

									var names = "";
									var firstDigit = result[x]["Strasse, Hausnummer1"].match(/\d/); //will give you the first digit in the string
									var index = result[x]["Strasse, Hausnummer1"].indexOf(firstDigit);
									names = result[x]["Strasse, Hausnummer1"].substring(0, index);
									var numberss = result[x]["Strasse, Hausnummer1"].substring(index, result[x]["Strasse, Hausnummer1"].length);

									account += ' <input type="text" name="Strasse1Id" value = "' + names + '" maxlength="60" class="form-control input-sm" />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id" value = "' + numberss + '" maxlength="40" class="form-control input-sm" />' +
											' </div>';
								}
								else {
									account += ' <input type="text" name="Strasse1Id" maxlength="60" class="form-control input-sm"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id"  maxlength="40" class="form-control input-sm" />' +
											' </div>';

								}

								account += ' <div class="col-md-2">' +
										   ' <label class="control-label">PLZ:</label>';
								if (result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
									account += ' <input type="text" name="PLZ1Id" value = "' + result[x]["PLZ1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="PLZ1Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += '   </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Ort:</label>';
								if (result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "") {
									account += ' <input type="text" name="Ort2Id" value = "' + result[x]["Ort1"] + '" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Ort2Id" maxlength="32" class="form-control input-sm"  />';

								}

								account += '  </div>' +
										  '   </div>' +
										  '  <div class="row form-group">' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label">Telefon:</label>';
								if (result[x]["Telefon1"] != undefined && result[x]["Telefon1"] != null && result[x]["Telefon1"] != "") {
									account += ' <input type="text" name="Telefon1Id" value = "' + result[x]["Telefon1"] + '" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Telefon1Id" maxlength="22" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label">Fax:</label>';
								if (result[x]["Fax1"] != undefined && result[x]["Fax1"] != null && result[x]["Fax1"] != "") {
									account += ' <input type="text" name="Fax1Id" value = "' + result[x]["Fax1"] + '" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Fax1Id" maxlength="22" class="form-control input-sm"  />';

								}
								account += ' </div>' +
										   ' <div class="col-md-4">' +
											   ' <label class="control-label">Email:</label>';
								if (result[x]["E-Mail"] != undefined && result[x]["E-Mail"] != null && result[x]["E-Mail"] != "") {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["E-Mail"] + '" class="form-control input-sm" />';
								}
								else if (result[x]["Email"]) {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["Email"] + '" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="Email1Id" class="form-control input-sm"  />';

								}

								account += '</div>' +
											 ' </div>' +
											  '<hr style="border-top: dotted 2px;" />' +
											  '<div class="row form-group">' +
														  ' <div class="col-md-4">' +
															  '<label class="control-label">UREG</label>' +
																  '   <input name="UREGId" onchange="" maxlength="15" class="form-control input-sm" type="text">' +
														  ' </div>' +
														  '<div class="col-md-4">' +
															  ' <label class="control-label">Cockpit Type:</label>' +
															  '<select id="CockpitTypeDrp" class="form-control"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>' +

														  '</div>' +
														  '<div class="col-md-4">' +
															  ' <label class="control-label">Anzeige im Cockpit-Admin:</label>' +
															  '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
															  '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>' +
														  ' </div>' +
													  ' </div>' +
							  '  </form>';
							}
							else {
								account += '  </div>' +
										 '  </div>' +
									 ' <div class="row form-group">' +
										 '  <div class="col-md-4">' +
											 ' <label class="control-label" style="display:none" >Firmenname</label>';

								if (result[x]["Firmenname1"] != undefined && result[x]["Firmenname1"] != null && result[x]["Firmenname1"] != "") {
									account += ' <input type="text" name="Firmenname1Id" value = "' + result[x]["Firmenname1"] + '" maxlength="155" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Firmenname1Id" maxlength="155" class="form-control input-sm"  style="display:none" />';

								}


								account += ' </div>' +
														' <div class="col-md-2">' +
															' <label class="control-label" style="display:none" >Vorname</label>';

								if (result[x]["Vorname1"] != undefined && result[x]["Vorname1"] != null && result[x]["Vorname1"] != "") {
									account += ' <input type="text" name="Vorname1Id" value = "' + result[x]["Vorname1"] + '" maxlength="32" class="form-control input-sm" style="display:none" />';
								}
								else {
									account += ' <input type="text" name="Vorname1Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += ' </div>' +
																	' <div class="col-md-2">' +
																		' <label class="control-label" style="display:none" >Nachname</label>';

								if (result[x]["Name1"] != undefined && result[x]["Name1"] != null && result[x]["Name1"] != "") {
									account += ' <input type="text" name="NameId" value = "' + result[x]["Name1"] + '" maxlength="100" class="form-control input-sm"style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="NameId" maxlength="100" class="form-control input-sm"  style="display:none" />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Abteilung</label>';

								if (result[x]["Abteilung1"] != undefined && result[x]["Abteilung1"] != null && result[x]["Abteilung1"] != "") {
									account += ' <input type="text" name="AbteilungId" value = "' + result[x]["Abteilung1"] + '" maxlength="100" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="AbteilungId" maxlength="100" class="form-control input-sm" style="display:none"   />';

								}

								account += ' </div>' +
								 ' <div class="col-md-3">' +
									 ' <label class="control-label" style="display:none" >Strasse:</label>';
								if (result[x]["Strasse, Hausnummer1"] != undefined && result[x]["Strasse, Hausnummer1"] != null && result[x]["Strasse, Hausnummer1"] != "") {

									var names = "";
									var firstDigit = result[x]["Strasse, Hausnummer1"].match(/\d/); //will give you the first digit in the string
									var index = result[x]["Strasse, Hausnummer1"].indexOf(firstDigit);
									names = result[x]["Strasse, Hausnummer1"].substring(0, index);
									var numberss = result[x]["Strasse, Hausnummer1"].substring(index, result[x]["Strasse, Hausnummer1"].length);

									account += ' <input type="text" name="Strasse1Id" value = "' + names + '"  maxlength="60" class="form-control input-sm" style="display:none"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Nr.:</label>' +
												' <input type="text" name="Nr1Id" value = "' + numberss + '"  maxlength="40" class="form-control input-sm" style="display:none"  />' +
											' </div>';
								}
								else {
									account += ' <input type="text" name="Strasse1Id"  maxlength="60" class="form-control input-sm" style="display:none"  />';
									account += '</div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Nr.:</label>' +
												' <input type="text" name="Nr1Id" maxlength="40" class="form-control input-sm" style="display:none"  />' +
											' </div>';

								}

								account += ' <div class="col-md-2">' +
										   ' <label class="control-label" style="display:none" >PLZ:</label>';
								if (result[x]["PLZ1"] != undefined && result[x]["PLZ1"] != null && result[x]["PLZ1"] != "") {
									account += ' <input type="text" name="PLZ1Id" value = "' + result[x]["PLZ1"] + '" maxlength="32" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="PLZ1Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += '   </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label" style="display:none" >Ort:</label>';
								if (result[x]["Ort1"] != undefined && result[x]["Ort1"] != null && result[x]["Ort1"] != "") {
									account += ' <input type="text" name="Ort2Id" value = "' + result[x]["Ort1"] + '" maxlength="32" class="form-control input-sm" style="display:none" />';
								}
								else {
									account += ' <input type="text" name="Ort2Id" maxlength="32" class="form-control input-sm" style="display:none"  />';

								}

								account += '  </div>' +
										  '   </div>' +
										  '  <div class="row form-group">' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label" style="display:none" >Telefon:</label>';
								if (result[x]["Telefon1"] != undefined && result[x]["Telefon1"] != null && result[x]["Telefon1"] != "") {
									account += ' <input type="text" name="Telefon1Id" value = "' + result[x]["Telefon1"] + '" maxlength="22" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Telefon1Id" maxlength="22" class="form-control input-sm" style="display:none"  />';

								}


								account += ' </div>' +
											  ' <div class="col-md-4">' +
												  '  <label class="control-label" style="display:none" >Fax:</label>';
								if (result[x]["Fax1"] != undefined && result[x]["Fax1"] != null && result[x]["Fax1"] != "") {
									account += ' <input type="text" name="Fax1Id" value = "' + result[x]["Fax1"] + '"  maxlength="22" class="form-control input-sm" style="display:none"  />';
								}
								else {
									account += ' <input type="text" name="Fax1Id"  maxlength="22" class="form-control input-sm"  />';

								}
								account += ' </div>' +
										   ' <div class="col-md-4">' +
											   ' <label class="control-label" style="display:none" >Email:</label>';
								if (result[x]["E-Mail"] != undefined && result[x]["E-Mail"] != null && result[x]["E-Mail"] != "") {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["E-Mail"] + '" class="form-control input-sm" style="display:none" />';
								}
								else if (result[x]["Email"]) {
									account += ' <input type="text" name="Email1Id" value = "' + result[x]["Email"] + '" class="form-control input-sm" style="display:none"/>';
								}
								else {
									account += ' <input type="text" name="Email1Id" class="form-control input-sm"  style="display:none"/>';

								}

								account += '</div>' +
											' </div>' +
											 '<hr style="border-top: dotted 2px;" />' +
											 '<div class="row form-group">' +
														 ' <div class="col-md-4">' +
															 '<label class="control-label">UREG</label>' +
																 '   <input name="UREGId" onchange="" maxlength="15" class="form-control input-sm" type="text">' +
														 ' </div>' +
														 '<div class="col-md-4">' +
															 ' <label class="control-label">Cockpit Type:</label>' +
															 '<select id="CockpitTypeDrp" class="form-control"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>' +

														 '</div>' +
														 '<div class="col-md-4">' +
															 ' <label class="control-label">Anzeige im Cockpit-Admin:</label>' +
															 '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
															 '<label><input onchange="updateKundenGruppe(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>' +
														 ' </div>' +
													 ' </div>' +
							 '  </form>';
							}


							document.getElementById("accountList").innerHTML += account;

						}
					}
					if (companiesName.length > 0) {
						SimilarAccounts();
					}
					else {
						request--
						if (request == 0) {
							hideLoadingMessage();
							$(".loder-text p").html("");

						}

					}

					// $("#verifiedByXMLtxt").css("display", "block");
					// $("#varifiedByXMLlbl").css("display", "block");

					displayDownloadLinks();

					//var tr = "";
					//for (var x = 0; x < result.length; x++) {
					//    tr += "<tr><td>" + result[x]["Name"] + "</td><td>" + result[x]["Email"] + "</td><td>" + result[x]["Stock Exchange"] + "</td></tr>";
					//}
					//document.getElementById("ExcelFile").innerHTML = tr;
				};
				reader.onloadend = function () {
					createUpdateDummyAccounts();
					//   alert("File Parsed Succefully.");
					hideLoadingMessage();
				}
				reader.readAsArrayBuffer(f);
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in ExcelParsing");
			}

		}

		function CheckAbweichendeRechnungsanschrift(radio) {
			//if (radio.value == "Ja")
			//{
			//    $(radio).closest('form').find('input[name="Firmenname1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Strasse1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Nr1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="PLZ1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Ort2Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Telefon1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Fax1Id"]').prop('disabled', false);
			//    $(radio).closest('form').find('input[name="Email1Id"]').prop('disabled', false);

			//}
			//else if (radio.value == "Nein")
			//{
			//    $(radio).closest('form').find('input[name="Firmenname1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Strasse1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Nr1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="PLZ1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Ort2Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Telefon1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Fax1Id"]').prop('disabled', true);
			//    $(radio).closest('form').find('input[name="Email1Id"]').prop('disabled', true);
			//}

		}
		//in this method we are checking the companies given in excel file in CRM
		function SimilarAccounts() {
			try {
				var filter = "";

				//for (var i = 0; i < companiesName.length; i++)
				//{
				//    if (filter == "") {
				//        filter += "contains(name, '" + encodeURIComponent(companiesName[i]) + "')";
				//    }
				//    else {
				//        filter += " or contains(name, '" + encodeURIComponent(companiesName[i]) + "')";
				//    }
				//}

				for (var i = 0; i < companiesName.length; i++) {
					if (filter == "") {
						filter += "name eq '" + encodeURIComponent(companiesName[i]) + "'";
					}
					else {
						filter += " or name eq '" + encodeURIComponent(companiesName[i]) + "'";
					}
				}


				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.0/accounts?$select=accountid,name&$filter=" + filter, true);
				//req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.0/accounts?fetchXml=" + encodeURI(fetch), true);

				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {

							var results = JSON.parse(this.response);
							for (var i = 0; i < results.value.length; i++) {
								var accountid = results.value[i]["accountid"];
								var name = results.value[i]["name"];
								var machingname = "";
								var dropdown = "<select id='similarAccountdrp' class='form-control' onchange='retrieveDataFromSimilarRecord(this)'>";
								dropdown += "<option value=''></option>";
								for (var j = 0; j < companiesName.length; j++) {
									if (companiesName[j] == name.trim()) {
										if (similarAccountId[j] == "") {

											dropdown += "<option value ='" + accountid + "'>" + name.trim() + "</option>";

										}
										else {
											if (accountid == similarAccountId[j]) {
												dropdown += "<option value ='" + accountid + "' selected='selected'>" + name.trim() + "</option>";
												similarAccountId[j] = "";
											}
											else
												dropdown += "<option value ='" + accountid + "'>" + name.trim() + "</option>";
										}

										machingname = companiesName[j];

									}
								}
								dropdown += "</select>";



								var similarAccountHtml = '<div class="col-md-3">' +
															  '<label class="control-label">Ähnlichkeiten in CRM:</label>' +
														   '</div>' +
														  '<div class="col-md-7">' +
														  dropdown +
														  '</div>';

								$('input[name="FirmennameId"]').each(function (i, elem) {
									if ($(elem).val() == machingname) {
										var element = $(elem).closest(".row").next()
										$(element).html(similarAccountHtml);
									}
								});

								if (similaraccountRetrieveFromDummyentity == accountid) {

								}

							}
							request--
							if (request == 0) {
								hideLoadingMessage();
								$(".loder-text p").html("");

							}


						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "SimilarAccounts");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in SimilarAccounts");
			}
		}

		function fixdata(data) {
			var o = "", l = 0, w = 10240;
			for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l * w + w)));
			o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
			return o;
		}

		//when Verified by XML checkbox has been checked
		function VerifiedByXML() {
			try {
				var mutterSelected = false;

				$("#accountList").find("[name='Mutter']").each(function (index, value) {
					if (value.checked == true) {
						mutterSelected = true;
					}
				});
				if (mutterSelected == false) {

					if (confirm('Keine Muttergesellschafts ausgewählt! Sind Sie sicher?')) {
						showLoadingMessage();
						UpdateDummyAccountEntity();
						if (confirm('Do you want to send Email to Newsroom Person?')) {
							var xmlUserName = opener.Xrm.Page.context.getUserName();
							var xmlUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
							// var xmlUserId = "D908C0FC-4408-E511-810B-C4346BACCE18";

							$(".loder-text p").html("Sending Email ");

							var entity = {};
							entity["ss_XmlUser@odata.bind"] = "/systemusers(" + xmlUserId + ")";
							entity.ss_verifiedbyxml = true;
							var req = new XMLHttpRequest();
							req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
							req.setRequestHeader("OData-MaxVersion", "4.0");
							req.setRequestHeader("OData-Version", "4.0");
							req.setRequestHeader("Accept", "application/json");
							req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
							req.onreadystatechange = function () {
								if (this.readyState === 4) {
									req.onreadystatechange = null;
									if (this.status === 204) {
										sendEmailToNewsroom();

										document.getElementById("verifiedByXMLtxt").disabled = true;
										document.getElementById("verifiedByNewsroomtxt").disabled = false;
										document.getElementById("continuebtn").disabled = true;
										$("#verifiedByXMLLookup").val(xmlUserName);
										hideLoadingMessage();
										$(".loder-text p").html("");





										//Success - No Return Data - Do Something
									} else {
										hideLoadingMessage();
										$(".loder-text p").html("");
										var errorText = JSON.parse(this.responseText).error.message;
										exceptionMessage(errorText);
										LogExceptioninCRM(errorText, this.status, "error in VerifiedByXML");
										// opener.Xrm.Utility.alertDialog(this.responseText);
										window.close();
									}
								}
							};
							req.send(JSON.stringify(entity));
						}
					}
				}
				else {
					showLoadingMessage();

					UpdateDummyAccountEntity();
					if (confirm('Do you want to send Email to Newsroom Person?')) {
						var xmlUserName = opener.Xrm.Page.context.getUserName();
						var xmlUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");

						$(".loder-text p").html("Sending Email ");

						var entity = {};
						if (xmlUserId != undefined && xmlUserId != null) {
							entity["ss_XmlUser@odata.bind"] = "/systemusers(" + xmlUserId + ")";
						}
						entity.ss_verifiedbyxml = true;
						var req = new XMLHttpRequest();
						req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
						req.setRequestHeader("OData-MaxVersion", "4.0");
						req.setRequestHeader("OData-Version", "4.0");
						req.setRequestHeader("Accept", "application/json");
						req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
						req.onreadystatechange = function () {
							if (this.readyState === 4) {
								req.onreadystatechange = null;
								if (this.status === 204) {
									sendEmailToNewsroom();

									document.getElementById("verifiedByXMLtxt").disabled = true;
									document.getElementById("verifiedByNewsroomtxt").disabled = false;
									document.getElementById("continuebtn").disabled = true;
									$("#verifiedByXMLLookup").val(xmlUserName);


									hideLoadingMessage();
									$(".loder-text p").html("");



									//Success - No Return Data - Do Something
								} else {
									hideLoadingMessage();
									$(".loder-text p").html("");

									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in VerifiedByXML");
									//  opener.Xrm.Utility.alertDialog(this.responseText);
									window.close();
								}
							}
						};
						req.send(JSON.stringify(entity));
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in VerifiedByXML");

			    //send email to Ron containing exception message
				sendExceptionEmail(e.message);
			    //send exception email
			}
		}

		function UpdateDummyAccountEntity() {
			try {
				$(".loder-text p").html("Updating Workflow ... ");
				var entityCollection = new Array();

				$("#accountList").find("form").each(function () {
					var form = $(this);
					var dummyAccountId = $(form[0]).attr("id")
					var selectFound = false;
					var entity = {};

					if (form[0]["OrtId"].localName == "select") {
						if (form[0]["OrtId"].value != "") {
							entity.ss_ort = form[0]["OrtId"].value;
							selectFound = true;
						}

					}
					if (form[0]["Ort1Id"].localName == "select") {
						if (form[0]["Ort1Id"].value != "") {

                            //changed by saad
							var ort1Obj = form[0]["Ort1Id"];
							//entity.ss_ort1 = $(ort1Obj).find(":selected").text();
						    //entity.ss_ort1value = form[0]["Ort1Id"].value;

							entity.ss_registergerichtoptionset = form[0]["Ort1Id"].value;

							entity.ss_amtsgericht = $(ort1Obj).find(":selected").text();//changed M107A3
							entity.ss_amtsgerichtvalue = form[0]["Ort1Id"].value;
							selectFound = true;
						}

					}

					if (form[0]["SteuerschlüsselId"].localName == "select") {
						if (form[0]["SteuerschlüsselId"].value != "") {
						    //entity.ss_steuerschlssel = form[0]["SteuerschlüsselId"].value;
						    entity.ss_steuerschluesseloptionset = form[0]["SteuerschlüsselId"].value;
							selectFound = true;
						}

					}
					if (form[0]["FaxId"].localName == "select") {
						if (form[0]["FaxId"].value != "") {
							entity.ss_fax = form[0]["FaxId"].value;
							selectFound = true;
						}

					}

					if (form[0]["StrasseId"].localName == "select") {
						if (form[0]["StrasseId"].value != "") {
							entity.ss_strasse = form[0]["StrasseId"].value;
							selectFound = true;
						}

					}

					if (form[0]["NrId"].localName == "select") {
						if (form[0]["NrId"].value != "") {
							entity.ss_nr = form[0]["NrId"].value;
							selectFound = true;
						}


					}

					if (form[0]["PLZId"].localName == "select") {
						if (form[0]["PLZId"].value != "") {
							entity.ss_plz = form[0]["PLZId"].value;
							selectFound = true;
						}

					}
					if (form[0]["TelefonId"].localName == "select") {
						if (form[0]["TelefonId"].value != "") {
							entity.ss_telefon = form[0]["TelefonId"].value;
							selectFound = true;
						}

					}
					if (form[0]["Strasse1Id"].localName == "select") {
						if (form[0]["Strasse1Id"].value != "") {
							entity.ss_strasse1 = form[0]["Strasse1Id"].value;
							selectFound = true;
						}

					}

					if (form[0]["Nr1Id"].localName == "select") {
						if (form[0]["Nr1Id"].value != "") {
							entity.ss_nr1 = form[0]["Nr1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["Fax1Id"].localName == "select") {
						if (form[0]["Fax1Id"].value != "") {
							entity.ss_fax1 = form[0]["Fax1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["Ort2Id"].localName == "select") {
						if (form[0]["Ort2Id"].value != "") {
							entity.ss_ort11 = form[0]["Ort2Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["PLZ1Id"].localName == "select") {
						if (form[0]["PLZ1Id"].value != "") {
							entity.ss_plz1 = form[0]["PLZ1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["Telefon1Id"].localName == "select") {
						if (form[0]["Telefon1Id"].value != "") {
							entity.ss_telefon1 = form[0]["Telefon1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["AllgemeineEmailId"].localName == "select") {
						if (form[0]["AllgemeineEmailId"].value != "") {
							entity.ss_allgemeineemail = form[0]["AllgemeineEmailId"].value;
							selectFound = true;
						}

					}
					if (form[0]["EmailId"].localName == "select") {
						if (form[0]["EmailId"].value != "") {
							entity.ss_email = form[0]["EmailId"].value;
							selectFound = true;
						}

					}
					if (form[0]["FirmennameId"].localName == "select") {
						if (form[0]["FirmennameId"].value != "") {
							entity.ss_firmenname = form[0]["FirmennameId"].value;
							selectFound = true;
						}

					}
					if (form[0]["RegisterartId"].localName == "select") {
						if (form[0]["RegisterartId"].value != "") {
							//entity.ss_registerart = form[0]["RegisterartId"].value;

							//registerart optionset field added by saad
							entity.registerartOptionSet = form[0]["RegisterartId"].value;
							selectFound = true;
						}

					}
					if (form[0]["HomepageId"].localName == "select") {
						if (form[0]["HomepageId"].value != "") {
							entity.ss_homepage = form[0]["HomepageId"].value;
							selectFound = true;
						}

					}
					if (form[0]["AbteilungId"].localName == "select") {
						if (form[0]["AbteilungId"].value != "") {
							entity.ss_abteilung1 = form[0]["AbteilungId"].value;
							selectFound = true;
						}

					}
					if (form[0]["ArtderGesellschaftId"].localName == "select") {
						if (form[0]["ArtderGesellschaftId"].value != "") {
							//entity.ss_artdergesellschaft = form[0]["ArtderGesellschaftId"].value;

							//var ss_artdergesellschaftObj = form[0]["ArtderGesellschaftId"];
							//entity.ss_artdergesellschafttext = $(ss_artdergesellschaftObj).find(":selected").text().toString().trim();
							selectFound = true;

							//added by saad
							entity.ss_new_company_type = form[0]["ArtderGesellschaftId"].value;
						}

					}
					if (form[0]["Email1Id"].localName == "select") {
						if (form[0]["Email1Id"].value != "") {
							entity.ss_email1 = form[0]["Email1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["Firmenname1Id"].localName == "select") {
						if (form[0]["Firmenname1Id"].value != "") {
							entity.ss_firmenname1 = form[0]["Firmenname1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["NameId"].localName == "select") {
						if (form[0]["NameId"].value != "") {
							entity.ss_nachname = form[0]["NameId"].value;
							selectFound = true;
						}

					}
					if (form[0]["Vorname1Id"].localName == "select") {
						if (form[0]["Vorname1Id"].value != "") {
							entity.ss_vorname1 = form[0]["Vorname1Id"].value;
							selectFound = true;
						}

					}
					if (form[0]["RechtsformId"].localName == "select") {
						if (form[0]["RechtsformId"].value != "") {
							//entity.ss_rechtsform = form[0]["RechtsformId"].value;

							//added by saad
							entity.ss_rechtsformoptionset = form[0]["RechtsformId"].value;
							selectFound = true;
						}

					}
					//if (form[0]["SteuerschlüsselId"].localName == "select") {
					//    if (form[0]["SteuerschlüsselId"].value != "") {
					//        entity.ss_steuerschlssel = form[0]["SteuerschlüsselId"].value;
					//        selectFound = true;
					//    }

					//}
					if (selectFound) {
						if (dummyAccountId != "" && dummyAccountId != undefined) {
							entity.ss_xmlchecklisttempaccountid = dummyAccountId;
							var body = JSON.stringify(entity);
							entityCollection.push(body);
						}
					}
				});

				if (entityCollection.length > 0) {
					var updateDummyEntity = [];
					updateDummyEntity.push('--batch_123456');
					updateDummyEntity.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
					updateDummyEntity.push('');
					var k = 0;
					for (var i = 0; i < entityCollection.length; i++) {

						k = k + 1;
						updateDummyEntity.push('--changeset_BBB456');
						updateDummyEntity.push('Content-Type:application/http');
						updateDummyEntity.push('Content-Transfer-Encoding:binary');
						var id = k;
						updateDummyEntity.push('Content-ID:' + id);
						updateDummyEntity.push('');
						updateDummyEntity.push('PATCH ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/ss_xmlchecklisttempaccounts(' + JSON.parse(entityCollection[i])["ss_xmlchecklisttempaccountid"] + ') HTTP/1.1');

						updateDummyEntity.push('Content-Type:application/json;type=entry');
						updateDummyEntity.push('');
						updateDummyEntity.push(entityCollection[i]);

					}

					updateDummyEntity.push('--changeset_BBB456--');
					updateDummyEntity.push('--batch_123456--');
					var payloadCreate = updateDummyEntity.join('\r\n');

					varifiedByXMLRequest++;
					$.ajax({
						method: 'POST',
						url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
						headers: {
							'Content-Type': 'multipart/mixed;boundary=batch_123456',
							'Accept': 'application/json',
							'Odata-MaxVersion': '4.0',
							'Odata-Version': '4.0'
						},
						data: payloadCreate,
						async: false,
						success: function (data, textStatus, xhr) {
							var d = data.split("\n");
							for (var i = 0; i < d.length; i++) {
								if (d[i].indexOf("OData-EntityId") != -1) {
									var uri = d[i];
									var regExp = /\(([^)]+)\)/;

									var matches = regExp.exec(uri);
									if (matches != undefined) {
										var newEntityId = matches[1];

										hideLoadingMessage();
										$(".loder-text p").html("");

										//  accoundIDS.push(newEntityId);
									}
								}
							}
						},
						error: function (xhr, textStatus, errorThrown) {

							hideLoadingMessage();
							$(".loder-text p").html("");
							alert("error occurred " + textStatus + " " + errorThrown);
							LogExceptioninCRM(errorThrown, 0, "error in UpdateDummyAccountEntity");
							//  UpdateDummyAccountEntity
							window.close();
						}
					});
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in UpdateDummyAccountEntity");
			}
		}
		// Method to send email to newsroom
		function sendEmailToNewsroom() {

			try {
				var FileName = $("#FirmenlisteUrl")[0].innerHTML;
				var url = $("#FirmenlisteUrl")[0].title;
				var FileDataBase64 = soapCallToDownloadFile(url);


				var xmlUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
				var opportunity = opener.Xrm.Page.data.entity.attributes.get("name").getValue();
				var username = opener.Xrm.Page.context.getUserName();
				var userEmail = "";
				var oppID = opener.Xrm.Page.data.entity.getId();
				var RecrodURL = "https://eqsgroup365.crm4.dynamics.com/main.aspx?etc=3&id=" + oppID + "&pagetype=entityrecord";

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/systemusers(" + xmlUserId + ")?$select=domainname", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							userEmail = result["domainname"];
						} else {

							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in sendEmailToNewsroom");
						}
					}
				};
				req.send();


				var email = {};
				email.subject = "Checklist " + opportunity + " ready to process";
				email.description = "Dear Newsroom, <br/><br/>" +
				"A new customer is ready to be processed.<br/>" +
				"Please fill out the Checklist <a href=" + RecrodURL + " target='_blank'>" + opportunity + "</a> and pass it to accounting.<br/><br/>" +
				 "Thank you!<br/>" + "<br/> " + username + "<br/>" + userEmail;
				// "Thank you!<br/>" + "<br/>" + username + "<br/>" + userEmail;


				$(".loder-text p").html("Sending Email.. ");
				var systemuserid = "37EBD2DF-E9B7-E711-8143-E0071B6641D1";


				var parties = [];
				var sender = {};
				sender["partyid_systemuser@odata.bind"] = "/systemusers(" + systemuserid + ")";
				sender["participationtypemask"] = 1; //From
				parties.push(sender);


				var CC = {};
				CC["partyid_systemuser@odata.bind"] = "/systemusers(" + xmlUserId + ")";
				CC["participationtypemask"] = 3; //From
				parties.push(CC);

				//zeeshan id
				var ccParty2 = new Object();
				ccParty2.addressused = "zeeshan.nasir@eqs.com";
				ccParty2["participationtypemask"] = 3; //cc
				parties.push(ccParty2);

				var activityPartyTo = new Object();
				// activityPartyTo["partyid_systemuser@odata.bind"] = "/systemusers(785A8FE7-402A-41B9-AFC4-E50BBE515876)";
				activityPartyTo.addressused = "newsroom@dgap.de";
				//activityPartyTo.addressused = "haider.shah@scaleablesolutions.com";
				// activityPartyTo.addressused = "crminfo@eqsgroup365.onmicrosoft.com";
				activityPartyTo["participationtypemask"] = 2; //To

				parties.push(activityPartyTo);
				email["email_activity_parties"] = parties;

				var req = new XMLHttpRequest();
				req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.0/emails", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"OData.Community.Display.V1.FormattedValue\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							var emailId = this.getResponseHeader("OData-EntityId");
							var ID = emailId.substr(emailId.length - 38).substring(1, 37);

							var attachmentEntity = {};
							attachmentEntity["objectid_email@odata.bind"] = "/emails(" + ID + ")";
							attachmentEntity.body = FileDataBase64;
							attachmentEntity.filename = FileName;
							attachmentEntity.subject = "Checklist " + opportunity;
							attachmentEntity.objecttypecode = 'email';
							var attachmentReq = new XMLHttpRequest();
							attachmentReq.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/activitymimeattachments", false);
							attachmentReq.setRequestHeader("OData-MaxVersion", "4.0");
							attachmentReq.setRequestHeader("OData-Version", "4.0");
							attachmentReq.setRequestHeader("Accept", "application/json");
							attachmentReq.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							attachmentReq.onreadystatechange = function () {
								if (this.readyState === 4) {
									attachmentReq.onreadystatechange = null;
									if (this.status === 204) {
										var uri = this.getResponseHeader("OData-EntityId");
										var regExp = /\(([^)]+)\)/;
										var matches = regExp.exec(uri);
										var newEntityId = matches[1];
									} else {
										//  opener.Xrm.Utility.alertDialog(this.statusText);
										var errorText = JSON.parse(this.responseText).error.message;
										exceptionMessage(errorText);
										LogExceptioninCRM(errorText, this.status, "error in creating email in sendEmailToNewsroom");
									}
								}
							};
							attachmentReq.send(JSON.stringify(attachmentEntity));

							var parameters =
							{
								"IssueSend": true
							};

							var request = new XMLHttpRequest();
							request.open("POST", emailId + "/Microsoft.Dynamics.CRM.SendEmail", false);
							request.setRequestHeader("Accept", "application/json");
							request.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							request.setRequestHeader("OData-MaxVersion", "4.0");
							request.setRequestHeader("OData-Version", "4.0");
							request.onreadystatechange = function () {
								if (this.readyState === 4) {
									request.onreadystatechange = null;
									if (this.status === 204) {
										// Success - returns sendemailresponse.
									}
									else {
										//var errorText = JSON.parse(this.responseText).error.message;
										//exceptionMessage(errorText);
										//LogExceptioninCRM(errorText, this.status, "error in sending email in sendEmailToNewsroom");
									}
								}
							};
							request.send(JSON.stringify(parameters));

							alert("Email Sent to Newsroom");
							hideLoadingMessage();
							$(".loder-text p").html("");
						} else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in sendEmailToNewsroom");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}

				}

				req.send(JSON.stringify(email));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in sendEmailToNewsroom");
			}
		}


		function retrieveSystemUser(xmlUserId)
		{
		    var req = new XMLHttpRequest();
		    req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/systemusers(" + xmlUserId + ")?$select=domainname", false);
		    req.setRequestHeader("OData-MaxVersion", "4.0");
		    req.setRequestHeader("OData-Version", "4.0");
		    req.setRequestHeader("Accept", "application/json");
		    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
		    req.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            req.onreadystatechange = null;
		            if (this.status === 200) {
		                retrieveSystemUserObj = JSON.parse(this.response);
		                //var result = JSON.parse(this.response);
		                //return result["domainname"];
		            } else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in sendEmailToAccounting in sendEmailToAccounting");
		                alert(errorText);
		                return;
		            }
		        }
		    };
		    req.send();
		}

		function saveActivityAttachments(attachmentEntity)
		{
		    var attachmentReq = new XMLHttpRequest();
		    attachmentReq.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/activitymimeattachments", false);
		    attachmentReq.setRequestHeader("OData-MaxVersion", "4.0");
		    attachmentReq.setRequestHeader("OData-Version", "4.0");
		    attachmentReq.setRequestHeader("Accept", "application/json");
		    attachmentReq.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    attachmentReq.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            attachmentReq.onreadystatechange = null;
		            if (this.status === 204) {
		                saveActivityAttachmentsObj = this.getResponseHeader("OData-EntityId");
		                //var regExp = /\(([^)]+)\)/;
		                //var matches = regExp.exec(uri);
		                //var newEntityId = matches[1];
		                //return uri;
		            } else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in creating email in sendEmailToAccounting");
		                alert(errorText);
		                return;
		            }
		        }
		    };
		    attachmentReq.send(JSON.stringify(attachmentEntity));
		}

		function sendEmail(parameters)
		{
		    var request = new XMLHttpRequest();
		    request.open("POST", saveEmailsEmailId + "/Microsoft.Dynamics.CRM.SendEmail", false);
		    request.setRequestHeader("Accept", "application/json");
		    request.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    request.setRequestHeader("OData-MaxVersion", "4.0");
		    request.setRequestHeader("OData-Version", "4.0");
		    request.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            request.onreadystatechange = null;
		            if (this.status === 204) {
		                sendemailresponse = "success";
		                // Success - returns sendemailresponse.
		            }
		            else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in sendEmail in sendEmailToAccounting");
		                alert(errorText);
		                return;
		            }
		        }
		    };
		    request.send(JSON.stringify(parameters));
		}

		function updateXMLChecklistIntegration(xmlchecklistintegrationsEntity)
		{
		    var req11 = new XMLHttpRequest();
		    req11.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
		    req11.setRequestHeader("OData-MaxVersion", "4.0");
		    req11.setRequestHeader("OData-Version", "4.0");
		    req11.setRequestHeader("Accept", "application/json");
		    req11.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req11.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
		    req11.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            req11.onreadystatechange = null;
		            if (this.status === 204) {

		                updateXMLChecklistIntegrationResponse = "success";
		                //Success - No Return Data - Do Something
		            } else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in updating ss_newsroomcontinue in sendEmailToAccounting");
		                // opener.Xrm.Utility.alertDialog(this.responseText);
		                ////window.close();
		                alert(errorText);
		                return;
		            }
		        }
		    };
		    req11.send(JSON.stringify(xmlchecklistintegrationsEntity));
		}

		function saveEmails(email)
		{
		    var req = new XMLHttpRequest();
		    req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.0/emails", false);
		    req.setRequestHeader("OData-MaxVersion", "4.0");
		    req.setRequestHeader("OData-Version", "4.0");
		    req.setRequestHeader("Accept", "application/json");
		    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req.setRequestHeader("Prefer", "odata.include-annotations=\"OData.Community.Display.V1.FormattedValue\"");
		    req.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            req.onreadystatechange = null;

		            if (this.status === 204) {

		                saveEmailsEmailId = this.getResponseHeader("OData-EntityId");

		            } else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in sendEmailToAccounting 1");
		                // opener.Xrm.Utility.alertDialog(this.responseText);
		                alert(errorText);
		                //window.close();
		                return;
		            }
		        }
		    }

		    req.send(JSON.stringify(email));
		}

		// Method to send email to Accounting Person
		function sendEmailToAccounting() {

			try {
				debugger;

				createUpdateAccounts();
				//var createUpdateAccountsCallResult = createUpdateAccounts();
				if(createUpdateAccountsCallResult == undefined ||createUpdateAccountsCallResult == null || createUpdateAccountsCallResult == "failed")
				{
				    window.close();
				}
				else
				{
				    try {
				        var FileName = $("#FirmenlisteUrl")[0].innerHTML;
				        var url = $("#FirmenlisteUrl")[0].title;
				        var FileDataBase64 = soapCallToDownloadFile(url);

				        if (confirm('Do you want to send an Email to Accounting Person? ')) {
				            var xmlUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
				            var opportunity = opener.Xrm.Page.data.entity.attributes.get("name").getValue();
				            var username = opener.Xrm.Page.context.getUserName();
				            var userEmail = "";
				            var NewsroomUserName = opener.Xrm.Page.context.getUserName();
				            var NewsroomUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
				            var oppID = opener.Xrm.Page.data.entity.getId();
				            var RecrodURL = "https://eqsgroup365.crm4.dynamics.com/main.aspx?etc=3&id=" + oppID + "&pagetype=entityrecord";

                            retrieveSystemUser(xmlUserId);
                            if (retrieveSystemUserObj == "" || retrieveSystemUserObj == null || retrieveSystemUserObj == undefined)
				            {
				                window.close();
				            }

                            userEmail = retrieveSystemUserObj["domainname"];

				            var systemuserid = "37EBD2DF-E9B7-E711-8143-E0071B6641D1";
				            // var systemuserid = "";

				            var email = {};
				            email.subject = "Checklist " + opportunity + " ready to process";
				            email.description = "Dear Accounting,<br/><br/>" +
                            "A new customer is ready to be processed.<br/>" +
                            "Please fill out the Checklist  <a href=" + RecrodURL + " target='_blank'>" + opportunity + "</a> and finalize it.<br/><br/>" +
                             "Thank you!<br/>" + "<br/> " + username + "  <br/>" + userEmail;

				            var parties = [];
				            //ActivityParty (From)
				            var sender = {};
				            sender["partyid_systemuser@odata.bind"] = "/systemusers(" + systemuserid + ")";
				            sender["participationtypemask"] = 1; //From
				            parties.push(sender);

				            var CC = {};
				            CC["partyid_systemuser@odata.bind"] = "/systemusers(" + xmlUserId + ")";
				            CC["participationtypemask"] = 3; //From
				            parties.push(CC);


				            var activityPartyTo = new Object();
				            // activityPartyTo["partyid_systemuser@odata.bind"] = "/systemusers(785A8FE7-402A-41B9-AFC4-E50BBE515876)";
				            activityPartyTo.addressused = "accounting@eqs.com";
				            // activityPartyTo.addressused = "crminfo@eqsgroup365.onmicrosoft.com";
				            activityPartyTo["participationtypemask"] = 2; //To

				            parties.push(activityPartyTo);
				            email["email_activity_parties"] = parties;

				            saveEmails(email);
				            if (saveEmailsEmailId == "" || saveEmailsEmailId == null || saveEmailsEmailId == undefined)
				            {
				                window.close();
				            }

				            var uri = "";
				            var ID = saveEmailsEmailId.substr(saveEmailsEmailId.length - 38).substring(1, 37);

				            var attachmentEntity = {};
				            attachmentEntity["objectid_email@odata.bind"] = "/emails(" + ID + ")";
				            attachmentEntity.body = FileDataBase64;
				            attachmentEntity.filename = FileName;
				            attachmentEntity.subject = "Checklist " + opportunity;
				            attachmentEntity.objecttypecode = 'email';

				            saveActivityAttachments(attachmentEntity)

				            if (saveActivityAttachmentsObj == "" || saveActivityAttachmentsObj == null || saveActivityAttachmentsObj == undefined) {
				                window.close();
				            }

				            uri = saveActivityAttachmentsObj;

				            var regExp = /\(([^)]+)\)/;
				            var matches = regExp.exec(uri);
				            var newEntityId = matches[1];


				            var parameters =
                            {
                                "IssueSend": true
                            };

				            sendEmail(parameters);
				            if (sendemailresponse == "" || sendemailresponse == null || sendemailresponse == undefined) {
				                window.close();
				            }


				            $("#accountingCheckbox").attr("disabled", false)
				            // $("#accountList :input").attr("disabled", true);
				            $("#accountList :input").attr('readonly', 'readonly');
				            document.getElementById("continuebtn").disabled = true;
				            alert("Email Sent to Accounting");
				            //$("#continuebtn").attr("disabled", true);


				            var xmlchecklistintegrationsEntity = {};
				            xmlchecklistintegrationsEntity.ss_newsroomcontinue = true;

				            updateXMLChecklistIntegration(xmlchecklistintegrationsEntity);

				            if (updateXMLChecklistIntegrationResponse == "" || updateXMLChecklistIntegrationResponse == null || updateXMLChecklistIntegrationResponse == undefined) {
				                window.close();
				            }

				        }
				    }
				    catch (e) {
				        exceptionMessage(e.message);
				        LogExceptioninCRM(e.message, e.number, "error in sendEmailToAccounting 2");

				        //send email to Ron containing exception message
				        sendExceptionEmail(e.message);
				        //send exception email

				        return;
				    }
				}
			}
			catch (e) {
				debugger;

				exceptionMessage(e.name);
				LogExceptioninCRM(e.name, e.number, "error in sendEmailToAccounting");

			    //send email to Ron containing exception message
				sendExceptionEmail(e.message);
			    //send exception email

				return;
			}
		}

		function sendExceptionEmail(exceptionMessage)
		{
		    var xmlUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
		    var opportunity = opener.Xrm.Page.data.entity.attributes.get("name").getValue();
		    var username = opener.Xrm.Page.context.getUserName();
		    var userEmail = "";
		    var NewsroomUserName = opener.Xrm.Page.context.getUserName();
		    var NewsroomUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
		    var oppID = opener.Xrm.Page.data.entity.getId();
		    var RecrodURL = "https://eqsgroup365.crm4.dynamics.com/main.aspx?etc=3&id=" + oppID + "&pagetype=entityrecord";

		    retrieveSystemUser(xmlUserId);
		    if (retrieveSystemUserObj == "" || retrieveSystemUserObj == null || retrieveSystemUserObj == undefined) {
		        window.close();
		    }

		    userEmail = retrieveSystemUserObj["domainname"];

		    var systemuserid = "37EBD2DF-E9B7-E711-8143-E0071B6641D1";
		    // var systemuserid = "";

		    var email = {};
		    email.subject = "Checklist " + opportunity + " failure";
		    email.description = "Dear Ron,<br/><br/>" +
            "Workflow has failed to process required operation.<br/>" +
            "Following is exception message:<br/>" + exceptionMessage + "<br/><br/>" +
             "Thank you!<br/>" + "<br/> " + username + "  <br/>" + userEmail;

		    var parties = [];
		    //ActivityParty (From)
		    var sender = {};
		    sender["partyid_systemuser@odata.bind"] = "/systemusers(" + systemuserid + ")";
		    sender["participationtypemask"] = 1; //From
		    parties.push(sender);

		    var CC = {};
		    CC["partyid_systemuser@odata.bind"] = "/systemusers(" + xmlUserId + ")";
		    CC["participationtypemask"] = 3; //From
		    parties.push(CC);


		    var activityPartyTo = new Object();
		    // activityPartyTo["partyid_systemuser@odata.bind"] = "/systemusers(785A8FE7-402A-41B9-AFC4-E50BBE515876)";
		    activityPartyTo.addressused = "ron.fechtner@eqs.com";
		    // activityPartyTo.addressused = "crminfo@eqsgroup365.onmicrosoft.com";
		    activityPartyTo["participationtypemask"] = 2; //To

		    parties.push(activityPartyTo);
		    email["email_activity_parties"] = parties;

		    saveEmails(email);
		    if (saveEmailsEmailId == "" || saveEmailsEmailId == null || saveEmailsEmailId == undefined) {
		        window.close();
		    }

		    var uri = "";
		    var ID = saveEmailsEmailId.substr(saveEmailsEmailId.length - 38).substring(1, 37);

		    var attachmentEntity = {};
		    attachmentEntity["objectid_email@odata.bind"] = "/emails(" + ID + ")";
		    attachmentEntity.body = FileDataBase64;
		    attachmentEntity.filename = FileName;
		    attachmentEntity.subject = "Checklist " + opportunity;
		    attachmentEntity.objecttypecode = 'email';

		    saveActivityAttachments(attachmentEntity)

		    if (saveActivityAttachmentsObj == "" || saveActivityAttachmentsObj == null || saveActivityAttachmentsObj == undefined) {
		        window.close();
		    }

		    uri = saveActivityAttachmentsObj;

		    var regExp = /\(([^)]+)\)/;
		    var matches = regExp.exec(uri);
		    var newEntityId = matches[1];


		    var parameters =
            {
                "IssueSend": true
            };

		    sendEmail(parameters);
		    if (sendemailresponse == "" || sendemailresponse == null || sendemailresponse == undefined) {
		        window.close();
		    }
		}

		// When newsroom click the verified button data will be updated into the workflow entity
		function VerifiedByNewsroom() {
			try {
				var missingfield = false;
				var mutterSelected = false;
				$("#accountList").find("[name='Mutter']").each(function (index, value) {
					if (value.checked == true) {
						mutterSelected = true;
					}
				});

				$("#accountList").find("form").each(function () {
					if (missingfield == false) {
						var form = $(this);
						var dummyAccountId = $(form[0]).attr("id")

						if (form[0]["Kunden-Nr"].value == "" || form[0]["Kunden-Nr"].value == null || form[0]["Kunden-Nr"].value == undefined) {
							alert("Please Provide value for Kunden-Nr");
							$(form[0]["Kunden-Nr"]).css('border-color', 'red');
							$(form[0]["Kunden-Nr"]).css('border-width', '2px');

							missingfield = true;
							return;

						}

						var CockpitType = $(form[0]["CockpitTypeDrp"]).find('option:selected').val();

						if (CockpitType == null || CockpitType == undefined || CockpitType == "none") {
							alert("Please Provide value for Cockpit Type");
							$(form[0]["CockpitTypeDrp"]).css('border-color', 'red');
							$(form[0]["CockpitTypeDrp"]).css('border-width', '2px');
							missingfield = true;
							return;
						}
						var ArtderGesellschaftId = $(form[0]["ArtderGesellschaftId"]).find('option:selected').val();

						if (ArtderGesellschaftId == null || ArtderGesellschaftId == undefined || ArtderGesellschaftId == "0") {
							alert("Please Provide value for ArtderGesellschaftId");
							$(form[0]["ArtderGesellschaftId"]).css('border-color', 'red');
							$(form[0]["ArtderGesellschaftId"]).css('border-width', '2px');
							missingfield = true;
							return;
						}

						var RegisterartId = $(form[0]["RegisterartId"]).find('option:selected').val();
						if (RegisterartId == null || RegisterartId == undefined || RegisterartId == "") {
							alert("Please Provide value for Registerart");
							$(form[0]["RegisterartId"]).css('border-color', 'red');
							$(form[0]["RegisterartId"]).css('border-width', '2px');
							missingfield = true;
							return;
						}

						var RechtsformId = $(form[0]["RechtsformId"]).find('option:selected').val();
						if (RechtsformId == null || RechtsformId == undefined || RechtsformId == "") {
							alert("Please Provide value for RechtsformId");
							$(form[0]["RechtsformId"]).css('border-color', 'red');
							$(form[0]["RechtsformId"]).css('border-width', '2px');
							missingfield = true;
							return;
						}



						var SteuerschlüsselId = $(form[0]["SteuerschlüsselId"]).find('option:selected').val();
						if (SteuerschlüsselId == null || SteuerschlüsselId == undefined || SteuerschlüsselId == "") {
							alert("Please Provide value for SteuerschlüsselId");
							$(form[0]["SteuerschlüsselId"]).css('border-color', 'red');
							$(form[0]["SteuerschlüsselId"]).css('border-width', '2px');
							missingfield = true;
							return;
						}
					}

				});

				if (missingfield == true) {
					return;
				}
				if (mutterSelected == false) {
					//if ($('input:checkbox[id=CompanyAdminCheckBox]').prop("checked") != true) {
					//    alert("Please Check Anlegen der Unternehmensdaten im Company Admin bzw. Main Admin!");
					//    return;
					//}
					if ($('input:checkbox[id=CompanyIDimCRMCheckBox]').prop("checked") != true) {
						alert("Please Check Company-ID im CRM eintragen. evtl. Verknüpfung mit Mutter");
						return;
					}

					if (confirm('Keine Muttergesellschafts ausgewählt! Sind Sie sicher?')) {
						showLoadingMessage();
						$(".loder-text p").html("Updating Workflow ... ");

						UpdateDummyAccountEntity();
						var NewsroomUserName = opener.Xrm.Page.context.getUserName();
						var NewsroomUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");


						var entity = {};
						entity["ss_newsroom@odata.bind"] = "/systemusers(" + NewsroomUserId + ")";
						// entity.ss_anlegenderunternehmensdatenimcompanyadmin = true;
						entity.ss_companyidimcrmeintragenevtlverknpfungmit = true;
						entity.ss_verifiedbynewsroom = true;

						var req = new XMLHttpRequest();
						req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
						req.setRequestHeader("OData-MaxVersion", "4.0");
						req.setRequestHeader("OData-Version", "4.0");
						req.setRequestHeader("Accept", "application/json");
						req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
						req.onreadystatechange = function () {
							if (this.readyState === 4) {
								req.onreadystatechange = null;
								if (this.status === 204) {
									$(".loder-text p").html("Creating Companies..");

									document.getElementById("verifiedByXMLtxt").disabled = true;
									document.getElementById("verifiedByNewsroomtxt").disabled = true;
									document.getElementById("continuebtn").disabled = false;

									// $("#accountList :input").attr("disabled", true);
									$("#accountList :input").attr('readonly', 'readonly');
									$("#KundenbetreuerLookup").val(NewsroomUserName);
									hideLoadingMessage();
									$(".loder-text p").html("");

								} else {
									hideLoadingMessage();
									$(".loder-text p").html("");
									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in VerifiedByNewsroom");
									// opener.Xrm.Utility.alertDialog(this.responseText);
									window.close();
								}
							}
						};
						req.send(JSON.stringify(entity));
					}
				}
				else {
					//if ($('input:checkbox[id=CompanyAdminCheckBox]').prop("checked") != true) {
					//    alert("Please Check Anlegen der Unternehmensdaten im Company Admin bzw. Main Admin!");
					//    return;
					//}
					if ($('input:checkbox[id=CompanyIDimCRMCheckBox]').prop("checked") != true) {
						alert("Please Check Company-ID im CRM eintragen. evtl. Verknüpfung mit Mutter");
						return;
					}
					showLoadingMessage();
					$(".loder-text p").html("Updating Workflow ... ");

					UpdateDummyAccountEntity();
					var NewsroomUserName = opener.Xrm.Page.context.getUserName();
					var NewsroomUserId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");


					var entity = {};
					entity["ss_newsroom@odata.bind"] = "/systemusers(" + NewsroomUserId + ")";
					// entity.ss_anlegenderunternehmensdatenimcompanyadmin = true;
					entity.ss_companyidimcrmeintragenevtlverknpfungmit = true;
					entity.ss_verifiedbynewsroom = true;

					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								$(".loder-text p").html("Creating Companies..");

								document.getElementById("verifiedByXMLtxt").disabled = true;
								document.getElementById("verifiedByNewsroomtxt").disabled = true;
								document.getElementById("continuebtn").disabled = false;

								// $("#accountList :input").attr("disabled", true);
								$("#accountList :input").attr('readonly', 'readonly');
								$("#KundenbetreuerLookup").val(NewsroomUserName);
								hideLoadingMessage();
								$(".loder-text p").html("");

							} else {
								hideLoadingMessage();
								$(".loder-text p").html("");
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in VerifiedByNewsroom 2");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in VerifiedByNewsroom");
			}

		}
		//this method retrieve data of the existing account selected from dropdown
		function retrieveDataFromSimilarRecord(select) {
			try {
				var xmlchecklisttempaccountId = $(select).closest('form').attr('id');
				var similarAccountId = $(select).find('option:selected').val();

				if (similarAccountId != undefined) {
					var entity = {};
					if (similarAccountId != "") {
						entity["ss_similaraccountid@odata.bind"] = "/accounts(" + similarAccountId + ")";
						var req1 = new XMLHttpRequest();
						req1.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + xmlchecklisttempaccountId + ")", true);
						req1.setRequestHeader("OData-MaxVersion", "4.0");
						req1.setRequestHeader("OData-Version", "4.0");
						req1.setRequestHeader("Accept", "application/json");
						req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
						req1.onreadystatechange = function () {
							if (this.readyState === 4) {
								req1.onreadystatechange = null;
								if (this.status === 204) {
									//Success - No Return Data - Do Something
								} else {
									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in retrieveDataFromSimilarRecord");
									//opener.Xrm.Utility.alertDialog(this.responseText);
									window.close();
								}
							}
						};
						req1.send(JSON.stringify(entity));
					}
					else if (similarAccountId == "") {
						var req1 = new XMLHttpRequest();
						req1.open("DELETE", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + xmlchecklisttempaccountId + ")/ss_similaraccountid/$ref", true);
						req1.setRequestHeader("OData-MaxVersion", "4.0");
						req1.setRequestHeader("OData-Version", "4.0");
						req1.setRequestHeader("Accept", "application/json");
						req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
						req1.onreadystatechange = function () {
							if (this.readyState === 4) {
								req1.onreadystatechange = null;
								if (this.status === 204) {
									//Success - No Return Data - Do Something
								} else {
									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in retrieveDataFromSimilarRecord");
									//  opener.Xrm.Utility.alertDialog(this.responseText);
									window.close();
								}
							}
						};
						req1.send(JSON.stringify(entity));

					}

				}


				var accountId = $(select).find('option:selected').val();
				if (accountId == "" || prevSelectedAccount != "") {
					if (prevSelectedAccount == "") {
						prevSelectedAccount = accountId;
					}

					if ($(select).closest('form').find('select[name="OrtId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="OrtId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="OrtId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}

					if ($(select).closest('form').find('select[name="R-NrId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="R-NrId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="R-NrId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Ort1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Ort1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Ort1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}


					if ($(select).closest('form').find('select[name="FaxId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="FaxId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="FaxId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);



					}

					if ($(select).closest('form').find('select[name="StrasseId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="StrasseId"]');
						var StrasseIdText = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="StrasseId" value = "' + StrasseIdText + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}

					if ($(select).closest('form').find('select[name="NrId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="NrId"]');
						var NrIdText = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="NrId" value = "' + NrIdText + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}


					if ($(select).closest('form').find('select[name="PLZId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="PLZId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");
						var inputElement = '<input type="text" name="PLZId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="TelefonId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="TelefonId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="TelefonId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Strasse1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Strasse1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Strasse1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}


					if ($(select).closest('form').find('select[name="Nr1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Nr1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Nr1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Fax1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Fax1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Fax1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Ort2Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Ort2Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Ort2Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="PLZ1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="PLZ1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="PLZ1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Telefon1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Telefon1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Telefon1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="AllgemeineEmailId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="AllgemeineEmailId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="AllgemeineEmailId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="EmailId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="EmailId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="EmailId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="FirmennameId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="FirmennameId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="FirmennameId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					//if ($(select).closest('form').find('select[name="RegisterartId"]').length > 0) {
					//    var element = $(select).closest('form').find('select[name="RegisterartId"]');
					//    var text = $(element).find('option')[2].value
					//    $(element).css('border', "");

					//    var inputElement = '<input type="text" name="RegisterartId" value = "' + text + '" class="form-control input-sm" />'
					//    $(element).replaceWith(inputElement);

					//}
					if ($(select).closest('form').find('select[name="HomepageId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="HomepageId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="HomepageId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="AbteilungId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="AbteilungId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="AbteilungId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					//if ($(select).closest('form').find('select[name="ArtderGesellschaftId"]').length > 0) {
					//    var element = $(select).closest('form').find('select[name="ArtderGesellschaftId"]');
					//    var text = $(element).find('option')[2].value
					//    $(element).css('border', "");

					//    var inputElement = '<input type="number" name="ArtderGesellschaftId" value = "' + text + '" maxlength="3" min="0" max="225" class="form-control input-sm" />'
					//    $(element).replaceWith(inputElement);

					//}
					if ($(select).closest('form').find('select[name="Email1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Email1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Email1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Firmenname1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Firmenname1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Firmenname1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="NameId"]').length > 0) {
						var element = $(select).closest('form').find('select[name="NameId"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="NameId" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					if ($(select).closest('form').find('select[name="Vorname1Id"]').length > 0) {
						var element = $(select).closest('form').find('select[name="Vorname1Id"]');
						var text = $(element).find('option')[2].value
						$(element).css('border', "");

						var inputElement = '<input type="text" name="Vorname1Id" value = "' + text + '" class="form-control input-sm" />'
						$(element).replaceWith(inputElement);

					}
					//if ($(select).closest('form').find('select[name="RechtsformId"]').length > 0) {
					//    var element = $(select).closest('form').find('select[name="RechtsformId"]');
					//    var text = $(element).find('option')[2].value
					//    $(element).css('border', "");

					//    var inputElement = '<input type="text" name="RechtsformId" value = "' + text + '" class="form-control input-sm" />'
					//    $(element).replaceWith(inputElement);

					//}
					//if ($(select).closest('form').find('select[name="SteuerschlüsselId"]').length > 0) {
					//    var element = $(select).closest('form').find('select[name="SteuerschlüsselId"]');
					//    var text = $(element).find('option')[2].value
					//    $(element).css('border', "");
					//    var inputElement = '<input type="text" name="SteuerschlüsselId" value = "' + text + '" class="form-control input-sm" />'
					//    $(element).replaceWith(inputElement);

					//}

				}


				if (accountId != "") {
					var req = new XMLHttpRequest();
					req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts(" + accountId + ")?$select=accountid,address1_city,new_registrierungsnummer,address1_country,address1_fax,address1_line1,address1_postalcode,address1_telephone1,bbo_equitystoryid,emailaddress1,emailaddress2,name,new_registerart,bbo_navid,websiteurl,ss_abteilung,ss_artdergesellschaft,ss_artdergesellschafttext,ss_email,ss_fax,ss_firmenname,ss_name,ss_ort,ss_plz,ss_rechtsform,ss_steuerschluessel,ss_strassehausnummer,ss_amtsgericht,ss_amtsgerichtvalue,ss_telefon,ss_vorname,new_registergericht, ss_registergerichtvalue, new_steuerschluesselindex", true); //changed M107A3

					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 200) {
								var result = JSON.parse(this.response);
								var accountid = result["accountid"];
								var address1_city = result["address1_city"];
								var address1_country = result["address1_country"];
								var address1_fax = result["address1_fax"];
								var address1_line1 = result["address1_line1"];
								var address1_postalcode = result["address1_postalcode"];
								var address1_telephone1 = result["address1_telephone1"];
								var ss_strassehausnummer = result["ss_strassehausnummer"];
								var ss_fax = result["ss_fax"];
								var ss_ort = result["ss_ort"];
								var ss_plz = result["ss_plz"];
								var ss_telefon = result["ss_telefon"];
								var bbo_equitystoryid = result["bbo_equitystoryid"];
								var emailaddress1 = result["emailaddress1"];
								var emailaddress2 = result["emailaddress2"];
								var name = result["name"];
								var new_registerart = result["new_registerart"];
								var new_registerart_formatted = result["new_registerart@OData.Community.Display.V1.FormattedValue"];
								var bbo_navid = result["bbo_navid"];
								var websiteurl = result["websiteurl"];
								var new_registergericht = result["new_registergericht"];
								var ss_abteilung = result["ss_abteilung"];
								var ss_artdergesellschaft = result["ss_artdergesellschaft"];
								var ss_artdergesellschafttext = result["ss_artdergesellschafttext"];
								var ss_email = result["ss_email"];
								var ss_firmenname = result["ss_firmenname"];
								var ss_name = result["ss_name"];
								var ss_rechtsform = result["ss_rechtsform"];
								var ss_steuerschluessel = result["ss_steuerschluessel"];
								var new_steuerschluesselindex = result["new_steuerschluesselindex"];
								var ss_vorname = result["ss_vorname"];
								var ss_amtsgericht = result["ss_amtsgericht"];
								var ss_amtsgerichtvalue = result["ss_amtsgerichtvalue"];//changed M107A3
								var new_registrierungsnummer = result["new_registrierungsnummer"];
								if (bbo_equitystoryid != null) {
									$(select).closest('form').find('input[name="EQS-ID"]').val(bbo_equitystoryid);
								}
								if (bbo_navid != null) {
									$(select).closest('form').find('input[name="Kunden-Nr"]').val(bbo_navid);
								}

								if ($(select).closest('form').find('input[name="OrtId"]').val() != "" && $(select).closest('form').find('input[name="OrtId"]').val() != undefined) {
									if (address1_city != null) {
										if (address1_city.toString().trim() != $(select).closest('form').find('input[name="OrtId"]').val().toString().trim()) {

											var element = $(select).closest('form').find('input[name="OrtId"]');
											var dropdown = "<select name='OrtId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + address1_city.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="OrtId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="OrtId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}


								if ($(select).closest('form').find('input[name="R-NrId"]').val() != "" && $(select).closest('form').find('input[name="R-NrId"]').val() != undefined) {
									if (new_registrierungsnummer != null) {
										if (new_registrierungsnummer.toString().trim() != $(select).closest('form').find('input[name="R-NrId"]').val().toString().trim()) {

											var element = $(select).closest('form').find('input[name="R-NrId"]');
											var dropdown = "<select name='R-NrId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + new_registrierungsnummer.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="R-NrId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="R-NrId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}

								if ($(select).closest('form').find('input[name="Ort1Id"]').val() != "" && $(select).closest('form').find('input[name="Ort1Id"]').val() != undefined) {
									if (ss_amtsgericht != null) {
										if (ss_amtsgericht.toString().trim() != $(select).closest('form').find('input[name="Ort1Id"]').val().toString().trim()) {

											var element = $(select).closest('form').find('input[name="Ort1Id"]');
											var dropdown = "<select name='Ort1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_amtsgericht.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Ort1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Ort1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}


								if ($(select).closest('form').find('input[name="AbteilungId"]').val() != "" && $(select).closest('form').find('input[name="AbteilungId"]').val() != undefined) {
									if (ss_abteilung != null) {
										if (ss_abteilung.toString().trim() != $(select).closest('form').find('input[name="AbteilungId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="AbteilungId"]');

											var dropdown = "<select name='AbteilungId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_abteilung.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="AbteilungId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="AbteilungId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								//if ($(select).closest('form').find('select[id="ArtderGesellschaftId"]').val() != "") {
								//    if (ss_artdergesellschaft != null) {
								//        if (ss_artdergesellschaft.toString().trim() != $(select).closest('form').find('select[id="ArtderGesellschaftId"]').val().toString().trim()) {
								//            var element = $(select).closest('form').find('select[id="ArtderGesellschaftId"]');

								//            var dropdown = "<option style='background-color: #ff2f2f'>" + ss_artdergesellschaft.toString().trim() + "</option>";
								//           // $(element).replaceWith(dropdown);
								//            $(element).append(dropdown);
								//            var element = $(select).closest('form').find('select[id="ArtderGesellschaftId"]');

								//            $(element).css('border', '1px solid black');

								//        }
								//    }
								//}
								if ($(select).closest('form').find('input[name="Email1Id"]').val() != "" && $(select).closest('form').find('input[name="Email1Id"]').val() != undefined) {
									if (ss_email != null) {
										if (ss_email.toString().trim() != $(select).closest('form').find('input[name="Email1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Email1Id"]');

											var dropdown = "<select name='Email1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_email.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Email1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Email1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}

								if ($(select).closest('form').find('input[name="Firmenname1Id"]').val() != "" && $(select).closest('form').find('input[name="Firmenname1Id"]').val() != undefined) {
									if (ss_firmenname != null) {
										if (ss_firmenname.toString().trim() != $(select).closest('form').find('input[name="Firmenname1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Firmenname1Id"]');

											var dropdown = "<select name='Firmenname1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_firmenname.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Firmenname1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Firmenname1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="NameId"]').val() != "" && $(select).closest('form').find('input[name="NameId"]').val() != undefined) {
									if (ss_name != null) {
										if (ss_name.toString().trim() != $(select).closest('form').find('input[name="NameId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="NameId"]');

											var dropdown = "<select name='NameId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_name.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="NameId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="NameId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="Vorname1Id"]').val() != "" && $(select).closest('form').find('input[name="Vorname1Id"]').val() != undefined) {
									if (ss_vorname != null) {
										if (ss_vorname.toString().trim() != $(select).closest('form').find('input[name="Vorname1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Vorname1Id"]');

											var dropdown = "<select name='Vorname1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_vorname.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Vorname1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Vorname1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								//if ($(select).closest('form').find('input[id="RechtsformId"]').val() != "") {
								//    if (ss_rechtsform != null) {
								//        if (ss_rechtsform.toString().trim() != $(select).closest('form').find('input[id="RechtsformId"]').val().toString().trim()) {
								//            var element = $(select).closest('form').find('input[id="RechtsformId"]');

								//            var dropdown = "<option style='background-color: #ff2f2f'>" + ss_rechtsform.toString().trim() + "</option>";
								//           // $(element).replaceWith(dropdown);
								//            $(element).append(dropdown);
								//            var element = $(select).closest('form').find('select[id="RechtsformId"]');

								//            $(element).css('border', '1px solid black');

								//        }
								//    }
								//}

								//if ($(select).closest('form').find('input[id="SteuerschlüsselId"]').val() != "") {
								//    if (ss_steuerschluessel != null) {
								//        if (ss_steuerschluessel.toString().trim() != $(select).closest('form').find('input[id="SteuerschlüsselId"]').val().toString().trim()) {
								//            var element = $(select).closest('form').find('input[id="SteuerschlüsselId"]');

								//            var dropdown = "<option style='background-color: #ff2f2f'>" + ss_steuerschluessel.toString().trim() + "</option>";
								//          //  $(element).replaceWith(dropdown);
								//            $(element).append(dropdown);

								//            var element = $(select).closest('form').find('select[id="SteuerschlüsselId"]');

								//            $(element).css('border', '1px solid black');

								//        }
								//    }
								//}

								if ($(select).closest('form').find('input[name="FaxId"]').val() != "" && $(select).closest('form').find('input[name="FaxId"]').val() != undefined) {
									if (address1_fax != null) {
										if (address1_fax.toString().trim() != $(select).closest('form').find('input[name="FaxId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="FaxId"]');
											var dropdown = "<select name='FaxId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + address1_fax.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="FaxId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="FaxId"]');
											$(element).css('border', '1px solid black');


										}
									}
								}
								if ($(select).closest('form').find('input[name="StrasseId"]').val() != "" && $(select).closest('form').find('input[name="StrasseId"]').val() != undefined) {
									if (address1_line1 != null) {
										var names = "";
										var firstDigit = address1_line1.match(/\d/); //will give you the first digit in the string
										var index = address1_line1.indexOf(firstDigit);
										names = address1_line1.substring(0, index);
										var numberss = address1_line1.substring(index, address1_line1.length);

										if (names.toString().trim() != $(select).closest('form').find('input[name="StrasseId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="StrasseId"]');
											var dropdown = "<select name='StrasseId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + names.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="StrasseId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="StrasseId"]');
											$(element).css('border', '1px solid black');

										}

									}
								}

								if ($(select).closest('form').find('input[name="NrId"]').val() != "" && $(select).closest('form').find('input[name="NrId"]').val() != undefined) {
									if (address1_line1 != null) {
										var names = "";
										var firstDigit = address1_line1.match(/\d/); //will give you the first digit in the string
										var index = address1_line1.indexOf(firstDigit);
										names = address1_line1.substring(0, index);
										var numberss = address1_line1.substring(index, address1_line1.length);

										if (numberss.toString().trim() != $(select).closest('form').find('input[name="NrId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="NrId"]');
											var dropdown = "<select name='NrId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + numberss.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="NrId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="NrId"]');
											$(element).css('border', '1px solid black');

										}

									}
								}
								if ($(select).closest('form').find('input[name="PLZId"]').val() != "" && $(select).closest('form').find('input[name="PLZId"]').val() != undefined) {
									if (address1_postalcode != null) {
										if (address1_postalcode.toString().trim() != $(select).closest('form').find('input[name="PLZId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="PLZId"]');

											var dropdown = "<select name='PLZId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + address1_postalcode.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="PLZId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="PLZId"]');

											$(element).css('border', '1px solid black');

										}

									}
								}
								if ($(select).closest('form').find('input[name="TelefonId"]').val() != "" && $(select).closest('form').find('input[name="TelefonId"]').val() != undefined) {
									if (address1_telephone1 != null) {
										if (address1_telephone1.toString().trim() != $(select).closest('form').find('input[name="TelefonId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="TelefonId"]');

											var dropdown = "<select name='TelefonId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + address1_postalcode.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="TelefonId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="TelefonId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="Strasse1Id"]').val() != "" && $(select).closest('form').find('input[name="Strasse1Id"]').val() != undefined) {
									if (ss_strassehausnummer != null) {

										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);

										if (names.toString().trim() != $(select).closest('form').find('input[name="Strasse1Id"]').val().toString().trim()) {

											var element = $(select).closest('form').find('input[name="Strasse1Id"]');

											var dropdown = "<select name='Strasse1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + names.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Strasse1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Strasse1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}


								if ($(select).closest('form').find('input[name="Nr1Id"]').val() != "" && $(select).closest('form').find('input[name="Nr1Id"]').val() != undefined) {
									if (ss_strassehausnummer != null) {

										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);

										if (numberss.toString().trim() != $(select).closest('form').find('input[name="Nr1Id"]').val().toString().trim()) {

											var element = $(select).closest('form').find('input[name="Nr1Id"]');

											var dropdown = "<select name='Nr1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + numberss.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Nr1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Nr1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="Fax1Id"]').val() != "" && $(select).closest('form').find('input[name="Fax1Id"]').val() != undefined) {
									if (ss_fax != null) {
										if (ss_fax.toString().trim() != $(select).closest('form').find('input[name="Fax1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Fax1Id"]');

											var dropdown = "<select name='Fax1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_fax.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Fax1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Fax1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="Ort2Id"]').val() != "" && $(select).closest('form').find('input[name="Ort2Id"]').val() != undefined) {
									if (ss_ort != null) {
										if (ss_ort.toString().trim() != $(select).closest('form').find('input[name="Ort2Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Ort2Id"]');

											var dropdown = "<select name='Ort2Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_ort.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Ort2Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Ort2Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="PLZ1Id"]').val() != "" && $(select).closest('form').find('input[name="PLZ1Id"]').val() != undefined) {
									if (ss_plz != null) {
										if (ss_plz.toString().trim() != $(select).closest('form').find('input[name="PLZ1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="PLZ1Id"]');

											var dropdown = "<select name='PLZ1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_plz.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="PLZ1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="PLZ1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="Telefon1Id"]').val() != "" && $(select).closest('form').find('input[name="Telefon1Id"]').val() != undefined) {
									if (ss_telefon != null) {
										if (ss_telefon.toString().trim() != $(select).closest('form').find('input[name="Telefon1Id"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="Telefon1Id"]');

											var dropdown = "<select name='Telefon1Id' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + ss_telefon.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="Telefon1Id"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="Telefon1Id"]');

											$(element).css('border', '1px solid black');

										}
									}
								}
								if ($(select).closest('form').find('input[name="AllgemeineEmailId"]').val() != "" && $(select).closest('form').find('input[name="AllgemeineEmailId"]').val() != undefined) {
									if (emailaddress1 != null) {
										if (emailaddress1.toString().trim() != $(select).closest('form').find('input[name="AllgemeineEmailId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="AllgemeineEmailId"]');

											var dropdown = "<select name='AllgemeineEmailId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + emailaddress1.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="AllgemeineEmailId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="AllgemeineEmailId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}

								if ($(select).closest('form').find('input[name="EmailId"]').val() != "" && $(select).closest('form').find('input[name="EmailId"]').val() != undefined) {
									if (emailaddress2 != null) {
										if (emailaddress2.toString().trim() != $(select).closest('form').find('input[name="EmailId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="EmailId"]');

											var dropdown = "<select name='EmailId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + emailaddress2.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="EmailId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="EmailId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}

								if ($(select).closest('form').find('input[name="FirmennameId"]').val() != "" && $(select).closest('form').find('input[name="FirmennameId"]').val() != undefined) {
									if (name != null) {
										var element = $(select).closest('form').find('input[name="FirmennameId"]');
										var dropdown = "<select name='FirmennameId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + name.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="FirmennameId"]').val().toString().trim() + "</option></select>";
										$(element).replaceWith(dropdown);

										var element = $(select).closest('form').find('select[name="FirmennameId"]');

										$(element).css('border', '1px solid black');

									}
								}

								//if ($(select).closest('form').find('input[id="RegisterartId"]').length > 0) {
								//    if (new_registerart_formatted != null) {

								//            var element = $(select).closest('form').find('input[id="RegisterartId"]');
								//            var dropdown = "<option style='background-color: #ff2f2f'>" + new_registerart_formatted.toString().trim() + "</option>";
								//            //$(element).replaceWith(dropdown);
								//            $(element).append(dropdown);
								//            var element = $(select).closest('form').find('select[name="RegisterartId"]');
								//            $(element).css('border', '1px solid black');


								//    }
								//}

								if ($(select).closest('form').find('input[name="HomepageId"]').val() != "" && $(select).closest('form').find('input[name="HomepageId"]').val() != undefined) {
									if (websiteurl != null) {
										if (websiteurl.toString().trim() != $(select).closest('form').find('input[name="HomepageId"]').val().toString().trim()) {
											var element = $(select).closest('form').find('input[name="HomepageId"]');

											var dropdown = "<select name='HomepageId' class='form-control input-sm'><option></option><option style='background-color: #ff2f2f'>" + websiteurl.toString().trim() + "</option><option selected='selected'>" + $(select).closest('form').find('input[name="HomepageId"]').val().toString().trim() + "</option></select>";
											$(element).replaceWith(dropdown);

											var element = $(select).closest('form').find('select[name="HomepageId"]');

											$(element).css('border', '1px solid black');

										}
									}
								}

							}
							else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in retrieveDataFromSimilarRecord");
								// Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send();
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in retrieveDataFromSimilarRecord");
			}
		}
		// Mothod to retrieve urls from workflow entity and display the links for downloading
		function displayDownloadLinks() {
			try {
				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=ss_stammdatenblatturl,ss_vertragurl,ss_firmenlisturl", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							var ss_stammdatenblatturl = result["ss_stammdatenblatturl"];
							var ss_vertragurl = result["ss_vertragurl"];
							var ss_firmenlisturl = result["ss_firmenlisturl"];

							if (ss_stammdatenblatturl != null) {
								ss_stammdatenblatturl = ss_stammdatenblatturl.split(" ");
								for (var i = 0; i < ss_stammdatenblatturl.length; i++) {
									var url = "<li> <a href='' title='" + ss_stammdatenblatturl[i] + "' id='StammdatenblattUrl' onclick='downloadFiles(this)'>" + ss_stammdatenblatturl[i].substring(ss_stammdatenblatturl[i].lastIndexOf('/') + 1) + "</a> </li>";

									$("#urlLink").append(url);
								}
							}

							if (ss_vertragurl != null) {
								ss_vertragurl = ss_vertragurl.split(" ");
								for (var i = 0; i < ss_vertragurl.length; i++) {
									var url = "<li> <a href='' title='" + ss_vertragurl[i] + "' id='StammdatenblattUrl' onclick='downloadFiles(this)'>" + ss_vertragurl[i].substring(ss_vertragurl[i].lastIndexOf('/') + 1) + "</a> </li>";

									$("#urlLink").append(url);
								}

								//$("#VertragUrl").css("display", "block");
								//$('#VertragUrl').text(ss_vertragurl.substring(ss_vertragurl.lastIndexOf('/') + 1));
								//$('#VertragUrl').attr('title', ss_vertragurl);
							}
							if (ss_firmenlisturl != null) {
								$("#FirmenlisteUrl").css("display", "block");
								$('#FirmenlisteUrl').text(ss_firmenlisturl.substring(ss_firmenlisturl.lastIndexOf('/') + 1));
								$('#FirmenlisteUrl').attr('title', ss_firmenlisturl);
							}


						} else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "displayDownloadLinks");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in displayDownloadLinks");
			}
		}
		//when user click the link for downloading, file will be downloaded
		function downloadFiles(linkClicked) {
			try {
				showLoadingMessage();
				$(".loder-text p").html("Downloading file from Sharepoint..");

				var FileName = linkClicked.innerHTML;
				var url = $(linkClicked).attr('title');
				var FileDataBase64 = soapCallToDownloadFile(url)

				var byteString = atob(FileDataBase64);
				// write the bytes of the string to an ArrayBuffer
				var ab = new ArrayBuffer(byteString.length);
				var ia = new Uint8Array(ab);
				for (var i = 0; i < byteString.length; i++) {
					ia[i] = byteString.charCodeAt(i);
				}

				// write the ArrayBuffer to a blob, and you're done
				var bb = new Blob([ab]);
				saveAs(bb, FileName);
				hideLoadingMessage();
				$(".loder-text p").html("");

				event.preventDefault();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in downloadFiles");
			}

		}
		// call action and custom workflow to download file
		function soapCallToDownloadFile(url) {
			try {
				// Creating the request XML for calling the Action
				var processName = "ss_ActionXMLChecklistIntegrationFileDownloadingFromSharepoint";
				url = decodeURI(url);
				url = url.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");
				var requestXML = "";
				requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
				requestXML += "<s:Body>";
				requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
				requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

				requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";
				requestXML += "<a:KeyValuePairOfstringanyType>";
				requestXML += "<b:key>FileUrl</b:key>";
				requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + url + "</b:value>";
				requestXML += "</a:KeyValuePairOfstringanyType>";

				requestXML += "</a:Parameters>";
				requestXML += "<a:RequestId i:nil=\"true\" />";
				requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
				requestXML += "</request>";
				requestXML += "</Execute>";
				requestXML += "</s:Body>";
				requestXML += "</s:Envelope>";

				var req = new XMLHttpRequest();
				req.open("POST", GetClientUrl(), false)
				req.setRequestHeader("Accept", "application/xml, text/xml, */*");
				req.setRequestHeader("Content-Type", "text/xml; charset=utf-8");
				req.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
				req.send(requestXML);
				if (req.status == 200) {
					var result = JSON.stringify(req.response);

					var FileDataBase64 = "";
					if ($(req.responseXML).find('ExecuteResult')[0].textContent != undefined && $(req.responseXML).find('ExecuteResult')[0].textContent != null && $(req.responseXML).find('ExecuteResult')[0].textContent != "") {
						var a = $(req.responseXML).find('ExecuteResult')[0].textContent;
						FileDataBase64 = a.replace("ss_ActionXMLChecklistIntegrationFileDownloadingFromSharepointFileData", "");

					}

					return FileDataBase64;
				}
				else if (req.status != 200) {
					var errorText = $(req.responseText).find("Message")[0].innerHTML;
					// var errorText = JSON.parse(req1.responseText).error.message;
					exceptionMessage(errorText);
					LogExceptioninCRM(errorText, this.status, "error in soapCallToDownloadFile");
					// exceptionMessage(req.response);
					// alert(req.response);
					window.close();
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, e.number, "error in soapCallToDownloadFile catch");
				//  alert(e.message);
				console.log(e.message);
				window.close();
			}
		}
		// when Mutter checkbox has been clicked in the companies forms.
		function MutterCheckBoxOnclick(checkBox) {
			try {
				if (checkBox.checked == true) {
					$("#accountList").find("[name='Mutter']").not(checkBox).attr("disabled", true);

					var accountid = $(checkBox).closest('form').attr('id');
					var entity = {};
					entity.ss_mutter = true;
					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								//Success - No Return Data - Do Something
							} else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in MutterCheckBoxOnclick");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
				else {
					$("#accountList").find("[name='Mutter']").removeAttr("disabled");
					// $("#accountList").find("[name='Mutter']").not(checkBox).attr("disabled", true);

					var accountid = $(checkBox).closest('form').attr('id');
					var entity = {};
					entity.ss_mutter = false;
					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								//Success - No Return Data - Do Something
							} else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in MutterCheckBoxOnclick else part");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in MutterCheckBoxOnclick");
			}
		}

        //added by saad
		function retrieveXmlChecklistIntegration(ChicklistEnitityId)
		{
		    //alert("in retrieveXmlChecklistIntegration function");
            var req = new XMLHttpRequest();
            req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=_ss_salesrep_value,_ss_xmluser_value,ss_xmlclienttype,_ss_newsroom_value,ss_vertragberwirtschaftsprfer,ss_notizen,ss_euauslnder,ss_vatid,ss_notes,ss_vertragurl,ss_firmenlisturl,_ss_wpkontakt_value,_ss_wirtschaftsprfer_value", false);
            req.setRequestHeader("OData-MaxVersion", "4.0");
            req.setRequestHeader("OData-Version", "4.0");
            req.setRequestHeader("Accept", "application/json");
            req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
            req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
            req.onreadystatechange = function () {
                if (this.readyState === 4) {
                    //alert("in retrieveXmlChecklistIntegration function callback");
                    req.onreadystatechange = null;
                    if (this.status === 200) {
                        retrieveXmlCheclistIntegrationObj = JSON.parse(this.response);
                        //return retrieveXmlChecklistIntegrationresult;

                    } else {

                        var errorText = JSON.parse(this.responseText).error.message;
                        alert(errorText);
                        retrieveXmlCheclistIntegrationObj = "";
                       // exceptionMessage(errorText);
                      //  LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 1");

                    }
                }
            };
            req.send();

        }

		function retrieveXmlTempAccount(opportunityId)
		{
		    //alert("in retrieveXmlTempAccount function");
		    var req = new XMLHttpRequest();
		    req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts?$select=ss_steuerschlssel,ss_abteilung1,ss_anzeigeimcockpitadmin,ss_cockpittype,ss_ureg,ss_abweichenderechnungsanschrift,ss_allgemeineemail,ss_anrede,ss_amtsgericht,ss_amtsgerichtvalue,ss_artdergesellschaft,ss_artdergesellschafttext,ss_email,ss_email1,ss_eqsid,ss_fax,ss_fax1,ss_firmenname,ss_firmenname1,ss_gesellschatsgr,ss_homepage,ss_kundennt,ss_mutter,ss_nachname,ss_nachname1,ss_nr,ss_nr1,ss_ort,ss_ort1,ss_ort1value,ss_ort11,ss_plz,ss_plz1,ss_rechtsform,ss_registerart,_ss_relatedopportunity_value,ss_rnr,_ss_similaraccountid_value,ss_steuerschlssel,ss_strasse,ss_strasse1,ss_telefon,ss_telefon1,ss_vorname,ss_vorname1,ss_xmlchecklisttempaccountid,ss_gesellschaftsgre,ss_new_company_type,ss_registerartoptionset,ss_rechtsformoptionset,ss_steuerschluesseloptionset,ss_registergerichtoptionset&$filter=ss_mutter eq true and _ss_relatedopportunity_value eq " + opportunityId, false);//changed M107A3
		    req.setRequestHeader("OData-MaxVersion", "4.0");
		    req.setRequestHeader("OData-Version", "4.0");
		    req.setRequestHeader("Accept", "application/json");
		    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
		    req.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            //alert("in retrieveXmlTempAccount function callback");
		            req.onreadystatechange = null;
		            if (this.status === 200) {

		                retrieveXmlTempAccountObj = JSON.parse(this.response);
		                //return result;
		            } else {
		                hideLoadingMessage();
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 3");
		                //window.close();
		                retrieveXmlTempAccountObj = "";
		                alert(errorText);
		            }
		        }
		    };
		    req.send();
		}

		function retrieveOpportunities(opportunityId)
		{
		    //alert("in retrieveOpportunities function");
		    var req = new XMLHttpRequest();
		    req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/opportunities(" + opportunityId + ")?$select=_parentaccountid_value", false);
		    req.setRequestHeader("OData-MaxVersion", "4.0");
		    req.setRequestHeader("OData-Version", "4.0");
		    req.setRequestHeader("Accept", "application/json");
		    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
		    req.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            //alert("in retrieveOpportunities function callback");
		            req.onreadystatechange = null;
		            if (this.status === 200) {
		                retrieveOpportunitiesObj = JSON.parse(this.response);
		                //return result;

		            } else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 4");
		                //window.close();
		                retrieveOpportunitiesObj = "";
		                alert(errorText);
		            }
		        }
		    };
		    req.send();
		}

		function retrieveXmlTempAccountToUpdateRealAccount(opportunityId)
		{
		    //alert("in retrieveXmlTempAccountToUpdateRealAccount function");
		    var req = new XMLHttpRequest();
		    req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts?$select=ss_steuerschlssel,ss_abteilung1,ss_anzeigeimcockpitadmin,ss_cockpittype,ss_ureg,ss_abweichenderechnungsanschrift,ss_allgemeineemail,ss_anrede,ss_artdergesellschaft,ss_artdergesellschafttext,ss_email,ss_email1,ss_eqsid,ss_fax,ss_fax1,ss_firmenname,ss_firmenname1,ss_gesellschatsgr,ss_homepage,ss_kundennt,ss_mutter,ss_nachname,ss_nachname1,ss_nr,ss_nr1,ss_ort,ss_ort1,ss_ort1value,ss_ort11,ss_plz,ss_plz1,ss_rechtsform,ss_registerart,_ss_relatedopportunity_value,ss_rnr,_ss_similaraccountid_value,ss_steuerschlssel,ss_strasse,ss_amtsgericht,ss_amtsgerichtvalue,ss_strasse1,ss_telefon,ss_telefon1,ss_vorname,ss_vorname1,ss_xmlchecklisttempaccountid,ss_gesellschaftsgre,ss_new_company_type,ss_registerartoptionset,ss_rechtsformoptionset,ss_steuerschluesseloptionset,ss_registergerichtoptionset&$filter=_ss_relatedopportunity_value eq " + opportunityId, false);//changed M107A3
		    req.setRequestHeader("OData-MaxVersion", "4.0");
		    req.setRequestHeader("OData-Version", "4.0");
		    req.setRequestHeader("Accept", "application/json");
		    req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
		    req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
		    req.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            //alert("in retrieveXmlTempAccountToUpdateRealAccount function callback");
		            req.onreadystatechange = null;
		            if (this.status === 200) {
		                retrieveXmlTempAccountToUpdateRealAccountObj = JSON.parse(this.response);
		                //return result;
		            }
		            else {
		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 5");
		                //window.close();

		                retrieveXmlTempAccountToUpdateRealAccountObj = "";
		                alert(errorText);
		            }
		        }
		    };
		    req.send();
		}
        //

		// when newsroom click verify by newsroom, accounts will be created/ updated based on the mutter checkbox and the similar account option.
		function createUpdateAccounts() {
			try {
				var ss_xmlclienttypeVal = 0;
				var ss_vertragberwirtschaftsprfer = false;
				var ss_notizen = "";
				var ss_euauslnder = false;
				var ss_vatid = "";
				var ss_notes = "";
				var ss_vertragurl = "";
				var ss_firmenlisturl = "";
				var _ss_wpkontakt_value = "";
				var _ss_wirtschaftsprfer_value = "";

				retrieveXmlCheclistIntegrationObj = "";
				retrieveXmlTempAccountObj = "";
				retrieveOpportunitiesObj = "";
				retrieveXmlTempAccountToUpdateRealAccountObj = "";

				$(".loder-text p").html("Updating Companies ... ");

				retrieveXmlChecklistIntegration(ChicklistEnitityId);
				//var retrieveXmlCheclistIntegrationObj = retrieveXmlChecklistIntegration(ChicklistEnitityId);
				if (retrieveXmlCheclistIntegrationObj != null && retrieveXmlCheclistIntegrationObj != "")
				{
				    ss_salesrepxmlid = retrieveXmlCheclistIntegrationObj["_ss_salesrep_value"];
				    ss_verifiedbyxml_UpdateOwner = retrieveXmlCheclistIntegrationObj["_ss_xmluser_value"];
				    ss_verifiedbynewsroom_UpdateOwner = retrieveXmlCheclistIntegrationObj["_ss_newsroom_value"];
				    ss_xmlclienttypeVal = retrieveXmlCheclistIntegrationObj["ss_xmlclienttype"];

				    //added by saad
				    ss_vertragberwirtschaftsprfer = retrieveXmlCheclistIntegrationObj["ss_vertragberwirtschaftsprfer"];
				    ss_notizen = retrieveXmlCheclistIntegrationObj["ss_notizen"];
				    ss_euauslnder = retrieveXmlCheclistIntegrationObj["ss_euauslnder"];
				    ss_vatid = retrieveXmlCheclistIntegrationObj["ss_vatid"];
				    ss_notes = retrieveXmlCheclistIntegrationObj["ss_notes"];
				    ss_vertragurl = retrieveXmlCheclistIntegrationObj["ss_vertragurl"];
				    ss_firmenlisturl = retrieveXmlCheclistIntegrationObj["ss_firmenlisturl"];
				    _ss_wpkontakt_value = retrieveXmlCheclistIntegrationObj["_ss_wpkontakt_value"];
				    _ss_wirtschaftsprfer_value = retrieveXmlCheclistIntegrationObj["_ss_wirtschaftsprfer_value"];
				    //saad
				}
				else
				{
				    createUpdateAccountsCallResult = "failed";
				    return;
				}


				var opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var parentAccount = "";
				var parentCreated = false;
				var excluedFromCreateWhenCreatedasaParent = "";
				//Check If Mutter checkbox is checked and we have similar account selected
				showLoadingMessage();
				$("#accountList").find("[name='Mutter']").each(function (index, value) {
					if (value.checked == true) {
						parentAccount = $(value).closest("form").find("#similarAccountdrp").find('option:selected').val();
					}
				});

				//If Mutter checkbox is checked and we donot have similar account selected then create the account and and set the created account parent of all other accounts
				if (parentAccount == "") {

				    retrieveXmlTempAccount(opportunityId);

				    //var retrieveXmlTempAccountObj = retrieveXmlTempAccount(opportunityId);
				    if (retrieveXmlTempAccountObj != null) {
				        for (var i = 0; i < retrieveXmlTempAccountObj.value.length; i++) {
				            var ss_abteilung1 = retrieveXmlTempAccountObj.value[i]["ss_abteilung1"];
				            var ss_abweichenderechnungsanschrift = retrieveXmlTempAccountObj.value[i]["ss_abweichenderechnungsanschrift"];
				            var ss_abweichenderechnungsanschrift_formatted = retrieveXmlTempAccountObj.value[i]["ss_abweichenderechnungsanschrift@OData.Community.Display.V1.FormattedValue"];
				            var ss_allgemeineemail = retrieveXmlTempAccountObj.value[i]["ss_allgemeineemail"];
				            var ss_anrede = retrieveXmlTempAccountObj.value[i]["ss_anrede"];
				            var ss_artdergesellschaft = retrieveXmlTempAccountObj.value[i]["ss_artdergesellschaft"];
				            var ss_artdergesellschafttext = retrieveXmlTempAccountObj.value[i]["ss_artdergesellschafttext"];
				            var ss_email = retrieveXmlTempAccountObj.value[i]["ss_email"];
				            var ss_email1 = retrieveXmlTempAccountObj.value[i]["ss_email1"];
				            var ss_eqsid = retrieveXmlTempAccountObj.value[i]["ss_eqsid"];
				            var ss_fax = retrieveXmlTempAccountObj.value[i]["ss_fax"];
				            var ss_fax1 = retrieveXmlTempAccountObj.value[i]["ss_fax1"];
				            var ss_firmenname = retrieveXmlTempAccountObj.value[i]["ss_firmenname"];
				            var ss_firmenname1 = retrieveXmlTempAccountObj.value[i]["ss_firmenname1"];
				            var ss_gesellschatsgr = retrieveXmlTempAccountObj.value[i]["ss_gesellschatsgr"];
				            var ss_homepage = retrieveXmlTempAccountObj.value[i]["ss_homepage"];
				            var ss_kundennt = retrieveXmlTempAccountObj.value[i]["ss_kundennt"];
				            var ss_mutter = retrieveXmlTempAccountObj.value[i]["ss_mutter"];
				            var ss_mutter_formatted = retrieveXmlTempAccountObj.value[i]["ss_mutter@OData.Community.Display.V1.FormattedValue"];
				            var ss_nachname = retrieveXmlTempAccountObj.value[i]["ss_nachname"];
				            var ss_nachname1 = retrieveXmlTempAccountObj.value[i]["ss_nachname1"];
				            var ss_nr = retrieveXmlTempAccountObj.value[i]["ss_nr"];
				            var ss_nr1 = retrieveXmlTempAccountObj.value[i]["ss_nr1"];
				            var ss_ort = retrieveXmlTempAccountObj.value[i]["ss_ort"];
				            var ss_ort1 = retrieveXmlTempAccountObj.value[i]["ss_ort1"];
				            //changed asim
				            var ss_ort1value = retrieveXmlTempAccountObj.value[i]["ss_ort1value"];

				            var ss_ort11 = retrieveXmlTempAccountObj.value[i]["ss_ort11"];
				            var ss_plz = retrieveXmlTempAccountObj.value[i]["ss_plz"];
				            var ss_plz1 = retrieveXmlTempAccountObj.value[i]["ss_plz1"];
				            var ss_rechtsform = retrieveXmlTempAccountObj.value[i]["ss_rechtsform"];
				            var ss_registerart = retrieveXmlTempAccountObj.value[i]["ss_registerart"];
				            var _ss_relatedopportunity_value = retrieveXmlTempAccountObj.value[i]["_ss_relatedopportunity_value"];
				            var _ss_relatedopportunity_value_formatted = retrieveXmlTempAccountObj.value[i]["_ss_relatedopportunity_value@OData.Community.Display.V1.FormattedValue"];
				            var _ss_relatedopportunity_value_lookuplogicalname = retrieveXmlTempAccountObj.value[i]["_ss_relatedopportunity_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
				            var ss_rnr = retrieveXmlTempAccountObj.value[i]["ss_rnr"];
				            var _ss_similaraccountid_value = retrieveXmlTempAccountObj.value[i]["_ss_similaraccountid_value"];
				            var _ss_similaraccountid_value_formatted = retrieveXmlTempAccountObj.value[i]["_ss_similaraccountid_value@OData.Community.Display.V1.FormattedValue"];
				            var _ss_similaraccountid_value_lookuplogicalname = retrieveXmlTempAccountObj.value[i]["_ss_similaraccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
				            var ss_steuerschlssel = retrieveXmlTempAccountObj.value[i]["ss_steuerschlssel"];
				            var ss_strasse = retrieveXmlTempAccountObj.value[i]["ss_strasse"];
				            var ss_strasse1 = retrieveXmlTempAccountObj.value[i]["ss_strasse1"];
				            var ss_telefon = retrieveXmlTempAccountObj.value[i]["ss_telefon"];
				            var ss_telefon1 = retrieveXmlTempAccountObj.value[i]["ss_telefon1"];
				            var ss_vorname = retrieveXmlTempAccountObj.value[i]["ss_vorname"];
				            var ss_vorname1 = retrieveXmlTempAccountObj.value[i]["ss_vorname1"];
				            var ss_xmlchecklisttempaccountid = retrieveXmlTempAccountObj.value[i]["ss_xmlchecklisttempaccountid"];
				            var ss_amtsgericht = retrieveXmlTempAccountObj.value[i]["ss_amtsgericht"];
				            var ss_amtsgerichtvalue = retrieveXmlTempAccountObj.value[i]["ss_amtsgerichtvalue"];//changed M107A3


				            var ss_anzeigeimcockpitadmin = retrieveXmlTempAccountObj.value[i]["ss_anzeigeimcockpitadmin"];
				            var ss_anzeigeimcockpitadmin_formatted = retrieveXmlTempAccountObj.value[i]["ss_anzeigeimcockpitadmin@OData.Community.Display.V1.FormattedValue"];
				            var ss_cockpittype = retrieveXmlTempAccountObj.value[i]["ss_cockpittype"];
				            var ss_cockpittype_formatted = retrieveXmlTempAccountObj.value[i]["ss_cockpittype@OData.Community.Display.V1.FormattedValue"];
				            var ss_ureg = retrieveXmlTempAccountObj.value[i]["ss_ureg"];
				            var ss_gesellschaftsgre = retrieveXmlTempAccountObj.value[i]["ss_gesellschaftsgre"];
				            var ss_gesellschaftsgre_formatted = retrieveXmlTempAccountObj.value[i]["ss_gesellschaftsgre@OData.Community.Display.V1.FormattedValue"];

				            //added by saad to retrieve company type optionset and registerart optionset
				            var ss_new_company_type = retrieveXmlTempAccountObj.value[i]["ss_new_company_type"];
				            var ss_new_company_type_formatted = retrieveXmlTempAccountObj.value[i]["ss_new_company_type@OData.Community.Display.V1.FormattedValue"];
				            var ss_registerartoptionset = retrieveXmlTempAccountObj.value[i]["ss_registerartoptionset"];
				            var ss_registerartoptionset_formatted = retrieveXmlTempAccountObj.value[i]["ss_registerartoptionset@OData.Community.Display.V1.FormattedValue"];
				            var ss_rechtsformoptionset = retrieveXmlTempAccountObj.value[i]["ss_rechtsformoptionset"];
				            var ss_rechtsformoptionset_formatted = retrieveXmlTempAccountObj.value[i]["ss_rechtsformoptionset@OData.Community.Display.V1.FormattedValue"];
				            var ss_steuerschluesseloptionset = retrieveXmlTempAccountObj.value[i]["ss_steuerschluesseloptionset"];
				            var ss_steuerschluesseloptionset_formatted = retrieveXmlTempAccountObj.value[i]["ss_steuerschluesseloptionset@OData.Community.Display.V1.FormattedValue"];
				            var ss_registergerichtoptionset = retrieveXmlTempAccountObj.value[i]["ss_registergerichtoptionset"];
				            var ss_registergerichtoptionset_formatted = retrieveXmlTempAccountObj.value[i]["ss_registergerichtoptionset@OData.Community.Display.V1.FormattedValue"];
				            //saad

				            excluedFromCreateWhenCreatedasaParent = ss_xmlchecklisttempaccountid;
				            var entity = {};
				            entity.ss_iscockpitdbupdated = false;
				            if ($("#PreismodellId")[0].value != null && $("#PreismodellId")[0].value != "") {

				                entity.new_xmlvertragstyp = $("#PreismodellId")[0].value;
				            }

				            if (ss_gesellschaftsgre != null) {
				                entity.ss_gesellschaftsgre = ss_gesellschaftsgre;
				            }

				            if ($("#PreismodellId")[0].value != null && $("#PreismodellId")[0].value != "") {

				                entity.new_xmlvertragstyp = $("#PreismodellId")[0].value;
				            }

				            if (ss_xmlclienttypeVal != 0) {
				                entity.ss_xmlclienttype = ss_xmlclienttypeVal;
				            }
				            entity.ss_mutter = true;
				            entity.ss_xmlchecklistopportunityid = opportunityId;
				            if (ss_firmenname != null) {
				                entity.name = ss_firmenname;
				                entity.address1_name = ss_firmenname;
				            }

				            if (ss_ureg != null) {
				                entity.ss_ureg = ss_ureg;
				            }
				            if (ss_anzeigeimcockpitadmin != null) {
				                entity.ss_anzeigeimcockpitadmin = ss_anzeigeimcockpitadmin;
				            }
				            if (ss_cockpittype != null) {
				                entity.ss_cockpittype = ss_cockpittype;
				            }


				            if (ss_strasse != null) {
				                if (ss_nr != null) {
				                    entity.address1_line1 = ss_strasse + " " + ss_nr;
				                }
				                else {
				                    entity.address1_line1 = ss_strasse;
				                    entity.address1_line2 = ss_strasse;
				                    entity.address1_line3 = ss_strasse;
				                }
				            }
				            if (ss_plz != null) {
				                entity.address1_postalcode = ss_plz;
				            }
				            if (ss_ort != null) {
				                entity.address1_city = ss_ort;
				            }
				            if (ss_homepage != null) {
				                if (ss_homepage.indexOf("http") == -1) {

				                    entity.websiteurl = "https://" + ss_homepage;
				                }
				                else {
				                    entity.websiteurl = ss_homepage;
				                }

				            }
				            if (ss_allgemeineemail != null) {
				                entity.emailaddress1 = ss_allgemeineemail;
				            }
				            if (ss_amtsgericht != null) {
				                entity.ss_amtsgericht = ss_amtsgericht;
				                entity.ss_amtsgerichtvalue = ss_amtsgerichtvalue;
				            }
				            //changed M107A3

				            //added by saad
				            if (ss_registerartoptionset != null) {
				                entity.new_registerart = ss_registerartoptionset;
				            }
				            //saad

				            if (ss_rnr != null) {
				                entity.new_registrierungsnummer = ss_rnr;
				            }

				            //added by saad
				            if (ss_registergerichtoptionset != null) {

				                entity.ss_registergericht = ss_registergerichtoptionset;
				            }


				            if (ss_rechtsformoptionset != null) {
				                entity.new_rechtsform = ss_rechtsformoptionset;
				            }

				            if (ss_steuerschluesseloptionset != null) {
				                //entity.address1_country = ss_steuerschluesseloptionset_formatted;
				                entity.address1_country = "Deutschland";
				                entity.new_steuerschluessel = ss_steuerschluesseloptionset;
				            }

				            if (ss_fax1 != null) {
				                entity.ss_fax = ss_fax1;
				            }

				            if (ss_eqsid != null) {
				                entity.bbo_equitystoryid = ss_eqsid;
				            }
				            if (ss_kundennt != null) {
				                entity.bbo_navid = ss_kundennt;
				            }

				            if (ss_new_company_type != null) {
				                entity.new_company_type = ss_new_company_type;
				            }

				            if (ss_firmenname1 != null) {
				                entity.ss_firmenname = ss_firmenname1;
				            }
				            if (ss_vorname1 != null) {
				                entity.ss_vorname = ss_vorname1;
				            }
				            if (ss_nachname1 != null) {
				                entity.ss_name = ss_nachname1;
				            }
				            if (ss_abteilung1 != null) {
				                entity.ss_abteilung = ss_abteilung1;
				            }
				            if (ss_strasse1 != "") {
				                if (ss_nr1 != null) {
				                    entity.ss_strassehausnummer = ss_strasse1 + ss_nr1;
				                }
				                else {
				                    entity.ss_strassehausnummer = ss_strasse1;
				                }
				            }
				            if (ss_ort11 != null) {
				                entity.ss_ort = ss_ort11;
				            }
				            if (ss_plz1 != "") {
				                entity.ss_plz = ss_plz1;
				            }

				            if (ss_email1 != null) {
				                entity.ss_email = ss_email1;
				            }
				            if (ss_telefon1 != "") {
				                entity.ss_telefon = ss_telefon1;
				            }

				            if (ss_salesrepxmlid != null && ss_salesrepxmlid != "") {
				                entity["ss_salesrepxml@odata.bind"] = "/systemusers(" + ss_salesrepxmlid + ")";
				            }

				            if (_ss_similaraccountid_value != null) {
				                entity.accountid = _ss_similaraccountid_value;
				                entity.ss_alreadyexists = true;
				            }
				            else {
				                if (parentAccount != "" && parentAccount != null && parentAccount != entity.accountid) {
				                    entity["parentaccountid@odata.bind"] = "/accounts(" + parentAccount + ")";
				                }
				            }

				            if (_ss_wirtschaftsprfer_value != "" && _ss_wirtschaftsprfer_value != null) {
				                entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts(" + _ss_wirtschaftsprfer_value + ")";
				            }
				            //

				            //added by saad
				            if (ss_verifiedbyxml_UpdateOwner != "" && ss_verifiedbyxml_UpdateOwner != null) {
				                entity["ownerid@odata.bind"] = "/systemusers(" + ss_verifiedbyxml_UpdateOwner + ")";
				                entity["new_xmlchecklistverifiedbyxml@odata.bind"] = "/systemusers(" + ss_verifiedbyxml_UpdateOwner + ")";
				            }

				            if (ss_verifiedbynewsroom_UpdateOwner != "" && ss_verifiedbynewsroom_UpdateOwner != null) {
				                entity["new_xmlchecklistverifiedbynewsroom@odata.bind"] = "/systemusers(" + ss_verifiedbynewsroom_UpdateOwner + ")";
				            }

				            if (ss_abweichenderechnungsanschrift != "" && ss_abweichenderechnungsanschrift != null) {
				                entity.new_abweichenderechnungsanschrift = ss_abweichenderechnungsanschrift;
				            }

				            if (ss_vertragberwirtschaftsprfer != "" && ss_vertragberwirtschaftsprfer != null) {
				                entity.new_contractviawp = ss_vertragberwirtschaftsprfer;
				            }

				            if (ss_notizen != "" && ss_notizen != null) {
				                entity.new_noteswp = ss_notizen;
				            }

				            if (ss_notes != "" && ss_notes != null) {
				                entity.new_notesxmlchecklist = ss_notes;
				            }

				            if (ss_vertragurl != "" && ss_vertragurl != null) {
				                entity.new_xmlcontracturl = ss_vertragurl;
				            }

				            if (ss_firmenlisturl != "" && ss_firmenlisturl != null) {
				                entity.new_xmlcompanylisturl = ss_firmenlisturl;
				            }

				            if (_ss_wpkontakt_value != "" && _ss_wpkontakt_value != null) {
				                entity["new_contactwp@odata.bind"] = "/contacts(" + _ss_wpkontakt_value + ")";
				            }
				            //saad


				            var req1 = new XMLHttpRequest();
				            req1.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts", false);
				            req1.setRequestHeader("OData-MaxVersion", "4.0");
				            req1.setRequestHeader("OData-Version", "4.0");
				            req1.setRequestHeader("Accept", "application/json");
				            req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				            req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				            req1.onreadystatechange = function () {
				                if (this.readyState === 4) {
				                    req1.onreadystatechange = null;
				                    if (this.status === 204) {

				                        var uri = this.getResponseHeader("OData-EntityId");
				                        var regExp = /\(([^)]+)\)/;
				                        var matches = regExp.exec(uri);
				                        parentCreated = true;
				                        parentAccount = matches[1];




				                    } else {
				                        hideLoadingMessage();
				                        var errorText = JSON.parse(this.responseText).error.message;
				                        exceptionMessage(errorText);
				                        LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 2");
				                        window.close();
				                    }
				                }
				            };
				            req1.send(JSON.stringify(entity));

				        }
				    }
				    else
				    {
				        createUpdateAccountsCallResult = "failed";
				        return;
				    }

				}


				// if we have failed to identify the parent account then get the parent account from the related entity
				if (parentAccount == "") {

				    retrieveOpportunities(opportunityId);

				    //var retrieveOpportunitiesObj = retrieveOpportunities(opportunityId);
				    if(retrieveOpportunitiesObj != null)
				    {
				        var _parentaccountid_value = retrieveOpportunitiesObj["_parentaccountid_value"];
				        var _parentaccountid_value_formatted = retrieveOpportunitiesObj["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
				        var _parentaccountid_value_lookuplogicalname = retrieveOpportunitiesObj["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

				        if (_parentaccountid_value != null) {
				            parentAccount = _parentaccountid_value;
				        }
				    }
				    else
				    {
				        createUpdateAccountsCallResult = "failed";
				        return;
				    }
				}

				var createAccount = false;
				var updateAccount = false;

				var entityCollection = new Array();
				$(".loder-text p").html("Creating Companies..");

				retrieveXmlTempAccountToUpdateRealAccount(opportunityId);

				//var results = retrieveXmlTempAccountToUpdateRealAccount(opportunityId);
				if (retrieveXmlTempAccountToUpdateRealAccountObj != null)
				{
				    for (var i = 0; i < retrieveXmlTempAccountToUpdateRealAccountObj.value.length; i++) {
				        var ss_abteilung1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_abteilung1"];
				        var ss_abweichenderechnungsanschrift = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_abweichenderechnungsanschrift"];
				        var ss_abweichenderechnungsanschrift_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_abweichenderechnungsanschrift@OData.Community.Display.V1.FormattedValue"];
				        var ss_allgemeineemail = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_allgemeineemail"];
				        var ss_anrede = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_anrede"];
				        var ss_artdergesellschaft = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_artdergesellschaft"];
				        var ss_artdergesellschafttext = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_artdergesellschafttext"];
				        var ss_email = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_email"];
				        var ss_email1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_email1"];
				        var ss_eqsid = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_eqsid"];
				        var ss_fax = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_fax"];
				        var ss_fax1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_fax1"];
				        var ss_firmenname = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_firmenname"];
				        var ss_firmenname1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_firmenname1"];
				        var ss_gesellschatsgr = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_gesellschatsgr"];
				        var ss_homepage = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_homepage"];
				        var ss_kundennt = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_kundennt"];
				        var ss_mutter = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_mutter"];
				        var ss_mutter_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_mutter@OData.Community.Display.V1.FormattedValue"];
				        var ss_nachname = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_nachname"];
				        var ss_nachname1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_nachname1"];
				        var ss_nr = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_nr"];
				        var ss_nr1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_nr1"];
				        var ss_ort = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_ort"];

				        var ss_ort1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_ort1"];
						//changed asim
				        var ss_ort1value = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_ort1value"];

				        var ss_ort11 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_ort11"];
				        var ss_plz = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_plz"];
				        var ss_plz1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_plz1"];
				        var ss_rechtsform = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_rechtsform"];
				        var ss_registerart = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_registerart"];
				        var _ss_relatedopportunity_value = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_relatedopportunity_value"];
				        var _ss_relatedopportunity_value_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_relatedopportunity_value@OData.Community.Display.V1.FormattedValue"];
				        var _ss_relatedopportunity_value_lookuplogicalname = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_relatedopportunity_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
						var ss_rnr = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_rnr"];
						var _ss_similaraccountid_value = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_similaraccountid_value"];
						var _ss_similaraccountid_value_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_similaraccountid_value@OData.Community.Display.V1.FormattedValue"];
						var _ss_similaraccountid_value_lookuplogicalname = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["_ss_similaraccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
						var ss_steuerschlssel = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_steuerschlssel"];
						var ss_strasse = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_strasse"];
						var ss_strasse1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_strasse1"];
						var ss_telefon = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_telefon"];
						var ss_telefon1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_telefon1"];
						var ss_vorname = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_vorname"];
						var ss_vorname1 = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_vorname1"];
						var ss_xmlchecklisttempaccountid = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_xmlchecklisttempaccountid"];
						var ss_amtsgericht = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_amtsgericht"];
						var ss_amtsgerichtvalue = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_amtsgerichtvalue"];//changed M107A3

						var ss_anzeigeimcockpitadmin = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_anzeigeimcockpitadmin"];
						var ss_anzeigeimcockpitadmin_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_anzeigeimcockpitadmin@OData.Community.Display.V1.FormattedValue"];
						var ss_cockpittype = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_cockpittype"];
						var ss_cockpittype_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_cockpittype@OData.Community.Display.V1.FormattedValue"];
						var ss_ureg = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_ureg"];
						var ss_gesellschaftsgre = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_gesellschaftsgre"];
						var ss_gesellschaftsgre_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_gesellschaftsgre@OData.Community.Display.V1.FormattedValue"];
						var entity = {};

						//added by saad to retrieve company type optionset and registerart optionset
						var ss_new_company_type = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_new_company_type"];
						var ss_new_company_type_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_new_company_type@OData.Community.Display.V1.FormattedValue"];
						var ss_registerartoptionset = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_registerartoptionset"];
						var ss_registerartoptionset_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_registerartoptionset@OData.Community.Display.V1.FormattedValue"];
						var ss_rechtsformoptionset = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_rechtsformoptionset"];
						var ss_rechtsformoptionset_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_rechtsformoptionset@OData.Community.Display.V1.FormattedValue"];
						var ss_steuerschluesseloptionset = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_steuerschluesseloptionset"];
						var ss_steuerschluesseloptionset_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_steuerschluesseloptionset@OData.Community.Display.V1.FormattedValue"];
						var ss_registergerichtoptionset = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_registergerichtoptionset"];
						var ss_registergerichtoptionset_formatted = retrieveXmlTempAccountToUpdateRealAccountObj.value[i]["ss_registergerichtoptionset@OData.Community.Display.V1.FormattedValue"];
						//saad

						if ($("#PreismodellId")[0].value != null && $("#PreismodellId")[0].value != "") {

							entity.new_xmlvertragstyp = $("#PreismodellId")[0].value;
						}

						if (ss_gesellschaftsgre != null) {
							entity.ss_gesellschaftsgre = ss_gesellschaftsgre;
						}
						if (ss_xmlclienttypeVal != 0) {
							entity.ss_xmlclienttype = ss_xmlclienttypeVal;
						}

						if (ss_ureg != null) {
							entity.ss_ureg = ss_ureg;
						}
						if (ss_anzeigeimcockpitadmin != null) {
							entity.ss_anzeigeimcockpitadmin = ss_anzeigeimcockpitadmin;
						}
						if (ss_cockpittype != null) {
							entity.ss_cockpittype = ss_cockpittype;
						}


						entity.ss_xmlchecklistopportunityid = opportunityId;
						entity.ss_iscockpitdbupdated = false;

						if (ss_amtsgericht != null) {
							entity.ss_amtsgericht = ss_amtsgericht;
							entity.ss_amtsgerichtvalue = ss_amtsgerichtvalue;//changed M107A3
						}


						if (ss_firmenname != null) {
							entity.name = ss_firmenname;
							entity.address1_name = ss_firmenname;
						}

						if (ss_strasse != null) {
							if (ss_nr != null) {
								entity.address1_line1 = ss_strasse + " " + ss_nr;
							}
							else {
								entity.address1_line1 = ss_strasse;
							}
						}
						else {
							if (ss_nr != null) {
								entity.address1_line1 = ss_nr;
							}
						}
						if (ss_plz != null) {
							entity.address1_postalcode = ss_plz;
						}
						if (ss_ort != null) {
							entity.address1_city = ss_ort;
						}
						if (ss_homepage != null) {

							if (ss_homepage.indexOf("http") == -1) {

								entity.websiteurl = "https://" + ss_homepage;
							}
							else {
								entity.websiteurl = ss_homepage;
							}

						}
						if (ss_allgemeineemail != null) {
							entity.emailaddress1 = ss_allgemeineemail;
						}

						//added by saad
						if(ss_registerartoptionset != null)
						{
							entity.new_registerart = ss_registerartoptionset;
						}
						//saad

						if (ss_rnr != null) {
							entity.new_registrierungsnummer = ss_rnr; //what to do about this field?
						}

						//added by saad
						if (ss_registergerichtoptionset != null) {

							entity.ss_registergericht = ss_registergerichtoptionset;
						}

						if (ss_rechtsformoptionset != null) {
							entity.new_rechtsform = ss_rechtsformoptionset;
						}

						if (ss_steuerschluesseloptionset != null) {
							//entity.address1_country = ss_steuerschluesseloptionset_formatted;
							entity.address1_country = "Deutschland";
							entity.new_steuerschluessel = ss_steuerschluesseloptionset;
						}

						if (ss_fax1 != null) {
							entity.ss_fax = ss_fax1;
						}

						if (ss_eqsid != null) {
							entity.bbo_equitystoryid = ss_eqsid;
						}
						if (ss_kundennt != null) {
							entity.bbo_navid = ss_kundennt;
						}
						//added by saad
						if(ss_new_company_type != null)
						{
							entity.new_company_type = ss_new_company_type;
						}

						if (ss_firmenname1 != null) {
							entity.ss_firmenname = ss_firmenname1;
						}
						if (ss_vorname1 != null) {
							entity.ss_vorname = ss_vorname1;
						}
						if (ss_nachname1 != null) {
							entity.ss_name = ss_nachname1;
						}
						if (ss_abteilung1 != null) {
							entity.ss_abteilung = ss_abteilung1;
						}
						if (ss_strasse1 != "") {
							if (ss_nr1 != null) {
								entity.ss_strassehausnummer = ss_strasse1 + ss_nr1;
							}
							else {
								entity.ss_strassehausnummer = ss_strasse1;
							}
						}
						if (ss_ort11 != null) {
							entity.ss_ort = ss_ort11;
						}
						if (ss_plz1 != "") {
							entity.ss_plz = ss_plz1;
						}

						if (ss_email1 != null) {
							entity.ss_email = ss_email1;
						}
						if (ss_telefon1 != "") {
							entity.ss_telefon = ss_telefon1;
						}

						if (_ss_similaraccountid_value != null) {
							entity.accountid = _ss_similaraccountid_value;
							entity.ss_alreadyexists = true;
						}

						if (ss_salesrepxmlid != null && ss_salesrepxmlid != "") {
							entity["ss_salesrepxml@odata.bind"] = "/systemusers(" + ss_salesrepxmlid + ")";
						}

						if (parentAccount != "" && parentAccount != null && parentAccount != entity.accountid) {
							entity["parentaccountid@odata.bind"] = "/accounts(" + parentAccount + ")";
						}

						if (_ss_wirtschaftsprfer_value != "" && _ss_wirtschaftsprfer_value != null) {
							entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts(" + _ss_wirtschaftsprfer_value + ")";
						}

                        //


						//added by saad
						if (ss_verifiedbyxml_UpdateOwner != "" && ss_verifiedbyxml_UpdateOwner != null) {
							entity["ownerid@odata.bind"] = "/systemusers(" + ss_verifiedbyxml_UpdateOwner + ")";
							entity["new_xmlchecklistverifiedbyxml@odata.bind"] = "/systemusers(" + ss_verifiedbyxml_UpdateOwner + ")";
						}

						if (ss_verifiedbynewsroom_UpdateOwner != "" && ss_verifiedbynewsroom_UpdateOwner != null) {
							entity["new_xmlchecklistverifiedbynewsroom@odata.bind"] = "/systemusers(" + ss_verifiedbynewsroom_UpdateOwner + ")";
						}

						if(ss_abweichenderechnungsanschrift != "" && ss_abweichenderechnungsanschrift != null)
						{
							entity.new_abweichenderechnungsanschrift = ss_abweichenderechnungsanschrift;
						}

						if(ss_vertragberwirtschaftsprfer != "" && ss_vertragberwirtschaftsprfer != null)
						{
							entity.new_contractviawp = ss_vertragberwirtschaftsprfer;
						}

						if(ss_notizen != "" && ss_notizen != null)
						{
							entity.new_noteswp = ss_notizen;
						}

						if(ss_notes != "" && ss_notes != null)
						{
							entity.new_notesxmlchecklist = ss_notes;
						}

						if(ss_vertragurl != "" && ss_vertragurl != null)
						{
							entity.new_xmlcontracturl = ss_vertragurl;
						}

						if(ss_firmenlisturl != "" && ss_firmenlisturl != null)
						{
							entity.new_xmlcompanylisturl = ss_firmenlisturl;
						}
                        //added for testing purpose
						//entity["abcd"] = "asdf";
						if(_ss_wpkontakt_value != "" && _ss_wpkontakt_value != null)
						{
							entity["new_contactwp@odata.bind"] = "/contacts(" + _ss_wpkontakt_value + ")";
						}

						if (excluedFromCreateWhenCreatedasaParent != ss_xmlchecklisttempaccountid) {
							var body = JSON.stringify(entity);
							entityCollection.push(body);
						}
				    }

					var dataCreate = [];
					dataCreate.push('--batch_123456');
					dataCreate.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
					dataCreate.push('');
					var k = 0;
					for (var i = 0; i < entityCollection.length; i++) {
						if (JSON.parse(entityCollection[i])["accountid"] == undefined) {
							k = k + 1;
							createAccount = true;
							dataCreate.push('--changeset_BBB456');
							dataCreate.push('Content-Type:application/http');
							dataCreate.push('Content-Transfer-Encoding:binary');
							var id = k;
							dataCreate.push('Content-ID:' + id);
							dataCreate.push('');
							dataCreate.push('POST ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/accounts HTTP/1.1');

							dataCreate.push('Content-Type:application/json;type=entry');
							dataCreate.push('');
							dataCreate.push(entityCollection[i]);
						}
					}

					dataCreate.push('--changeset_BBB456--');
					dataCreate.push('--batch_123456--');
					var payloadCreate = dataCreate.join('\r\n');


					if (createAccount == true) {

						$.ajax({
							method: 'POST',

							url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
							headers: {
								'Content-Type': 'multipart/mixed;boundary=batch_123456',
								'Accept': 'application/json',
								'Odata-MaxVersion': '4.0',
								'Odata-Version': '4.0'
							},
							data: payloadCreate,
							async: false,
							success: function (data, textStatus, xhr) {
							    var sendContactsBatch = true;
								var d = data.split("\n");
								for (var i = 0; i < d.length; i++) {
									if (d[i].indexOf("OData-EntityId") != -1) {
										var uri = d[i];
										var regExp = /\(([^)]+)\)/;

										var matches = regExp.exec(uri);
										if (matches != undefined) {
											var newEntityId = matches[1];

											accoundIDS.push(newEntityId);

										}
									}

								    //added by saad to handle error which comes in success message
									if (d[i].indexOf("error") != -1)
									{
									    if (d[i+1].indexOf("code") != -1)
									    {
									        var codeindex = d[i + 1].indexOf("code");
									        var innererrorIndex = d[i+1].indexOf("innererror");
									        var errorSubstring = d[i + 1].substring(codeindex + 20, innererrorIndex - 3);
									        createUpdateAccountsCallResult = "failed";
									        sendContactsBatch = false;
									        alert(errorSubstring);
									        window.close();
									    }
									}
								}
								if (sendContactsBatch == true)
								{
								    createContactsBatchRequest(accoundIDS);
								}
							},
							error: function (xhr, textStatus, errorThrown) {
							    createUpdateAccountsCallResult = "failed";

								alert("Error Occurred in creating Accounts \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);
								//LogExceptioninCRM(errorThrown, 0, "error in createUpdateAccounts 5");
							    //window.close();
							    return;
							}
						});
					}

					var dataUpdate = [];
					dataUpdate.push('--batch_123456');
					dataUpdate.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
					dataUpdate.push('');
					var l = 0;
					for (var i = 0; i < entityCollection.length; i++) {
					    if (JSON.parse(entityCollection[i])["accountid"] != undefined) {
					        l = l + 1;
					        updateAccount = true;
					        accoundIDS.push(JSON.parse(entityCollection[i])["accountid"]);
					        dataUpdate.push('--changeset_BBB456');
					        dataUpdate.push('Content-Type:application/http');
					        dataUpdate.push('Content-Transfer-Encoding:binary');
					        var id = l;
					        dataUpdate.push('Content-ID:' + id);
					        dataUpdate.push('');
					        dataUpdate.push('PATCH ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/accounts(' + JSON.parse(entityCollection[i])["accountid"] + ') HTTP/1.1');
					        dataUpdate.push('Content-Type:application/json;type=entry');
					        dataUpdate.push('');
					        dataUpdate.push(entityCollection[i]);
					    }
					}
					dataUpdate.push('--changeset_BBB456--');
					dataUpdate.push('--batch_123456--');
					var payload = dataUpdate.join('\r\n');

					if (updateAccount == true)
					{
                            $(".loder-text p").html("Updating Companies..");
                            $.ajax(
                            {
                                method: 'POST',
                                url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
                                headers: {
                                    'Content-Type': 'multipart/mixed;boundary=batch_123456',
                                    'Accept': 'application/json',
                                    'Odata-MaxVersion': '4.0',
                                    'Odata-Version': '4.0'

                                },

                                data: payload,
                                async: false,
                                success: function (data, textStatus, xhr) {
                                    //added by saad to handle error which comes in success message
                                    var sendContactsBatch = true;
                                    var d = data.split("\n");
                                    for (var i = 0; i < d.length; i++) {

                                        if (d[i].indexOf("error") != -1) {
                                            if (d[i + 1].indexOf("code") != -1) {
                                                var codeindex = d[i + 1].indexOf("code");
                                                var innererrorIndex = d[i + 1].indexOf("innererror");
                                                var errorSubstring = d[i + 1].substring(codeindex + 20, innererrorIndex - 3);
                                                createUpdateAccountsCallResult = "failed";
                                                sendContactsBatch = false;
                                                alert(errorSubstring);
                                                window.close();
                                            }
                                        }
                                    }
                                    if (sendContactsBatch == true) {
                                        createContactsBatchRequest(accoundIDS);
                                    }
                                    //  deleteDummyaccounts();
                                },
                                error: function (xhr, data, textStatus, errorThrown) {
                                    debugger;

                                    createUpdateAccountsCallResult = "failed";

                                    // alert("Error Occurred " + textStatus + " " + errorThrown);
                                    alert("Error Occurred in updating Accounts\n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);
                                    //LogExceptioninCRM(errorThrown, 0, "error in createUpdateAccounts 6");
                                    //exceptionMessage(this.responseText);
                                    // alert(data, textStatus + " " + errorThrown);
                                    window.close();
                                }
                            });
                        }
                        else {
                            //  deleteDummyaccounts();
                        }

				}
				else
				{
				    createUpdateAccountsCallResult = "failed";
				    return;
				}
			}
		    catch (e) {
		        createUpdateAccountsCallResult = "failed";
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in createUpdateAccounts");
			}
		}

		function createContactsBatchRequest(accoundIDS)
		{


		    var retrieveRequest = [];
		    retrieveRequest.push('--batch_123456');
		    retrieveRequest.push('Content-Type: application/http');
		    retrieveRequest.push('Content-Transfer-Encoding:binary');
		    retrieveRequest.push('\n');
		    var filter = "";
		    for (var i = 0; i < accoundIDS.length; i++) {
		        if (i == accoundIDS.length - 1) {
		            filter += "accountid eq " + accoundIDS[i];

		        }
		        else {
		            filter += "accountid eq " + accoundIDS[i] + " or ";
		        }
		    }
		    retrieveRequest.push('GET ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/accounts?$select=name&$filter=' + filter + ' HTTP/1.1');
		    // retrieveRequest.push('Accept: application/json');
		    retrieveRequest.push('\n');
		    retrieveRequest.push('--batch_123456--');
		    retrieveRequest.push('\n');
		    var payloadRetrieve = retrieveRequest.join('\r\n');

		    var req1 = new XMLHttpRequest();
		    req1.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/$batch", false);
		    req1.setRequestHeader("OData-MaxVersion", "4.0");
		    req1.setRequestHeader("OData-Version", "4.0");
		    req1.setRequestHeader("Accept", "application/json");
		    req1.setRequestHeader("Content-Type", "multipart/mixed;boundary=batch_contactfetch");
		    req1.onreadystatechange = function () {
		        if (this.readyState === 4) {
		            req1.onreadystatechange = null;
		            if (this.status === 200) {

		                debugger
		                var response = JSON.parse(this.response.substring(this.response.indexOf('{'), this.response.lastIndexOf('}') + 1));

		                for (var i = 0; i < response.value.length; i++) {
		                    var name = response.value[i]["name"];
		                    var id = response.value[i]["accountid"];
		                    accountname.push(name);
		                    accountRetrieveIds.push(id);

		                }
		                createContacts();
		            } else {
		                debugger;

		                createUpdateAccountsCallResult = "failed";

		                var errorText = JSON.parse(this.responseText).error.message;
		                //exceptionMessage(errorText);
		                //LogExceptioninCRM(errorText, this.status, "error in createUpdateAccounts 7");
		                //opener.Xrm.Utility.alertDialog(this.responseText);
		                window.close();
		                alert(errorText);
		            }
		        }
		    };

		    var body = '--batch_contactfetch\n'
		    body += 'Content-Type: application/http\n'
		    body += 'Content-Transfer-Encoding: binary\n'
		    body += '\n'
		    body += 'GET ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/accounts?$select=name&$filter=' + filter + ' HTTP/1.1\n'
		    body += 'Content-Type: application/json\n'
		    body += 'OData-Version: 4.0\n'
		    body += 'OData-MaxVersion: 4.0\n'
		    body += '\n'
		    body += '--batch_contactfetch--'

		    req1.send(body);
		}

		function retrievedataFromAccounts() {
			try {
				var opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");

				var fetch = '<fetch>' +
							   '<entity name="account" >' +
								 '<attribute name="ss_mutter" />' +
								 '<attribute name="bbo_navid" />' +
								 '<attribute name="address1_country" />' +
								 '<attribute name="address1_postalcode" />' +
								 '<attribute name="ss_artdergesellschaft" />' +
								 '<attribute name="ss_artdergesellschafttext" />' +

								//added attribute by saad
								'<attribute name="new_company_type" />' +
								'<attribute name="new_rechtsform" />' +
                                '<attribute name="new_steuerschluessel" />' +
                                '<attribute name="ss_registergericht" />' +
								//saad

								 '<attribute name="ss_firmenname" />' +
								' <attribute name="ss_vorname" />' +
								 '<attribute name="ss_name" />' +
								 '<attribute name="ss_abteilung" />' +
								 '<attribute name="ss_strassehausnummer" />' +
								 '<attribute name="ss_plz" />' +
								 '<attribute name="ss_ort" />' +
								 '<attribute name="ss_telefon" />' +
								 '<attribute name="ss_fax" />' +
								 '<attribute name="ss_email" />' +
								 '<attribute name="ss_rechtsform" />' +
								 '<attribute name="ss_amtsgericht" />' +
								 '<attribute name="ss_amtsgerichtvalue" />' +
								 '<attribute name="address1_line1" />' +
								 '<attribute name="bbo_equitystoryid" />' +
								 '<attribute name="address1_city" />' +
								' <attribute name="name" />' +
								 '<attribute name="websiteurl" />' +
								 '<attribute name="emailaddress1" />' +
								' <attribute name="ss_registergerichtvalue" />' +
								' <attribute name="new_registergericht" />' +
								 '<attribute name="new_registrierungsnummer" />' +
								 '<attribute name="new_registerart" />' +
								' <attribute name="parentaccountid" />' +
								' <attribute name="parentaccountidname" />' +
								' <attribute name="new_registerartname" />' +
								' <attribute name="ss_gesellschaftsgre" />' +
								' <attribute name="ss_cockpittype" />' +
								 '<attribute name="ss_cockpittypename" />' +
								 ' <attribute name="ss_anzeigeimcockpitadminname" />' +
								 ' <attribute name="ss_anzeigeimcockpitadmin" />' +
								 '  <attribute name="ss_ureg" />' +
								' <filter>' +
								  ' <condition attribute="ss_xmlchecklistopportunityid" operator="eq" value="' + opportunityId + '" />' +
								  '<condition entityname="contact" attribute="ss_iscreatedfromworkflow" operator="eq" value="1" />' +
								 '</filter>' +
								 '<link-entity name="contact" from="parentcustomerid" to="accountid" >' +
								   '<attribute name="salutation" />' +
                                   '<attribute name="bbo_salutation" />' +
								   '<attribute name="fax" />' +
								   '<attribute name="lastname" />' +
								   '<attribute name="firstname" />' +
								   '<attribute name="telephone1" />' +
								  ' <attribute name="emailaddress1" />' +
								' </link-entity>' +
							  ' </entity>' +
							 '</fetch>';

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?fetchXml=" + fetch, true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							var account = "";
							var COLOR1 = "#A9A9A9";
							var COLOR2 = "#FFA500";
							var bgcolor = "#A9A9A9";
							var counter = 0;


							for (var i = 0; i < results.value.length; i++) {

								var address1_city = results.value[i]["address1_city"];
								var address1_country = results.value[i]["address1_country"];
								var address1_line1 = results.value[i]["address1_line1"];
								var address1_postalcode = results.value[i]["address1_postalcode"];
								var bbo_equitystoryid = results.value[i]["bbo_equitystoryid"];
								var emailaddress1 = results.value[i]["emailaddress1"];
								var name = results.value[i]["name"];
								var new_registerart = results.value[i]["new_registerart"];
								var new_registerart_formatted = results.value[i]["new_registerart@OData.Community.Display.V1.FormattedValue"];
								var new_registergericht = results.value[i]["new_registergericht"];
								var new_registrierungsnummer = results.value[i]["new_registrierungsnummer"];
								var ss_abteilung = results.value[i]["ss_abteilung"];
								var ss_artdergesellschaft = results.value[i]["ss_artdergesellschaft"];
								var ss_artdergesellschafttext = results.value[i]["ss_artdergesellschafttext"];

								//added attribute by saad
								var ss_new_company_type = results.value[i]["new_company_type"];
								var ss_new_company_type_formatted = results.value[i]["new_company_type@OData.Community.Display.V1.FormattedValue"];
								var new_rechtsform = results.value[i]["new_rechtsform"];
								var new_rechtsform_formatted = results.value[i]["new_rechtsform@OData.Community.Display.V1.FormattedValue"];
								var new_steuerschluessel = results.value[i]["new_steuerschluessel"];
								var new_steuerschluessel_formatted = results.value[i]["new_steuerschluessel@OData.Community.Display.V1.FormattedValue"];
								var ss_registergericht = results.value[i]["ss_registergericht"];
								var ss_registergericht_formatted = results.value[i]["ss_registergericht@OData.Community.Display.V1.FormattedValue"];



								var bbo_navid = results.value[i]["bbo_navid"];
								var ss_email = results.value[i]["ss_email"];
								var ss_fax = results.value[i]["ss_fax"];
								var ss_firmenname = results.value[i]["ss_firmenname"];
								var ss_name = results.value[i]["ss_name"];
								var ss_ort = results.value[i]["ss_ort"];
								var ss_plz = results.value[i]["ss_plz"];
								var ss_rechtsform = results.value[i]["ss_rechtsform"];
								var ss_strassehausnummer = results.value[i]["ss_strassehausnummer"];
								var ss_telefon = results.value[i]["ss_telefon"];
								var ss_vorname = results.value[i]["ss_vorname"];
								var websiteurl = results.value[i]["websiteurl"];
								var ss_Gesellschaftsgre = results.value[i]["ss_gesellschaftsgre"];
								var _parentaccountid_value = results.value[i]["_parentaccountid_value"];
								var _parentaccountid_value_formatted = results.value[i]["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
								var _parentaccountid_value_lookuplogicalname = results.value[i]["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
								var ss_amtsgericht = results.value[i]["ss_amtsgericht"];
								var ss_amtsgerichtvalue = results.value[i]["ss_amtsgerichtvalue"]; //changed M107A3
								var ss_mutter = results.value[i]["ss_mutter"];
								var ss_mutter_formatted = results.value[i]["ss_mutter@OData.Community.Display.V1.FormattedValue"];

								var ss_anzeigeimcockpitadmin = results.value[i]["ss_anzeigeimcockpitadmin"];
								var ss_anzeigeimcockpitadmin_formatted = results.value[i]["ss_anzeigeimcockpitadmin@OData.Community.Display.V1.FormattedValue"];
								var ss_cockpittype = results.value[i]["ss_cockpittype"];
								var ss_cockpittype_formatted = results.value[i]["ss_cockpittype@OData.Community.Display.V1.FormattedValue"];
								var ss_ureg = results.value[i]["ss_ureg"];


								var firstname = results.value[i]["contact1_x002e_firstname"];
								var lastname = results.value[i]["contact1_x002e_lastname"];
								var telephone1 = results.value[i]["contact1_x002e_telephone1"];
								var salutation = results.value[i]["contact1_x002e_salutation"];
								var emailaddress1contact = results.value[i]["contact1_x002e_emailaddress1"];
								var fax = results.value[i]["contact1_x002e_fax"];

								var bbo_salutation;
								if (results.value[i]["contact1_x002e_bbo_salutation"])
								{
								    //bbo_salutation = results.value[i]["contact1_x002e_bbo_salutation"];
								    bbo_salutation = results.value[i]["contact1_x002e_bbo_salutation@OData.Community.Display.V1.FormattedValue"];
								}



								bgcolor = bgcolor == COLOR1 ? COLOR2 : COLOR1;
								counter += 1;
								account += '<form style="background-color:' + bgcolor + '" class="form-style fixed-height forms">' +
								'<div class="row form-inline form-group">' +
									' <div class="col-md-3">' +
										'<label class="control-label">Firma' + counter + ':</label>' +
										'<label class="checkbox-inline">';
								if (ss_mutter == true) {
									account += '   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" checked="checked" value="">Mutter';
								}
								else {
									account += '   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" value="">Mutter';
								}

								account += ' </label>' +
									' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">EQS-ID:</label>';
								if (bbo_equitystoryid != null) {
									account += '<input name="EQS-ID" value="' + bbo_equitystoryid + '" type="text" onchange="updateAccount(this)" class="form-control input-sm" readonly />';

								}
								else {
									account += '<input name="EQS-ID" type="text" onchange="updateAccount(this)" class="form-control input-sm" readonly />';
								}
								//'<p class="text-muted text-center"> "Account" [bbo_equitystoryid]</p>'+
								account += '</div>' +
									'<div class="col-md-5">' +
										' <label class="control-label">Kunden-Nr:</label>';
								if (bbo_navid != null) {
									account += '<input name="Kunden-Nr" value="' + bbo_navid + '" type="text" maxlength="10" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += '<input name="Kunden-Nr" value="" type="text" maxlength="10" onchange="updateAccount(this)" class="form-control input-sm" />';
								}

								//'<p class="text-muted text-center"> "Account" [ss_companyadminid]</p>'+
								account += ' </div>' +
								' </div>' +
								'<div class="row form-group">' +
									'<div class="col-md-4">' +
										' <label class="control-label">Firmenname:</label>';

								if (name != null) {
									//companiesName.push(ss_firmenname);
									//similaraccountName.push(ss_firmenname);

									account += ' <input type="text" name="FirmennameId" value = "' + name + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="FirmennameId" onchange="updateAccount(this)" class="form-control input-sm" />';
								}

								account += '</div>' +
											'<div class="col-md-4">' +
												' <label class="control-label">Strasse:</label>';


								if (address1_line1 != null) {

									var names = "";
									var firstDigit = address1_line1.match(/\d/); //will give you the first digit in the string
									var index = address1_line1.indexOf(firstDigit);
									names = address1_line1.substring(0, index);
									var numberss = address1_line1.substring(index, address1_line1.length);


									account += ' <input type="text" name="StrasseId" value = "' + names + '" onchange="updateAccount(this)" class="form-control input-sm" />';

								}
								else {
									account += ' <input type="text" name="StrasseId" onchange="updateAccount(this)" class="form-control input-sm"  />';


								}
								if (address1_line1 != null) {
									var names = "";
									var firstDigit = address1_line1.match(/\d/); //will give you the first digit in the string
									var index = address1_line1.indexOf(firstDigit);
									names = address1_line1.substring(0, index);
									var numberss = address1_line1.substring(index, address1_line1.length);

									account += ' </div>' +
										   '<div class="col-md-2">' +
											   '  <label class="control-label">Nr.:</label>' +
											   '  <input type="text" name="NrId" value = "' + numberss + '" onchange="updateAccount(this)" class="form-control input-sm"  />' +
										   '  </div>';
								}
								else {
									account += ' </div>' +
										   '<div class="col-md-2">' +
											   '  <label class="control-label">Nr.:</label>' +
											   '  <input type="text" name="NrId" onchange="updateAccount(this)" class="form-control input-sm"  />' +
										   '  </div>';

								}


								account += ' <div class="col-md-2">' +
												' <label class="control-label">PLZ:</label>';

								if (address1_postalcode != null) {
									account += ' <input type="text" name="PLZId" value = "' + address1_postalcode + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="PLZId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}
								account += '  </div>' +
											 ' <div class="col-md-2">' +
												 ' <label class="control-label">Ort:</label>';

								if (address1_city != null) {
									account += ' <input type="text" name="OrtId" value = "' + address1_city + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="OrtId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}
								account += '</div>' +
											'</div> <div class="row form-group"> </div>';

								if (ss_Gesellschaftsgre != null) {
									account += '<div class="row form-group">' +
													' <div class="col-md-3">' +
														'<label class="control-label">Gesellschaftsgröße.:</label>' +
														' <input type="text" name="GesellschatsgrId" value = "' + ss_Gesellschaftsgre + '" onchange="updateAccount(this)" class="form-control input-sm" />' +
													'</div>' +
													' <div class="col-md-4">' +
														' <label class="control-label">Homepage:</label>';
								}
								else {
									account += '<div class="row form-group">' +
												   ' <div class="col-md-3">' +
													   '<label class="control-label">Gesellschaftsgröße.:</label>' +
													   ' <input type="text" name="GesellschatsgrId" onchange="updateAccount(this)" class="form-control input-sm" />' +
												   '</div>' +
												   ' <div class="col-md-4">' +
													   ' <label class="control-label">Homepage:</label>';
								}
								if (websiteurl != null) {
									account += ' <input type="text" name="HomepageId" value = "' + websiteurl + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="HomepageId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-4">' +
												' <label class="control-label">Allgemeine Email:</label>';

								if (emailaddress1 != null) {
									account += ' <input type="text" name="AllgemeineEmailId" value = "' + emailaddress1 + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="AllgemeineEmailId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											  '  </div>' +
											  '<div class="row form-group">' +
												  ' <div class="col-md-2">' +
													  '<label class="control-label">Anrede</label>';
								//if (salutation != null) {
								//	account += ' <input type="text" name="AnredeId" value = "' + salutation + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								//}
								//else {
								//	account += ' <input type="text" name="AnredeId" onchange="updateAccount(this)" class="form-control input-sm"  />';

							    //}

								if (bbo_salutation != null && bbo_salutation != "") {
								    account += ' <input type="text" name="AnredeId" value = "' + bbo_salutation + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
								    account += ' <input type="text" name="AnredeId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 ' <label class="control-label">Vorname</label>';

								if (firstname != null) {
									account += ' <input type="text" name="VornameId" value = "' + firstname + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="VornameId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}
								account += ' </div>' +
											' <div class="col-md-2">' +
												'  <label class="control-label">Nachname</label>';
								if (lastname != null) {
									account += ' <input type="text" name="NachnameId" value = "' + lastname + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="NachnameId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											'  <div class="col-md-2">' +
												'  <label class="control-label">Telefon</label>';
								if (telephone1 != null) {
									account += ' <input type="text" name="TelefonId" value = "' + telephone1 + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="TelefonId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Fax</label>';
								if (fax != null) {
									account += ' <input type="text" name="FaxId" value = "' + fax + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="FaxId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}


								account += ' </div>' +
								 ' <div class="col-md-2">' +
									 ' <label class="control-label">Email</label>';
								if (emailaddress1contact != null) {
									account += ' <input type="text" name="EmailId" value = "' + emailaddress1contact + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="EmailId" onchange="updateAccount(this)" class="form-control input-sm"  />';
								}
								account += '  </div>' +
											 ' </div>' +
											 ' <div class="row form-group">' +
												 '<div class="col-md-3">' +
													 ' <label class="control-label">Art der Gesellschaft</label>';



								//added by saad for company type optionset
								if(ss_new_company_type != null)
								{
									account += '<select id="ArtderGesellschaftId" onchange="updateAccount(this)" class="form-control">' +
										'<option value="0">Wählen</option>';//should we add this option into crm optionset or not?
									if (ss_new_company_type == 1) {
									account += '<option value="1" selected="selected">Kreditinstitut</option>';
									}
									else {
									account += '<option value="1">Kreditinstitut</option>';

									}
									if (ss_new_company_type == 2) {
									account += '<option value="2" selected="selected">Pensionsfonds</option>';
									}
									else {
									account += '<option value="2">Pensionsfonds</option>';

									}
									if (ss_new_company_type == 3) {
									account += '<option value="3" selected="selected">Finanzdienstleister</option>';
									}
									else {
									account += '<option value="3">Finanzdienstleister</option>';

									}
									if (ss_new_company_type == 4) {
									account += '<option value="4" selected="selected">Versicherung</option>';
									}
									else {
									account += '<option value="4">Versicherung</option>';

									}
									if (ss_new_company_type == 5) {
									account += '<option value="5" selected="selected">Rückversicherungsgesellschaft</option>';
									}
									else {
									account += '<option value="5">Rückversicherungsgesellschaft</option>';

									}

									if (ss_new_company_type == 6) {
									account += '<option value="6" selected="selected">AIF Kapitalverwaltungsgesellschaft</option>';
									}
									else {
									account += '<option value="6">AIF Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_new_company_type == 7) {
									account += '<option value="7" selected="selected">OGAW-Investmentaktiengesellschaft</option>';
									}
									else {
									account += '<option value="7">OGAW-Investmentaktiengesellschaft</option>';

									}
									if (ss_new_company_type == 8) {
									account += '<option value="8" selected="selected">AIF-Investmentaktiengesellschaft</option>';
									}
									else {
									account += '<option value="8">AIF-Investmentaktiengesellschaft</option>';

									}
									if (ss_new_company_type == 9) {
									account += '<option value="9" selected="selected">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';
									}
									else {
									account += '<option value="9">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 10) {
									account += '<option value="10" selected="selected">Offene Investmentkommanditgesellschaft</option>';
									}
									else {
									account += '<option value="10">Offene Investmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 11) {
									account += '<option value="11" selected="selected">Emittent von Vermögensanlagen</option>';
									}
									else {
									account += '<option value="11">Emittent von Vermögensanlagen</option>';

									}
									if (ss_new_company_type == 12) {
									account += ' <option value="12" selected="selected">Externe Kapitalverwaltungsgesellschaft</option>';
									}
									else {
									account += ' <option value="12">Externe Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_new_company_type == 13) {
									account += ' <option value="13" selected="selected">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';
									}
									else {
									account += ' <option value="13">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 14) {
									account += ' <option value="14" selected="selected">Unternehmensbeteiligungsgesellschaft</option>';
									}
									else {
									account += ' <option value="14">Unternehmensbeteiligungsgesellschaft</option>';

									}
									if (ss_new_company_type == 15) {
									account += '<option value="15" selected="selected">Beteiligungsgesellschaft</option>';
									}
									else {
									account += '<option value="15">Beteiligungsgesellschaft</option>';

									}
									if (ss_new_company_type == 16) {
									account += '<option value="16" selected="selected">Eisenbahnunternehmen</option>';
									}
									else {
									account += '<option value="16">Eisenbahnunternehmen</option>';

									}
									if (ss_new_company_type == 17) {
									account += ' <option value="17" selected="selected">keine der genannten Gesellschaftsarten</option>';
									}
									else {
									account += ' <option value="17">keine der genannten Gesellschaftsarten</option>';

									}
									account += ' </select>';
								}
								//saad
								else {
									// account += ' <input type="number" name="ArtderGesellschaftId" onkeypress="return event.charCode >= 48 && event.charCode <= 57" onchange="updateAccount(this)" maxlength="3" min="0" max="225" class="form-control input-sm"  />';
									account += '<select id="ArtderGesellschaftId" onchange="updateAccount(this)" class="form-control">' +
												   '<option value="0">Wählen</option>' +
												   '<option value="1">Kreditinstitut</option>' +
												   '<option value="2">Pensionsfonds</option>' +
												   '<option value="3">Finanzdienstleister</option>' +
												   '<option value="4">Versicherung</option>' +
												   '<option value="5">Rückversicherungsgesellschaft</option>' +
												   '<option value="6">AIF Kapitalverwaltungsgesellschaft</option>' +
												   '<option value="7">OGAW-Investmentaktiengesellschaft</option>' +
												   '<option value="8">AIF-Investmentaktiengesellschaft</option>' +
												   '<option value="9">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>' +
												   '<option value="10">Offene Investmentkommanditgesellschaft</option>' +
												   '<option value="11">Emittent von Vermögensanlagen</option>' +
												  ' <option value="12">Externe Kapitalverwaltungsgesellschaft</option>' +
												  ' <option value="13">Geschlossene Spezial-Investmentkommanditgesellschaft</option>' +
												  ' <option value="14">Unternehmensbeteiligungsgesellschaft</option>' +
												   '<option value="15">Beteiligungsgesellschaft</option>' +
												   '<option value="16">Eisenbahnunternehmen</option>' +
												  ' <option value="17">keine der genannten Gesellschaftsarten</option>' +
											  ' </select>';
								}

								account += ' </div>' +
											 '<div class="col-md-2">' +
												 '  <label class="control-label">Registerart</label>';

								//added by saad
								if (new_registerart != null) {
									account += '<select id="RegisterartId" onchange="updateAccount(this)" class="form-control">' +
												'<option value="">Wählen</option>';
									if (new_registerart == 1) {
										account += '<option value="1" selected="selected">HRA</option>';
									}
									else {
										account += '<option value="1">HRA</option>';

									}
									if (new_registerart == 2) {
										account += '<option value="2" selected="selected">HRB</option>';
									}
									else {
										account += '<option value="2">HRB</option>';

									}
									if (new_registerart == 3) {
										account += '<option value="3" selected="selected">VR</option>';
									}
									else {
										account += '<option value="3">VR</option>';

									}
									if (new_registerart == 4) {
										account += ' <option value="4" selected="selected">GnR</option>';
									}
									else {
										account += ' <option value="4">GnR</option>';

									}
									if (new_registerart == 5) {
										account += ' <option value="5" selected="selected">PR</option>';
									}
									else {
										account += ' <option value="5">PR</option>';

									}

									account += '</select>';
								}
								//saad
								else {
									//  account += ' <input type="text" name="RegisterartId" onchange="updateAccount(this)" class="form-control input-sm"  />';
									account += '<select id="RegisterartId" onchange="updateAccount(this)" class="form-control">' +
																				   '<option value="">Wählen</option>' +
																				   '<option value="1">HRA</option>' +
																				   '<option value="2">HRB</option>' +
																				   '<option value="3">VR</option>' +
																				  ' <option value="4">GnR</option>' +
																				  ' <option value="5">PR</option>' +
																				 '</select>';
								}

								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 '  <label class="control-label">R-Nr.:</label>';

								if (new_registrierungsnummer != null) {
									account += ' <input type="text" name="R-NrId" value = "' + new_registrierungsnummer + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="R-NrId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}

								account += ' </div>' +
								  ' <div class="col-md-2">' +
									  '  <label class="control-label">Ort1:</label>';
								//if (ss_ort != null) {
								//    account += ' <input type="text" name="Ort1Id" value = "' + ss_ort + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								//}
								//else {
								//    account += ' <input type="text" name="Ort1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

								//}


                                //added by saad
								if (ss_registergericht != null) {
								    account += '<select id="Ort1Id" onchange="updateAccount(this)" class="form-control input-sm">';
								    account += '<option value="all">all</option>';

								    if (ss_registergericht == 1) {
								        account += '<option value="1" selected="selected">Aachen</option>';
								    }
								    else {
								        account += '<option value="1">Aachen</option>';

								    }
								    if (ss_registergericht == 2) {
								        account += '<option value="2" selected="selected">Altenburg</option>';
								    }
								    else {
								        account += '<option value="2">Altenburg</option>';

								    }
								    if (ss_registergericht == 3) {
								        account += '<option value="3" selected="selected">Amberg</option>';
								    }
								    else {
								        account += '<option value="3">Amberg</option>';

								    }
								    if (ss_registergericht == 4) {
								        account += '<option value="4" selected="selected">Ansbach</option>';
								    }
								    else {
								        account += '<option value="4">Ansbach</option>';

								    }
								    if (ss_registergericht == 5) {
								        account += '<option value="5" selected="selected">Apolda</option>';
								    }
								    else {
								        account += '<option value="5">Apolda</option>';

								    }
								    if (ss_registergericht == 6) {
								        account += '<option value="6" selected="selected">Arnsberg</option>';
								    }
								    else {
								        account += '<option value="6">Arnsberg</option>';

								    }
								    if (ss_registergericht == 7) {
								        account += '<option value="7" selected="selected">Arnstadt</option>';
								    }
								    else {
								        account += '<option value="7">Arnstadt</option>';

								    }
								    if (ss_registergericht == 8) {
								        account += '<option value="8" selected="selected">Arnstadt Zweigstelle Ilmenau</option>';
								    }
								    else {
								        account += '<option value="8">Arnstadt Zweigstelle Ilmenau</option>';

								    }
								    if (ss_registergericht == 9) {
								        account += '<option value="9" selected="selected">Aschaffenburg</option>';
								    }
								    else {
								        account += '<option value="9">Aschaffenburg</option>';

								    }
								    if (ss_registergericht == 10) {
								        account += '<option value="10" selected="selected">Augsburg</option>';
								    }
								    else {
								        account += '<option value="10">Augsburg</option>';

								    }
								    if (ss_registergericht == 11) {
								        account += '<option value="11" selected="selected">Aurich</option>';
								    }
								    else {
								        account += '<option value="11">Aurich</option>';

								    }
								    if (ss_registergericht == 12) {
								        account += '<option value="12" selected="selected">Bad Hersfeld</option>';
								    }
								    else {
								        account += '<option value="12">Bad Hersfeld</option>';

								    }
								    if (ss_registergericht == 13) {
								        account += '<option value="13" selected="selected">Bad Homburg v.d.H.</option>';
								    }
								    else {
								        account += '<option value="13">Bad Homburg v.d.H.</option>';

								    }
								    if (ss_registergericht == 14) {
								        account += '<option value="14" selected="selected">Bad Kreuznach</option>';
								    }
								    else {
								        account += '<option value="14">Bad Kreuznach</option>';

								    }
								    if (ss_registergericht == 15) {
								        account += '<option value="15" selected="selected">Bad Oeynhausen</option>';
								    }
								    else {
								        account += '<option value="15">Bad Oeynhausen</option>';

								    }
								    if (ss_registergericht == 16) {
								        account += '<option value="16" selected="selected">Bad Salzungen</option>';
								    }
								    else {
								        account += '<option value="16">Bad Salzungen</option>';

								    }
								    if (ss_registergericht == 17) {
								        account += '<option value="17" selected="selected">Bamberg</option>';
								    }
								    else {
								        account += '<option value="17">Bamberg</option>';

								    }
								    if (ss_registergericht == 18) {
								        account += '<option value="18" selected="selected">Bayreuth</option>';
								    }
								    else {
								        account += '<option value="18">Bayreuth</option>';

								    }
								    if (ss_registergericht == 19) {
								        account += '<option value="19" selected="selected">Berlin (Charlottenburg)</option>';
								    }
								    else {
								        account += '<option value="19">Berlin (Charlottenburg)</option>';

								    }
								    if (ss_registergericht == 20) {
								        account += '<option value="20" selected="selected">Bielefeld</option>';
								    }
								    else {
								        account += '<option value="20">Bielefeld</option>';

								    }
								    if (ss_registergericht == 21) {
								        account += '<option value="21" selected="selected">Bochum</option> ';
								    }
								    else {
								        account += '<option value="21">Bochum</option> ';

								    }
								    if (ss_registergericht == 22) {
								        account += '<option value="22" selected="selected">Bonn</option>';
								    }
								    else {
								        account += '<option value="22">Bonn</option>';

								    }
								    if (ss_registergericht == 23) {
								        account += '<option value="23" selected="selected">Braunschweig</option>';
								    }
								    else {
								        account += '<option value="23">Braunschweig</option>';

								    }
								    if (ss_registergericht == 24) {
								        account += '<option value="24" selected="selected">Bremen</option>';
								    }
								    else {
								        account += '<option value="24">Bremen</option>';

								    }
								    if (ss_registergericht == 25) {
								        account += '<option value="25" selected="selected">Chemnitz</option>';
								    }
								    else {
								        account += '<option value="25">Chemnitz</option>';

								    }
								    if (ss_registergericht == 26) {
								        account += '<option value="26" selected="selected">Coburg</option>';
								    }
								    else {
								        account += '<option value="26">Coburg</option>';

								    }
								    if (ss_registergericht == 27) {
								        account += '<option value="27" selected="selected">Coesfeld</option>';
								    }
								    else {
								        account += '<option value="27">Coesfeld</option>';

								    }
								    if (ss_registergericht == 28) {
								        account += '<option value="28" selected="selected">Cottbus</option>';
								    }
								    else {
								        account += '<option value="28">Cottbus</option>';

								    }
								    if (ss_registergericht == 29) {
								        account += '<option value="29" selected="selected">Darmstadt</option>';
								    }
								    else {
								        account += '<option value="29">Darmstadt</option>';

								    }
								    if (ss_registergericht == 30) {
								        account += '<option value="30" selected="selected">Deggendorf</option>';
								    }
								    else {
								        account += '<option value="30">Deggendorf</option>';

								    }
								    if (ss_registergericht == 31) {
								        account += '<option value="31" selected="selected">Dortmund</option>';
								    }
								    else {
								        account += '<option value="31">Dortmund</option>';

								    }
								    if (ss_registergericht == 32) {

								        account += '<option value="32" selected="selected">Dresden</option>';
								    }
								    else {
								        account += '<option value="32">Dresden</option>';

								    }
								    if (ss_registergericht == 33) {
								        account += '<option value="33" selected="selected">Duisburg</option>';
								    }
								    else {
								        account += '<option value="33">Duisburg</option>';

								    }
								    if (ss_registergericht == 34) {
								        account += '<option value="34" selected="selected">Düren</option>';
								    }
								    else {
								        account += '<option value="34">Düren</option>';

								    }
								    if (ss_registergericht == 35) {
								        account += '<option value="35" selected="selected">Düsseldorf</option>';
								    }
								    else {
								        account += '<option value="35">Düsseldorf</option>';

								    }
								    if (ss_registergericht == 36) {
								        account += '<option value="36" selected="selected">Eisenach</option>';
								    }
								    else {
								        account += '<option value="36">Eisenach</option>';

								    }
								    if (ss_registergericht == 37) {
								        account += '<option value="37" selected="selected">Erfurt</option>';
								    }
								    else {
								        account += '<option value="37">Erfurt</option>';

								    }
								    if (ss_registergericht == 38) {
								        account += '<option value="38" selected="selected">Eschwege</option>';
								    }
								    else {
								        account += '<option value="38">Eschwege</option>';

								    }
								    if (ss_registergericht == 39) {
								        account += '<option value="39" selected="selected">Essen</option>';
								    }
								    else {
								        account += '<option value="39">Essen</option>';

								    }
								    if (ss_registergericht == 40) {
								        account += '<option value="40" selected="selected">Flensburg</option>';
								    }
								    else {
								        account += '<option value="40">Flensburg</option>';

								    }
								    if (ss_registergericht == 41) {
								        account += '<option value="41" selected="selected">Frankfurt am Main</option>';
								    }
								    else {
								        account += '<option value="41">Frankfurt am Main</option>';

								    }

								    if (ss_registergericht == 42) {
								        account += '<option value="42" selected="selected">Frankfurt/Oder</option>';
								    }
								    else {
								        account += '<option value="42">Frankfurt/Oder</option>';

								    }

								    if (ss_registergericht == 43) {
								        account += '<option value="43" selected="selected">Freiburg</option>';
								    }
								    else {
								        account += '<option value="43">Freiburg</option>';

								    }
								    if (ss_registergericht == 44) {
								        account += '<option value="44" selected="selected">Friedberg</option>';
								    }
								    else {
								        account += '<option value="44">Friedberg</option>';

								    }
								    if (ss_registergericht == 45) {
								        account += '<option value="45" selected="selected">Fritzlar</option>';
								    }
								    else {
								        account += '<option value="45">Fritzlar</option>';

								    }
								    if (ss_registergericht == 46) {
								        account += '<option value="46" selected="selected">Fulda</option>';
								    }
								    else {
								        account += '<option value="46">Fulda</option>';

								    }
								    if (ss_registergericht == 47) {
								        account += '<option value="47" selected="selected">Fürth</option>';
								    }
								    else {
								        account += '<option value="47">Fürth</option>';

								    }
								    if (ss_registergericht == 48) {
								        account += '<option value="48" selected="selected">Gelsenkirchen</option>';
								    }
								    else {
								        account += '<option value="48">Gelsenkirchen</option>';

								    }
								    if (ss_registergericht == 49) {
								        account += '<option value="49" selected="selected">Gera</option>';
								    }
								    else {
								        account += '<option value="49">Gera</option>';

								    }
								    if (ss_registergericht == 50) {
								        account += '<option value="50" selected="selected">Gießen</option>';
								    }
								    else {
								        account += '<option value="50">Gießen</option>';

								    }
								    if (ss_registergericht == 51) {
								        account += '<option value="51" selected="selected">Gotha</option>';
								    }
								    else {
								        account += '<option value="51">Gotha</option>';

								    }
								    if (ss_registergericht == 52) {
								        account += '<option value="52" selected="selected">Greiz</option>';
								    }
								    else {
								        account += '<option value="52">Greiz</option>';

								    }
								    if (ss_registergericht == 53) {
								        account += '<option value="53" selected="selected">Göttingen</option>';
								    }
								    else {
								        account += '<option value="53">Göttingen</option>';

								    }
								    if (ss_registergericht == 54) {
								        account += '<option value="54" selected="selected">Gütersloh</option>';
								    }
								    else {
								        account += '<option value="54">Gütersloh</option>';

								    }
								    if (ss_registergericht == 55) {
								        account += '<option value="55" selected="selected">Hagen</option>';
								    }
								    else {
								        account += '<option value="55">Hagen</option>';

								    }
								    if (ss_registergericht == 56) {
								        account += '<option value="56" selected="selected">Hamburg</option>';
								    }
								    else {
								        account += '<option value="56">Hamburg</option>';

								    }
								    if (ss_registergericht == 57) {
								        account += '<option value="57" selected="selected">Hamm</option>';
								    }
								    else {
								        account += '<option value="57">Hamm</option>';

								    }
								    if (ss_registergericht == 58) {
								        account += '<option value="58" selected="selected">Hanau</option>';
								    }
								    else {
								        account += '<option value="58">Hanau</option>';

								    }
								    if (ss_registergericht == 59) {
								        account += '<option value="59" selected="selected">Hannover</option>';
								    }
								    else {
								        account += '<option value="59">Hannover</option>';

								    }
								    if (ss_registergericht == 60) {
								        account += '<option value="60" selected="selected">Heilbad Heiligenstadt</option>';
								    }
								    else {
								        account += '<option value="60">Heilbad Heiligenstadt</option>';

								    }
								    if (ss_registergericht == 61) {
								        account += '<option value="61" selected="selected">Hildburghausen</option>';
								    }
								    else {
								        account += '<option value="61">Hildburghausen</option>';

								    }
								    if (ss_registergericht == 62) {
								        account += '<option value="62" selected="selected">Hildesheim</option>';
								    }
								    else {
								        account += '<option value="62">Hildesheim</option>';

								    }
								    if (ss_registergericht == 63) {
								        account += '<option value="63" selected="selected">Hof</option>';
								    }
								    else {
								        account += '<option value="63">Hof</option>';

								    }
								    if (ss_registergericht == 64) {
								        account += '<option value="64" selected="selected">Homburg</option>';
								    }
								    else {
								        account += '<option value="64">Homburg</option>';

								    }
								    if (ss_registergericht == 65) {
								        account += '<option value="65" selected="selected">Ingolstadt</option>';
								    }
								    else {
								        account += '<option value="65">Ingolstadt</option>';

								    }
								    if (ss_registergericht == 66) {
								        account += '<option value="66" selected="selected">Iserlohn</option>';
								    }
								    else {
								        account += '<option value="66">Iserlohn</option>';

								    }
								    if (ss_registergericht == 67) {
								        account += '<option value="67" selected="selected">Jena</option>';
								    }
								    else {
								        account += '<option value="67">Jena</option>';

								    }
								    if (ss_registergericht == 68) {
								        account += '<option value="68" selected="selected">Kaiserslautern</option>';
								    }
								    else {
								        account += '<option value="68">Kaiserslautern</option>';

								    }
								    if (ss_registergericht == 69) {
								        account += '<option value="69" selected="selected">Kassel</option>';
								    }
								    else {
								        account += '<option value="69">Kassel</option>';

								    }
								    if (ss_registergericht == 70) {
								        account += '<option value="70" selected="selected">Kempten (Allgäu)</option>';
								    }
								    else {
								        account += '<option value="70">Kempten (Allgäu)</option>';

								    }
								    if (ss_registergericht == 71) {
								        account += '<option value="71" selected="selected">Kiel</option>';
								    }
								    else {
								        account += '<option value="71">Kiel</option>';

								    }
								    if (ss_registergericht == 72) {
								        account += '<option value="72" selected="selected">Kleve</option>';
								    }
								    else {
								        account += '<option value="72">Kleve</option>';

								    }
								    if (ss_registergericht == 73) {
								        account += '<option value="73" selected="selected">Koblenz</option>';
								    }
								    else {
								        account += '<option value="73">Koblenz</option>';

								    }
								    if (ss_registergericht == 74) {
								        account += '<option value="74" selected="selected">Korbach</option>';
								    }
								    else {
								        account += '<option value="74">Korbach</option>';

								    }
								    if (ss_registergericht == 75) {
								        account += '<option value="75" selected="selected">Krefeld</option>';
								    }
								    else {
								        account += '<option value="75">Königstein</option>';

								    }
								    if (ss_registergericht == 76) {
								        account += '<option value="76" selected="selected">Köln</option>';
								    }
								    else {
								        account += '<option value="76">Köln</option>';

								    }
								    if (ss_registergericht == 77) {
								        account += '<option value="77" selected="selected">Königstein</option>';
								    }
								    else {
								        account += '<option value="77">Königstein</option>';

								    }
								    if (ss_registergericht == 78) {
								        account += '<option value="78" selected="selected">Landau</option>';
								    }
								    else {
								        account += '<option value="78">Landau</option>';

								    }
								    if (ss_registergericht == 79) {
								        account += '<option value="79" selected="selected">Landshut</option>';
								    }
								    else {
								        account += '<option value="79">Landshut</option>';

								    }
								    if (ss_registergericht == 80) {
								        account += '<option value="80" selected="selected">Langenfeld</option>';
								    }
								    else {
								        account += '<option value="80">Langenfeld</option>';

								    }
								    if (ss_registergericht == 81) {
								        account += '<option value="81" selected="selected">Lebach</option>';
								    }
								    else {
								        account += '<option value="81">Lebach</option>';

								    }
								    if (ss_registergericht == 82) {
								        account += '<option value="82" selected="selected">Leipzig</option>';
								    }
								    else {
								        account += '<option value="82">Leipzig</option>';

								    }
								    if (ss_registergericht == 83) {
								        account += '<option value="83" selected="selected">Lemgo</option>';
								    }
								    else {
								        account += '<option value="83">Lemgo</option>';

								    }
								    if (ss_registergericht == 84) {
								        account += '<option value="84" selected="selected">Limburg</option>';
								    }
								    else {
								        account += '<option value="84">Limburg</option>';

								    }

								    if (ss_registergericht == 85) {
								        account += '<option value="85" selected="selected">Ludwigshafen a.Rhein (Ludwigshafen)</option>';
								    }
								    else {
								        account += '<option value="85">Ludwigshafen a.Rhein (Ludwigshafen)</option>';

								    }
								    if (ss_registergericht == 86) {
								        account += '<option value="86" selected="selected">Lübeck</option>';
								    }
								    else {
								        account += '<option value="86">Lübeck</option>';

								    }
								    if (ss_registergericht == 87) {
								        account += '<option value="87" selected="selected">Lüneburg</option>';
								    }
								    else {
								        account += '<option value="87">Lüneburg</option>';

								    }
								    if (ss_registergericht == 88) {
								        account += '<option value="88" selected="selected">Mainz</option>';
								    }
								    else {
								        account += '<option value="88">Mainz</option>';

								    }
								    if (ss_registergericht == 89) {
								        account += '<option value="89" selected="selected">Mannheim</option>';
								    }
								    else {
								        account += '<option value="89">Mannheim</option>';

								    }
								    if (ss_registergericht == 90) {
								        account += '<option value="90" selected="selected">Marburg</option>';
								    }
								    else {
								        account += '<option value="90">Marburg</option>';

								    }
								    if (ss_registergericht == 91) {
								        account += '<option value="91" selected="selected">Meiningen</option>';
								    }
								    else {
								        account += '<option value="91">Meiningen</option>';

								    }
								    if (ss_registergericht == 92) {
								        account += '<option value="92" selected="selected">Memmingen</option>';
								    }
								    else {
								        account += '<option value="92">Memmingen</option>';

								    }
								    if (ss_registergericht == 93) {
								        account += '<option value="93" selected="selected">Merzig</option>';
								    }
								    else {
								        account += '<option value="93">Merzig</option>';

								    }
								    if (ss_registergericht == 94) {
								        account += '<option value="94" selected="selected">Montabaur</option>';
								    }
								    else {
								        account += '<option value="94">Montabaur</option>';

								    }
								    if (ss_registergericht == 95) {
								        account += '<option value="95" selected="selected">Mönchengladbach</option>';
								    }
								    else {
								        account += '<option value="95">Mönchengladbach</option>';

								    }
								    if (ss_registergericht == 96) {
								        account += '<option value="96" selected="selected">Mühlhausen</option>';
								    }
								    else {
								        account += '<option value="96">Mühlhausen</option>';

								    }
								    if (ss_registergericht == 97) {
								        account += '<option value="97" selected="selected">München</option>';
								    }
								    else {
								        account += '<option value="97">München</option>';

								    }
								    if (ss_registergericht == 98) {
								        account += '<option value="98" selected="selected">Münster</option>';
								    }
								    else {
								        account += '<option value="98">Münster</option>';

								    }
								    if (ss_registergericht == 99) {
								        account += '<option value="99" selected="selected">Neubrandenburg</option>';
								    }
								    else {
								        account += '<option value="99">Neubrandenburg</option>';

								    }
								    if (ss_registergericht == 100) {
								        account += '<option value="100" selected="selected">Neunkirchen</option>';
								    }
								    else {
								        account += '<option value="100">Neunkirchen</option>';

								    }
								    if (ss_registergericht == 101) {
								        account += '<option value="101" selected="selected">Neuruppin</option>';
								    }
								    else {
								        account += '<option value="101">Neuruppin</option>';

								    }
								    if (ss_registergericht == 102) {
								        account += '<option value="102" selected="selected">Neuss</option>';
								    }
								    else {
								        account += '<option value="102">Neuss</option>';

								    }
								    if (ss_registergericht == 103) {
								        account += '<option value="103" selected="selected">Nordhausen</option>';
								    }
								    else {
								        account += '<option value="103">Nordhausen</option>';

								    }
								    if (ss_registergericht == 104) {
								        account += '<option value="104" selected="selected">Nürnberg</option>';
								    }
								    else {
								        account += '<option value="104">Nürnberg</option>';

								    }
								    if (ss_registergericht == 105) {
								        account += '<option value="105" selected="selected">Offenbach am Main</option>';
								    }
								    else {
								        account += '<option value="105">Offenbach am Main</option>';

								    }
								    if (ss_registergericht == 106) {
								        account += '<option value="106" selected="selected">Oldenburg (Oldenburg)</option>';
								    }
								    else {
								        account += '<option value="106">Oldenburg (Oldenburg)</option>';

								    }
								    if (ss_registergericht == 107) {
								        account += '<option value="107" selected="selected">Osnabrück</option>';
								    }
								    else {
								        account += '<option value="107">Osnabrück</option>';

								    }
								    if (ss_registergericht == 108) {
								        account += '<option value="108" selected="selected">Ottweiler</option>';
								    }
								    else {
								        account += '<option value="108">Ottweiler</option>';

								    }
								    if (ss_registergericht == 109) {
								        account += '<option value="109" selected="selected">Paderborn</option>';
								    }
								    else {
								        account += '<option value="109">Paderborn</option>';

								    }
								    if (ss_registergericht == 110) {
								        account += '<option value="110" selected="selected">Passau</option>';
								    }
								    else {
								        account += '<option value="110">Passau</option>';

								    }
								    if (ss_registergericht == 111) {
								        account += '<option value="111" selected="selected">Pinneberg</option>';
								    }
								    else {
								        account += '<option value="111">Pinneberg</option>';

								    }

								    if (ss_registergericht == 112) {
								        account += '<option value="112" selected="selected">Potsdam</option>';
								    }
								    else {
								        account += '<option value="112">Potsdam</option>';

								    }
								    if (ss_registergericht == 113) {
								        account += '<option value="113" selected="selected">Pößneck</option>';
								    }
								    else {
								        account += '<option value="113">Pößneck</option>';

								    }
								    if (ss_registergericht == 114) {
								        account += '<option value="114" selected="selected">Pößneck Zweigstelle Bad Lobenstein</option>';
								    }
								    else {
								        account += '<option value="114">Pößneck Zweigstelle Bad Lobenstein</option>';

								    }
								    if (ss_registergericht == 115) {
								        account += '<option value="115" selected="selected">Recklinghausen</option>';
								    }
								    else {
								        account += '<option value="115">Recklinghausen</option>';

								    }
								    if (ss_registergericht == 116) {
								        account += '<option value="116" selected="selected">Regensburg</option>';
								    }
								    else {
								        account += '<option value="116">Regensburg</option>';

								    }
								    if (ss_registergericht == 117) {
								        account += '<option value="117" selected="selected">Rostock</option>';
								    }
								    else {
								        account += '<option value="117">Rostock</option>';

								    }
								    if (ss_registergericht == 118) {
								        account += '<option value="118" selected="selected">Rudolstadt</option>';
								    }
								    else {
								        account += '<option value="118">Rudolstadt</option>';

								    }
								    if (ss_registergericht == 119) {
								        account += '<option value="119" selected="selected">Rudolstadt Zweigstelle Saalfeld</option>';
								    }
								    else {
								        account += '<option value="119">Rudolstadt Zweigstelle Saalfeld</option>';

								    }
								    if (ss_registergericht == 120) {
								        account += '<option value="120" selected="selected"> Saarbrücken</option>';
								    }
								    else {
								        account += '<option value="120" > Saarbrücken</option>';

								    }
								    if (ss_registergericht == 121) {
								        account += '<option value="121" selected="selected"> Saarlouis</option>';
								    }
								    else {
								        account += '<option value="121"> Saarlouis</option>';

								    }
								    if (ss_registergericht == 122) {
								        account += '<option value="122" selected="selected"> Schweinfurt</option>';
								    }
								    else {
								        account += '<option value="122" > Schweinfurt</option>';

								    }
								    if (ss_registergericht == 123) {
								        account += '<option value="123" selected="selected"> Schwerin</option>';
								    }
								    else {
								        account += '<option value="123"> Schwerin</option>';
								    }
								    if (ss_registergericht == 124) {
								        account += '<option value="124" selected="selected"> Siegburg</option>';
								    }
								    else {
								        account += '<option value="124"> Siegburg</option>';

								    }
								    if (ss_registergericht == 125) {
								        account += '<option value="125" selected="selected"> Siegen</option>';
								    }
								    else {
								        account += '<option value="125"> Siegen</option>';

								    }
								    if (ss_registergericht == 126) {
								        account += '<option value="126" selected="selected"> Sondershausen</option>';
								    }
								    else {
								        account += '<option value="126" > Sondershausen</option>';

								    }
								    if (ss_registergericht == 127) {
								        account += '<option value="127" selected="selected"> Sonneberg</option>';
								    }
								    else {
								        account += '<option value="127"> Sonneberg</option>';

								    }
								    if (ss_registergericht == 128) {
								        account += '<option value="128" selected="selected"> St. Ingbert (St Ingbert)</option>';
								    }
								    else {
								        account += '<option value="128" > St. Ingbert (St Ingbert)</option>';

								    }
								    if (ss_registergericht == 129) {
								        account += '<option value="129" selected="selected"> St. Wendel (St Wendel)</option>';
								    }
								    else {
								        account += '<option value="129"> St. Wendel (St Wendel)</option>';
								    }
								    if (ss_registergericht == 130) {
								        account += '<option value="130" selected="selected"> Stadthagen</option>';
								    }
								    else {
								        account += '<option value="130"> Stadthagen</option>';

								    }
								    if (ss_registergericht == 131) {
								        account += '<option value="131" selected="selected"> Stadtroda</option>';
								    }
								    else {
								        account += '<option value="131"> Stadtroda</option>';

								    }
								    if (ss_registergericht == 132) {
								        account += '<option value="132" selected="selected"> Steinfurt</option>';
								    }
								    else {
								        account += '<option value="132" > Steinfurt</option>';

								    }
								    if (ss_registergericht == 133) {
								        account += '<option value="133" selected="selected"> Stendal</option>';
								    }
								    else {
								        account += '<option value="133"> Stendal</option>';

								    }
								    if (ss_registergericht == 134) {
								        account += '<option value="134" selected="selected"> Stralsund</option>';
								    }
								    else {
								        account += '<option value="134"> Stralsund</option>';

								    }
								    if (ss_registergericht == 135) {
								        account += '<option value="135" selected="selected"> Straubing</option>';
								    }
								    else {
								        account += '<option value="135" > Straubing</option>';

								    }
								    if (ss_registergericht == 136) {
								        account += '<option value="136" selected="selected"> Stuttgart</option>';
								    }
								    else {
								        account += '<option value="136"> Stuttgart</option>';

								    }
								    if (ss_registergericht == 137) {
								        account += '<option value="137" selected="selected"> Suhl</option>';
								    }
								    else {
								        account += '<option value="137"> Suhl</option>';

								    }
								    if (ss_registergericht == 138) {
								        account += '<option value="138" selected="selected"> Sömmerda</option>';
								    }
								    else {
								        account += '<option value="138"> Sömmerda</option>';

								    }
								    if (ss_registergericht == 139) {
								        account += '<option value="139" selected="selected"> Tostedt</option>';
								    }
								    else {
								        account += '<option value="139"> Tostedt</option>';

								    }
								    if (ss_registergericht == 140) {
								        account += '<option value="140" selected="selected"> Traunstein</option>';
								    }
								    else {
								        account += '<option value="140"> Traunstein</option>';

								    }
								    if (ss_registergericht == 141) {
								        account += '<option value="141" selected="selected">Ulm</option>';
								    }
								    else {
								        account += '<option value="141">Ulm</option>';

								    }
								    if (ss_registergericht == 142) {
								        account += '<option value="142" selected="selected">Völklingen</option>';
								    }
								    else {
								        account += '<option value="142">Völklingen</option>';

								    }
								    if (ss_registergericht == 143) {
								        account += '<option value="143" selected="selected">Walsrode</option>';
								    }
								    else {
								        account += '<option value="143">Walsrode</option>';

								    }
								    if (ss_registergericht == 144) {
								        account += '<option value="144" selected="selected">Weiden i. d. OPf.</option>';
								    }
								    else {
								        account += '<option value="144">Weiden i. d. OPf.</option>';

								    }
								    if (ss_registergericht == 145) {
								        account += '<option value="145" selected="selected">Weimar</option>';
								    }
								    else {
								        account += '<option value="145">Weimar</option>';

								    }
								    if (ss_registergericht == 146) {
								        account += '<option value="146" selected="selected">Wetzlar</option>';
								    }
								    else {
								        account += '<option value="146">Wetzlar</option>';

								    }
								    if (ss_registergericht == 147) {
								        account += '<option value="147" selected="selected">Wiesbaden</option>';
								    }
								    else {
								        account += '<option value="147">Wiesbaden</option>';

								    }
								    if (ss_registergericht == 148) {
								        account += '<option value="148" selected="selected">Wittlich</option>';
								    }
								    else {
								        account += '<option value="148">Wittlich</option>';

								    }
								    if (ss_registergericht == 149) {
								        account += '<option value="149" selected="selected">Wuppertal</option>';
								    }
								    else {
								        account += '<option value="149">Wuppertal</option>';

								    }
								    if (ss_registergericht == 150) {
								        account += '<option value="150" selected="selected">Würzburg</option>';
								    }
								    else {
								        account += '<option value="150">Würzburg</option>';

								    }
								    if (ss_registergericht == 151) {
								        account += '<option value="151" selected="selected">Zweibrücken</option>';
								    }
								    else {
								        account += '<option value="151">Zweibrücken</option>';

								    }
								    account += '</select>';
								}
                                    //saad


								//if (new_registergericht != null) {
								//	new_registergericht = new_registergericht.toString().trim();
								//	account += '<select id="Ort1Id" onchange="updateAccount(this)" class="form-control input-sm">';
								//	account += '<option value="all">all</option>';

								//	if (new_registergericht == "Aachen") {
								//		account += '<option value="R3101" selected="selected">Aachen</option>';
								//	}
								//	else {
								//		account += '<option value="R3101">Aachen</option>';

								//	}
								//	if (new_registergericht == "Altenburg") {
								//		account += '<option value="Y1201" selected="selected">Altenburg</option>';
								//	}
								//	else {
								//		account += '<option value="Y1201">Altenburg</option>';

								//	}
								//	if (new_registergericht == "Amberg") {
								//		account += '<option value="D3101" selected="selected">Amberg</option>';
								//	}
								//	else {
								//		account += '<option value="D3101">Amberg</option>';

								//	}
								//	if (new_registergericht == "Ansbach") {
								//		account += '<option value="D3201" selected="selected">Ansbach</option>';
								//	}
								//	else {
								//		account += '<option value="D3201">Ansbach</option>';

								//	}
								//	if (new_registergericht == "Apolda") {
								//		account += '<option value="Y1101" selected="selected">Apolda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1101">Apolda</option>';

								//	}
								//	if (new_registergericht == "Arnsberg") {
								//		account += '<option value="R1901" selected="selected">Arnsberg</option>';
								//	}
								//	else {
								//		account += '<option value="R1901">Arnsberg</option>';

								//	}
								//	if (new_registergericht == "Arnstadt") {
								//		account += '<option value="Y1102" selected="selected">Arnstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1102">Arnstadt</option>';

								//	}
								//	if (new_registergericht == "Arnstadt Zweigstelle Ilmenau") {
								//		account += '<option value="Y1303" selected="selected">Arnstadt Zweigstelle Ilmenau</option>';
								//	}
								//	else {
								//		account += '<option value="Y1303">Arnstadt Zweigstelle Ilmenau</option>';

								//	}
								//	if (new_registergericht == "Aschaffenburg") {
								//		account += '<option value="D4102" selected="selected">Aschaffenburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4102">Aschaffenburg</option>';

								//	}
								//	if (new_registergericht == "Augsburg") {
								//		account += '<option value="D2102" selected="selected">Augsburg</option>';
								//	}
								//	else {
								//		account += '<option value="D2102">Augsburg</option>';

								//	}
								//	if (new_registergericht == "Aurich") {
								//		account += '<option value="P3101" selected="selected">Aurich</option>';
								//	}
								//	else {
								//		account += '<option value="P3101">Aurich</option>';

								//	}
								//	if (new_registergericht == "Bad Hersfeld") {
								//		account += '<option value="M1305" selected="selected">Bad Hersfeld</option>';
								//	}
								//	else {
								//		account += '<option value="M1305">Bad Hersfeld</option>';

								//	}
								//	if (new_registergericht == "Bad Homburg v.d.H.") {
								//		account += '<option value="M1202" selected="selected">Bad Homburg v.d.H.</option>';
								//	}
								//	else {
								//		account += '<option value="M1202">Bad Homburg v.d.H.</option>';

								//	}
								//	if (new_registergericht == "Bad Kreuznach") {
								//		account += '<option value="T2101" selected="selected">Bad Kreuznach</option>';
								//	}
								//	else {
								//		account += '<option value="T2101">Bad Kreuznach</option>';

								//	}
								//	if (new_registergericht == "Bad Oeynhausen") {
								//		account += '<option value="R2108" selected="selected">Bad Oeynhausen</option>';
								//	}
								//	else {
								//		account += '<option value="R2108">Bad Oeynhausen</option>';

								//	}
								//	if (new_registergericht == "Bad Salzungen") {
								//		account += '<option value="Y1301" selected="selected">Bad Salzungen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1301">Bad Salzungen</option>';

								//	}
								//	if (new_registergericht == "Bamberg") {
								//		account += '<option value="D4201" selected="selected">Bamberg</option>';
								//	}
								//	else {
								//		account += '<option value="D4201">Bamberg</option>';

								//	}
								//	if (new_registergericht == "Bayreuth") {
								//		account += '<option value="D4301" selected="selected">Bayreuth</option>';
								//	}
								//	else {
								//		account += '<option value="D4301">Bayreuth</option>';

								//	}
								//	if (new_registergericht == "Berlin (Charlottenburg)") {
								//		account += '<option value="F1103" selected="selected">Berlin (Charlottenburg)</option>';
								//	}
								//	else {
								//		account += '<option value="F1103">Berlin (Charlottenburg)</option>';

								//	}
								//	if (new_registergericht == "Bielefeld") {
								//		account += '<option value="R2101" selected="selected">Bielefeld</option>';
								//	}
								//	else {
								//		account += '<option value="R2101">Bielefeld</option>';

								//	}
								//	if (new_registergericht == "Bochum") {
								//		account += '<option value="R2201" selected="selected">Bochum</option> ';
								//	}
								//	else {
								//		account += '<option value="R2201">Bochum</option> ';

								//	}
								//	if (new_registergericht == "Bonn") {
								//		account += '<option value="R3201" selected="selected">Bonn</option>';
								//	}
								//	else {
								//		account += '<option value="R3201">Bonn</option>';

								//	}
								//	if (new_registergericht == "Braunschweig") {
								//		account += '<option value="P1103" selected="selected">Braunschweig</option>';
								//	}
								//	else {
								//		account += '<option value="P1103">Braunschweig</option>';

								//	}
								//	if (new_registergericht == "Bremen") {
								//		account += '<option value="H1101" selected="selected">Bremen</option>';
								//	}
								//	else {
								//		account += '<option value="H1101">Bremen</option>';

								//	}
								//	if (new_registergericht == "Chemnitz") {
								//		account += '<option value="U1206" selected="selected">Chemnitz</option>';
								//	}
								//	else {
								//		account += '<option value="U1206">Chemnitz</option>';

								//	}
								//	if (new_registergericht == "Coburg") {
								//		account += '<option value="D4401" selected="selected">Coburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4401">Coburg</option>';

								//	}
								//	if (new_registergericht == "Coesfeld") {
								//		account += '<option value="R2707" selected="selected">Coesfeld</option>';
								//	}
								//	else {
								//		account += '<option value="R2707">Coesfeld</option>';

								//	}
								//	if (new_registergericht == "Cottbus") {
								//		account += '<option value="G1103" selected="selected">Cottbus</option>';
								//	}
								//	else {
								//		account += '<option value="G1103">Cottbus</option>';

								//	}
								//	if (new_registergericht == "Darmstadt") {
								//		account += '<option value="M1103" selected="selected">Darmstadt</option>';
								//	}
								//	else {
								//		account += '<option value="M1103">Darmstadt</option>';

								//	}
								//	if (new_registergericht == "Deggendorf") {
								//		account += '<option value="D2201" selected="selected">Deggendorf</option>';
								//	}
								//	else {
								//		account += '<option value="D2201">Deggendorf</option>';

								//	}
								//	if (new_registergericht == "Dortmund") {
								//		account += '<option value="R2402" selected="selected">Dortmund</option>';
								//	}
								//	else {
								//		account += '<option value="R2402">Dortmund</option>';

								//	}
								//	if (new_registergericht == "Dresden") {

								//		account += '<option value="U1104" selected="selected">Dresden</option>';
								//	}
								//	else {
								//		account += '<option value="U1104">Dresden</option>';

								//	}
								//	if (new_registergericht == "Duisburg") {
								//		account += '<option value="R1202" selected="selected">Duisburg</option>';
								//	}
								//	else {
								//		account += '<option value="R1202">Duisburg</option>';

								//	}
								//	if (new_registergericht == "Düren") {
								//		account += '<option value="R3103" selected="selected">Düren</option>';
								//	}
								//	else {
								//		account += '<option value="R3103">Düren</option>';

								//	}
								//	if (new_registergericht == "Düsseldorf") {
								//		account += '<option value="R1101" selected="selected">Düsseldorf</option>';
								//	}
								//	else {
								//		account += '<option value="R1101">Düsseldorf</option>';

								//	}
								//	if (new_registergericht == "Eisenach") {
								//		account += '<option value="Y1105" selected="selected">Eisenach</option>';
								//	}
								//	else {
								//		account += '<option value="Y1105">Eisenach</option>';

								//	}
								//	if (new_registergericht == "Erfurt") {
								//		account += '<option value="Y1106" selected="selected">Erfurt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1106">Erfurt</option>';

								//	}
								//	if (new_registergericht == "Eschwege") {
								//		account += '<option value="M1602" selected="selected">Eschwege</option>';
								//	}
								//	else {
								//		account += '<option value="M1602">Eschwege</option>';

								//	}
								//	if (new_registergericht == "Essen") {
								//		account += '<option value="R2503" selected="selected">Essen</option>';
								//	}
								//	else {
								//		account += '<option value="R2503">Essen</option>';

								//	}
								//	if (new_registergericht == "Flensburg") {
								//		account += '<option value="X1112" selected="selected">Flensburg</option>';
								//	}
								//	else {
								//		account += '<option value="X1112">Flensburg</option>';

								//	}
								//	if (new_registergericht == "Frankfurt am Main") {
								//		account += '<option value="M1201" selected="selected">Frankfurt am Main</option>';
								//	}
								//	else {
								//		account += '<option value="M1201">Frankfurt am Main</option>';

								//	}

								//	if (new_registergericht == "Frankfurt/Oder") {
								//		account += '<option value="G1207" selected="selected">Frankfurt/Oder</option>';
								//	}
								//	else {
								//		account += '<option value="G1207">Frankfurt/Oder</option>';

								//	}

								//	if (new_registergericht == "Freiburg") {
								//		account += '<option value="B1204" selected="selected">Freiburg</option>';
								//	}
								//	else {
								//		account += '<option value="B1204">Freiburg</option>';

								//	}
								//	if (new_registergericht == "Friedberg") {
								//		account += '<option value="M1405" selected="selected">Friedberg</option>';
								//	}
								//	else {
								//		account += '<option value="M1405">Friedberg</option>';

								//	}
								//	if (new_registergericht == "Fritzlar") {
								//		account += '<option value="M1603" selected="selected">Fritzlar</option>';
								//	}
								//	else {
								//		account += '<option value="M1603">Fritzlar</option>';

								//	}
								//	if (new_registergericht == "Fulda") {
								//		account += '<option value="M1301" selected="selected">Fulda</option>';
								//	}
								//	else {
								//		account += '<option value="M1301">Fulda</option>';

								//	}
								//	if (new_registergericht == "Fürth") {
								//		account += '<option value="D3304" selected="selected">Fürth</option>';
								//	}
								//	else {
								//		account += '<option value="D3304">Fürth</option>';

								//	}
								//	if (new_registergericht == "Gelsenkirchen") {
								//		account += '<option value="R2507" selected="selected">Gelsenkirchen</option>';
								//	}
								//	else {
								//		account += '<option value="R2507">Gelsenkirchen</option>';

								//	}
								//	if (new_registergericht == "Gera") {
								//		account += '<option value="Y1203" selected="selected">Gera</option>';
								//	}
								//	else {
								//		account += '<option value="Y1203">Gera</option>';

								//	}
								//	if (new_registergericht == "Gießen") {
								//		account += '<option value="M1406" selected="selected">Gießen</option>';
								//	}
								//	else {
								//		account += '<option value="M1406">Gießen</option>';

								//	}
								//	if (new_registergericht == "Gotha") {
								//		account += '<option value="Y1108" selected="selected">Gotha</option>';
								//	}
								//	else {
								//		account += '<option value="Y1108">Gotha</option>';

								//	}
								//	if (new_registergericht == "Göttingen") {
								//		account += '<option value="P2204" selected="selected">Göttingen</option>';
								//	}
								//	else {
								//		account += '<option value="P2204">Göttingen</option>';

								//	}
								//	if (new_registergericht == "Greiz") {
								//		account += '<option value="Y1205" selected="selected">Greiz</option>';
								//	}
								//	else {
								//		account += '<option value="Y1205">Greiz</option>';

								//	}
								//	if (new_registergericht == "Gütersloh") {
								//		account += '<option value="R2103" selected="selected">Gütersloh</option>';
								//	}
								//	else {
								//		account += '<option value="R2103">Gütersloh</option>';

								//	}
								//	if (new_registergericht == "Hagen") {
								//		account += '<option value="R2602" selected="selected">Hagen</option>';
								//	}
								//	else {
								//		account += '<option value="R2602">Hagen</option>';

								//	}
								//	if (new_registergericht == "Hamburg") {
								//		account += '<option value="K1101" selected="selected">Hamburg</option>';
								//	}
								//	else {
								//		account += '<option value="K1101">Hamburg</option>';

								//	}
								//	if (new_registergericht == "Hamm") {
								//		account += '<option value="R2404" selected="selected">Hamm</option>';
								//	}
								//	else {
								//		account += '<option value="R2404">Hamm</option>';

								//	}
								//	if (new_registergericht == "Hanau") {
								//		account += '<option value="M1502" selected="selected">Hanau</option>';
								//	}
								//	else {
								//		account += '<option value="M1502">Hanau</option>';

								//	}
								//	if (new_registergericht == "Hannover") {
								//		account += '<option value="P2305" selected="selected">Hannover</option>';
								//	}
								//	else {
								//		account += '<option value="P2305">Hannover</option>';

								//	}
								//	if (new_registergericht == "Heilbad Heiligenstadt") {
								//		account += '<option value="Y1109" selected="selected">Heilbad Heiligenstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1109">Heilbad Heiligenstadt</option>';

								//	}
								//	if (new_registergericht == "Hildburghausen") {
								//		account += '<option value="Y1302" selected="selected">Hildburghausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1302">Hildburghausen</option>';

								//	}
								//	if (new_registergericht == "Hildesheim") {
								//		account += '<option value="P2408" selected="selected">Hildesheim</option>';
								//	}
								//	else {
								//		account += '<option value="P2408">Hildesheim</option>';

								//	}
								//	if (new_registergericht == "Hof") {
								//		account += '<option value="D4501" selected="selected">Hof</option>';
								//	}
								//	else {
								//		account += '<option value="D4501">Hof</option>';

								//	}
								//	if (new_registergericht == "Homburg") {
								//		account += '<option value="V1102" selected="selected">Homburg</option>';
								//	}
								//	else {
								//		account += '<option value="V1102">Homburg</option>';

								//	}
								//	if (new_registergericht == "Ingolstadt") {
								//		account += '<option value="D5701" selected="selected">Ingolstadt</option>';
								//	}
								//	else {
								//		account += '<option value="D5701">Ingolstadt</option>';

								//	}
								//	if (new_registergericht == "Iserlohn") {
								//		account += '<option value="R2604" selected="selected">Iserlohn</option>';
								//	}
								//	else {
								//		account += '<option value="R2604">Iserlohn</option>';

								//	}
								//	if (new_registergericht == "Jena") {
								//		account += '<option value="Y1206" selected="selected">Jena</option>';
								//	}
								//	else {
								//		account += '<option value="Y1206">Jena</option>';

								//	}
								//	if (new_registergericht == "Kaiserslautern") {
								//		account += '<option value="T3201" selected="selected">Kaiserslautern</option>';
								//	}
								//	else {
								//		account += '<option value="T3201">Kaiserslautern</option>';

								//	}
								//	if (new_registergericht == "Kassel") {
								//		account += '<option value="M1607" selected="selected">Kassel</option>';
								//	}
								//	else {
								//		account += '<option value="M1607">Kassel</option>';

								//	}
								//	if (new_registergericht == "Kempten (Allgäu)") {
								//		account += '<option value="D2304" selected="selected">Kempten (Allgäu)</option>';
								//	}
								//	else {
								//		account += '<option value="D2304">Kempten (Allgäu)</option>';

								//	}
								//	if (new_registergericht == "Kiel") {
								//		account += '<option value="X1517" selected="selected">Kiel</option>';
								//	}
								//	else {
								//		account += '<option value="X1517">Kiel</option>';

								//	}
								//	if (new_registergericht == "Kleve") {
								//		account += '<option value="R1304" selected="selected">Kleve</option>';
								//	}
								//	else {
								//		account += '<option value="R1304">Kleve</option>';

								//	}
								//	if (new_registergericht == "Koblenz") {
								//		account += '<option value="T2210" selected="selected">Koblenz</option>';
								//	}
								//	else {
								//		account += '<option value="T2210">Koblenz</option>';

								//	}
								//	if (new_registergericht == "Köln") {
								//		account += '<option value="R3306" selected="selected">Köln</option>';
								//	}
								//	else {
								//		account += '<option value="R3306">Köln</option>';

								//	}
								//	if (new_registergericht == "Königstein") {
								//		account += '<option value="M1203" selected="selected">Königstein</option>';
								//	}
								//	else {
								//		account += '<option value="M1203">Königstein</option>';

								//	}
								//	if (new_registergericht == "Korbach") {
								//		account += '<option value="M1608" selected="selected">Korbach</option>';
								//	}
								//	else {
								//		account += '<option value="M1608">Korbach</option>';

								//	}
								//	if (new_registergericht == "Krefeld") {
								//		account += '<option value="R1402" selected="selected">Krefeld</option>';
								//	}
								//	else {
								//		account += '<option value="R1402">Krefeld</option>';

								//	}
								//	if (new_registergericht == "Landau") {
								//		account += '<option value="T3304" selected="selected">Landau</option>';
								//	}
								//	else {
								//		account += '<option value="T3304">Landau</option>';

								//	}
								//	if (new_registergericht == "Landshut") {
								//		account += '<option value="D2404" selected="selected">Landshut</option>';
								//	}
								//	else {
								//		account += '<option value="D2404">Landshut</option>';

								//	}
								//	if (new_registergericht == "Langenfeld") {
								//		account += '<option value="R1105" selected="selected">Langenfeld</option>';
								//	}
								//	else {

								//	}
								//	if (new_registergericht == "Lebach") {
								//		account += '<option value="V1103" selected="selected">Lebach</option>';
								//	}
								//	else {
								//		account += '<option value="V1103">Lebach</option>';

								//	}
								//	if (new_registergericht == "Leipzig") {
								//		account += '<option value="U1308" selected="selected">Leipzig</option>';
								//	}
								//	else {
								//		account += '<option value="U1308">Leipzig</option>';

								//	}
								//	if (new_registergericht == "Lemgo") {
								//		account += '<option value="R2307" selected="selected">Lemgo</option>';
								//	}
								//	else {
								//		account += '<option value="R2307">Lemgo</option>';

								//	}
								//	if (new_registergericht == "Limburg") {
								//		account += '<option value="M1706" selected="selected">Limburg</option>';
								//	}
								//	else {
								//		account += '<option value="M1706">Limburg</option>';

								//	}
								//	if (new_registergericht == "Lübeck") {
								//		account += '<option value="X1721" selected="selected">Lübeck</option>';
								//	}
								//	else {
								//		account += '<option value="X1721">Lübeck</option>';

								//	}
								//	if (new_registergericht == "Ludwigshafen a.Rhein (Ludwigshafen)") {
								//		account += '<option value="T3104" selected="selected">Ludwigshafen a.Rhein (Ludwigshafen)</option>';
								//	}
								//	else {
								//		account += '<option value="T3104">Ludwigshafen a.Rhein (Ludwigshafen)</option>';

								//	}
								//	if (new_registergericht == "Lüneburg") {
								//		account += '<option value="P2507" selected="selected">Lüneburg</option>';
								//	}
								//	else {
								//		account += '<option value="P2507">Lüneburg</option>';

								//	}
								//	if (new_registergericht == "Mainz") {
								//		account += '<option value="T2304" selected="selected">Mainz</option>';
								//	}
								//	else {
								//		account += '<option value="T2304">Mainz</option>';

								//	}
								//	if (new_registergericht == "Mannheim") {
								//		account += '<option value="B1601" selected="selected">Mannheim</option>';
								//	}
								//	else {
								//		account += '<option value="B1601">Mannheim</option>';

								//	}
								//	if (new_registergericht == "Marburg") {
								//		account += '<option value="M1809" selected="selected">Marburg</option>';
								//	}
								//	else {
								//		account += '<option value="M1809">Marburg</option>';

								//	}
								//	if (new_registergericht == "Meiningen") {
								//		account += '<option value="Y1304" selected="selected">Meiningen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1304">Meiningen</option>';

								//	}
								//	if (new_registergericht == "Memmingen") {
								//		account += '<option value="D2505" selected="selected">Memmingen</option>';
								//	}
								//	else {
								//		account += '<option value="D2505">Memmingen</option>';

								//	}
								//	if (new_registergericht == "Merzig") {
								//		account += '<option value="V1104" selected="selected">Merzig</option>';
								//	}
								//	else {
								//		account += '<option value="V1104">Merzig</option>';

								//	}
								//	if (new_registergericht == "Mönchengladbach") {
								//		account += '<option value="R1504" selected="selected">Mönchengladbach</option>';
								//	}
								//	else {
								//		account += '<option value="R1504">Mönchengladbach</option>';

								//	}
								//	if (new_registergericht == "Montabaur") {
								//		account += '<option value="T2214" selected="selected">Montabaur</option>';
								//	}
								//	else {
								//		account += '<option value="T2214">Montabaur</option>';

								//	}
								//	if (new_registergericht == "Mühlhausen") {
								//		account += '<option value="Y1110" selected="selected">Mühlhausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1110">Mühlhausen</option>';

								//	}
								//	if (new_registergericht == "München") {
								//		account += '<option value="D2601" selected="selected">München</option>';
								//	}
								//	else {
								//		account += '<option value="D2601">München</option>';

								//	}
								//	if (new_registergericht == "Münster") {
								//		account += '<option value="R2713" selected="selected">Münster</option>';
								//	}
								//	else {
								//		account += '<option value="R2713">Münster</option>';

								//	}
								//	if (new_registergericht == "Neubrandenburg") {
								//		account += '<option value="N1105" selected="selected">Neubrandenburg</option>';
								//	}
								//	else {
								//		account += '<option value="N1105">Neubrandenburg</option>';

								//	}
								//	if (new_registergericht == "Neunkirchen") {
								//		account += '<option value="V1105" selected="selected">Neunkirchen</option>';
								//	}
								//	else {
								//		account += '<option value="V1105">Neunkirchen</option>';

								//	}
								//	if (new_registergericht == "Neuruppin") {
								//		account += '<option value="G1309" selected="selected">Neuruppin</option>';
								//	}
								//	else {
								//		account += '<option value="G1309">Neuruppin</option>';

								//	}
								//	if (new_registergericht == "Neuss") {
								//		account += '<option value="R1102" selected="selected">Neuss</option>';
								//	}
								//	else {
								//		account += '<option value="R1102">Neuss</option>';

								//	}
								//	if (new_registergericht == "Nordhausen") {
								//		account += '<option value="Y1111" selected="selected">Nordhausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1111">Nordhausen</option>';

								//	}
								//	if (new_registergericht == "Nürnberg") {
								//		account += '<option value="D3310" selected="selected">Nürnberg</option>';
								//	}
								//	else {
								//		account += '<option value="D3310">Nürnberg</option>';

								//	}
								//	if (new_registergericht == "Offenbach am Main") {
								//		account += '<option value="M1114" selected="selected">Offenbach am Main</option>';
								//	}
								//	else {
								//		account += '<option value="M1114">Offenbach am Main</option>';

								//	}
								//	if (new_registergericht == "Oldenburg (Oldenburg)") {
								//		account += '<option value="P3210" selected="selected">Oldenburg (Oldenburg)</option>';
								//	}
								//	else {
								//		account += '<option value="P3210">Oldenburg (Oldenburg)</option>';

								//	}
								//	if (new_registergericht == "Osnabrück") {
								//		account += '<option value="P3313" selected="selected">Osnabrück</option>';
								//	}
								//	else {
								//		account += '<option value="P3313">Osnabrück</option>';

								//	}
								//	if (new_registergericht == "Ottweiler") {
								//		account += '<option value="V1107" selected="selected">Ottweiler</option>';
								//	}
								//	else {
								//		account += '<option value="V1107">Ottweiler</option>';

								//	}
								//	if (new_registergericht == "Paderborn") {
								//		account += '<option value="R2809" selected="selected">Paderborn</option>';
								//	}
								//	else {
								//		account += '<option value="R2809">Paderborn</option>';

								//	}
								//	if (new_registergericht == "Passau") {
								//		account += '<option value="D2803" selected="selected">Passau</option>';
								//	}
								//	else {
								//		account += '<option value="D2803">Passau</option>';

								//	}
								//	if (new_registergericht == "Pinneberg") {
								//		account += '<option value="X1321" selected="selected">Pinneberg</option>';
								//	}
								//	else {
								//		account += '<option value="X1321">Pinneberg</option>';

								//	}
								//	if (new_registergericht == "Pößneck") {
								//		account += '<option value="Y1209" selected="selected">Pößneck</option>';
								//	}
								//	else {
								//		account += '<option value="Y1209">Pößneck</option>';

								//	}
								//	if (new_registergericht == "Pößneck Zweigstelle Bad Lobenstein") {
								//		account += '<option value="Y1208" selected="selected">Pößneck Zweigstelle Bad Lobenstein</option>';
								//	}
								//	else {
								//		account += '<option value="Y1208">Pößneck Zweigstelle Bad Lobenstein</option>';

								//	}
								//	if (new_registergericht == "Potsdam") {
								//		account += '<option value="G1312" selected="selected">Potsdam</option>';
								//	}
								//	else {
								//		account += '<option value="G1312">Potsdam</option>';

								//	}
								//	if (new_registergericht == "Recklinghausen") {
								//		account += '<option value="R2204" selected="selected">Recklinghausen</option>';
								//	}
								//	else {
								//		account += '<option value="R2204">Recklinghausen</option>';

								//	}
								//	if (new_registergericht == "Regensburg") {
								//		account += '<option value="D3410" selected="selected">Regensburg</option>';
								//	}
								//	else {
								//		account += '<option value="D3410">Regensburg</option>';

								//	}
								//	if (new_registergericht == "Rostock") {
								//		account += '<option value="N1206" selected="selected">Rostock</option>';
								//	}
								//	else {
								//		account += '<option value="N1206">Rostock</option>';

								//	}
								//	if (new_registergericht == "Rudolstadt") {
								//		account += '<option value="Y1210" selected="selected">Rudolstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1210">Rudolstadt</option>';

								//	}
								//	if (new_registergericht == "Rudolstadt Zweigstelle Saalfeld") {
								//		account += '<option value="Y1211" selected="selected">Rudolstadt Zweigstelle Saalfeld</option>';
								//	}
								//	else {
								//		account += '<option value="Y1211">Rudolstadt Zweigstelle Saalfeld</option>';

								//	}
								//	if (new_registergericht == "Saarbrücken") {
								//		account += '<option value="V1109" selected="selected">Saarbrücken</option>';
								//	}
								//	else {
								//		account += '<option value="V1109">Saarbrücken</option>';

								//	}
								//	if (new_registergericht == "Saarlouis") {
								//		account += '<option value="V1110" selected="selected">Saarlouis</option>';
								//	}
								//	else {
								//		account += '<option value="V1110">Saarlouis</option>';

								//	}
								//	if (new_registergericht == "Schweinfurt") {
								//		account += '<option value="D4608" selected="selected">Schweinfurt</option>';
								//	}
								//	else {
								//		account += '<option value="D4608">Schweinfurt</option>';

								//	}
								//	if (new_registergericht == "Schwerin") {
								//		account += '<option value="N1308" selected="selected">Schwerin</option>';
								//	}
								//	else {
								//		account += '<option value="N1308">Schwerin</option>';

								//	}
								//	if (new_registergericht == "Siegburg") {
								//		account += '<option value="R3208" selected="selected">Siegburg</option>';
								//	}
								//	else {
								//		account += '<option value="R3208">Siegburg</option>';

								//	}
								//	if (new_registergericht == "Siegen") {
								//		account += '<option value="R2909" selected="selected">Siegen</option>';
								//	}
								//	else {
								//		account += '<option value="R2909">Siegen</option>';

								//	}
								//	if (new_registergericht == "Sömmerda") {
								//		account += '<option value="Y1112" selected="selected">Sömmerda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1112">Sömmerda</option>';

								//	}
								//	if (new_registergericht == "Sondershausen") {
								//		account += '<option value="Y1113" selected="selected">Sondershausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1113">Sondershausen</option>';

								//	}
								//	if (new_registergericht == "Sonneberg") {
								//		account += '<option value="Y1307" selected="selected">Sonneberg</option>';
								//	}
								//	else {
								//		account += '<option value="Y1307">Sonneberg</option>';

								//	}
								//	if (new_registergericht == "Stadthagen") {
								//		account += '<option value="P2106" selected="selected">Stadthagen</option>';
								//	}
								//	else {
								//		account += '<option value="P2106">Stadthagen</option>';

								//	}
								//	if (new_registergericht == "Stadtroda") {
								//		account += '<option value="Y1214" selected="selected">Stadtroda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1214">Stadtroda</option>';

								//	}
								//	if (new_registergericht == "Steinfurt") {
								//		account += '<option value="R2706" selected="selected">Steinfurt</option>';
								//	}
								//	else {
								//		account += '<option value="R2706">Steinfurt</option>';

								//	}
								//	if (new_registergericht == "Stendal") {
								//		account += '<option value="W1215" selected="selected">Stendal</option>';
								//	}
								//	else {
								//		account += '<option value="W1215">Stendal</option>';

								//	}
								//	if (new_registergericht == "St. Ingbert (St Ingbert)") {
								//		account += '<option value="V1111" selected="selected">St. Ingbert (St Ingbert)</option>';
								//	}
								//	else {
								//		account += '<option value="V1111">St. Ingbert (St Ingbert)</option>';

								//	}
								//	if (new_registergericht == "Stralsund") {
								//		account += '<option value="N1209" selected="selected">Stralsund</option>';
								//	}
								//	else {
								//		account += '<option value="N1209">Stralsund</option>';

								//	}
								//	if (new_registergericht == "Straubing") {
								//		account += '<option value="D3413" selected="selected">Straubing</option>';
								//	}
								//	else {
								//		account += '<option value="D3413">Straubing</option>';

								//	}
								//	if (new_registergericht == "Stuttgart") {
								//		account += '<option value="B2609" selected="selected">Stuttgart</option>';
								//	}
								//	else {
								//		account += '<option value="B2609">Stuttgart</option>';

								//	}
								//	if (new_registergericht == "St. Wendel (St Wendel)") {
								//		account += '<option value="V1112" selected="selected">St. Wendel (St Wendel)</option>';
								//	}
								//	else {
								//		account += '<option value="V1112">St. Wendel (St Wendel)</option>';

								//	}
								//	if (new_registergericht == "Suhl") {
								//		account += '<option value="Y1308" selected="selected">Suhl</option>';
								//	}
								//	else {
								//		account += '<option value="Y1308">Suhl</option>';

								//	}
								//	if (new_registergericht == "Tostedt") {
								//		account += '<option value="P2613" selected="selected">Tostedt</option>';
								//	}
								//	else {
								//		account += '<option value="P2613">Tostedt</option>';

								//	}
								//	if (new_registergericht == "Traunstein") {
								//		account += '<option value="D2910" selected="selected">Traunstein</option>';
								//	}
								//	else {
								//		account += '<option value="D2910">Traunstein</option>';

								//	}
								//	if (new_registergericht == "Ulm") {
								//		account += '<option value="B2805" selected="selected">Ulm</option>';
								//	}
								//	else {
								//		account += '<option value="B2805">Ulm</option>';

								//	}
								//	if (new_registergericht == "Völklingen") {
								//		account += '<option value="V1115" selected="selected">Völklingen</option>';
								//	}
								//	else {
								//		account += '<option value="V1115">Völklingen</option>';

								//	}
								//	if (new_registergericht == "Walsrode") {
								//		account += '<option value="P2716" selected="selected">Walsrode</option>';
								//	}
								//	else {
								//		account += '<option value="P2716">Walsrode</option>';

								//	}
								//	if (new_registergericht == "Weiden i. d. OPf.") {
								//		account += '<option value="D3508" selected="selected">Weiden i. d. OPf.</option>';
								//	}
								//	else {
								//		account += '<option value="D3508">Weiden i. d. OPf.</option>';

								//	}
								//	if (new_registergericht == "Weimar") {
								//		account += '<option value="Y1114" selected="selected">Weimar</option>';
								//	}
								//	else {
								//		account += '<option value="Y1114">Weimar</option>';

								//	}
								//	if (new_registergericht == "Wetzlar") {
								//		account += '<option value="M1710" selected="selected">Wetzlar</option>';
								//	}
								//	else {
								//		account += '<option value="M1710">Wetzlar</option>';

								//	}
								//	if (new_registergericht == "Wiesbaden") {
								//		account += '<option value="M1906" selected="selected">Wiesbaden</option>';
								//	}
								//	else {
								//		account += '<option value="M1906">Wiesbaden</option>';

								//	}
								//	if (new_registergericht == "Wittlich") {
								//		account += '<option value="T2408" selected="selected">Wittlich</option>';
								//	}
								//	else {
								//		account += '<option value="T2408">Wittlich</option>';

								//	}
								//	if (new_registergericht == "Wuppertal") {
								//		account += '<option value="R1608" selected="selected">Wuppertal</option>';
								//	}
								//	else {
								//		account += '<option value="R1608">Wuppertal</option>';

								//	}
								//	if (new_registergericht == "Würzburg") {
								//		account += '<option value="D4708" selected="selected">Würzburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4708">Würzburg</option>';

								//	}
								//	if (new_registergericht == "Zweibrücken") {
								//		account += '<option value="T3403" selected="selected">Zweibrücken</option>';
								//	}
								//	else {
								//		account += '<option value="T3403">Zweibrücken</option>';

								//	}
								//	account += '</select>';
								//}
								else {
									account += '<select name="registergericht" class="form-control">' +
										'<option value="" selected="selected">all</option>' +
										'<option value="1">Aachen</option>' +
									    '<option value="2">Altenburg</option>' +
									    '<option value="3">Amberg</option>' +
									    '<option value="4">Ansbach</option>' +
									    '<option value="5">Apolda</option>' +
									    '<option value="6">Arnsberg</option>' +
									    '<option value="7">Arnstadt</option>' +
									    '<option value="8">Arnstadt Zweigstelle Ilmenau</option>' +
									    '<option value="9">Aschaffenburg</option>' +
									    '<option value="10">Augsburg</option>' +
									    '<option value="11">Aurich</option>' +
									    '<option value="12">Bad Hersfeld</option>' +
									    '<option value="13">Bad Homburg v.d.H.</option>' +
									    '<option value="14">Bad Kreuznach</option>' +
									    '<option value="15">Bad Oeynhausen</option>' +
									    '<option value="16">Bad Salzungen</option>' +
									    '<option value="17">Bamberg</option>' +
									    '<option value="18">Bayreuth</option>' +
									    '<option value="19">Berlin (Charlottenburg)</option>' +
									    '<option value="20">Bielefeld</option>' +
									    '<option value="21">Bochum</option>' +
									    '<option value="22">Bonn</option>' +
									    '<option value="23">Braunschweig</option>' +
									    '<option value="24">Bremen</option>' +
									    '<option value="25">Chemnitz</option>' +
									    '<option value="26">Coburg</option>' +
									    '<option value="27">Coesfeld</option>' +
									    '<option value="28">Cottbus</option>' +
									    '<option value="29">Darmstadt</option>' +
									    '<option value="30">Deggendorf</option>' +
									    '<option value="31">Dortmund</option>' +
									    '<option value="32">Dresden</option>' +
									    '<option value="33">Duisburg</option>' +
									    '<option value="34">Düren</option>' +
									    '<option value="35">Düsseldorf</option>' +
									    '<option value="36">Eisenach</option>' +
									    '<option value="37">Erfurt</option>' +
									    '<option value="38">Eschwege</option>' +
									    '<option value="39">Essen</option>' +
									    '<option value="40">Flensburg</option>' +
									    '<option value="41">Frankfurt am Main</option>' +
									    '<option value="42">Frankfurt/Oder</option>' +
									    '<option value="43">Freiburg</option>' +
									    '<option value="44">Friedberg</option>' +
									    '<option value="45">Fritzlar</option>' +
									    '<option value="46">Fulda</option>' +
									    '<option value="47">Fürth</option>' +
									    '<option value="48">Gelsenkirchen</option>' +
									    '<option value="49">Gera</option>' +
									    '<option value="50">Gießen</option>' +
									    '<option value="51">Gotha</option>' +
									    '<option value="52">Greiz</option>' +
									    '<option value="53">Göttingen</option>' +
									    '<option value="54">Gütersloh</option>' +
									    '<option value="55">Hagen</option>' +
									    '<option value="56">Hamburg</option>' +
									    '<option value="57">Hamm</option>' +
									    '<option value="58">Hanau</option>' +
									    '<option value="59">Hannover</option>' +
									    '<option value="60">Heilbad Heiligenstadt</option>' +
									    '<option value="61">Hildburghausen</option>' +
									    '<option value="62">Hildesheim</option>' +
									    '<option value="63">Hof</option>' +
									    '<option value="64">Homburg</option>' +
									    '<option value="65">Ingolstadt</option>' +
									    '<option value="66">Iserlohn</option>' +
									    '<option value="67">Jena</option>' +
									    '<option value="68">Kaiserslautern</option>' +
									    '<option value="69">Kassel</option>' +
									    '<option value="70">Kempten (Allgäu)</option>' +
									    '<option value="71">Kiel</option>' +
									    '<option value="72">Kleve</option>' +
									    '<option value="73">Koblenz</option>' +
									    '<option value="74">Korbach</option>' +
									    '<option value="75">Krefeld</option>' +
									    '<option value="76">Köln</option>' +
									    '<option value="77">Königstein</option>' +
									    '<option value="78">Landau</option>' +
									    '<option value="79">Landshut</option>' +
									    '<option value="80">Langenfeld</option>' +
									    '<option value="81">Lebach</option>' +
									    '<option value="82">Leipzig</option>' +
									    '<option value="83">Lemgo</option>' +
									    '<option value="84">Limburg</option>' +
									    '<option value="85">Ludwigshafen a.Rhein (Ludwigshafen)</option>' +
									    '<option value="86">Lübeck</option>' +
									    '<option value="87">Lüneburg</option>' +
									    '<option value="88">Mainz</option>' +
									    '<option value="89">Mannheim</option>' +
									    '<option value="90">Marburg</option>' +
									    '<option value="91">Meiningen</option>' +
									    '<option value="92">Memmingen</option>' +
									    '<option value="93">Merzig</option>' +
                                        '<option value="94">Montabaur</option>' +
									    '<option value="95">Mönchengladbach</option>' +
									    '<option value="96">Mühlhausen</option>' +
									    '<option value="97">München</option>' +
									    '<option value="98">Münster</option>' +
									    '<option value="99">Neubrandenburg</option>' +
									    '<option value="100">Neunkirchen</option>' +
									    '<option value="101">Neuruppin</option>' +
									    '<option value="102">Neuss</option>' +
									    '<option value="103">Nordhausen</option>' +
									    '<option value="104">Nürnberg</option>' +
									    '<option value="105">Offenbach am Main</option>' +
									    '<option value="106">Oldenburg (Oldenburg)</option>' +
									    '<option value="107">Osnabrück</option>' +
									    '<option value="108">Ottweiler</option>' +
									    '<option value="109">Paderborn</option>' +
									    '<option value="110">Passau</option>' +
									    '<option value="111">Pinneberg</option>' +
                                        '<option value="112">Potsdam</option>' +
									    '<option value="113">Pößneck</option>' +
									    '<option value="114">Pößneck Zweigstelle Bad Lobenstein</option>' +

									    '<option value="115">Recklinghausen</option>' +
									    '<option value="116">Regensburg</option>' +
									    '<option value="117">Rostock</option>' +
									    '<option value="118">Rudolstadt</option>' +
									    '<option value="119">Rudolstadt Zweigstelle Saalfeld</option>' +
									    '<option value="120">Saarbrücken</option>' +
									    '<option value="121">Saarlouis</option>' +
									    '<option value="122">Schweinfurt</option>' +
									    '<option value="123">Schwerin</option>' +
									    '<option value="124">Siegburg</option>' +
									    '<option value="125">Siegen</option>' +
									    //'<option value="126">Sömmerda</option>' +
									    '<option value="126">Sondershausen</option>' +
									    '<option value="127">Sonneberg</option>' +
                                        '<option value="128">St. Ingbert (St Ingbert)</option>' +
                                        '<option value="129">St. Wendel (St Wendel)</option>' +
									    '<option value="130">Stadthagen</option>' +
									    '<option value="131">Stadtroda</option>' +
									    '<option value="132">Steinfurt</option>' +
									    '<option value="133">Stendal</option>' +
									    //'<option value="133">St. Ingbert (St Ingbert)</option>' +
									    '<option value="134">Stralsund</option>' +
									    '<option value="135">Straubing</option>' +
									    '<option value="136">Stuttgart</option>' +
									    //'<option value="137">St. Wendel (St Wendel)</option>' +
									    '<option value="137">Suhl</option>' +
                                        '<option value="138">Sömmerda</option>' +
									    '<option value="139">Tostedt</option>' +
									    '<option value="140">Traunstein</option>' +
									    '<option value="141">Ulm</option>' +
									    '<option value="142">Völklingen</option>' +
									    '<option value="143">Walsrode</option>' +
									    '<option value="144">Weiden i. d. OPf.</option>' +
									    '<option value="145">Weimar</option>' +
									    '<option value="146">Wetzlar</option>' +
									    '<option value="147">Wiesbaden</option>' +
									    '<option value="148">Wittlich</option>' +
									    '<option value="149">Wuppertal</option>' +
									    '<option value="150">Würzburg</option>' +
									    '<option value="151">Zweibrücken</option>' +
									'</select>';
								}


								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 '  <label class="control-label">Rechtsform</label>';


								if (new_rechtsform != null) {
								    account += '<select id="RechtsformId" onchange="updateAccount(this)" style="width:140px" class="form-control">' +
                                                                                '<option value="">Wählen</option>';
								    if (new_rechtsform == 1) {
								        account += '<option value="1" selected="selected">Aktiengesellschaft</option>';
								    }
								    else {
								        account += '<option value="1">Aktiengesellschaft</option>';
								    }

								    if (new_rechtsform == 2) {
								        account += '<option value="2" selected="selected">eingetragene Genossenschaft</option>';
								    }
								    else {
								        account += '<option value="2">eingetragene Genossenschaft</option>';
								    }
								    if (new_rechtsform == 3) {
								        account += '<option value="3" selected="selected">Einzelkaufmann</option>';
								    }
								    else {
								        account += '<option value="3">Einzelkaufmann</option>';
								    }
								    if (new_rechtsform == 4) {
								        account += '<option value="4" selected="selected">Europäische wirtschaftliche Interessenvereinigung</option>';
								    }
								    else {
								        account += '<option value="4">Europäische wirtschaftliche Interessenvereinigung</option>';
								    }
								    if (new_rechtsform == 5) {
								        account += '<option value="5" selected="selected">Gesellschaft mit beschränkter Haftung</option>';
								    }
								    else {
								        account += '<option value="5">Gesellschaft mit beschränkter Haftung</option>';
								    }
								    if (new_rechtsform == 6) {
								        account += '<option value="6" selected="selected">GmbH &amp; Co. KG</option>';
								    }
								    else {
								        account += '<option value="6">GmbH &amp; Co. KG</option>';
								    }
								    if (new_rechtsform == 7) {
								        account += '<option value="7" selected="selected">Gmbh &amp; Co. OHG</option>';
								    }
								    else {
								        account += '<option value="7">Gmbh &amp; Co. OHG</option>';
								    }
								    if (new_rechtsform == 8) {
								        account += '<option value="8" selected="selected">Kommanditgesellschaft</option>';
								    }
								    else {
								        account += '<option value="8">Kommanditgesellschaft</option>';
								    }
								    if (new_rechtsform == 9) {
								        account += '<option value="9" selected="selected">Kommanditgesellschaft auf Aktien</option>';
								    }
								    else {
								        account += '<option value="9">Kommanditgesellschaft auf Aktien</option>';
								    }
								    if (new_rechtsform == 10) {
								        account += '<option value="10" selected="selected">Offene Handelsgesellschaft</option>';
								    }
								    else {
								        account += '<option value="10">Offene Handelsgesellschaft</option>';
								    }
								    if (new_rechtsform == 11) {
								        account += '<option value="11" selected="selected">Partner</option>';
								    }
								    else {
								        account += '<option value="11">Partner</option>';
								    }
								    if (new_rechtsform == 12) {
								        account += '<option value="12" selected="selected">Rechtsform ausländischen Rechts HRA</option>';
								    }
								    else {
								        account += '<option value="12">Rechtsform ausländischen Rechts HRA</option>';
								    }
								    if (new_rechtsform == 13) {
								        account += '<option value="13" selected="selected">Rechtsform ausländischen Rechts HRB</option>';
								    }
								    else {
								        account += '<option value="13">Rechtsform ausländischen Rechts HRB</option>';
								    }
								    if (new_rechtsform == 14) {
								        account += '<option value="14" selected="selected">Rechtsform ausländischen Rechts GnR</option>';
								    }
								    else {
								        account += '<option value="14">Rechtsform ausländischen Rechts GnR</option>';
								    }
								    if (new_rechtsform == 15) {
								        account += '<option value="15" selected="selected">Rechtsform ausländischen Rechts PR</option>';
								    }
								    else {
								        account += '<option value="15">Rechtsform ausländischen Rechts PR</option>';
								    }
								    if (new_rechtsform == 16) {
								        account += '<option value="16" selected="selected">Societas Europaea (SE)</option>';
								    }
								    else {
								        account += '<option value="16">Societas Europaea (SE)</option>';
								    }
								    if (new_rechtsform == 17) {
								        account += '<option value="17" selected="selected">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								    }
								    else {
								        account += '<option value="17">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								    }
								    if (new_rechtsform == 18) {
								        account += '<option value="18" selected="selected">Stiftung (bürgerlichen Rechts)</option>';
								    }
								    else {
								        account += '<option value="18">Stiftung (bürgerlichen Rechts)</option>';
								    }
								    if (new_rechtsform == 19) {
								        account += '<option value="19" selected="selected">Verein</option>';
								    }
								    else {
								        account += '<option value="19">Verein</option>';
								    }
								    if (new_rechtsform == 20) {
								        account += '<option value="20" selected="selected">Versicherungsverein auf Gegenseitigkeit</option>';
								    }
								    else {
								        account += '<option value="20">Versicherungsverein auf Gegenseitigkeit</option>';
								    }

								    account += '</select>';
								}
								else {
									// account += ' <input type="text" name="RechtsformId" onchange="updateAccount(this)" class="form-control input-sm"  />';
									account += '<select id="RechtsformId"  onchange="updateAccount(this)" style="width:140px" class="form-control">' +
												 '<option value="">Wählen</option>' +
												 '<option value="1">Aktiengesellschaft</option>' +
												 '<option value="2">eingetragene Genossenschaft</option>' +
												 '<option value="3">Einzelkaufmann</option>' +
												 '<option value="4">Europäische wirtschaftliche Interessenvereinigung</option>' +
												 '<option value="5">Gesellschaft mit beschränkter Haftung</option>' +
												 '<option value="6">GmbH &amp; Co. KG</option>' +
												' <option value="7">Gmbh &amp; Co. OHG</option>' +
												 '<option value="8">Kommanditgesellschaft</option>' +
												 '<option value="9">Kommanditgesellschaft auf Aktien</option>' +
												' <option value="10">Offene Handelsgesellschaft</option>' +
												' <option value="11">Partner</option>' +
												 '<option value="12">Rechtsform ausländischen Rechts HRA</option>' +
												 '<option value="13">Rechtsform ausländischen Rechts HRB</option>' +
												' <option value="14">Rechtsform ausländischen Rechts GnR</option>' +
												' <option value="15">Rechtsform ausländischen Rechts PR</option>' +
												' <option value="16">Societas Europaea (SE)</option>' +
												 '<option value="17">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>' +
												 '<option value="18">Stiftung (bürgerlichen Rechts)</option>' +
												 '<option value="19">Verein</option>' +
												' <option value="20">Versicherungsverein auf Gegenseitigkeit</option>' +
											' </select>';
								}

								account += '  </div>' +
											' <div class="col-md-3">' +
												' <label class="control-label">Steuerschlüssel</label>';

                                //we dont need to use address1_country, we can use optionset of steuerschluessel
								if (new_steuerschluessel != null) {
								    // account += ' <input type="text" name="SteuerschlüsselId" value = "' + address1_country + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								    account += '<select id="SteuerschlüsselId" onchange="updateAccount(this)" class="form-control">' +
																			 '<option value="Wählen">Wählen</option>';
								    if (new_steuerschluessel == 1) {
								        account += '<option value="1" selected="selected">Deutschland</option>';
								    }
								    else {
								        account += '<option value="1">Deutschland</option>';
								    }
								    if (new_steuerschluessel == 2) {
								        account += '<option value="2" selected="selected">Freihafen; Zollausschlussgebiet</option>';
								    }
								    else {
								        account += '<option value="2">Freihafen; Zollausschlussgebiet</option>';
								    }
								    if (new_steuerschluessel == 3) {
								        account += '<option value="3" selected="selected">EU-Ausland</option>';
								    }
								    else {
								        account += '<option value="3">EU-Ausland</option>';
								    }

								    if (new_steuerschluessel == 4) {
								        account += '<option value="4" selected="selected">Nicht-EU-Ausland</option>';
								    }
								    else {
								        account += '<option value="4">Nicht-EU-Ausland</option>';
								    }
								    if (new_steuerschluessel == 5) {
								        account += '<option value="5" selected="selected">internationale Institutionen</option>';
								    }
								    else {
								        account += '<option value="5">internationale Institutionen</option>';
								    }
								    if (new_steuerschluessel == 6) {
								        account += '<option value="6" selected="selected">NATO-Truppen</option>';
								    }
								    else {
								        account += '<option value="6">NATO-Truppen</option>';
								    }

								    account += '</select>';
								}


								//if (address1_country != null) {
								//	// account += ' <input type="text" name="SteuerschlüsselId" value = "' + address1_country + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								//	account += '<select id="SteuerschlüsselId" onchange="updateAccount(this)" class="form-control">' +
								//											 '<option value="Wählen">Wählen</option>';
								//	if (address1_country == "Deutschland") {
								//		account += '<option value="Deutschland" selected="selected">Deutschland</option>';
								//	}
								//	else {
								//		account += '<option value="Deutschland">Deutschland</option>';
								//	}
								//	if (address1_country == "Freihafen; Zollausschlussgebiet") {
								//		account += '<option value="Freihafen; Zollausschlussgebiet" selected="selected">Freihafen; Zollausschlussgebiet</option>';
								//	}
								//	else {
								//		account += '<option value="Freihafen; Zollausschlussgebiet">Freihafen; Zollausschlussgebiet</option>';
								//	}
								//	if (address1_country == "EU-Ausland") {
								//		account += '<option value="EU-Ausland" selected="selected">EU-Ausland</option>';
								//	}
								//	else {
								//		account += '<option value="EU-Ausland">EU-Ausland</option>';
								//	}

								//	if (address1_country == "Nicht-EU-Ausland") {
								//		account += '<option value="Nicht-EU-Ausland" selected="selected">Nicht-EU-Ausland</option>';
								//	}
								//	else {
								//		account += '<option value="Nicht-EU-Ausland">Nicht-EU-Ausland</option>';
								//	}
								//	if (address1_country == "internationale Institutionen") {
								//		account += '<option value="internationale Institutionen" selected="selected">internationale Institutionen</option>';
								//	}
								//	else {
								//		account += '<option value="internationale Institutionen">internationale Institutionen</option>';
								//	}
								//	if (address1_country == "NATO-Truppen") {
								//		account += '<option value="NATO-Truppen" selected="selected">NATO-Truppen</option>';
								//	}
								//	else {
								//		account += '<option value="NATO-Truppen">NATO-Truppen</option>';
								//	}

								//	account += '</select>';
								//}
								else {
									//  account += ' <input type="text" name="SteuerschlüsselId" onchange="updateAccount(this)" class="form-control input-sm"  />';
									account += '<select id="SteuerschlüsselId" class="form-control" onchange="updateAccount(this)">' +
												'<option value="Wählen" selected="selected">Wählen</option>' +
												'<option value="1">Deutschland</option>' +
												'<option value="2">Freihafen; Zollausschlussgebiet</option>' +
												'<option value="3">EU-Ausland</option>' +
												'<option value="4">Nicht-EU-Ausland</option>' +
												'<option value="5">internationale Institutionen</option>' +
												'<option value="6">NATO-Truppen</option>' +
											   '</select>';
								}

								account += ' </div>' +
										  ' </div>' +
										  '  <div class="row form-group">' +
											  '  <div class="col-md-12">' +
												  ' <label class="control-label">Abweichende Rechnungsanschrift:</label>';
								var ss_abweichenderechnungsanschrift = false;

								if (ss_firmenname == null && ss_vorname == null && ss_name == null && ss_abteilung == null && ss_strassehausnummer == null && ss_plz == null && ss_ort == null && ss_telefon == null && ss_fax == null && ss_email == null) {
									ss_abweichenderechnungsanschrift = true;
								}

								if (ss_abweichenderechnungsanschrift == false) {

									account += ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
									' </label>' +
									' <label class="radio-inline">' +
										'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
									'  </label>';

								}
								else {
									account += ' <label class="radio-inline">' +
							 ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" disabled="disabled">Ja' +
							 ' </label>' +
							 ' <label class="radio-inline">' +
								 '<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" checked="checked" disabled="disabled">Nein' +
							 '  </label>';
								}

								if (ss_abweichenderechnungsanschrift == false) {
									account += '  </div>' +
												 '  </div>' +
											 ' <div class="row form-group">' +
												 '  <div class="col-md-4">' +
													 ' <label class="control-label">Firmenname</label>';
									if (ss_firmenname != null) {
										account += ' <input type="text" name="Firmenname1Id" value = "' + ss_firmenname + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Firmenname1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += ' </div>' +
															' <div class="col-md-2">' +
																' <label class="control-label">Vorname</label>';

									if (ss_vorname != null) {
										account += ' <input type="text" name="Vorname1Id" value = "' + ss_vorname + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Vorname1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += ' </div>' +
																		' <div class="col-md-2">' +
																			' <label class="control-label">Nachname</label>';

									if (ss_name != null) {
										account += ' <input type="text" name="NameId" value = "' + ss_name + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="NameId" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += ' </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Abteilung</label>';

									if (ss_abteilung != null) {
										account += ' <input type="text" name="AbteilungId" value = "' + ss_abteilung + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="AbteilungId" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += ' </div>' +
									 ' <div class="col-md-3">' +
										 ' <label class="control-label">Strasse:</label>';

									if (ss_strassehausnummer != null) {
										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);

										account += ' <input type="text" name="Strasse1Id" value = "' + names + '" onchange="updateAccount(this)" class="form-control input-sm" />';

									}
									else {
										account += ' <input type="text" name="Strasse1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									if (ss_strassehausnummer != null) {
										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);
										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Nr.:</label>' +
													' <input type="text" name="Nr1Id" value = "' + numberss + '" onchange="updateAccount(this)" class="form-control input-sm" />' +
												' </div>';
									}
									else {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Nr.:</label>' +
													' <input type="text" name="Nr1Id" onchange="updateAccount(this)" class="form-control input-sm" />' +
												' </div>';

									}

									account += ' <div class="col-md-2">' +
											   ' <label class="control-label">PLZ:</label>';
									if (ss_plz != null) {
										account += ' <input type="text" name="PLZ1Id" value = "' + ss_plz + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="PLZ1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += '   </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Ort:</label>';
									if (ss_ort != null) {
										account += ' <input type="text" name="Ort2Id" value = "' + ss_ort + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Ort2Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += '  </div>' +
											  '   </div>' +
											  '  <div class="row form-group">' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label">Telefon:</label>';
									if (ss_telefon != null) {
										account += ' <input type="text" name="Telefon1Id" value = "' + ss_telefon + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Telefon1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}


									account += ' </div>' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label">Fax:</label>';
									if (ss_fax != null) {
										account += ' <input type="text" name="Fax1Id" value = "' + ss_fax + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Fax1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}
									account += ' </div>' +
											   ' <div class="col-md-4">' +
												   ' <label class="control-label">Email:</label>';
									if (ss_email != null) {
										account += ' <input type="text" name="Email1Id" value = "' + ss_email + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Email1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}
									account += '</div>' +
										  ' </div>' +
										   '<hr style="border-top: dotted 2px;" />' +
										   '<div class="row form-group">' +
													   ' <div class="col-md-4">' +
														   '<label class="control-label">UREG</label>';
									if (ss_ureg != null) {
										account += '   <input name="UREGId" value = "' + ss_ureg + '" class="form-control input-sm" onchange="updateUREG(this)" type="text">';
									}
									else {
										account += '   <input name="UREGId" onchange="updateUREG(this)" class="form-control input-sm" type="text">';

									}
									account += ' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">Cockpit Type:</label>';
									if (ss_cockpittype == 1) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit" selected="selected">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									else if (ss_cockpittype == 2) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit" selected="selected">PR Cockpit</option></select>';

									}
									else {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									account += '</div>' +
													'<div class="col-md-4">' +
														' <label class="control-label">Anzeige im Cockpit-Admin:</label>';
									if (ss_anzeigeimcockpitadmin == true) {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja"  checked="checked">Ja</label>' +
													   '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>';
									}
									else {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
													  '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein" checked="checked">Nein</label>';
									}

									account += ' </div>' +
												' </div>' +
						'  </form>';
								}
								else {
									account += '  </div>' +
											 '  </div>' +
										 ' <div class="row form-group">' +
											 '  <div class="col-md-4">' +
												 ' <label class="control-label" style="display:none">Firmenname</label>';
									if (ss_firmenname != null) {
										account += ' <input type="text" name="Firmenname1Id" value = "' + ss_firmenname + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Firmenname1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
															' <div class="col-md-2">' +
																' <label class="control-label" style="display:none">Vorname</label>';

									if (ss_vorname != null) {
										account += ' <input type="text" name="Vorname1Id" value = "' + ss_vorname + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="Vorname1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
																		' <div class="col-md-2">' +
																			' <label class="control-label" style="display:none">Nachname</label>';

									if (ss_name != null) {
										account += ' <input type="text" name="NameId" value = "' + ss_name + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="NameId" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Abteilung</label>';

									if (ss_abteilung != null) {
										account += ' <input type="text" name="AbteilungId" value = "' + ss_abteilung + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="AbteilungId" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
									 ' <div class="col-md-3">' +
										 ' <label class="control-label" style="display:none">Strasse:</label>';

									if (ss_strassehausnummer != null) {
										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);

										account += ' <input type="text" name="Strasse1Id" value = "' + names + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}
									else {
										account += ' <input type="text" name="Strasse1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									if (ss_strassehausnummer != null) {
										var names = "";
										var firstDigit = ss_strassehausnummer.match(/\d/); //will give you the first digit in the string
										var index = ss_strassehausnummer.indexOf(firstDigit);
										names = ss_strassehausnummer.substring(0, index);
										var numberss = ss_strassehausnummer.substring(index, ss_strassehausnummer.length);

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Nr.:</label>' +
													' <input type="text" name="Nr1Id" value = "' + numberss + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />' +
												' </div>';
									}
									else {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Nr.:</label>' +
													' <input type="text" name="Nr1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />' +
												' </div>';

									}

									account += ' <div class="col-md-2">' +
											   ' <label class="control-label" style="display:none">PLZ:</label>';
									if (ss_plz != null) {
										account += ' <input type="text" name="PLZ1Id" value = "' + ss_plz + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="PLZ1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += '   </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Ort:</label>';
									if (ss_ort != null) {
										account += ' <input type="text" name="Ort2Id" value = "' + ss_ort + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="Ort2Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += '  </div>' +
											  '   </div>' +
											  '  <div class="row form-group">' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label" style="display:none">Telefon:</label>';
									if (ss_telefon != null) {
										account += ' <input type="text" name="Telefon1Id" value = "' + ss_telefon + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Telefon1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}


									account += ' </div>' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label" style="display:none">Fax:</label>';
									if (ss_fax != null) {
										account += ' <input type="text" name="Fax1Id" value = "' + ss_fax + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Fax1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}
									account += ' </div>' +
											   ' <div class="col-md-4">' +
												   ' <label class="control-label" style="display:none">Email:</label>';
									if (ss_email != null) {
										account += ' <input type="text" name="Email1Id" value = "' + ss_email + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Email1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += '</div>' +
										   ' </div>' +
											'<hr style="border-top: dotted 2px;" />' +
											'<div class="row form-group">' +
														' <div class="col-md-4">' +
															'<label class="control-label">UREG</label>';
									if (ss_ureg != null) {
										account += '   <input name="UREGId" value = "' + ss_ureg + '" class="form-control input-sm" onchange="updateUREG(this)" type="text">';
									}
									else {
										account += '   <input name="UREGId" onchange="updateUREG(this)" class="form-control input-sm" type="text">';

									}
									account += ' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">Cockpit Type:</label>';
									if (ss_cockpittype == 1) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit" selected="selected">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									else if (ss_cockpittype == 2) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit" selected="selected">PR Cockpit</option></select>';

									}
									else {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									account += '</div>' +
													'<div class="col-md-4">' +
														' <label class="control-label">Anzeige im Cockpit-Admin:</label>';
									if (ss_anzeigeimcockpitadmin == true) {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja"  checked="checked">Ja</label>' +
													   '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>';
									}
									else {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
													  '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" style="margin-left: 50px" name="AnzeigeimCockpitAdmin" value="Nein" checked="checked">Nein</label>';
									}

									account += ' </div>' +
												' </div>' +
						'  </form>';

								}
							}
							displayDownloadLinks();
							$("#accountList").html(account);

							if (disabledAccountForms) {
								$("#accountList :input").attr('readonly', 'readonly');
							}
						}
						else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in retrievedataFromAccounts");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in retrievedataFromAccounts");
			}
		}
		function createContacts() {
			try {
				$(".loder-text p").html("Creating Contacts..");

				var contactCollection = new Array();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts?$select=accountid,emailaddress1,name&$filter=ss_xmlchecklistopportunityid eq '" + opportunityId + "'", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var AccountResults = JSON.parse(this.response);

							var req1 = new XMLHttpRequest();
							req1.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts?$select=ss_allgemeineemail,ss_anrede,ss_email,ss_fax,ss_firmenname,ss_nachname,ss_telefon,ss_vorname&$filter=_ss_relatedopportunity_value eq " + opportunityId, false);
							req1.setRequestHeader("OData-MaxVersion", "4.0");
							req1.setRequestHeader("OData-Version", "4.0");
							req1.setRequestHeader("Accept", "application/json");
							req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
							req1.onreadystatechange = function () {
								if (this.readyState === 4) {
									req1.onreadystatechange = null;
									if (this.status === 200) {
										var DummyAccountsResults = JSON.parse(this.response);

										for (var i = 0; i < AccountResults.value.length; i++) {
											for (var j = 0; j < DummyAccountsResults.value.length; j++) {

												if (AccountResults.value[i]["name"] == DummyAccountsResults.value[j]["ss_firmenname"] && AccountResults.value[i]["emailaddress1"] == DummyAccountsResults.value[j]["ss_allgemeineemail"]) {
													var accountid = AccountResults.value[i]["accountid"];

													var ss_anrede = DummyAccountsResults.value[j]["ss_anrede"];
													var ss_email = DummyAccountsResults.value[j]["ss_email"];
													var ss_fax = DummyAccountsResults.value[j]["ss_fax"];
													var ss_nachname = DummyAccountsResults.value[j]["ss_nachname"];
													var ss_telefon = DummyAccountsResults.value[j]["ss_telefon"];
													var ss_vorname = DummyAccountsResults.value[j]["ss_vorname"];

													var entity = {};
													entity.firstname = ss_vorname;
													entity.lastname = ss_nachname;
													entity.telephone1 = ss_telefon;
												    //mapping of ss_andrede test to be changed according to optionset

													if (ss_anrede.trim() == "Mrs.")
													{
													    entity.bbo_salutation = 717800002;
													}
													else if (ss_anrede == "Mr.")
													{
													    entity.bbo_salutation = 100000000;
													}
													else if (ss_anrede == "Ms.")
													{
													    entity.bbo_salutation = 100000001;
													}
													else if (ss_anrede == "Herr") {
													    entity.bbo_salutation = 864850000;
													}
													else if (ss_anrede == "Frau") {
													    entity.bbo_salutation = 864850001;
													}
													else if (ss_anrede == "Madame") {
													    entity.bbo_salutation = 717800000;
													}
													else if (ss_anrede == "Monsieur") {
													    entity.bbo_salutation = 717800001;
													}



													//entity.salutation = ss_anrede; //to be removed
													entity.emailaddress1 = ss_email;
													entity.ss_iscreatedfromworkflow = true;
													entity.fax = ss_fax;

													entity["parentcustomerid_account@odata.bind"] = "/accounts(" + accountid + ")";

													if (ss_verifiedbyxml_UpdateOwner != "" && ss_verifiedbyxml_UpdateOwner != null) {
														entity["owninguser@odata.bind"] = "/systemusers(" + ss_verifiedbyxml_UpdateOwner + ")";
													}

                                                    //added to test
													//entity["asdf"] = "abc";

													// entity["owninguser@odata.bind"] = "/accounts(" + accountid + ")";


													//if (SelectedAccountIdinDropdown != "" && SelectedAccountIdinDropdown != "norecordfound") {
													//	entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts(" + SelectedAccountIdinDropdown + ")";
													//}
													var body = JSON.stringify(entity);
													contactCollection.push(body);
												}
											}
										}

										var dataCreate = [];
										dataCreate.push('--batch_123456');
										dataCreate.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
										dataCreate.push('');

										for (var i = 0; i < contactCollection.length; i++) {

											dataCreate.push('--changeset_BBB456');
											dataCreate.push('Content-Type:application/http');
											dataCreate.push('Content-Transfer-Encoding:binary');
											var id = i + 1;
											dataCreate.push('Content-ID:' + id);
											dataCreate.push('');
											dataCreate.push('POST ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/contacts HTTP/1.1');

											dataCreate.push('Content-Type:application/json;type=entry');
											dataCreate.push('');
											dataCreate.push(contactCollection[i]);

										}

										dataCreate.push('--changeset_BBB456--');
										dataCreate.push('--batch_123456--');
										var payloadCreate = dataCreate.join('\r\n');

										$.ajax({
											method: 'POST',

											url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
											headers: {
												'Content-Type': 'multipart/mixed;boundary=batch_123456',
												'Accept': 'application/json',
												'Odata-MaxVersion': '4.0',
												'Odata-Version': '4.0'
											},
											data: payloadCreate,
											async: false,
											success: function (data, textStatus, xhr) {
											    var sendContactsBatch = true;
											    var d = data.split("\n");
											    for (var i = 0; i < d.length; i++) {

											        if (d[i].indexOf("error") != -1) {
											            if (d[i + 1].indexOf("code") != -1) {
											                var codeindex = d[i + 1].indexOf("code");
											                var innererrorIndex = d[i + 1].indexOf("innererror");
											                var errorSubstring = d[i + 1].substring(codeindex + 20, innererrorIndex - 3);
											                createUpdateAccountsCallResult = "failed";
											                sendContactsBatch = false;
											                alert(errorSubstring);
											                window.close();
											            }
											        }
											    }
											    if (sendContactsBatch == true) {
											        deleteDummyaccounts();
											        //var d = data.split("\n");
											        alert("Unternehmen wurden in crm erstellt");
											        hideLoadingMessage();
											    }
											},
											error: function (xhr, textStatus, errorThrown) {
												hideLoadingMessage();
												alert("Error Occurred \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);
												LogExceptioninCRM(errorThrown, 0, "error in createContacts");
												// alert("Error Occurred "+ textStatus + " " + errorThrown);
											}
										});

									}
									else {
										var errorText = JSON.parse(this.responseText).error.message;
										exceptionMessage(errorText);
										LogExceptioninCRM(errorText, this.status, "error in createContacts 1");
										// opener.Xrm.Utility.alertDialog(this.responseText);
										window.close();
									}
								}


							};
							req1.send();

						}
						else {
							deleteDummyaccounts();
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in createContacts 2");
							//opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in createContacts");
			}
		}

		function deleteDummyaccounts() {
			try {
				var xmldummyaccountsIds = new Array();
				$("#accountList").find("form").each(function () {
					var form = $(this);

					var xmldummyaccountsId = $(form[0]).attr("id");
					xmldummyaccountsIds.push(xmldummyaccountsId);
				});
				var data = [];
				data.push('--batch_123456');
				data.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
				data.push('');
				//Add requests to the collection
				for (var i = 0; i < xmldummyaccountsIds.length; i++) {
					data.push('--changeset_BBB456');
					data.push('Content-Type:application/http');
					data.push('Content-Transfer-Encoding:binary');
					var id = i + 1;
					data.push('Content-ID:' + id);
					data.push('');
					data.push('DELETE ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/ss_xmlchecklisttempaccounts(' + xmldummyaccountsIds[i] + ') HTTP/1.1');
					data.push('Content-Type:application/json;type=entry');
					data.push('');
					data.push('{}');
				}
				data.push('--changeset_BBB456--');
				data.push('--batch_123456--');
				var payload = data.join('\r\n');
				$.ajax(
				{
					method: 'POST',

					url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
					headers: {
						'Content-Type': 'multipart/mixed;boundary=batch_123456',
						'Accept': 'application/json',
						'Odata-MaxVersion': '4.0',
						'Odata-Version': '4.0'

					},
					data: payload,
					async: false,
					success: function (data, textStatus, xhr) {


					},
					error: function (xhr, textStatus, errorThrown) {
						//  alert(textStatus + " " + errorThrown);
						alert("Error Occurred \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);

						LogExceptioninCRM(errorThrown, 0, "error in deleteDummyaccounts");
						window.close();
					}
				});
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in deleteDummyaccounts");
			}
		}
		//when accounting person check the checkbox
		function checkedByAccounting(checkbox) {
			try {
				if (checkbox.checked == true) {
					var accountingPersonName = opener.Xrm.Page.context.getUserName();
					var accountingPersonId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");

					var entity = {};
					entity["ss_KundenbetreuerAccounting@odata.bind"] = "/systemusers(" + accountingPersonId + ")";

					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								//$(checkbox).closest(".container").find("#sideForm").find("#KundenbetreuerAccounting").val(accountingPersonName);
								//$("#finishBtn").css("display", "block");

								document.getElementById("finishBtn").disabled = false;
								$("#accountingLable").css("display", "none")
								$("#accountingCheckbox").css("display", "none")
								document.getElementById("accountingCheckbox").disabled = true;
							}
							else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in checkedByAccounting");
								//opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
				else {
					alert("Please select the checkbox to continue");
					return;
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in checkedByAccounting");
			}
		}
		function finish() {
			try {
				var xmlUserId = "";
				var currentUser = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");
				var opportunity = opener.Xrm.Page.data.entity.attributes.get("name").getValue();
				var username = opener.Xrm.Page.context.getUserName();
				var userEmailXML = "";
				var userEmailCurrent = "";
				var oppID = opener.Xrm.Page.data.entity.getId();
				var RecrodURL = "https://eqsgroup365.crm4.dynamics.com/main.aspx?etc=3&id=" + oppID + "&pagetype=entityrecord";


				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")?$select=_ss_xmluser_value", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							xmlUserId = result["_ss_xmluser_value"];
							var _ss_xmluser_value_formatted = result["_ss_xmluser_value@OData.Community.Display.V1.FormattedValue"];
							var _ss_xmluser_value_lookuplogicalname = result["_ss_xmluser_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
						} else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in finish");
							//opener.Xrm.Utility.alertDialog(this.statusText);
						}
					}
				};
				req.send();




				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/systemusers(" + xmlUserId + ")?$select=domainname", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							userEmailXML = result["domainname"];
						} else {
							// opener.Xrm.Utility.alertDialog(this.statusText);

							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in finish 2");
						}
					}
				};
				req.send();

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/systemusers(" + currentUser + ")?$select=domainname", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							userEmailCurrent = result["domainname"];
						} else {
							//  opener.Xrm.Utility.alertDialog(this.statusText);
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in finish 3");
						}
					}
				};
				req.send();

				var systemuserid = "37EBD2DF-E9B7-E711-8143-E0071B6641D1";
				//var systemuserid = "";
				var email = {};
				email.subject = "Checklist " + opportunity + " is finished";
				email.description = "Hallo, <br/><br/>" +
				"The Checklist <a href=" + RecrodURL + " target='_blank'>" + opportunity + "</a> is done.<br/><br/>" +
				"Thank you!<br/>" + "<br/> " + username + " <br/>" + userEmailCurrent;
				// "Thank you!<br/>" + "<br/>" + username + "<br/>" + userEmailCurrent;



				var parties = [];
				var sender = {};
				sender["partyid_systemuser@odata.bind"] = "/systemusers(" + systemuserid + ")";
				sender["participationtypemask"] = 1; //From
				parties.push(sender);

				var CC = {};
				CC["partyid_systemuser@odata.bind"] = "/systemusers(" + currentUser + ")";
				CC["participationtypemask"] = 3; //From
				parties.push(CC);

				var activityPartyTo = new Object();

				activityPartyTo.addressused = userEmailXML;
				activityPartyTo["participationtypemask"] = 2; //To

				parties.push(activityPartyTo);
				email["email_activity_parties"] = parties;

				var req = new XMLHttpRequest();
				req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.0/emails", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"OData.Community.Display.V1.FormattedValue\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							var emailId = this.getResponseHeader("OData-EntityId");
							// alert(emailId);
							var parameters =
							{
								"IssueSend": true
							};

							var request = new XMLHttpRequest();
							request.open("POST", emailId + "/Microsoft.Dynamics.CRM.SendEmail", false);
							request.setRequestHeader("Accept", "application/json");
							request.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							request.setRequestHeader("OData-MaxVersion", "4.0");
							request.setRequestHeader("OData-Version", "4.0");
							request.onreadystatechange = function () {
								if (this.readyState === 4) {
									request.onreadystatechange = null;
									if (this.status === 204) {
										// Success - returns sendemailresponse.
									}
									else {
										//var errorText = JSON.parse(this.responseText).error.message;
										//exceptionMessage(errorText);
										//LogExceptioninCRM(errorText, this.status, "error in email sending finish");
									}
								}
							};
							request.send(JSON.stringify(parameters));

							alert("Email Sent to XML");

						} else {

							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in finish");
							window.close();
						}
					}

				}

				req.send(JSON.stringify(email));

				var entity = {};
				entity.ss_workflowfinished = true;

				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							document.getElementById("finishBtn").disabled = true;
							//Success - No Return Data - Do Something
						} else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in updating ss_workflowfinished in finish");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in finish");
			}
		}
		function showLoadingMessage() {
			$("#msgDiv").css("display", "block")
		}
		function hideLoadingMessage() {
			$("#msgDiv").css("display", "none")
		}
		function createUpdateDummyAccounts() {
			try {

				var createAccount = false;
				var updateAccount = false;
				var entityCollection = new Array();
				$(".loder-text p").html("Creating Companies..");
				//alert($("#accountList").find("form").length);
				$("#accountList").find("form").each(function () {
					var form = $(this);
					var entity = {};
					entity.ss_mutter = false;

					if (form[0]["AbweichendeOptradioJa"].checked == true) {
						entity.ss_abweichenderechnungsanschrift = true;
					}
					else {
						entity.ss_abweichenderechnungsanschrift = false;
					}

					if (form[0]["FaxId"].value != "") {
						entity.ss_fax = form[0]["FaxId"].value.toString().trim();
					}

					if (form[0]["FirmennameId"].value != "") {
						entity.ss_firmenname = form[0]["FirmennameId"].value.toString().trim();
					}

					if (form[0]["StrasseId"].value != "") {
						entity.ss_strasse = form[0]["StrasseId"].value.toString().trim();
					}
					if (form[0]["NrId"].value != "") {
						entity.ss_nr = form[0]["NrId"].value.toString().trim();
					}
					if (form[0]["PLZId"].value != "") {
						entity.ss_plz = form[0]["PLZId"].value.toString().trim();
					}
					if (form[0]["OrtId"].value != "") {
						entity.ss_ort = form[0]["OrtId"].value.toString().trim();
					}
					if (form[0]["HomepageId"].value != "") {
						entity.ss_homepage = form[0]["HomepageId"].value.toString().trim();
					}
					if (form[0]["AllgemeineEmailId"].value != "") {
						entity.ss_allgemeineemail = form[0]["AllgemeineEmailId"].value.toString().trim();
					}
					if (form[0]["TelefonId"].value != "") {
						entity.ss_telefon = form[0]["TelefonId"].value.toString().trim();
					}

					//new_registerart is optionset
					if (form[0]["RegisterartId"].value != "") {
						//entity.ss_registerart = form[0]["RegisterartId"].value.toString().trim();

						//added by saad
						if (form[0]["RegisterartId"].localName == "select") {
							//entity.ss_artdergesellschaft = form[0]["ArtderGesellschaftId"].value.toString().trim();
							//changed asim
							//var artdergesellschaftObj = form[0]["ArtderGesellschaftId"];
							//entity.ss_artdergesellschafttext = $(artdergesellschaftObj).find(":selected").text().toString().trim();

							//added by saad
							entity.ss_registerartoptionset = form[0]["RegisterartId"].value;
						}
						else {
						   //entity.ss_artdergesellschafttext = form[0]["ArtderGesellschaftId"].value.toString().trim();

							jQuery.each(registerartOptionSet, function(optionName,optionId) {
								if(optionName == form[0]["RegisterartId"].value.toString().trim())
								{
									entity.ss_registerartoptionset = optionId;
								}
							});
						}

					}

				    //added by saad
					if (form[0]["SteuerschlüsselId"].value != "") {
					    if (form[0]["SteuerschlüsselId"].localName == "select") {
					        entity.ss_steuerschluesseloptionset = form[0]["SteuerschlüsselId"].value;
					    }
					    else {
					        jQuery.each(steuerschluesseloptionset, function (optionName, optionId) {
					            if (optionName == form[0]["SteuerschlüsselId"].value.toString().trim()) {
					                entity.ss_steuerschluesseloptionset = optionId;
					            }
					        });
					    }

					}

					//if (form[0]["SteuerschlüsselId"].value != "") {
					//	entity.ss_steuerschlssel = form[0]["SteuerschlüsselId"].value.toString().trim();
					//}
					if (form[0]["Fax1Id"].value != "") {
						entity.ss_fax1 = form[0]["Fax1Id"].value.toString().trim();
					}

					if (form[0]["EQS-ID"].value != "") {
						entity.ss_eqsid = form[0]["EQS-ID"].value.toString().trim();
					}
					if (form[0]["Kunden-Nr"].value != "") {
						entity.ss_kundennt = form[0]["Kunden-Nr"].value.toString().trim();
					}
					if (form[0]["ArtderGesellschaftId"].value != "") {
						if (form[0]["ArtderGesellschaftId"].localName == "select") {
							//entity.ss_artdergesellschaft = form[0]["ArtderGesellschaftId"].value.toString().trim();
							//changed asim
							//var artdergesellschaftObj = form[0]["ArtderGesellschaftId"];
							//entity.ss_artdergesellschafttext = $(artdergesellschaftObj).find(":selected").text().toString().trim();

							//added by saad
							entity.ss_new_company_type = form[0]["ArtderGesellschaftId"].value;
						}
						else {
						   //entity.ss_artdergesellschafttext = form[0]["ArtderGesellschaftId"].value.toString().trim();

							jQuery.each(companyTypeOptionSet, function(optionName,optionId) {
								if(optionName == form[0]["ArtderGesellschaftId"].value.toString().trim())
								{
									entity.ss_new_company_type = optionId;
								}
							});
						}

					}
					if (form[0]["R-NrId"].value != "") {
						entity.ss_rnr = form[0]["R-NrId"].value.toString().trim();
					}

					if (form[0]["Ort1Id"].value != "") {

						if (form[0]["Ort1Id"].localName == "select") {
						    //entity.ss_ort1value = form[0]["Ort1Id"].value.toString().trim();
						    entity.ss_registergerichtoptionset = form[0]["Ort1Id"].value;
						    //entity.ss_amtsgerichtvalue = form[0]["Ort1Id"].value.toString().trim();
						    entity.ss_amtsgerichtvalue = form[0]["Ort1Id"].value;
						    //changed M107A3
							var ort1Obj = form[0]["Ort1Id"];
							//entity.ss_ort1 = $(ort1Obj).find(":selected").text().toString().trim();
							entity.ss_amtsgericht = $(ort1Obj).find(":selected").text().toString().trim();
						}
						else {
							//entity.ss_ort1 = form[0]["Ort1Id"].value.toString().trim();
						    entity.ss_amtsgericht = form[0]["Ort1Id"].value.toString().trim();

						    jQuery.each(ss_registergerichtoptionset, function (optionName, optionId) {
						        if (optionName == form[0]["Ort1Id"].value.toString().trim()) {
						            entity.ss_registergerichtoptionset = optionId;
						        }
						    });

						}


					}

				    //added by saad
					if (form[0]["RechtsformId"].value != "") {
					    if (form[0]["RechtsformId"].localName == "select") {
					        entity.ss_rechtsformoptionset = form[0]["RechtsformId"].value;
					    }
					    else {
					        jQuery.each(rechtsformOptionSet, function (optionName, optionId) {
					            if (optionName == form[0]["RechtsformId"].value.toString().trim()) {
					                entity.ss_rechtsformoptionset = optionId;
					            }
					        });
					    }

					}

					//if (form[0]["RechtsformId"].value != "") {
					//	entity.ss_rechtsform = form[0]["RechtsformId"].value;
					//}

					if (form[0]["Firmenname1Id"].value != "") {
						entity.ss_firmenname1 = form[0]["Firmenname1Id"].value.toString().trim();
					}
					if (form[0]["Vorname1Id"].value != "") {
						entity.ss_vorname1 = form[0]["Vorname1Id"].value.toString().trim();
					}
					if (form[0]["NameId"].value != "") {
						entity.ss_nachname1 = form[0]["NameId"].value.toString().trim();
					}
					if (form[0]["AbteilungId"].value != "") {
						entity.ss_abteilung1 = form[0]["AbteilungId"].value.toString().trim();
					}
					if (form[0]["Strasse1Id"].value != "") {
						entity.ss_strasse1 = form[0]["Strasse1Id"].value.toString().trim();
					}
					if (form[0]["Nr1Id"].value != "") {
						entity.ss_nr1 = form[0]["Nr1Id"].value.toString().trim();
					}

					if (form[0]["Ort2Id"].value != "") {
						entity.ss_ort11 = form[0]["Ort2Id"].value.toString().trim();
					}
					if (form[0]["PLZ1Id"].value != "") {
						entity.ss_plz1 = form[0]["PLZ1Id"].value.toString().trim();
					}
					if (form[0]["Email1Id"].value != "") {
						entity.ss_email1 = form[0]["Email1Id"].value.toString().trim();
					}
					if (form[0]["Telefon1Id"].value != "") {
						entity.ss_telefon1 = form[0]["Telefon1Id"].value.toString().trim();
					}
					entity["ss_RelatedOpportunity@odata.bind"] = "/opportunities(" + opportunityId + ")";
					if (form[0]["VornameId"].value != "") {
						entity.ss_vorname = form[0]["VornameId"].value;
					}

					if (form[0]["NachnameId"].value != "") {
						entity.ss_nachname = form[0]["NachnameId"].value.toString().trim();
					}
					if (form[0]["AnredeId"].value != "") {
						entity.ss_anrede = form[0]["AnredeId"].value.toString().trim();
					}


					if (form[0]["EmailId"].value != "") {
						entity.ss_email = form[0]["EmailId"].value.toString().trim();;
					}
					if (form[0]["GesellschatsgrId"].value != "") {
						entity.ss_gesellschaftsgre = form[0]["GesellschatsgrId"].value.toString().trim();
					}

					var body = JSON.stringify(entity);
					entityCollection.push(body);
				});



				var dataCreate = [];
				dataCreate.push('--batch_123456');
				dataCreate.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
				dataCreate.push('');
				var k = 0;
				for (var i = 0; i < entityCollection.length; i++) {

					k = k + 1;
					createAccount = true;
					dataCreate.push('--changeset_BBB456');
					dataCreate.push('Content-Type:application/http');
					dataCreate.push('Content-Transfer-Encoding:binary');
					var id = k;
					dataCreate.push('Content-ID:' + id);
					dataCreate.push('');
					dataCreate.push('POST ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/ss_xmlchecklisttempaccounts HTTP/1.1');

					dataCreate.push('Content-Type:application/json;type=entry');
					dataCreate.push('');
					dataCreate.push(entityCollection[i]);

				}

				dataCreate.push('--changeset_BBB456--');
				dataCreate.push('--batch_123456--');
				var payloadCreate = dataCreate.join('\r\n');

				if (createAccount == true) {
					$.ajax({
						method: 'POST',

						url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
						headers: {
							'Content-Type': 'multipart/mixed;boundary=batch_123456',
							'Accept': 'application/json',
							'Odata-MaxVersion': '4.0',
							'Odata-Version': '4.0'
						},
						data: payloadCreate,
						async: false,
						success: function (data, textStatus, xhr) {
							var d = data.split("\n");
							for (var i = 0; i < d.length; i++) {
								if (d[i].indexOf("OData-EntityId") != -1) {
									var uri = d[i];
									var regExp = /\(([^)]+)\)/;

									var matches = regExp.exec(uri);
									if (matches != undefined) {
										var newEntityId = matches[1];

									  accoundIDS.push(newEntityId);
									}
								}
							}

						},
						error: function (xhr, textStatus, errorThrown) {
							alert("Error Occurred \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);
							LogExceptioninCRM(errorThrown, 0, "error in createUpdateDummyAccounts");
							//  alert(textStatus + " " + errorThrown);
							window.close();
						}
					});
					$("#accountList").html("");
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in createUpdateDummyAccounts catch");
			}
		}
		function retrieveDummyRecords() {
			try {
				var opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts?$select=ss_abteilung1,ss_anzeigeimcockpitadmin,ss_cockpittype,ss_ureg,ss_abweichenderechnungsanschrift,ss_allgemeineemail,ss_anrede,ss_artdergesellschaft,ss_artdergesellschafttext,ss_email,ss_email1,ss_eqsid,ss_fax,ss_fax1,ss_mutter,ss_firmenname,ss_firmenname1,ss_gesellschatsgr,ss_homepage,ss_kundennt,ss_nachname,ss_nachname1,ss_nr,ss_nr1,ss_ort,ss_ort1,ss_ort1value,ss_ort11,ss_plz,ss_plz1,ss_rechtsform,ss_registerart,_ss_relatedopportunity_value,ss_rnr,ss_steuerschlssel,ss_strasse,ss_strasse1,ss_amtsgericht,ss_amtsgerichtvalue,ss_telefon,ss_telefon1,ss_vorname,ss_vorname1,ss_xmlchecklisttempaccountid,_ss_similaraccountid_value,ss_new_company_type,ss_registerartoptionset,ss_rechtsformoptionset,ss_steuerschluesseloptionset,ss_registergerichtoptionset&$filter=_ss_relatedopportunity_value eq " + opportunityId, false); //changed M107A3
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var results = JSON.parse(this.response);
							var COLOR1 = "#A9A9A9";
							var COLOR2 = "#FFA500";
							var bgcolor = "#A9A9A9";
							var account = "";
							var counter = 0;
							companiesName.length = 0;
							for (var i = 0; i < results.value.length; i++) {
								var ss_abteilung1 = results.value[i]["ss_abteilung1"];
								//var ss_abweichenderechnungsanschrift = results.value[i]["ss_abweichenderechnungsanschrift"];

								var ss_abweichenderechnungsanschrift = results.value[i]["ss_abweichenderechnungsanschrift"];
								var ss_abweichenderechnungsanschrift_formatted = results.value[i]["ss_abweichenderechnungsanschrift@OData.Community.Display.V1.FormattedValue"];

								var ss_allgemeineemail = results.value[i]["ss_allgemeineemail"];
								var ss_anrede = results.value[i]["ss_anrede"];
								var ss_artdergesellschaft = results.value[i]["ss_artdergesellschaft"];
								var ss_artdergesellschafttext = results.value[i]["ss_artdergesellschafttext"];

								//added by saad
								var ss_new_company_type = results.value[i]["ss_new_company_type"];
            					var ss_new_company_type_formatted = results.value[i]["ss_new_company_type@OData.Community.Display.V1.FormattedValue"];
								var ss_registerartoptionset = results.value[i]["ss_registerartoptionset"];
								var ss_registerartoptionset_formatted = results.value[i]["ss_registerartoptionset@OData.Community.Display.V1.FormattedValue"];
								var ss_rechtsformoptionset = results.value[i]["ss_rechtsformoptionset"];
								var ss_rechtsformoptionset_formatted = results.value[i]["ss_rechtsformoptionset@OData.Community.Display.V1.FormattedValue"];
								var ss_steuerschluesseloptionset = results.value[i]["ss_steuerschluesseloptionset"];
								var ss_steuerschluesseloptionset_formatted = results.value[i]["ss_steuerschluesseloptionset@OData.Community.Display.V1.FormattedValue"];
								var ss_registergerichtoptionset = results.value[i]["ss_registergerichtoptionset"];
								var ss_registergerichtoptionset_formatted = results.value[i]["ss_registergerichtoptionset@OData.Community.Display.V1.FormattedValue"];
								//

								var ss_email = results.value[i]["ss_email"];
								var ss_email1 = results.value[i]["ss_email1"];
								var ss_eqsid = results.value[i]["ss_eqsid"];
								var ss_fax = results.value[i]["ss_fax"];
								var ss_fax1 = results.value[i]["ss_fax1"];
								var ss_mutter = results.value[i]["ss_mutter"];
								var ss_mutter_formatted = results.value[i]["ss_mutter@OData.Community.Display.V1.FormattedValue"];
								var ss_firmenname = results.value[i]["ss_firmenname"];
								var ss_firmenname1 = results.value[i]["ss_firmenname1"];
								var ss_gesellschatsgr = results.value[i]["ss_gesellschatsgr"];
								var ss_homepage = results.value[i]["ss_homepage"];
								var ss_kundennt = results.value[i]["ss_kundennt"];
								var ss_nachname = results.value[i]["ss_nachname"];
								var ss_nachname1 = results.value[i]["ss_nachname1"];
								var ss_nr = results.value[i]["ss_nr"];
								var ss_nr1 = results.value[i]["ss_nr1"];
								var ss_ort = results.value[i]["ss_ort"];
								var ss_ort1 = results.value[i]["ss_ort1"];

								//changed asim
								var ss_ort1value = results.value[i]["ss_ort1value"];

								var ss_ort11 = results.value[i]["ss_ort11"];
								var ss_plz = results.value[i]["ss_plz"];
								var ss_plz1 = results.value[i]["ss_plz1"];
								var ss_rechtsform = results.value[i]["ss_rechtsform"];
								var ss_registerart = results.value[i]["ss_registerart"];
								var _ss_relatedopportunity_value = results.value[i]["_ss_relatedopportunity_value"];
								var _ss_relatedopportunity_value_formatted = results.value[i]["_ss_relatedopportunity_value@OData.Community.Display.V1.FormattedValue"];
								var _ss_relatedopportunity_value_lookuplogicalname = results.value[i]["_ss_relatedopportunity_value@Microsoft.Dynamics.CRM.lookuplogicalname"];
								var ss_rnr = results.value[i]["ss_rnr"];
								var ss_steuerschlssel = results.value[i]["ss_steuerschlssel"];
								var ss_strasse = results.value[i]["ss_strasse"];
								var ss_strasse1 = results.value[i]["ss_strasse1"];
								var ss_telefon = results.value[i]["ss_telefon"];
								var ss_telefon1 = results.value[i]["ss_telefon1"];
								var ss_vorname = results.value[i]["ss_vorname"];
								var ss_vorname1 = results.value[i]["ss_vorname1"];
								var ss_xmlchecklisttempaccountid = results.value[i]["ss_xmlchecklisttempaccountid"];
								var ss_amtsgericht = results.value[i]["ss_amtsgericht"];
								var ss_amtsgerichtvalue = results.value[i]["ss_amtsgerichtvalue"];//changed M107A3
								var ss_Gesellschaftsgre = results.value[i]["ss_gesellschaftsgre"];
								var ss_anzeigeimcockpitadmin = results.value[i]["ss_anzeigeimcockpitadmin"];
								var ss_anzeigeimcockpitadmin_formatted = results.value[i]["ss_anzeigeimcockpitadmin@OData.Community.Display.V1.FormattedValue"];
								var ss_cockpittype = results.value[i]["ss_cockpittype"];
								var ss_cockpittype_formatted = results.value[i]["ss_cockpittype@OData.Community.Display.V1.FormattedValue"];
								var ss_ureg = results.value[i]["ss_ureg"];

								similaraccountRetrieveFromDummyentity = results.value[i]["_ss_similaraccountid_value"];
								if (results.value[i]["_ss_similaraccountid_value"]) {
									var _ss_similaraccountid_value_formatted = results.value[i]["_ss_similaraccountid_value@OData.Community.Display.V1.FormattedValue"];
									var _ss_similaraccountid_value_lookuplogicalname = results.value[i]["_ss_similaraccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

									similarAccountId.push(similaraccountRetrieveFromDummyentity)
								}
								else {
									similarAccountId.push("");
								}


								bgcolor = bgcolor == COLOR1 ? COLOR2 : COLOR1;
								counter += 1;
								account += '<form style="background-color:' + bgcolor + '" id="' + ss_xmlchecklisttempaccountid + '" class="form-style fixed-height forms">' +
								'<div class="row form-inline form-group">' +
									' <div class="col-md-3">' +
										'<label class="control-label">Firma' + counter + ':</label>' +
										'<label class="checkbox-inline">';
								if (ss_mutter) {
									account += '   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" checked="checked" value="">Mutter';
								}
								else {
									account += '   <input name="Mutter" onchange="MutterCheckBoxOnclick(this)" type="checkbox" value="">Mutter';
								}

								account += ' </label>' +
									' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">EQS-ID:</label>';
								if (ss_eqsid != null) {
									account += '<input name="EQS-ID" value="' + ss_eqsid + '" type="text" onchange="updateAccount(this)" class="form-control input-sm" readonly />';

								}
								else {
									account += '<input name="EQS-ID" type="text" onchange="updateAccount(this)" class="form-control input-sm" readonly/>';
								}
								//'<p class="text-muted text-center"> "Account" [bbo_equitystoryid]</p>'+
								account += '</div>' +
									'<div class="col-md-5">' +
										' <label class="control-label">Kunden-Nr:</label>';
								if (ss_kundennt != null) {
									account += '<input name="Kunden-Nr" value="' + ss_kundennt + '" type="text" maxlength="10" onchange="updateAccount(this)" onkeypress="return event.charCode >= 48 && event.charCode <= 57" class="form-control input-sm" />';
								}
								else {
									account += '<input name="Kunden-Nr" value="" type="text" maxlength="10" onchange="updateAccount(this)" onkeypress="return event.charCode >= 48 && event.charCode <= 57" class="form-control input-sm" />';
								}


								account += ' </div>' +
								' </div>' +
								'<div class="row form-group">' +
									'<div class="col-md-4">' +
										' <label class="control-label">Firmenname:</label>';

								if (ss_firmenname != null) {
									companiesName.push(ss_firmenname);
									similaraccountName.push(ss_firmenname);

									account += ' <input type="text" name="FirmennameId" value = "' + ss_firmenname + '" onchange="updateAccount(this)" maxlength="160" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="FirmennameId" onchange="updateAccount(this)" maxlength="160" class="form-control input-sm" />';
								}

								account += '</div>' +
											'<div class="col-md-4">' +
												' <label class="control-label">Strasse:</label>';


								if (ss_strasse != null) {

									account += ' <input type="text" name="StrasseId" value = "' + ss_strasse + '" onchange="updateAccount(this)" maxlength="180" class="form-control input-sm" />';

								}
								else {
									account += ' <input type="text" name="StrasseId" onchange="updateAccount(this)" maxlength="180" class="form-control input-sm"  />';


								}
								if (ss_nr != null) {


									account += ' </div>' +
										   '<div class="col-md-2">' +
											   '  <label class="control-label">Nr.:</label>' +
											   '  <input type="text" name="NrId" value = "' + ss_nr + '" onchange="updateAccount(this)" maxlength="75" class="form-control input-sm"  />' +
										   '  </div>';
								}
								else {
									account += ' </div>' +
										   '<div class="col-md-2">' +
											   '  <label class="control-label">Nr.:</label>' +
											   '  <input type="text" name="NrId" onchange="updateAccount(this)" maxlength="75" class="form-control input-sm"  />' +
										   '  </div>';

								}


								account += ' <div class="col-md-2">' +
												' <label class="control-label">PLZ:</label>';

								if (ss_plz != null) {
									account += ' <input type="text" name="PLZId" value = "' + ss_plz + '" onchange="updateAccount(this)" maxlength="10" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="PLZId" onchange="updateAccount(this)" maxlength="10" class="form-control input-sm"  />';

								}
								account += '  </div>' +
											 ' <div class="col-md-2">' +
												 ' <label class="control-label">Ort:</label>';

								if (ss_ort != null) {
									account += ' <input type="text" name="OrtId" value = "' + ss_ort + '" onchange="updateAccount(this)"  maxlength="30" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="OrtId" onchange="updateAccount(this)"  maxlength="30" class="form-control input-sm"  />';

								}
								account += '</div>' +
											'</div> <div class="row form-group"> </div>';

								if (ss_Gesellschaftsgre != null) {
									account += '<div class="row form-group">' +
													' <div class="col-md-3">' +
														'<label class="control-label">Gesellschaftsgröße.:</label>' +
														' <input type="text" name="GesellschatsgrId" value= "' + ss_Gesellschaftsgre + '" onchange="updateAccount(this)" onkeypress="return event.charCode >= 48 && event.charCode <= 57"  maxlength="10" class="form-control input-sm" />' +
													'</div>' +
													' <div class="col-md-4">' +
														' <label class="control-label">Homepage:</label>';
								}
								else {
									account += '<div class="row form-group">' +
												   ' <div class="col-md-3">' +
													   '<label class="control-label">Gesellschaftsgröße.:</label>' +
													   ' <input type="text" name="GesellschatsgrId" onchange="updateAccount(this)" onkeypress="return event.charCode >= 48 && event.charCode <= 57" maxlength="10" class="form-control input-sm" />' +
												   '</div>' +
												   ' <div class="col-md-4">' +
													   ' <label class="control-label">Homepage:</label>';
								}
								if (ss_homepage != null) {
									account += ' <input type="text" name="HomepageId" value = "' + ss_homepage + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="HomepageId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-4">' +
												' <label class="control-label">Allgemeine Email:</label>';

								if (ss_allgemeineemail != null) {
									account += ' <input type="text" name="AllgemeineEmailId" value = "' + ss_allgemeineemail + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="AllgemeineEmailId" onchange="updateAccount(this)" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											  '  </div>' +
											  '<div class="row form-group">' +
												  ' <div class="col-md-2">' +
													  '<label class="control-label">Anrede</label>';
								if (ss_anrede != null) {
									account += ' <input type="text" name="AnredeId" value = "' + ss_anrede + '" onchange="updateAccount(this)" maxlength="10" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="AnredeId" onchange="updateAccount(this)" maxlength="10" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 ' <label class="control-label">Vorname</label>';

								if (ss_vorname != null) {
									account += ' <input type="text" name="VornameId" value = "' + ss_vorname + '" onchange="updateAccount(this)"  maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="VornameId" onchange="updateAccount(this)"  maxlength="32" class="form-control input-sm"  />';

								}
								account += ' </div>' +
											' <div class="col-md-2">' +
												'  <label class="control-label">Nachname</label>';
								if (ss_nachname != null) {
									account += ' <input type="text" name="NachnameId" value = "' + ss_nachname + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="NachnameId" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm"  />';

								}


								account += ' </div>' +
											'  <div class="col-md-2">' +
												'  <label class="control-label">Telefon</label>';
								if (ss_telefon != null) {
									account += ' <input type="text" name="TelefonId" value = "' + ss_telefon + '" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="TelefonId" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm"  />';

								}

								account += ' </div>' +
											' <div class="col-md-2">' +
												' <label class="control-label">Fax</label>';
								if (ss_fax != null) {
									account += ' <input type="text" name="FaxId" value = "' + ss_fax + '" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="FaxId" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm"  />';

								}


								account += ' </div>' +
								 ' <div class="col-md-2">' +
									 ' <label class="control-label">Email</label>';
								if (ss_email != null) {
									account += ' <input type="text" name="EmailId" value = "' + ss_email + '" onchange="updateAccount(this)" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="EmailId" onchange="updateAccount(this)" class="form-control input-sm"  />';
								}
								account += '  </div>' +
											 ' </div>' +
											 ' <div class="row form-group">' +
												 '<div class="col-md-3">' +
													 ' <label class="control-label">Art der Gesellschaft</label>';

								if(ss_new_company_type != null)
								{
									account += '<select id="ArtderGesellschaftId" onchange="updateAccount(this)" class="form-control">' +
										'<option value="0">Wählen</option>';
									if (ss_new_company_type == 1) {
									account += '<option value="1" selected="selected">Kreditinstitut</option>';
									}
									else {
									account += '<option value="1">Kreditinstitut</option>';

									}
									if (ss_new_company_type == 2) {
									account += '<option value="2" selected="selected">Pensionsfonds</option>';
									}
									else {
									account += '<option value="2">Pensionsfonds</option>';

									}
									if (ss_new_company_type == 3) {
									account += '<option value="3" selected="selected">Finanzdienstleister</option>';
									}
									else {
									account += '<option value="3">Finanzdienstleister</option>';

									}
									if (ss_new_company_type == 4) {
									account += '<option value="4" selected="selected">Versicherung</option>';
									}
									else {
									account += '<option value="4">Versicherung</option>';

									}
									if (ss_new_company_type == 5) {
									account += '<option value="5" selected="selected">Rückversicherungsgesellschaft</option>';
									}
									else {
									account += '<option value="5">Rückversicherungsgesellschaft</option>';

									}

									if (ss_new_company_type == 6) {
									account += '<option value="6" selected="selected">AIF Kapitalverwaltungsgesellschaft</option>';
									}
									else {
									account += '<option value="6">AIF Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_new_company_type == 7) {
									account += '<option value="7" selected="selected">OGAW-Investmentaktiengesellschaft</option>';
									}
									else {
									account += '<option value="7">OGAW-Investmentaktiengesellschaft</option>';

									}
									if (ss_new_company_type == 8) {
									account += '<option value="8" selected="selected">AIF-Investmentaktiengesellschaft</option>';
									}
									else {
									account += '<option value="8">AIF-Investmentaktiengesellschaft</option>';

									}
									if (ss_new_company_type == 9) {
									account += '<option value="9" selected="selected">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';
									}
									else {
									account += '<option value="9">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 10) {
									account += '<option value="10" selected="selected">Offene Investmentkommanditgesellschaft</option>';
									}
									else {
									account += '<option value="10">Offene Investmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 11) {
									account += '<option value="11" selected="selected">Emittent von Vermögensanlagen</option>';
									}
									else {
									account += '<option value="11">Emittent von Vermögensanlagen</option>';

									}
									if (ss_new_company_type == 12) {
									account += ' <option value="12" selected="selected">Externe Kapitalverwaltungsgesellschaft</option>';
									}
									else {
									account += ' <option value="12">Externe Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_new_company_type == 13) {
									account += ' <option value="13" selected="selected">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';
									}
									else {
									account += ' <option value="13">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';

									}
									if (ss_new_company_type == 14) {
									account += ' <option value="14" selected="selected">Unternehmensbeteiligungsgesellschaft</option>';
									}
									else {
									account += ' <option value="14">Unternehmensbeteiligungsgesellschaft</option>';

									}
									if (ss_new_company_type == 15) {
									account += '<option value="15" selected="selected">Beteiligungsgesellschaft</option>';
									}
									else {
									account += '<option value="15">Beteiligungsgesellschaft</option>';

									}
									if (ss_new_company_type == 16) {
									account += '<option value="16" selected="selected">Eisenbahnunternehmen</option>';
									}
									else {
									account += '<option value="16">Eisenbahnunternehmen</option>';

									}
									if (ss_new_company_type == 17) {
									account += ' <option value="17" selected="selected">keine der genannten Gesellschaftsarten</option>';
									}
									else {
									account += ' <option value="17">keine der genannten Gesellschaftsarten</option>';

									}
									account += ' </select>';
								}


							   /* if (ss_artdergesellschafttext != null) {
								ss_artdergesellschafttext = ss_artdergesellschafttext.toString().trim();
									//  account += ' <input type="number" name="ArtderGesellschaftId" value = "' + ss_artdergesellschaft + '" onkeypress="return event.charCode >= 48 && event.charCode <= 57" onchange="updateAccount(this)" maxlength="3" min="0" max="225" class="form-control input-sm" />';
									account += '<select id="ArtderGesellschaftId" onchange="updateAccount(this)" class="form-control">' +
																			 '<option value="0">Wählen</option>';
									if (ss_artdergesellschafttext == "Kreditinstitut") {
										account += '<option value="1" selected="selected">Kreditinstitut</option>';
									}
									else {
										account += '<option value="1">Kreditinstitut</option>';

									}
									if (ss_artdergesellschafttext == "Pensionsfonds") {
										account += '<option value="2" selected="selected">Pensionsfonds</option>';
									}
									else {
										account += '<option value="2">Pensionsfonds</option>';

									}
									if (ss_artdergesellschafttext == "Finanzdienstleister") {
										account += '<option value="3" selected="selected">Finanzdienstleister</option>';
									}
									else {
										account += '<option value="3">Finanzdienstleister</option>';

									}
									if (ss_artdergesellschafttext == "Versicherung") {
										account += '<option value="4" selected="selected">Versicherung</option>';
									}
									else {
										account += '<option value="4">Versicherung</option>';

									}
									if (ss_artdergesellschafttext == "Rückversicherungsgesellschaft") {
										account += '<option value="5" selected="selected">Rückversicherungsgesellschaft</option>';
									}
									else {
										account += '<option value="5">Rückversicherungsgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "AIF Kapitalverwaltungsgesellschaft") {
										account += '<option value="6" selected="selected">AIF Kapitalverwaltungsgesellschaft</option>';
									}
									else {
										account += '<option value="6">AIF Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "OGAW-Investmentaktiengesellschaft") {
										account += '<option value="7" selected="selected">OGAW-Investmentaktiengesellschaft</option>';
									}
									else {
										account += '<option value="7">OGAW-Investmentaktiengesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "AIF-Investmentaktiengesellschaft") {
										account += '<option value="8" selected="selected">AIF-Investmentaktiengesellschaft</option>';
									}
									else {
										account += '<option value="8">AIF-Investmentaktiengesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Geschlossene Publikumsinvestmentkommanditgesellschaft") {
										account += '<option value="9" selected="selected">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';
									}
									else {
										account += '<option value="9">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Offene Investmentkommanditgesellschaft") {
										account += '<option value="10" selected="selected">Offene Investmentkommanditgesellschaft</option>';
									}
									else {
										account += '<option value="10">Offene Investmentkommanditgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Emittent von Vermögensanlagen") {
										account += '<option value="11" selected="selected">Emittent von Vermögensanlagen</option>';
									}
									else {
										account += '<option value="11">Emittent von Vermögensanlagen</option>';

									}
									if (ss_artdergesellschafttext == "Externe Kapitalverwaltungsgesellschaft") {
										account += ' <option value="12" selected="selected">Externe Kapitalverwaltungsgesellschaft</option>';
									}
									else {
										account += ' <option value="12">Externe Kapitalverwaltungsgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Geschlossene Spezial-Investmentkommanditgesellschaft") {
										account += ' <option value="13" selected="selected">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';
									}
									else {
										account += ' <option value="13">Geschlossene Spezial-Investmentkommanditgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Unternehmensbeteiligungsgesellschaft") {
										account += ' <option value="14" selected="selected">Unternehmensbeteiligungsgesellschaft</option>';
									}
									else {
										account += ' <option value="14">Unternehmensbeteiligungsgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Beteiligungsgesellschaft") {
										account += '<option value="15" selected="selected">Beteiligungsgesellschaft</option>';
									}
									else {
										account += '<option value="15">Beteiligungsgesellschaft</option>';

									}
									if (ss_artdergesellschafttext == "Eisenbahnunternehmen") {
										account += '<option value="16" selected="selected">Eisenbahnunternehmen</option>';
									}
									else {
										account += '<option value="16">Eisenbahnunternehmen</option>';

									}
									if (ss_artdergesellschafttext == "keine der genannten Gesellschaftsarten") {
										account += ' <option value="17" selected="selected">keine der genannten Gesellschaftsarten</option>';
									}
									else {
										account += ' <option value="17">keine der genannten Gesellschaftsarten</option>';

									}
									account += ' </select>';
								} */
								else {
									// account += ' <input type="number" name="ArtderGesellschaftId" onkeyup="this.value = validateNumber(this.value, 0, 225)" onchange="updateAccount(this)" maxlength="3" min="0" max="225" class="form-control input-sm"  />';
									account += '<select id="ArtderGesellschaftId" onchange="updateAccount(this)" class="form-control">' +
												  '<option value="0">Wählen</option>' +
												  '<option value="1">Kreditinstitut</option>' +
												  '<option value="2">Pensionsfonds</option>' +
												  '<option value="3">Finanzdienstleister</option>' +
												  '<option value="4">Versicherung</option>' +
												  '<option value="5">Rückversicherungsgesellschaft</option>' +
												  '<option value="6">AIF Kapitalverwaltungsgesellschaft</option>' +
												  '<option value="7">OGAW-Investmentaktiengesellschaft</option>' +
												  '<option value="8">AIF-Investmentaktiengesellschaft</option>' +
												  '<option value="9">Geschlossene Publikumsinvestmentkommanditgesellschaft</option>' +
												  '<option value="10">Offene Investmentkommanditgesellschaft</option>' +
												  '<option value="11">Emittent von Vermögensanlagen</option>' +
												 ' <option value="12">Externe Kapitalverwaltungsgesellschaft</option>' +
												 ' <option value="13">Geschlossene Spezial-Investmentkommanditgesellschaft</option>' +
												 ' <option value="14">Unternehmensbeteiligungsgesellschaft</option>' +
												  '<option value="15">Beteiligungsgesellschaft</option>' +
												  '<option value="16">Eisenbahnunternehmen</option>' +
												 ' <option value="17">keine der genannten Gesellschaftsarten</option>' +
											 ' </select>';
								}

								account += ' </div>' +
											 '<div class="col-md-2">' +
												 '  <label class="control-label">Registerart</label>';

									if (ss_registerartoptionset != null) {
									//  account += ' <input type="text" name="RegisterartId" value = "' + ss_registerart + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
									account += '<select id="RegisterartId" onchange="updateAccount(this)" class="form-control">' +
												'<option value="">Wählen</option>';
									if (ss_registerartoptionset == 1) {
										account += '<option value="1" selected="selected">HRA</option>';
									}
									else {
										account += '<option value="1">HRA</option>';

									}
									if (ss_registerartoptionset == 2) {
										account += '<option value="2" selected="selected">HRB</option>';
									}
									else {
										account += '<option value="2">HRB</option>';

									}
									if (ss_registerartoptionset == 3) {
										account += '<option value="3" selected="selected">VR</option>';
									}
									else {
										account += '<option value="3">VR</option>';

									}
									if (ss_registerartoptionset == 4) {
										account += ' <option value="4" selected="selected">GnR</option>';
									}
									else {
										account += ' <option value="4">GnR</option>';

									}
									if (ss_registerartoptionset == 5) {
										account += ' <option value="5" selected="selected">PR</option>';
									}
									else {
										account += ' <option value="5">PR</option>';

									}

									account += '</select>';
								}

								/* if (ss_registerart != null) {
									//  account += ' <input type="text" name="RegisterartId" value = "' + ss_registerart + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
									account += '<select id="RegisterartId" onchange="updateAccount(this)" class="form-control">' +
												'<option value="">Wählen</option>';
									if (ss_registerart == "HRA") {
										account += '<option value="1" selected="selected">HRA</option>';
									}
									else {
										account += '<option value="1">HRA</option>';

									}
									if (ss_registerart == "HRB") {
										account += '<option value="2" selected="selected">HRB</option>';
									}
									else {
										account += '<option value="2">HRB</option>';

									}
									if (ss_registerart == "VR") {
										account += '<option value="3" selected="selected">VR</option>';
									}
									else {
										account += '<option value="3">VR</option>';

									}
									if (ss_registerart == "GnR") {
										account += ' <option value="4" selected="selected">GnR</option>';
									}
									else {
										account += ' <option value="4">GnR</option>';

									}
									if (ss_registerart == "PR") {
										account += ' <option value="5" selected="selected">PR</option>';
									}
									else {
										account += ' <option value="5">PR</option>';

									}

									account += '</select>';
								} */
								else {
									// account += ' <input type="text" name="RegisterartId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';
									account += '<select id="RegisterartId" onchange="updateAccount(this)" class="form-control">' +
													 '<option value="">Wählen</option>' +
													 '<option value="1">HRA</option>' +
													 '<option value="2">HRB</option>' +
													 '<option value="3">VR</option>' +
													' <option value="4">GnR</option>' +
													' <option value="5">PR</option>' +
												   '</select>';
								}

								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 '  <label class="control-label">R-Nr.:</label>';

								if (ss_rnr != null) {
									account += ' <input type="text" name="R-NrId" value = "' + ss_rnr + '" onchange="updateAccount(this)" maxlength="50" class="form-control input-sm" />';
								}
								else {
									account += ' <input type="text" name="R-NrId" onchange="updateAccount(this)" maxlength="50" class="form-control input-sm"  />';

								}

								account += ' </div>' +
								  ' <div class="col-md-2">' +
									  '  <label class="control-label">Ort1:</label>';
								//if (ss_ort1 != null) {
								//    account += ' <input type="text" name="Ort1Id" value = "' + ss_amtsgericht + '" onchange="updateAccount(this)" maxlength="50" class="form-control input-sm" />';
								//}
								//else {
								//    account += ' <input type="text" name="Ort1Id" onchange="updateAccount(this)" maxlength="50" class="form-control input-sm"  />';

							    //}


								if (ss_registergerichtoptionset != null) {



								    account += '<select id="Ort1Id" onchange="updateAccount(this)" class="form-control input-sm" >';
								    account += '<option value="">all</option>';

								    if (ss_registergerichtoptionset == 1) {
								        account += '<option value="1" selected="selected"> Aachen</option>';
								    }
								    else {
								        account += '<option value="1"> Aachen</option>';
								    }
								    if (ss_registergerichtoptionset == 2) {
								        account += '<option value="2" selected="selected"> Altenburg</option>';
								    }
								    else {
								        account += '<option value="2"> Altenburg</option>';

								    }
								    if (ss_registergerichtoptionset == 3) {
								        account += '<option value="3" selected="selected"> Amberg</option>';
								    }
								    else {
								        account += '<option value="3"> Amberg</option>';

								    }
								    if (ss_registergerichtoptionset == 4) {
								        account += '<option value="4" selected="selected"> Ansbach</option>';
								    }
								    else {
								        account += '<option value="4"> Ansbach</option>';

								    }
								    if (ss_registergerichtoptionset == 5) {
								        account += '<option value="5" selected="selected"> Apolda</option>';
								    }
								    else {
								        account += '<option value="5"> Apolda</option>';

								    }
								    if (ss_registergerichtoptionset == 6) {
								        account += '<option value="6" selected="selected"> Arnsberg</option>';
								    }
								    else {
								        account += '<option value="6"> Arnsberg</option>';

								    }
								    if (ss_registergerichtoptionset == 7) {
								        account += '<option value="7" selected="selected"> Arnstadt</option>';
								    }
								    else {
								        account += '<option value="7"> Arnstadt</option>';

								    }
								    if (ss_registergerichtoptionset == 8) {
								        account += '<option value="8" selected="selected"> Arnstadt Zweigstelle Ilmenau</option>';
								    }
								    else {
								        account += '<option value="8"> Arnstadt Zweigstelle Ilmenau</option>';

								    }
								    if (ss_registergerichtoptionset == 9) {
								        account += '<option value="9" selected="selected"> Aschaffenburg</option>';
								    }
								    else {
								        account += '<option value="9"> Aschaffenburg</option>';

								    }
								    if (ss_registergerichtoptionset == 10) {
								        account += '<option value="10" selected="selected"> Augsburg</option>';
								    }
								    else {
								        account += '<option value="10"> Augsburg</option>';

								    }
								    if (ss_registergerichtoptionset == 11) {
								        account += '<option value="11" selected="selected"> Aurich</option>';
								    }
								    else {
								        account += '<option value="11"> Aurich</option>';

								    }
								    if (ss_registergerichtoptionset == 12) {
								        account += '<option value="12" selected="selected"> Bad Hersfeld</option>';
								    }
								    else {
								        account += '<option value="12"> Bad Hersfeld</option>';

								    }
								    if (ss_registergerichtoptionset == 13) {
								        account += '<option value="13" selected="selected"> Bad Homburg v.d.H.</option>';
								    }
								    else {
								        account += '<option value="13"> Bad Homburg v.d.H.</option>';

								    }
								    if (ss_registergerichtoptionset == 14) {
								        account += '<option value="14" selected="selected"> Bad Kreuznach</option>';
								    }
								    else {
								        account += '<option value="14"> Bad Kreuznach</option>';

								    }
								    if (ss_registergerichtoptionset == 15) {
								        account += '<option value="15" selected="selected"> Bad Oeynhausen</option>';
								    }
								    else {
								        account += '<option value="15"> Bad Oeynhausen</option>';

								    }
								    if (ss_registergerichtoptionset == 16) {
								        account += '<option value="16" selected="selected"> Bad Salzungen</option>';
								    }
								    else {
								        account += '<option value="16"> Bad Salzungen</option>';

								    }
								    if (ss_registergerichtoptionset == 17) {
								        account += '<option value="17" selected="selected"> Bamberg</option>';
								    }
								    else {
								        account += '<option value="17"> Bamberg</option>';

								    }
								    if (ss_registergerichtoptionset == 18) {
								        account += '<option value="18" selected="selected"> Bayreuth</option>';
								    }
								    else {
								        account += '<option value="18"> Bayreuth</option>';

								    }
								    if (ss_registergerichtoptionset == 19) {
								        account += '<option value="19" selected="selected"> Berlin (Charlottenburg)</option>';
								    }
								    else {
								        account += '<option value="19"> Berlin (Charlottenburg)</option>';

								    }
								    if (ss_registergerichtoptionset == 20) {
								        account += '<option value="20" selected="selected"> Bielefeld</option>';
								    }
								    else {
								        account += '<option value="20"> Bielefeld</option>';

								    }
								    if (ss_registergerichtoptionset == 21) {
								        account += '<option value="21" selected="selected"> Bochum</option> ';
								    }
								    else {
								        account += '<option value="21"> Bochum</option> ';

								    }
								    if (ss_registergerichtoptionset == 22) {
								        account += '<option value="22" selected="selected"> Bonn</option>';
								    }
								    else {
								        account += '<option value="22"> Bonn</option>';

								    }
								    if (ss_registergerichtoptionset == 23) {
								        account += '<option value="23" selected="selected"> Braunschweig</option>';
								    }
								    else {
								        account += '<option value="23"> Braunschweig</option>';

								    }
								    if (ss_registergerichtoptionset == 24) {
								        account += '<option value="24" selected="selected"> Bremen</option>';
								    }
								    else {
								        account += '<option value="24"> Bremen</option>';

								    }
								    if (ss_registergerichtoptionset == 25) {
								        account += '<option value="25" selected="selected"> Chemnitz</option>';
								    }
								    else {
								        account += '<option value="25"> Chemnitz</option>';

								    }
								    if (ss_registergerichtoptionset == 26) {
								        account += '<option value="26" selected="selected"> Coburg</option>';
								    }
								    else {
								        account += '<option value="26"> Coburg</option>';

								    }
								    if (ss_registergerichtoptionset == 27) {
								        account += '<option value="27" selected="selected"> Coesfeld</option>';
								    }
								    else {
								        account += '<option value="27"> Coesfeld</option>';

								    }
								    if (ss_registergerichtoptionset == 28) {
								        account += '<option value="28" selected="selected"> Cottbus</option>';
								    }
								    else {
								        account += '<option value="28"> Cottbus</option>';

								    }
								    if (ss_registergerichtoptionset == 29) {
								        account += '<option value="29" selected="selected"> Darmstadt</option>';
								    }
								    else {
								        account += '<option value="29"> Darmstadt</option>';

								    }
								    if (ss_registergerichtoptionset == 30) {
								        account += '<option value="30" selected="selected"> Deggendorf</option>';
								    }
								    else {
								        account += '<option value="30"> Deggendorf</option>';

								    }
								    if (ss_registergerichtoptionset == 31) {
								        account += '<option value="31" selected="selected"> Dortmund</option>';
								    }
								    else {
								        account += '<option value="31"> Dortmund</option>';

								    }
								    if (ss_registergerichtoptionset == 32) {

								        account += '<option value="32" selected="selected"> Dresden</option>';
								    }
								    else {
								        account += '<option value="32"> Dresden</option>';

								    }
								    if (ss_registergerichtoptionset == 33) {
								        account += '<option value="33" selected="selected"> Duisburg</option>';
								    }
								    else {
								        account += '<option value="33"> Duisburg</option>';

								    }
								    if (ss_registergerichtoptionset == 34) {
								        account += '<option value="34" selected="selected"> Düren</option>';
								    }
								    else {
								        account += '<option value="34"> Düren</option>';

								    }
								    if (ss_registergerichtoptionset == 35) {
								        account += '<option value="35" selected="selected"> Düsseldorf</option>';
								    }
								    else {
								        account += '<option value="35"> Düsseldorf</option>';

								    }
								    if (ss_registergerichtoptionset == 36) {
								        account += '<option value="36" selected="selected"> Eisenach</option>';
								    }
								    else {
								        account += '<option value="36"> Eisenach</option>';

								    }
								    if (ss_registergerichtoptionset == 37) {
								        account += '<option value="37" selected="selected"> Erfurt</option>';
								    }
								    else {
								        account += '<option value="37"> Erfurt</option>';

								    }
								    if (ss_registergerichtoptionset == 38) {
								        account += '<option value="38" selected="selected"> Eschwege</option>';
								    }
								    else {
								        account += '<option value="38"> Eschwege</option>';

								    }
								    if (ss_registergerichtoptionset == 39) {
								        account += '<option value="39" selected="selected"> Essen</option>';
								    }
								    else {
								        account += '<option value="39"> Essen</option>';

								    }
								    if (ss_registergerichtoptionset == 40) {
								        account += '<option value="40" selected="selected"> Flensburg</option>';
								    }
								    else {
								        account += '<option value="40"> Flensburg</option>';

								    }
								    if (ss_registergerichtoptionset == 41) {
								        account += '<option value="41" selected="selected"> Frankfurt am Main</option>';
								    }
								    else {
								        account += '<option value="41"> Frankfurt am Main</option>';

								    }

								    if (ss_registergerichtoptionset == 42) {
								        account += '<option value="42" selected="selected"> Frankfurt/Oder</option>';
								    }
								    else {
								        account += '<option value="42"> Frankfurt/Oder</option>';

								    }

								    if (ss_registergerichtoptionset == 43) {
								        account += '<option value="43" selected="selected"> Freiburg</option>';
								    }
								    else {
								        account += '<option value="43"> Freiburg</option>';

								    }
								    if (ss_registergerichtoptionset == 44) {
								        account += '<option value="44" selected="selected"> Friedberg</option>';
								    }
								    else {
								        account += '<option value="44"> Friedberg</option>';

								    }
								    if (ss_registergerichtoptionset == 45) {
								        account += '<option value="45" selected="selected"> Fritzlar</option>';
								    }
								    else {
								        account += '<option value="45"> Fritzlar</option>';

								    }
								    if (ss_registergerichtoptionset == 46) {
								        account += '<option value="46" selected="selected"> Fulda</option>';
								    }
								    else {
								        account += '<option value="46"> Fulda</option>';

								    }
								    if (ss_registergerichtoptionset == 47) {
								        account += '<option value="47" selected="selected"> Fürth</option>';
								    }
								    else {
								        account += '<option value="47"> Fürth</option>';

								    }
								    if (ss_registergerichtoptionset == 48) {
								        account += '<option value="48" selected="selected"> Gelsenkirchen</option>';
								    }
								    else {
								        account += '<option value="48"> Gelsenkirchen</option>';

								    }
								    if (ss_registergerichtoptionset == 49) {
								        account += '<option value="49" selected="selected"> Gera</option>';
								    }
								    else {
								        account += '<option value="49"> Gera</option>';

								    }
								    if (ss_registergerichtoptionset == 50) {
								        account += '<option value="50" selected="selected"> Gießen</option>';
								    }
								    else {
								        account += '<option value="50"> Gießen</option>';

								    }
								    if (ss_registergerichtoptionset == 51) {
								        account += '<option value="51" selected="selected"> Gotha</option>';
								    }
								    else {
								        account += '<option value="51"> Gotha</option>';

								    }
								    if (ss_registergerichtoptionset == 52) {
								        account += '<option value="52" selected="selected"> Greiz</option>';
								    }
								    else {
								        account += '<option value="52"> Greiz</option>';

								    }
								    if (ss_registergerichtoptionset == 53) {
								        account += '<option value="53" selected="selected"> Göttingen</option>';
								    }
								    else {
								        account += '<option value="53"> Göttingen</option>';

								    }
								    if (ss_registergerichtoptionset == 54) {
								        account += '<option value="54" selected="selected"> Gütersloh</option>';
								    }
								    else {
								        account += '<option value="54"> Gütersloh</option>';

								    }
								    if (ss_registergerichtoptionset == 55) {
								        account += '<option value="55" selected="selected"> Hagen</option>';
								    }
								    else {
								        account += '<option value="55"> Hagen</option>';

								    }
								    if (ss_registergerichtoptionset == 56) {
								        account += '<option value="56" selected="selected"> Hamburg</option>';
								    }
								    else {
								        account += '<option value="56"> Hamburg</option>';

								    }
								    if (ss_registergerichtoptionset == 57) {
								        account += '<option value="57" selected="selected"> Hamm</option>';
								    }
								    else {
								        account += '<option value="57"> Hamm</option>';

								    }
								    if (ss_registergerichtoptionset == 58) {
								        account += '<option value="58" selected="selected"> Hanau</option>';
								    }
								    else {
								        account += '<option value="58"> Hanau</option>';

								    }
								    if (ss_registergerichtoptionset == 59) {
								        account += '<option value="59" selected="selected"> Hannover</option>';
								    }
								    else {
								        account += '<option value="59"> Hannover</option>';

								    }
								    if (ss_registergerichtoptionset == 60) {
								        account += '<option value="60" selected="selected"> Heilbad Heiligenstadt</option>';
								    }
								    else {
								        account += '<option value="60"> Heilbad Heiligenstadt</option>';

								    }
								    if (ss_registergerichtoptionset == 61) {
								        account += '<option value="61" selected="selected"> Hildburghausen</option>';
								    }
								    else {
								        account += '<option value="61"> Hildburghausen</option>';

								    }
								    if (ss_registergerichtoptionset == 62) {
								        account += '<option value="62" selected="selected"> Hildesheim</option>';
								    }
								    else {
								        account += '<option value="62"> Hildesheim</option>';

								    }
								    if (ss_registergerichtoptionset == 63) {
								        account += '<option value="63" selected="selected"> Hof</option>';
								    }
								    else {
								        account += '<option value="63"> Hof</option>';

								    }
								    if (ss_registergerichtoptionset == 64) {
								        account += '<option value="64" selected="selected"> Homburg</option>';
								    }
								    else {
								        account += '<option value="64"> Homburg</option>';

								    }
								    if (ss_registergerichtoptionset == 65) {
								        account += '<option value="65" selected="selected"> Ingolstadt</option>';
								    }
								    else {
								        account += '<option value="65"> Ingolstadt</option>';

								    }
								    if (ss_registergerichtoptionset == 66) {
								        account += '<option value="66" selected="selected"> Iserlohn</option>';
								    }
								    else {
								        account += '<option value="66"> Iserlohn</option>';

								    }
								    if (ss_registergerichtoptionset == 67) {
								        account += '<option value="67" selected="selected"> Jena</option>';
								    }
								    else {
								        account += '<option value="67"> Jena</option>';

								    }
								    if (ss_registergerichtoptionset == 68) {
								        account += '<option value="68" selected="selected"> Kaiserslautern</option>';
								    }
								    else {
								        account += '<option value="68"> Kaiserslautern</option>';

								    }
								    if (ss_registergerichtoptionset == 69) {
								        account += '<option value="69" selected="selected"> Kassel</option>';
								    }
								    else {
								        account += '<option value="69"> Kassel</option>';

								    }
								    if (ss_registergerichtoptionset == 70) {
								        account += '<option value="70" selected="selected"> Kempten (Allgäu)</option>';
								    }
								    else {
								        account += '<option value="70"> Kempten (Allgäu)</option>';

								    }
								    if (ss_registergerichtoptionset == 71) {
								        account += '<option value="71" selected="selected"> Kiel</option>';
								    }
								    else {
								        account += '<option value="71"> Kiel</option>';

								    }
								    if (ss_registergerichtoptionset == 72) {
								        account += '<option value="72" selected="selected"> Kleve</option>';
								    }
								    else {
								        account += '<option value="72"> Kleve</option>';

								    }
								    if (ss_registergerichtoptionset == 73) {
								        account += '<option value="73" selected="selected"> Koblenz</option>';
								    }
								    else {
								        account += '<option value="73"> Koblenz</option>';

								    }
								    if (ss_registergerichtoptionset == 74) {
								        account += '<option value="74" selected="selected"> Korbach</option>';
								    }
								    else {
								        account += '<option value="74"> Korbach</option>';

								    }
								    if (ss_registergerichtoptionset == 75) {
								        account += '<option value="75" selected="selected"> Krefeld</option>';
								    }
								    else {
								        account += '<option value="75"> Krefeld</option>';

								    }
								    if (ss_registergerichtoptionset == 76) {
								        account += '<option value="76" selected="selected"> Köln</option>';
								    }
								    else {
								        account += '<option value="76"> Köln</option>';

								    }
								    if (ss_registergerichtoptionset == 77) {
								        account += '<option value="77" selected="selected"> Königstein</option>';
								    }
								    else {
								        account += '<option value="77"> Königstein</option>';

								    }
								    if (ss_registergerichtoptionset == 78) {
								        account += '<option value="78" selected="selected"> Landau</option>';
								    }
								    else {
								        account += '<option value="78"> Landau</option>';

								    }
								    if (ss_registergerichtoptionset == 79) {
								        account += '<option value="79" selected="selected"> Landshut</option>';
								    }
								    else {
								        account += '<option value="79"> Landshut</option>';

								    }
								    if (ss_registergerichtoptionset == 80) {
								        account += '<option value="80" selected="selected"> Langenfeld</option>';
								    }
								    else {
								        account += '<option value="80"> Langenfeld</option>';

								    }
								    if (ss_registergerichtoptionset == 81) {
								        account += '<option value="81" selected="selected"> Lebach</option>';
								    }
								    else {
								        account += '<option value="81"> Lebach</option>';

								    }
								    if (ss_registergerichtoptionset == 82) {
								        account += '<option value="82" selected="selected"> Leipzig</option>';
								    }
								    else {
								        account += '<option value=82> Leipzig</option>';

								    }
								    if (ss_registergerichtoptionset == 83) {
								        account += '<option value="83" selected="selected"> Lemgo</option>';
								    }
								    else {
								        account += '<option value="83"> Lemgo</option>';

								    }
								    if (ss_registergerichtoptionset == 84) {
								        account += '<option value="84" selected="selected"> Limburg</option>';
								    }
								    else {
								        account += '<option value="84"> Limburg</option>';

								    }

								    if (ss_registergerichtoptionset == 85) {
								        account += '<option value="85" selected="selected"> Ludwigshafen a.Rhein (Ludwigshafen)</option>';
								    }
								    else {
								        account += '<option value="85"> Ludwigshafen a.Rhein (Ludwigshafen)</option>';

								    }
								    if (ss_registergerichtoptionset == 86) {
								        account += '<option value="86" selected="selected"> Lübeck</option>';
								    }
								    else {
								        account += '<option value="86"> Lübeck</option>';

								    }
								    if (ss_registergerichtoptionset == 87) {
								        account += '<option value="87" selected="selected"> Lüneburg</option>';
								    }
								    else {
								        account += '<option value="87"> Lüneburg</option>';

								    }
								    if (ss_registergerichtoptionset == 88) {
								        account += '<option value="88" selected="selected"> Mainz</option>';
								    }
								    else {
								        account += '<option value="88"> Mainz</option>';

								    }
								    if (ss_registergerichtoptionset == 89) {
								        account += '<option value="89" selected="selected"> Mannheim</option>';
								    }
								    else {
								        account += '<option value="89"> Mannheim</option>';

								    }
								    if (ss_registergerichtoptionset == 90) {
								        account += '<option value="90" selected="selected"> Marburg</option>';
								    }
								    else {
								        account += '<option value="90"> Marburg</option>';

								    }
								    if (ss_registergerichtoptionset == 91) {
								        account += '<option value="91" selected="selected"> Meiningen</option>';
								    }
								    else {
								        account += '<option value="91"> Meiningen</option>';

								    }
								    if (ss_registergerichtoptionset == 92) {
								        account += '<option value="92" selected="selected"> Memmingen</option>';
								    }
								    else {
								        account += '<option value="92"> Memmingen</option>';

								    }
								    if (ss_registergerichtoptionset == 93) {
								        account += '<option value="93" selected="selected"> Merzig</option>';
								    }
								    else {
								        account += '<option value="93"> Merzig</option>';

								    }
								    if (ss_registergerichtoptionset == 94) {
								        account += '<option value="94" selected="selected"> Montabaur</option>';
								    }
								    else {
								        account += '<option value="94"> Montabaur</option>';

								    }
								    if (ss_registergerichtoptionset == 95) {
								        account += '<option value="95" selected="selected"> Mönchengladbach</option>';
								    }
								    else {
								        account += '<option value="95"> Mönchengladbach</option>';

								    }
								    if (ss_registergerichtoptionset == 96) {
								        account += '<option value="96" selected="selected"> Mühlhausen</option>';
								    }
								    else {
								        account += '<option value="96"> Mühlhausen</option>';

								    }
								    if (ss_registergerichtoptionset == 97) {
								        account += '<option value="97" selected="selected"> München</option>';
								    }
								    else {
								        account += '<option value="97"> München</option>';

								    }
								    if (ss_registergerichtoptionset == 98) {
								        account += '<option value="98" selected="selected"> Münster</option>';
								    }
								    else {
								        account += '<option value="98"> Münster</option>';

								    }
								    if (ss_registergerichtoptionset == 99) {
								        account += '<option value="99" selected="selected"> Neubrandenburg</option>';
								    }
								    else {
								        account += '<option value="99"> Neubrandenburg</option>';

								    }
								    if (ss_registergerichtoptionset == 100) {
								        account += '<option value="100" selected="selected"> Neunkirchen</option>';
								    }
								    else {
								        account += '<option value="100"> Neunkirchen</option>';

								    }
								    if (ss_registergerichtoptionset == 101) {
								        account += '<option value="101" selected="selected"> Neuruppin</option>';
								    }
								    else {
								        account += '<option value="101"> Neuruppin</option>';

								    }
								    if (ss_registergerichtoptionset == 102) {
								        account += '<option value="102" selected="selected"> Neuss</option>';
								    }
								    else {
								        account += '<option value="102"> Neuss</option>';

								    }
								    if (ss_registergerichtoptionset == 103) {
								        account += '<option value="103" selected="selected"> Nordhausen</option>';
								    }
								    else {
								        account += '<option value="103"> Nordhausen</option>';

								    }
								    if (ss_registergerichtoptionset == 104) {
								        account += '<option value="104" selected="selected"> Nürnberg</option>';
								    }
								    else {
								        account += '<option value="104"> Nürnberg</option>';

								    }
								    if (ss_registergerichtoptionset == 105) {
								        account += '<option value="105" selected="selected"> Offenbach am Main</option>';
								    }
								    else {
								        account += '<option value="105"> Offenbach am Main</option>';

								    }
								    if (ss_registergerichtoptionset == 106) {
								        account += '<option value="106" selected="selected"> Oldenburg (Oldenburg)</option>';
								    }
								    else {
								        account += '<option value="106"> Oldenburg (Oldenburg)</option>';

								    }
								    if (ss_registergerichtoptionset == 107) {
								        account += '<option value="107" selected="selected"> Osnabrück</option>';
								    }
								    else {
								        account += '<option value="107"> Osnabrück</option>';

								    }
								    if (ss_registergerichtoptionset == 108) {
								        account += '<option value="108" selected="selected"> Ottweiler</option>';
								    }
								    else {
								        account += '<option value="108"> Ottweiler</option>';

								    }
								    if (ss_registergerichtoptionset == 109) {
								        account += '<option value="109" selected="selected"> Paderborn</option>';
								    }
								    else {
								        account += '<option value="109"> Paderborn</option>';

								    }
								    if (ss_registergerichtoptionset == 110) {
								        account += '<option value="110" selected="selected"> Passau</option>';
								    }
								    else {
								        account += '<option value="110"> Passau</option>';

								    }
								    if (ss_registergerichtoptionset == 111) {
								        account += '<option value="111" selected="selected"> Pinneberg</option>';
								    }
								    else {
								        account += '<option value="111"> Pinneberg</option>';

								    }
								    if (ss_registergerichtoptionset == 112) {
								        account += '<option value="112" selected="selected"> Potsdam</option>';
								    }
								    else {
								        account += '<option value="112"> Potsdam</option>';

								    }
								    if (ss_registergerichtoptionset == 113) {
								        account += '<option value="113" selected="selected"> Pößneck</option>';
								    }
								    else {
								        account += '<option value="113"> Pößneck</option>';

								    }
								    if (ss_registergerichtoptionset == 114) {
								        account += '<option value="114" selected="selected"> Pößneck Zweigstelle Bad Lobenstein</option>';
								    }
								    else {
								        account += '<option value="114"> Pößneck Zweigstelle Bad Lobenstein</option>';

								    }

								    if (ss_registergerichtoptionset == 115) {
								        account += '<option value="115" selected="selected"> Recklinghausen</option>';
								    }
								    else {
								        account += '<option value="115"> Recklinghausen</option>';

								    }
								    if (ss_registergerichtoptionset == 116) {
								        account += '<option value="116" selected="selected"> Regensburg</option>';
								    }
								    else {
								        account += '<option value="116"> Regensburg</option>';
								    }
								    if (ss_registergerichtoptionset == 117) {
								        account += '<option value="117" selected="selected"> Rostock</option>';
								    }
								    else {
								        account += '<option value="117"> Rostock</option>';
								    }
								    if (ss_registergerichtoptionset == 118) {
								        account += '<option value="118" selected="selected"> Rudolstadt</option>';
								    }
								    else {
								        account += '<option value="118" > Rudolstadt</option>';

								    }
								    if (ss_registergerichtoptionset == 119) {
								        account += '<option value="119" selected="selected"> Rudolstadt Zweigstelle Saalfeld</option>';
								    }
								    else {
								        account += '<option value="119"> Rudolstadt Zweigstelle Saalfeld</option>';

								    }
								    if (ss_registergerichtoptionset == 120) {
								        account += '<option value="120" selected="selected"> Saarbrücken</option>';
								    }
								    else {
								        account += '<option value="120" > Saarbrücken</option>';

								    }
								    if (ss_registergerichtoptionset == 121) {
								        account += '<option value="121" selected="selected"> Saarlouis</option>';
								    }
								    else {
								        account += '<option value="121"> Saarlouis</option>';

								    }
								    if (ss_registergerichtoptionset == 122) {
								        account += '<option value="122" selected="selected"> Schweinfurt</option>';
								    }
								    else {
								        account += '<option value="122" > Schweinfurt</option>';

								    }
								    if (ss_registergerichtoptionset == 123) {
								        account += '<option value="123" selected="selected"> Schwerin</option>';
								    }
								    else {
								        account += '<option value="123"> Schwerin</option>';
								    }
								    if (ss_registergerichtoptionset == 124) {
								        account += '<option value="124" selected="selected"> Siegburg</option>';
								    }
								    else {
								        account += '<option value="124"> Siegburg</option>';

								    }
								    if (ss_registergerichtoptionset == 125) {
								        account += '<option value="125" selected="selected"> Siegen</option>';
								    }
								    else {
								        account += '<option value="125"> Siegen</option>';

								    }
								    if (ss_registergerichtoptionset == 126) {
								        account += '<option value="126" selected="selected"> Sondershausen</option>';
								    }
								    else {
								        account += '<option value="126" > Sondershausen</option>';

								    }
								    if (ss_registergerichtoptionset == 127) {
								        account += '<option value="127" selected="selected"> Sonneberg</option>';
								    }
								    else {
								        account += '<option value="127"> Sonneberg</option>';

								    }
								    if (ss_registergerichtoptionset == 128) {
								        account += '<option value="128" selected="selected"> St. Ingbert (St Ingbert)</option>';
								    }
								    else {
								        account += '<option value="128" > St. Ingbert (St Ingbert)</option>';

								    }
								    if (ss_registergerichtoptionset == 129) {
								        account += '<option value="129" selected="selected"> St. Wendel (St Wendel)</option>';
								    }
								    else {
								        account += '<option value="129"> St. Wendel (St Wendel)</option>';
								    }
								    if (ss_registergerichtoptionset == 130) {
								        account += '<option value="130" selected="selected"> Stadthagen</option>';
								    }
								    else {
								        account += '<option value="130"> Stadthagen</option>';

								    }
								    if (ss_registergerichtoptionset == 131) {
								        account += '<option value="131" selected="selected"> Stadtroda</option>';
								    }
								    else {
								        account += '<option value="131"> Stadtroda</option>';

								    }
								    if (ss_registergerichtoptionset == 132) {
								        account += '<option value="132" selected="selected"> Steinfurt</option>';
								    }
								    else {
								        account += '<option value="132" > Steinfurt</option>';

								    }
								    if (ss_registergerichtoptionset == 133) {
								        account += '<option value="133" selected="selected"> Stendal</option>';
								    }
								    else {
								        account += '<option value="133"> Stendal</option>';

								    }
								    if (ss_registergerichtoptionset == 134) {
								        account += '<option value="134" selected="selected"> Stralsund</option>';
								    }
								    else {
								        account += '<option value="134"> Stralsund</option>';

								    }
								    if (ss_registergerichtoptionset == 135) {
								        account += '<option value="135" selected="selected"> Straubing</option>';
								    }
								    else {
								        account += '<option value="135" > Straubing</option>';

								    }
								    if (ss_registergerichtoptionset == 136) {
								        account += '<option value="136" selected="selected"> Stuttgart</option>';
								    }
								    else {
								        account += '<option value="136"> Stuttgart</option>';

								    }
								    if (ss_registergerichtoptionset == 137) {
								        account += '<option value="137" selected="selected"> Suhl</option>';
								    }
								    else {
								        account += '<option value="137"> Suhl</option>';

								    }
								    if (ss_registergerichtoptionset == 138) {
								        account += '<option value="138" selected="selected"> Sömmerda</option>';
								    }
								    else {
								        account += '<option value="138"> Sömmerda</option>';

								    }
								    if (ss_registergerichtoptionset == 139) {
								        account += '<option value="139" selected="selected"> Tostedt</option>';
								    }
								    else {
								        account += '<option value="139"> Tostedt</option>';

								    }
								    if (ss_registergerichtoptionset == 140) {
								        account += '<option value="140" selected="selected"> Traunstein</option>';
								    }
								    else {
								        account += '<option value="140"> Traunstein</option>';

								    }
								    if (ss_registergerichtoptionset == 141) {
								        account += '<option value="141" selected="selected"> Ulm</option>';
								    }
								    else {
								        account += '<option value="141"> Ulm</option>';

								    }
								    if (ss_registergerichtoptionset == 142) {
								        account += '<option value="142" selected="selected"> Völklingen</option>';
								    }
								    else {
								        account += '<option value="142"> Völklingen</option>';

								    }
								    if (ss_registergerichtoptionset == 143) {
								        account += '<option value="143" selected="selected"> Walsrode</option>';
								    }
								    else {
								        account += '<option value="143"> Walsrode</option>';

								    }
								    if (ss_registergerichtoptionset == 144) {
								        account += '<option value="144" selected="selected"> Weiden i. d. OPf.</option>';
								    }
								    else {
								        account += '<option value="144"> Weiden i. d. OPf.</option>';

								    }
								    if (ss_registergerichtoptionset == 145) {
								        account += '<option value="145" selected="selected"> Weimar</option>';
								    }
								    else {
								        account += '<option value="145"> Weimar</option>';

								    }
								    if (ss_registergerichtoptionset == 146) {
								        account += '<option value="146" selected="selected"> Wetzlar</option>';
								    }
								    else {
								        account += '<option value="146"> Wetzlar</option>';

								    }
								    if (ss_registergerichtoptionset == 147) {
								        account += '<option value="147" selected="selected"> Wiesbaden</option>';
								    }
								    else {
								        account += '<option value="147"> Wiesbaden</option>';

								    }
								    if (ss_registergerichtoptionset == 148) {
								        account += '<option value="148" selected="selected"> Wittlich</option>';
								    }
								    else {
								        account += '<option value="148"> Wittlich</option>';

								    }
								    if (ss_registergerichtoptionset == 149) {
								        account += '<option value="149" selected="selected"> Wuppertal</option>';
								    }
								    else {
								        account += '<option value="149"> Wuppertal</option>';

								    }
								    if (ss_registergerichtoptionset == 150) {
								        account += '<option value="150" selected="selected"> Würzburg</option>';
								    }
								    else {
								        account += '<option value="150"> Würzburg</option>';

								    }
								    if (ss_registergerichtoptionset == 151) {
								        account += '<option value="151" selected="selected"> Zweibrücken</option>';
								    }
								    else {
								        account += '<option value="151"> Zweibrücken</option>';

								    }
								    account += '</select>';

								}



								//if (ss_ort1 != null) {



								//	account += '<select id="Ort1Id" onchange="updateAccount(this)" class="form-control input-sm" >';
								//	account += '<option value="">all</option>';

								//	if (ss_ort1.toString().trim().toString().trim() == "Aachen") {
								//		account += '<option value="R3101" selected="selected"> Aachen</option>';
								//	}
								//	else {
								//		account += '<option value="R3101"> Aachen</option>';
								//	}
								//	if (ss_ort1.toString().trim() == "Altenburg") {
								//		account += '<option value="Y1201" selected="selected"> Altenburg</option>';
								//	}
								//	else {
								//		account += '<option value="Y1201"> Altenburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Amberg") {
								//		account += '<option value="D3101" selected="selected"> Amberg</option>';
								//	}
								//	else {
								//		account += '<option value="D3101"> Amberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Ansbach") {
								//		account += '<option value="D3201" selected="selected"> Ansbach</option>';
								//	}
								//	else {
								//		account += '<option value="D3201"> Ansbach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Apolda") {
								//		account += '<option value="Y1101" selected="selected"> Apolda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1101"> Apolda</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Arnsberg") {
								//		account += '<option value="R1901" selected="selected"> Arnsberg</option>';
								//	}
								//	else {
								//		account += '<option value="R1901"> Arnsberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Arnstadt") {
								//		account += '<option value="Y1102" selected="selected"> Arnstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1102"> Arnstadt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Arnstadt Zweigstelle Ilmenau") {
								//		account += '<option value="Y1303" selected="selected"> Arnstadt Zweigstelle Ilmenau</option>';
								//	}
								//	else {
								//		account += '<option value="Y1303"> Arnstadt Zweigstelle Ilmenau</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Aschaffenburg") {
								//		account += '<option value="D4102" selected="selected"> Aschaffenburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4102"> Aschaffenburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Augsburg") {
								//		account += '<option value="D2102" selected="selected"> Augsburg</option>';
								//	}
								//	else {
								//		account += '<option value="D2102"> Augsburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Aurich") {
								//		account += '<option value="P3101" selected="selected"> Aurich</option>';
								//	}
								//	else {
								//		account += '<option value="P3101"> Aurich</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bad Hersfeld") {
								//		account += '<option value="M1305" selected="selected"> Bad Hersfeld</option>';
								//	}
								//	else {
								//		account += '<option value="M1305"> Bad Hersfeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bad Homburg v.d.H.") {
								//		account += '<option value="M1202" selected="selected"> Bad Homburg v.d.H.</option>';
								//	}
								//	else {
								//		account += '<option value="M1202"> Bad Homburg v.d.H.</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bad Kreuznach") {
								//		account += '<option value="T2101" selected="selected"> Bad Kreuznach</option>';
								//	}
								//	else {
								//		account += '<option value="T2101"> Bad Kreuznach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bad Oeynhausen") {
								//		account += '<option value="R2108" selected="selected"> Bad Oeynhausen</option>';
								//	}
								//	else {
								//		account += '<option value="R2108"> Bad Oeynhausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bad Salzungen") {
								//		account += '<option value="Y1301" selected="selected"> Bad Salzungen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1301"> Bad Salzungen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bamberg") {
								//		account += '<option value="D4201" selected="selected"> Bamberg</option>';
								//	}
								//	else {
								//		account += '<option value="D4201"> Bamberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bayreuth") {
								//		account += '<option value="D4301" selected="selected"> Bayreuth</option>';
								//	}
								//	else {
								//		account += '<option value="D4301"> Bayreuth</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Berlin (Charlottenburg)") {
								//		account += '<option value="F1103" selected="selected"> Berlin (Charlottenburg)</option>';
								//	}
								//	else {
								//		account += '<option value="F1103"> Berlin (Charlottenburg)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bielefeld") {
								//		account += '<option value="R2101" selected="selected"> Bielefeld</option>';
								//	}
								//	else {
								//		account += '<option value="R2101"> Bielefeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bochum") {
								//		account += '<option value="R2201" selected="selected"> Bochum</option> ';
								//	}
								//	else {
								//		account += '<option value="R2201"> Bochum</option> ';

								//	}
								//	if (ss_ort1.toString().trim() == "Bonn") {
								//		account += '<option value="R3201" selected="selected"> Bonn</option>';
								//	}
								//	else {
								//		account += '<option value="R3201"> Bonn</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Braunschweig") {
								//		account += '<option value="P1103" selected="selected"> Braunschweig</option>';
								//	}
								//	else {
								//		account += '<option value="P1103"> Braunschweig</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Bremen") {
								//		account += '<option value="H1101" selected="selected"> Bremen</option>';
								//	}
								//	else {
								//		account += '<option value="H1101"> Bremen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Chemnitz") {
								//		account += '<option value="U1206" selected="selected"> Chemnitz</option>';
								//	}
								//	else {
								//		account += '<option value="U1206"> Chemnitz</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Coburg") {
								//		account += '<option value="D4401" selected="selected"> Coburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4401"> Coburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Coesfeld") {
								//		account += '<option value="R2707" selected="selected"> Coesfeld</option>';
								//	}
								//	else {
								//		account += '<option value="R2707"> Coesfeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Cottbus") {
								//		account += '<option value="G1103" selected="selected"> Cottbus</option>';
								//	}
								//	else {
								//		account += '<option value="G1103"> Cottbus</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Darmstadt") {
								//		account += '<option value="M1103" selected="selected"> Darmstadt</option>';
								//	}
								//	else {
								//		account += '<option value="M1103"> Darmstadt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Deggendorf") {
								//		account += '<option value="D2201" selected="selected"> Deggendorf</option>';
								//	}
								//	else {
								//		account += '<option value="D2201"> Deggendorf</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Dortmund") {
								//		account += '<option value="R2402" selected="selected"> Dortmund</option>';
								//	}
								//	else {
								//		account += '<option value="R2402"> Dortmund</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Dresden") {

								//		account += '<option value="U1104" selected="selected"> Dresden</option>';
								//	}
								//	else {
								//		account += '<option value="U1104"> Dresden</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Duisburg") {
								//		account += '<option value="R1202" selected="selected"> Duisburg</option>';
								//	}
								//	else {
								//		account += '<option value="R1202"> Duisburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Düren") {
								//		account += '<option value="R3103" selected="selected"> Düren</option>';
								//	}
								//	else {
								//		account += '<option value="R3103"> Düren</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Düsseldorf") {
								//		account += '<option value="R1101" selected="selected"> Düsseldorf</option>';
								//	}
								//	else {
								//		account += '<option value="R1101"> Düsseldorf</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Eisenach") {
								//		account += '<option value="Y1105" selected="selected"> Eisenach</option>';
								//	}
								//	else {
								//		account += '<option value="Y1105"> Eisenach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Erfurt") {
								//		account += '<option value="Y1106" selected="selected"> Erfurt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1106"> Erfurt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Eschwege") {
								//		account += '<option value="M1602" selected="selected"> Eschwege</option>';
								//	}
								//	else {
								//		account += '<option value="M1602"> Eschwege</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Essen") {
								//		account += '<option value="R2503" selected="selected"> Essen</option>';
								//	}
								//	else {
								//		account += '<option value="R2503"> Essen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Flensburg") {
								//		account += '<option value="X1112" selected="selected"> Flensburg</option>';
								//	}
								//	else {
								//		account += '<option value="X1112"> Flensburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Frankfurt am Main") {
								//		account += '<option value="M1201" selected="selected"> Frankfurt am Main</option>';
								//	}
								//	else {
								//		account += '<option value="M1201"> Frankfurt am Main</option>';

								//	}

								//	if (ss_ort1.toString().trim() == "Frankfurt/Oder") {
								//		account += '<option value="G1207" selected="selected"> Frankfurt/Oder</option>';
								//	}
								//	else {
								//		account += '<option value="G1207"> Frankfurt/Oder</option>';

								//	}

								//	if (ss_ort1.toString().trim() == "Freiburg") {
								//		account += '<option value="B1204" selected="selected"> Freiburg</option>';
								//	}
								//	else {
								//		account += '<option value="B1204"> Freiburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Friedberg") {
								//		account += '<option value="M1405" selected="selected"> Friedberg</option>';
								//	}
								//	else {
								//		account += '<option value="M1405"> Friedberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Fritzlar") {
								//		account += '<option value="M1603" selected="selected"> Fritzlar</option>';
								//	}
								//	else {
								//		account += '<option value="M1603"> Fritzlar</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Fulda") {
								//		account += '<option value="M1301" selected="selected"> Fulda</option>';
								//	}
								//	else {
								//		account += '<option value="M1301"> Fulda</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Fürth") {
								//		account += '<option value="D3304" selected="selected"> Fürth</option>';
								//	}
								//	else {
								//		account += '<option value="D3304"> Fürth</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Gelsenkirchen") {
								//		account += '<option value="R2507" selected="selected"> Gelsenkirchen</option>';
								//	}
								//	else {
								//		account += '<option value="R2507"> Gelsenkirchen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Gera") {
								//		account += '<option value="Y1203" selected="selected"> Gera</option>';
								//	}
								//	else {
								//		account += '<option value="Y1203"> Gera</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Gießen") {
								//		account += '<option value="M1406" selected="selected"> Gießen</option>';
								//	}
								//	else {
								//		account += '<option value="M1406"> Gießen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Gotha") {
								//		account += '<option value="Y1108" selected="selected"> Gotha</option>';
								//	}
								//	else {
								//		account += '<option value="Y1108"> Gotha</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Göttingen") {
								//		account += '<option value="P2204" selected="selected"> Göttingen</option>';
								//	}
								//	else {
								//		account += '<option value="P2204"> Göttingen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Greiz") {
								//		account += '<option value="Y1205" selected="selected"> Greiz</option>';
								//	}
								//	else {
								//		account += '<option value="Y1205"> Greiz</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Gütersloh") {
								//		account += '<option value="R2103" selected="selected"> Gütersloh</option>';
								//	}
								//	else {
								//		account += '<option value="R2103"> Gütersloh</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hagen") {
								//		account += '<option value="R2602" selected="selected"> Hagen</option>';
								//	}
								//	else {
								//		account += '<option value="R2602"> Hagen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hamburg") {
								//		account += '<option value="K1101" selected="selected"> Hamburg</option>';
								//	}
								//	else {
								//		account += '<option value="K1101"> Hamburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hamm") {
								//		account += '<option value="R2404" selected="selected"> Hamm</option>';
								//	}
								//	else {
								//		account += '<option value="R2404"> Hamm</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hanau") {
								//		account += '<option value="M1502" selected="selected"> Hanau</option>';
								//	}
								//	else {
								//		account += '<option value="M1502"> Hanau</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hannover") {
								//		account += '<option value="P2305" selected="selected"> Hannover</option>';
								//	}
								//	else {
								//		account += '<option value="P2305"> Hannover</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Heilbad Heiligenstadt") {
								//		account += '<option value="Y1109" selected="selected"> Heilbad Heiligenstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1109"> Heilbad Heiligenstadt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hildburghausen") {
								//		account += '<option value="Y1302" selected="selected"> Hildburghausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1302"> Hildburghausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hildesheim") {
								//		account += '<option value="P2408" selected="selected"> Hildesheim</option>';
								//	}
								//	else {
								//		account += '<option value="P2408"> Hildesheim</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Hof") {
								//		account += '<option value="D4501" selected="selected"> Hof</option>';
								//	}
								//	else {
								//		account += '<option value="D4501"> Hof</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Homburg") {
								//		account += '<option value="V1102" selected="selected"> Homburg</option>';
								//	}
								//	else {
								//		account += '<option value="V1102"> Homburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Ingolstadt") {
								//		account += '<option value="D5701" selected="selected"> Ingolstadt</option>';
								//	}
								//	else {
								//		account += '<option value="D5701"> Ingolstadt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Iserlohn") {
								//		account += '<option value="R2604" selected="selected"> Iserlohn</option>';
								//	}
								//	else {
								//		account += '<option value="R2604"> Iserlohn</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Jena") {
								//		account += '<option value="Y1206" selected="selected"> Jena</option>';
								//	}
								//	else {
								//		account += '<option value="Y1206"> Jena</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Kaiserslautern") {
								//		account += '<option value="T3201" selected="selected"> Kaiserslautern</option>';
								//	}
								//	else {
								//		account += '<option value="T3201"> Kaiserslautern</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Kassel") {
								//		account += '<option value="M1607" selected="selected"> Kassel</option>';
								//	}
								//	else {
								//		account += '<option value="M1607"> Kassel</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Kempten (Allgäu)") {
								//		account += '<option value="D2304" selected="selected"> Kempten (Allgäu)</option>';
								//	}
								//	else {
								//		account += '<option value="D2304"> Kempten (Allgäu)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Kiel") {
								//		account += '<option value="X1517" selected="selected"> Kiel</option>';
								//	}
								//	else {
								//		account += '<option value="X1517"> Kiel</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Kleve") {
								//		account += '<option value="R1304" selected="selected"> Kleve</option>';
								//	}
								//	else {
								//		account += '<option value="R1304"> Kleve</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Koblenz") {
								//		account += '<option value="T2210" selected="selected"> Koblenz</option>';
								//	}
								//	else {
								//		account += '<option value="T2210"> Koblenz</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Köln") {
								//		account += '<option value="R3306" selected="selected"> Köln</option>';
								//	}
								//	else {
								//		account += '<option value="R3306"> Köln</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Königstein") {
								//		account += '<option value="M1203" selected="selected"> Königstein</option>';
								//	}
								//	else {
								//		account += '<option value="M1203"> Königstein</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Korbach") {
								//		account += '<option value="M1608" selected="selected"> Korbach</option>';
								//	}
								//	else {
								//		account += '<option value="M1608"> Korbach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Krefeld") {
								//		account += '<option value="R1402" selected="selected"> Krefeld</option>';
								//	}
								//	else {
								//		account += '<option value="R1402"> Krefeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Landau") {
								//		account += '<option value="T3304" selected="selected"> Landau</option>';
								//	}
								//	else {
								//		account += '<option value="T3304"> Landau</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Landshut") {
								//		account += '<option value="D2404" selected="selected"> Landshut</option>';
								//	}
								//	else {
								//		account += '<option value="D2404"> Landshut</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Langenfeld") {
								//		account += '<option value="R1105" selected="selected"> Langenfeld</option>';
								//	}
								//	else {
								//		account += '<option value="R1105"> Langenfeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Lebach") {
								//		account += '<option value="V1103" selected="selected"> Lebach</option>';
								//	}
								//	else {
								//		account += '<option value="V1103"> Lebach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Leipzig") {
								//		account += '<option value="U1308" selected="selected"> Leipzig</option>';
								//	}
								//	else {
								//		account += '<option value="U1308"> Leipzig</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Lemgo") {
								//		account += '<option value="R2307" selected="selected"> Lemgo</option>';
								//	}
								//	else {
								//		account += '<option value="R2307"> Lemgo</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Limburg") {
								//		account += '<option value="M1706" selected="selected"> Limburg</option>';
								//	}
								//	else {
								//		account += '<option value="M1706"> Limburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Lübeck") {
								//		account += '<option value="X1721" selected="selected"> Lübeck</option>';
								//	}
								//	else {
								//		account += '<option value="X1721"> Lübeck</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Ludwigshafen a.Rhein (Ludwigshafen)") {
								//		account += '<option value="T3104" selected="selected"> Ludwigshafen a.Rhein (Ludwigshafen)</option>';
								//	}
								//	else {
								//		account += '<option value="T3104"> Ludwigshafen a.Rhein (Ludwigshafen)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Lüneburg") {
								//		account += '<option value="P2507" selected="selected"> Lüneburg</option>';
								//	}
								//	else {
								//		account += '<option value="P2507"> Lüneburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Mainz") {
								//		account += '<option value="T2304" selected="selected"> Mainz</option>';
								//	}
								//	else {
								//		account += '<option value="T2304"> Mainz</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Mannheim") {
								//		account += '<option value="B1601" selected="selected"> Mannheim</option>';
								//	}
								//	else {
								//		account += '<option value="B1601"> Mannheim</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Marburg") {
								//		account += '<option value="M1809" selected="selected"> Marburg</option>';
								//	}
								//	else {
								//		account += '<option value="M1809"> Marburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Meiningen") {
								//		account += '<option value="Y1304" selected="selected"> Meiningen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1304"> Meiningen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Memmingen") {
								//		account += '<option value="D2505" selected="selected"> Memmingen</option>';
								//	}
								//	else {
								//		account += '<option value="D2505"> Memmingen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Merzig") {
								//		account += '<option value="V1104" selected="selected"> Merzig</option>';
								//	}
								//	else {
								//		account += '<option value="V1104"> Merzig</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Mönchengladbach") {
								//		account += '<option value="R1504" selected="selected"> Mönchengladbach</option>';
								//	}
								//	else {
								//		account += '<option value="R1504"> Mönchengladbach</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Montabaur") {
								//		account += '<option value="T2214" selected="selected"> Montabaur</option>';
								//	}
								//	else {
								//		account += '<option value="T2214"> Montabaur</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Mühlhausen") {
								//		account += '<option value="Y1110" selected="selected"> Mühlhausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1110"> Mühlhausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "München") {
								//		account += '<option value="D2601" selected="selected"> München</option>';
								//	}
								//	else {
								//		account += '<option value="D2601"> München</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Münster") {
								//		account += '<option value="R2713" selected="selected"> Münster</option>';
								//	}
								//	else {
								//		account += '<option value="R2713"> Münster</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Neubrandenburg") {
								//		account += '<option value="N1105" selected="selected"> Neubrandenburg</option>';
								//	}
								//	else {
								//		account += '<option value="N1105"> Neubrandenburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Neunkirchen") {
								//		account += '<option value="V1105" selected="selected"> Neunkirchen</option>';
								//	}
								//	else {
								//		account += '<option value="V1105"> Neunkirchen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Neuruppin") {
								//		account += '<option value="G1309" selected="selected"> Neuruppin</option>';
								//	}
								//	else {
								//		account += '<option value="G1309"> Neuruppin</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Neuss") {
								//		account += '<option value="R1102" selected="selected"> Neuss</option>';
								//	}
								//	else {
								//		account += '<option value="R1102"> Neuss</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Nordhausen") {
								//		account += '<option value="Y1111" selected="selected"> Nordhausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1111"> Nordhausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Nürnberg") {
								//		account += '<option value="D3310" selected="selected"> Nürnberg</option>';
								//	}
								//	else {
								//		account += '<option value="D3310"> Nürnberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Offenbach am Main") {
								//		account += '<option value="M1114" selected="selected"> Offenbach am Main</option>';
								//	}
								//	else {
								//		account += '<option value="M1114"> Offenbach am Main</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Oldenburg (Oldenburg)") {
								//		account += '<option value="P3210" selected="selected"> Oldenburg (Oldenburg)</option>';
								//	}
								//	else {
								//		account += '<option value="P3210"> Oldenburg (Oldenburg)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Osnabrück") {
								//		account += '<option value="P3313" selected="selected"> Osnabrück</option>';
								//	}
								//	else {
								//		account += '<option value="P3313"> Osnabrück</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Ottweiler") {
								//		account += '<option value="V1107" selected="selected"> Ottweiler</option>';
								//	}
								//	else {
								//		account += '<option value="V1107"> Ottweiler</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Paderborn") {
								//		account += '<option value="R2809" selected="selected"> Paderborn</option>';
								//	}
								//	else {
								//		account += '<option value="R2809"> Paderborn</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Passau") {
								//		account += '<option value="D2803" selected="selected"> Passau</option>';
								//	}
								//	else {
								//		account += '<option value="D2803"> Passau</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Pinneberg") {
								//		account += '<option value="X1321" selected="selected"> Pinneberg</option>';
								//	}
								//	else {
								//		account += '<option value="X1321"> Pinneberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Pößneck") {
								//		account += '<option value="Y1209" selected="selected"> Pößneck</option>';
								//	}
								//	else {
								//		account += '<option value="Y1209"> Pößneck</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Pößneck Zweigstelle Bad Lobenstein") {
								//		account += '<option value="Y1208" selected="selected"> Pößneck Zweigstelle Bad Lobenstein</option>';
								//	}
								//	else {
								//		account += '<option value="Y1208"> Pößneck Zweigstelle Bad Lobenstein</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Potsdam") {
								//		account += '<option value="G1312" selected="selected"> Potsdam</option>';
								//	}
								//	else {
								//		account += '<option value="G1312"> Potsdam</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Recklinghausen") {
								//		account += '<option value="R2204" selected="selected"> Recklinghausen</option>';
								//	}
								//	else {
								//		account += '<option value="R2204"> Recklinghausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Regensburg") {
								//		account += '<option value="D3410" selected="selected"> Regensburg</option>';
								//	}
								//	else {
								//		account += '<option value="D3410"> Regensburg</option>';
								//	}
								//	if (ss_ort1.toString().trim() == "Rostock") {
								//		account += '<option value="N1206" selected="selected"> Rostock</option>';
								//	}
								//	else {
								//		account += '<option value="N1206"> Rostock</option>';
								//	}
								//	if (ss_ort1.toString().trim() == "Rudolstadt") {
								//		account += '<option value="Y1210" selected="selected"> Rudolstadt</option>';
								//	}
								//	else {
								//		account += '<option value="Y1210" > Rudolstadt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Rudolstadt Zweigstelle Saalfeld") {
								//		account += '<option value="Y1211" selected="selected"> Rudolstadt Zweigstelle Saalfeld</option>';
								//	}
								//	else {
								//		account += '<option value="Y1211"> Rudolstadt Zweigstelle Saalfeld</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Saarbrücken") {
								//		account += '<option value="V1109" selected="selected"> Saarbrücken</option>';
								//	}
								//	else {
								//		account += '<option value="V1109" > Saarbrücken</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Saarlouis") {
								//		account += '<option value="V1110" selected="selected"> Saarlouis</option>';
								//	}
								//	else {
								//		account += '<option value="V1110"> Saarlouis</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Schweinfurt") {
								//		account += '<option value="D4608" selected="selected"> Schweinfurt</option>';
								//	}
								//	else {
								//		account += '<option value="D4608" > Schweinfurt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Schwerin") {
								//		account += '<option value="N1308" selected="selected"> Schwerin</option>';
								//	}
								//	else {

								//	}
								//	if (ss_ort1.toString().trim() == "Siegburg") {
								//		account += '<option value="R3208" selected="selected"> Siegburg</option>';
								//	}
								//	else {
								//		account += '<option value="R3208"> Siegburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Siegen") {
								//		account += '<option value="R2909" selected="selected"> Siegen</option>';
								//	}
								//	else {
								//		account += '<option value="R2909"> Siegen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Sömmerda") {
								//		account += '<option value="Y1112" selected="selected"> Sömmerda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1112" > Sömmerda</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Sondershausen") {
								//		account += '<option value="Y1113" selected="selected"> Sondershausen</option>';
								//	}
								//	else {
								//		account += '<option value="Y1113"> Sondershausen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Sonneberg") {
								//		account += '<option value="Y1307" selected="selected"> Sonneberg</option>';
								//	}
								//	else {
								//		account += '<option value="Y1307" > Sonneberg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Stadthagen") {
								//		account += '<option value="P2106" selected="selected"> Stadthagen</option>';
								//	}
								//	else {
								//		account += '<option value="P2106"> Stadthagen</option>';
								//	}
								//	if (ss_ort1.toString().trim() == "Stadtroda") {
								//		account += '<option value="Y1214" selected="selected"> Stadtroda</option>';
								//	}
								//	else {
								//		account += '<option value="Y1214"> Stadtroda</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Steinfurt") {
								//		account += '<option value="R2706" selected="selected"> Steinfurt</option>';
								//	}
								//	else {
								//		account += '<option value="R2706"> Steinfurt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Stendal") {
								//		account += '<option value="W1215" selected="selected"> Stendal</option>';
								//	}
								//	else {
								//		account += '<option value="W1215" > Stendal</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "St. Ingbert (St Ingbert)") {
								//		account += '<option value="V1111" selected="selected"> St. Ingbert (St Ingbert)</option>';
								//	}
								//	else {
								//		account += '<option value="V1111"> St. Ingbert (St Ingbert)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Stralsund") {
								//		account += '<option value="N1209" selected="selected"> Stralsund</option>';
								//	}
								//	else {
								//		account += '<option value="N1209"> Stralsund</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Straubing") {
								//		account += '<option value="D3413" selected="selected"> Straubing</option>';
								//	}
								//	else {
								//		account += '<option value="D3413" > Straubing</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Stuttgart") {
								//		account += '<option value="B2609" selected="selected"> Stuttgart</option>';
								//	}
								//	else {
								//		account += '<option value="B2609"> Stuttgart</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "St. Wendel (St Wendel)") {
								//		account += '<option value="V1112" selected="selected"> St. Wendel (St Wendel)</option>';
								//	}
								//	else {
								//		account += '<option value="V1112"> St. Wendel (St Wendel)</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Suhl") {
								//		account += '<option value="Y1308" selected="selected"> Suhl</option>';
								//	}
								//	else {
								//		account += '<option value="Y1308"> Suhl</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Tostedt") {
								//		account += '<option value="P2613" selected="selected"> Tostedt</option>';
								//	}
								//	else {
								//		account += '<option value="P2613"> Tostedt</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Traunstein") {
								//		account += '<option value="D2910" selected="selected"> Traunstein</option>';
								//	}
								//	else {
								//		account += '<option value="D2910"> Traunstein</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Ulm") {
								//		account += '<option value="B2805" selected="selected"> Ulm</option>';
								//	}
								//	else {
								//		account += '<option value="B2805"> Ulm</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Völklingen") {
								//		account += '<option value="V1115" selected="selected"> Völklingen</option>';
								//	}
								//	else {
								//		account += '<option value="V1115"> Völklingen</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Walsrode") {
								//		account += '<option value="P2716" selected="selected"> Walsrode</option>';
								//	}
								//	else {
								//		account += '<option value="P2716"> Walsrode</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Weiden i. d. OPf.") {
								//		account += '<option value="D3508" selected="selected"> Weiden i. d. OPf.</option>';
								//	}
								//	else {
								//		account += '<option value="D3508"> Weiden i. d. OPf.</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Weimar") {
								//		account += '<option value="Y1114" selected="selected"> Weimar</option>';
								//	}
								//	else {
								//		account += '<option value="Y1114"> Weimar</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Wetzlar") {
								//		account += '<option value="M1710" selected="selected"> Wetzlar</option>';
								//	}
								//	else {
								//		account += '<option value="M1710"> Wetzlar</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Wiesbaden") {
								//		account += '<option value="M1906" selected="selected"> Wiesbaden</option>';
								//	}
								//	else {
								//		account += '<option value="M1906"> Wiesbaden</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Wittlich") {
								//		account += '<option value="T2408" selected="selected"> Wittlich</option>';
								//	}
								//	else {
								//		account += '<option value="T2408"> Wittlich</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Wuppertal") {
								//		account += '<option value="R1608" selected="selected"> Wuppertal</option>';
								//	}
								//	else {
								//		account += '<option value="R1608"> Wuppertal</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Würzburg") {
								//		account += '<option value="D4708" selected="selected"> Würzburg</option>';
								//	}
								//	else {
								//		account += '<option value="D4708"> Würzburg</option>';

								//	}
								//	if (ss_ort1.toString().trim() == "Zweibrücken") {
								//		account += '<option value="T3403" selected="selected"> Zweibrücken</option>';
								//	}
								//	else {
								//		account += '<option value="T3403"> Zweibrücken</option>';

								//	}
								//	account += '</select>';

								//}
								else {
									account += '<select id="Ort1Id" class="form-control input-sm" >';

									account += '<option value="" selected="selected">all</option>' +
									 '<option value="1">Aachen</option>' +
									 '<option value="2">Altenburg</option>' +
									 '<option value="3">Amberg</option>' +
									 '<option value="4">Ansbach</option>' +
									 '<option value="5">Apolda</option>' +
									 '<option value="6">Arnsberg</option>' +
									 '<option value="7">Arnstadt</option>' +
									 '<option value="8">Arnstadt Zweigstelle Ilmenau</option>' +
									 '<option value="9">Aschaffenburg</option>' +
									 '<option value="10">Augsburg</option>' +
									 '<option value="11">Aurich</option>' +
									 '<option value="12">Bad Hersfeld</option>' +
									 '<option value="13">Bad Homburg v.d.H.</option>' +
									 '<option value="14">Bad Kreuznach</option>' +
									 '<option value="15">Bad Oeynhausen</option>' +
									 '<option value="16">Bad Salzungen</option>' +
									 '<option value="17">Bamberg</option>' +
									 '<option value="18">Bayreuth</option>' +
									 '<option value="19">Berlin (Charlottenburg)</option>' +
									 '<option value="20">Bielefeld</option>' +
									 '<option value="21">Bochum</option>' +
									 '<option value="22">Bonn</option>' +
									 '<option value="23">Braunschweig</option>' +
									 '<option value="24">Bremen</option>' +
									 '<option value="25">Chemnitz</option>' +
									 '<option value="26">Coburg</option>' +
									 '<option value="27">Coesfeld</option>' +
									 '<option value="28">Cottbus</option>' +
									 '<option value="29">Darmstadt</option>' +
									 '<option value="30">Deggendorf</option>' +
									 '<option value="31">Dortmund</option>' +
									 '<option value="32">Dresden</option>' +
									 '<option value="33">Duisburg</option>' +
									 '<option value="34">Düren</option>' +
									 '<option value="35">Düsseldorf</option>' +
									 '<option value="36">Eisenach</option>' +
									 '<option value="37">Erfurt</option>' +
									 '<option value="38">Eschwege</option>' +
									 '<option value="39">Essen</option>' +
									 '<option value="40">Flensburg</option>' +
									 '<option value="41">Frankfurt am Main</option>' +
									 '<option value="42">Frankfurt/Oder</option>' +
									 '<option value="43">Freiburg</option>' +
									 '<option value="44">Friedberg</option>' +
									 '<option value="45">Fritzlar</option>' +
									 '<option value="46">Fulda</option>' +
									 '<option value="47">Fürth</option>' +
									 '<option value="48">Gelsenkirchen</option>' +
									 '<option value="49">Gera</option>' +
									 '<option value="50">Gießen</option>' +
									 '<option value="51">Gotha</option>' +
									 '<option value="52">Greiz</option>' +
									 '<option value="53">Göttingen</option>' +
									 '<option value="54">Gütersloh</option>' +
									 '<option value="55">Hagen</option>' +
									 '<option value="56">Hamburg</option>' +
									 '<option value="57">Hamm</option>' +
									 '<option value="58">Hanau</option>' +
									 '<option value="59">Hannover</option>' +
									 '<option value="60">Heilbad Heiligenstadt</option>' +
									 '<option value="61">Hildburghausen</option>' +
									 '<option value="62">Hildesheim</option>' +
									 '<option value="63">Hof</option>' +
									 '<option value="64">Homburg</option>' +
									 '<option value="65">Ingolstadt</option>' +
									 '<option value="66">Iserlohn</option>' +
									 '<option value="67">Jena</option>' +
									 '<option value="68">Kaiserslautern</option>' +
									 '<option value="69">Kassel</option>' +
									 '<option value="70">Kempten (Allgäu)</option>' +
									 '<option value="71">Kiel</option>' +
									'<option value="72">Kleve</option>' +
									'<option value="73">Koblenz</option>' +
									'<option value="74">Korbach</option>' +
									'<option value="75">Krefeld</option>' +
									'<option value="76">Köln</option>' +
									'<option value="77">Königstein</option>' +
									'<option value="78">Landau</option>' +
									'<option value="79">Landshut</option>' +
									'<option value="80">Langenfeld</option>' +
									 '<option value="81">Lebach</option>' +
									 '<option value="82">Leipzig</option>' +
									 '<option value="83">Lemgo</option>' +
									 '<option value="84">Limburg</option>' +
									 '<option value="85">Ludwigshafen a.Rhein (Ludwigshafen)</option>' +
                                     '<option value="86">Lübeck</option>' +
                                     '<option value="87">Lüneburg</option>' +
									 '<option value="88">Mainz</option>' +
									 '<option value="89">Mannheim</option>' +
									 '<option value="90">Marburg</option>' +
									 '<option value="91">Meiningen</option>' +
									 '<option value="92">Memmingen</option>' +
									 '<option value="93">Merzig</option>' +
                                     '<option value="94">Montabaur</option>' +
									 '<option value="95">Mönchengladbach</option>' +
									 '<option value="96">Mühlhausen</option>' +
									 '<option value="97">München</option>' +
									 '<option value="98">Münster</option>' +
									 '<option value="99">Neubrandenburg</option>' +
									 '<option value="100">Neunkirchen</option>' +
									 '<option value="101">Neuruppin</option>' +
									 '<option value="102">Neuss</option>' +
									 '<option value="103">Nordhausen</option>' +
									 '<option value="104">Nürnberg</option>' +
									 '<option value="105">Offenbach am Main</option>' +
									 '<option value="106">Oldenburg (Oldenburg)</option>' +
									 '<option value="107">Osnabrück</option>' +
									 '<option value="108">Ottweiler</option>' +
									 '<option value="109">Paderborn</option>' +
									 '<option value="110">Passau</option>' +
									 '<option value="111">Pinneberg</option>' +
                                     '<option value="112">Potsdam</option>' +
									 '<option value="113">Pößneck</option>' +
									 '<option value="114">Pößneck Zweigstelle Bad Lobenstein</option>' +

									 '<option value="115">Recklinghausen</option>' +
									 '<option value="116">Regensburg</option>' +
									 '<option value="117">Rostock</option>' +
									 '<option value="118">Rudolstadt</option>' +
									 '<option value="119">Rudolstadt Zweigstelle Saalfeld</option>' +
									 '<option value="120">Saarbrücken</option>' +
									 '<option value="121">Saarlouis</option>' +
									 '<option value="122">Schweinfurt</option>' +
									 '<option value="123">Schwerin</option>' +
									 '<option value="124">Siegburg</option>' +
									 '<option value="125">Siegen</option>' +
									//'<option value="126">Sömmerda</option>' +
									'<option value="126">Sondershausen</option>' +
									'<option value="127">Sonneberg</option>' +
                                    '<option value="128">St. Ingbert (St Ingbert)</option>' +
                                    '<option value="129">St. Wendel (St Wendel)</option>' +
									'<option value="130">Stadthagen</option>' +
									'<option value="131">Stadtroda</option>' +
									'<option value="132">Steinfurt</option>' +
									'<option value="133">Stendal</option>' +
									//'<option value="133">St. Ingbert (St Ingbert)</option>' +
									'<option value="134">Stralsund</option>' +
									'<option value="135">Straubing</option>' +
									'<option value="136">Stuttgart</option>' +
									//'<option value="137">St. Wendel (St Wendel)</option>' +
									'<option value="137">Suhl</option>' +
                                    '<option value="138">Sömmerda</option>' +
									'<option value="139">Tostedt</option>' +
									'<option value="140">Traunstein</option>' +
									 '<option value="141">Ulm</option>' +
									 '<option value="142">Völklingen</option>' +
									 '<option value="143">Walsrode</option>' +
									 '<option value="144">Weiden i. d. OPf.</option>' +
									 '<option value="145">Weimar</option>' +
									 '<option value="146">Wetzlar</option>' +
									 '<option value="147">Wiesbaden</option>' +
									 '<option value="148">Wittlich</option>' +
									 '<option value="149">Wuppertal</option>' +
									 '<option value="150">Würzburg</option>' +
									 '<option value="151">Zweibrücken</option>' +
								 '</select>';
								}


								account += ' </div>' +
											 ' <div class="col-md-2">' +
												 '  <label class="control-label">Rechtsform</label>';


								if (ss_rechtsformoptionset != null) {
								    account += '<select id="RechtsformId" onchange="updateAccount(this)" style="width:140px" class="form-control">' +
											   '<option value="">Wählen</option>';
								    if (ss_rechtsformoptionset == 1) {
								        account += '<option value="1" selected="selected">Aktiengesellschaft</option>';
								    }
								    else {
								        account += '<option value="1">Aktiengesellschaft</option>';
								    }

								    if (ss_rechtsformoptionset == 2) {
								        account += '<option value="2" selected="selected">eingetragene Genossenschaft</option>';
								    }
								    else {
								        account += '<option value="2">eingetragene Genossenschaft</option>';
								    }
								    if (ss_rechtsformoptionset == 3) {
								        account += '<option value="3" selected="selected">Einzelkaufmann</option>';
								    }
								    else {
								        account += '<option value="3">Einzelkaufmann</option>';
								    }
								    if (ss_rechtsformoptionset == 4) {
								        account += '<option value="4" selected="selected">Europäische wirtschaftliche Interessenvereinigung</option>';
								    }
								    else {
								        account += '<option value="4">Europäische wirtschaftliche Interessenvereinigung</option>';
								    }
								    if (ss_rechtsformoptionset == 5) {
								        account += '<option value="5" selected="selected">Gesellschaft mit beschränkter Haftung</option>';
								    }
								    else {
								        account += '<option value="5">Gesellschaft mit beschränkter Haftung</option>';
								    }
								    if (ss_rechtsformoptionset == 6) {
								        account += '<option value="6" selected="selected">GmbH &amp; Co. KG</option>';
								    }
								    else {
								        account += '<option value="6">GmbH &amp; Co. KG</option>';
								    }
								    if (ss_rechtsformoptionset == 7) {
								        account += '<option value="7" selected="selected">Gmbh &amp; Co. OHG</option>';
								    }
								    else {
								        account += '<option value="7">Gmbh &amp; Co. OHG</option>';
								    }
								    if (ss_rechtsformoptionset == 8) {
								        account += '<option value="8" selected="selected">Kommanditgesellschaft</option>';
								    }
								    else {
								        account += '<option value="8">Kommanditgesellschaft</option>';
								    }
								    if (ss_rechtsformoptionset == 9) {
								        account += '<option value="9" selected="selected">Kommanditgesellschaft auf Aktien</option>';
								    }
								    else {
								        account += '<option value="9">Kommanditgesellschaft auf Aktien</option>';
								    }
								    if (ss_rechtsformoptionset == 10) {
								        account += '<option value="10" selected="selected">Offene Handelsgesellschaft</option>';
								    }
								    else {
								        account += '<option value="10">Offene Handelsgesellschaft</option>';
								    }
								    if (ss_rechtsformoptionset == 11) {
								        account += '<option value="11" selected="selected">Partner</option>';
								    }
								    else {
								        account += '<option value="11">Partner</option>';
								    }
								    if (ss_rechtsformoptionset == 12) {
								        account += '<option value="12" selected="selected">Rechtsform ausländischen Rechts HRA</option>';
								    }
								    else {
								        account += '<option value="12">Rechtsform ausländischen Rechts HRA</option>';
								    }
								    if (ss_rechtsformoptionset == 13) {
								        account += '<option value="13" selected="selected">Rechtsform ausländischen Rechts HRB</option>';
								    }
								    else {
								        account += '<option value="13">Rechtsform ausländischen Rechts HRB</option>';
								    }
								    if (ss_rechtsformoptionset == 14) {
								        account += '<option value="14" selected="selected">Rechtsform ausländischen Rechts GnR</option>';
								    }
								    else {
								        account += '<option value="14">Rechtsform ausländischen Rechts GnR</option>';
								    }
								    if (ss_rechtsformoptionset == 15) {
								        account += '<option value="15" selected="selected">Rechtsform ausländischen Rechts PR</option>';
								    }
								    else {
								        account += '<option value="15">Rechtsform ausländischen Rechts PR</option>';
								    }
								    if (ss_rechtsformoptionset == 16) {
								        account += '<option value="16" selected="selected">Societas Europaea (SE)</option>';
								    }
								    else {
								        account += '<option value="16">Societas Europaea (SE)</option>';
								    }
								    if (ss_rechtsformoptionset == 17) {
								        account += '<option value="17" selected="selected">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								    }
								    else {
								        account += '<option value="17">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								    }
								    if (ss_rechtsformoptionset == 18) {
								        account += '<option value="18" selected="selected">Stiftung (bürgerlichen Rechts)</option>';
								    }
								    else {
								        account += '<option value="18">Stiftung (bürgerlichen Rechts)</option>';
								    }
								    if (ss_rechtsformoptionset == 19) {
								        account += '<option value="19" selected="selected">Verein</option>';
								    }
								    else {
								        account += '<option value="19">Verein</option>';
								    }
								    if (ss_rechtsformoptionset == 20) {
								        account += '<option value="20" selected="selected">Versicherungsverein auf Gegenseitigkeit</option>';
								    }
								    else {
								        account += '<option value="20">Versicherungsverein auf Gegenseitigkeit</option>';
								    }

								    account += '</select>';
								}


								//if (ss_rechtsform != null) {
								//	//account += ' <input type="text" name="RechtsformId" value = "' + ss_rechtsform + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
								//	account += '<select id="RechtsformId" onchange="updateAccount(this)" style="width:140px" class="form-control">' +
								//			   '<option value="">Wählen</option>';
								//	if (ss_rechtsform == "Aktiengesellschaft") {
								//		account += '<option value="Aktiengesellschaft" selected="selected">Aktiengesellschaft</option>';
								//	}
								//	else {
								//		account += '<option value="Aktiengesellschaft">Aktiengesellschaft</option>';
								//	}

								//	if (ss_rechtsform == "eingetragene Genossenschaft") {
								//		account += '<option value="eingetragene Genossenschaft" selected="selected">eingetragene Genossenschaft</option>';
								//	}
								//	else {
								//		account += '<option value="eingetragene Genossenschaft">eingetragene Genossenschaft</option>';
								//	}
								//	if (ss_rechtsform == "Einzelkaufmann") {
								//		account += '<option value="Einzelkaufmann" selected="selected">Einzelkaufmann</option>';
								//	}
								//	else {
								//		account += '<option value="Einzelkaufmann">Einzelkaufmann</option>';
								//	}
								//	if (ss_rechtsform == "Europäische wirtschaftliche Interessenvereinigung") {
								//		account += '<option value="Europäische wirtschaftliche Interessenvereinigung" selected="selected">Europäische wirtschaftliche Interessenvereinigung</option>';
								//	}
								//	else {
								//		account += '<option value="Europäische wirtschaftliche Interessenvereinigung">Europäische wirtschaftliche Interessenvereinigung</option>';
								//	}
								//	if (ss_rechtsform == "Gesellschaft mit beschränkter Haftung") {
								//		account += '<option value="Gesellschaft mit beschränkter Haftung" selected="selected">Gesellschaft mit beschränkter Haftung</option>';
								//	}
								//	else {
								//		account += '<option value="Gesellschaft mit beschränkter Haftung">Gesellschaft mit beschränkter Haftung</option>';
								//	}
								//	if (ss_rechtsform == "GmbH &amp; Co. KG") {
								//		account += '<option value="GmbH &amp; Co. KG" selected="selected">GmbH &amp; Co. KG</option>';
								//	}
								//	else {
								//		account += '<option value="GmbH &amp; Co. KG">GmbH &amp; Co. KG</option>';
								//	}
								//	if (ss_rechtsform == "Gmbh &amp; Co. OHG") {
								//		account += '<option value="Gmbh &amp; Co. OHG" selected="selected">Gmbh &amp; Co. OHG</option>';
								//	}
								//	else {
								//		account += '<option value="Gmbh &amp; Co. OHG">Gmbh &amp; Co. OHG</option>';
								//	}
								//	if (ss_rechtsform == "Kommanditgesellschaft") {
								//		account += '<option value="Kommanditgesellschaft" selected="selected">Kommanditgesellschaft</option>';
								//	}
								//	else {
								//		account += '<option value="Kommanditgesellschaft">Kommanditgesellschaft</option>';
								//	}
								//	if (ss_rechtsform == "Kommanditgesellschaft auf Aktien") {
								//		account += '<option value="Kommanditgesellschaft auf Aktien" selected="selected">Kommanditgesellschaft auf Aktien</option>';
								//	}
								//	else {
								//		account += '<option value="Kommanditgesellschaft auf Aktien">Kommanditgesellschaft auf Aktien</option>';
								//	}
								//	if (ss_rechtsform == "Offene Handelsgesellschaft") {
								//		account += '<option value="Offene Handelsgesellschaft" selected="selected">Offene Handelsgesellschaft</option>';
								//	}
								//	else {
								//		account += '<option value="Offene Handelsgesellschaft">Offene Handelsgesellschaft</option>';
								//	}
								//	if (ss_rechtsform == "Partner") {
								//		account += '<option value="Partner" selected="selected">Partner</option>';
								//	}
								//	else {
								//		account += '<option value="Partner">Partner</option>';
								//	}
								//	if (ss_rechtsform == "Rechtsform ausländischen Rechts HRA") {
								//		account += '<option value="Rechtsform ausländischen Rechts HRA" selected="selected">Rechtsform ausländischen Rechts HRA</option>';
								//	}
								//	else {
								//		account += '<option value="Rechtsform ausländischen Rechts HRA">Rechtsform ausländischen Rechts HRA</option>';
								//	}
								//	if (ss_rechtsform == "Rechtsform ausländischen Rechts HRB") {
								//		account += '<option value="Rechtsform ausländischen Rechts HRB" selected="selected">Rechtsform ausländischen Rechts HRB</option>';
								//	}
								//	else {
								//		account += '<option value="Rechtsform ausländischen Rechts HRB">Rechtsform ausländischen Rechts HRB</option>';
								//	}
								//	if (ss_rechtsform == "Rechtsform ausländischen Rechts GnR") {
								//		account += '<option value="Rechtsform ausländischen Rechts GnR" selected="selected">Rechtsform ausländischen Rechts GnR</option>';
								//	}
								//	else {
								//		account += '<option value="Rechtsform ausländischen Rechts GnR">Rechtsform ausländischen Rechts GnR</option>';
								//	}
								//	if (ss_rechtsform == "Rechtsform ausländischen Rechts PR") {
								//		account += '<option value="Rechtsform ausländischen Rechts PR" selected="selected">Rechtsform ausländischen Rechts PR</option>';
								//	}
								//	else {
								//		account += '<option value="Rechtsform ausländischen Rechts PR">Rechtsform ausländischen Rechts PR</option>';
								//	}
								//	if (ss_rechtsform == "Societas Europaea (SE)") {
								//		account += '<option value="Societas Europaea (SE)" selected="selected">Societas Europaea (SE)</option>';
								//	}
								//	else {
								//		account += '<option value="Societas Europaea (SE)">Societas Europaea (SE)</option>';
								//	}
								//	if (ss_rechtsform == "Sonstiges (z.B. Behörde, Kommunde, etc.)") {
								//		account += '<option value="Sonstiges (z.B. Behörde, Kommune, etc.)" selected="selected">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								//	}
								//	else {
								//		account += '<option value="Sonstiges (z.B. Behörde, Kommune, etc.)">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>';
								//	}
								//	if (ss_rechtsform == "Stiftung (bürgerlichen Rechts)") {
								//		account += '<option value="Stiftung (bürgerlichen Rechts)" selected="selected">Stiftung (bürgerlichen Rechts)</option>';
								//	}
								//	else {
								//		account += '<option value="Stiftung (bürgerlichen Rechts)">Stiftung (bürgerlichen Rechts)</option>';
								//	}
								//	if (ss_rechtsform == "Verein") {
								//		account += '<option value="Verein" selected="selected">Verein</option>';
								//	}
								//	else {
								//		account += '<option value="Verein">Verein</option>';
								//	}
								//	if (ss_rechtsform == "Versicherungsverein auf Gegenseitigkeit") {
								//		account += '<option value="Versicherungsverein auf Gegenseitigkeit" selected="selected">Versicherungsverein auf Gegenseitigkeit</option>';
								//	}
								//	else {
								//		account += '<option value="Versicherungsverein auf Gegenseitigkeit">Versicherungsverein auf Gegenseitigkeit</option>';
								//	}

								//	account += '</select>';
								//}
								else {
									// account += ' <input type="text" name="RechtsformId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';
									account += '<select id="RechtsformId"  onchange="updateAccount(this)" style="width:140px" class="form-control">' +
												 '<option value="">Wählen</option>' +
												 '<option value="1">Aktiengesellschaft</option>' +
												 '<option value="2">eingetragene Genossenschaft</option>' +
												 '<option value="3">Einzelkaufmann</option>' +
												 '<option value="4">Europäische wirtschaftliche Interessenvereinigung</option>' +
												 '<option value="5">Gesellschaft mit beschränkter Haftung</option>' +
												 '<option value="6">GmbH &amp; Co. KG</option>' +
												' <option value="7">Gmbh &amp; Co. OHG</option>' +
												 '<option value="8">Kommanditgesellschaft</option>' +
												 '<option value="9">Kommanditgesellschaft auf Aktien</option>' +
												' <option value="10">Offene Handelsgesellschaft</option>' +
												' <option value="11">Partner</option>' +
												 '<option value="12">Rechtsform ausländischen Rechts HRA</option>' +
												 '<option value="13">Rechtsform ausländischen Rechts HRB</option>' +
												' <option value="14">Rechtsform ausländischen Rechts GnR</option>' +
												' <option value="15">Rechtsform ausländischen Rechts PR</option>' +
												' <option value="16">Societas Europaea (SE)</option>' +
												 '<option value="17">Sonstiges (z.B. Behörde, Kommunde, etc.)</option>' +
												 '<option value="18">Stiftung (bürgerlichen Rechts)</option>' +
												 '<option value="19">Verein</option>' +
												' <option value="20">Versicherungsverein auf Gegenseitigkeit</option>' +
											' </select>';
								}

								account += '  </div>' +
											' <div class="col-md-3">' +
												' <label class="control-label">Steuerschlüssel</label>';


								if (ss_steuerschluesseloptionset != null) {

								    account += '<select id="SteuerschlüsselId" onchange="updateAccount(this)" class="form-control">' +
											   '<option value="">Wählen</option>';
								    if (ss_steuerschluesseloptionset == 1) {
								        account += '<option value="1" selected="selected">Deutschland</option>';
								    }
								    else {
								        account += '<option value="1">Deutschland</option>';
								    }
								    if (ss_steuerschluesseloptionset == 2) {
								        account += '<option value="2" selected="selected">Freihafen; Zollausschlussgebiet</option>';
								    }
								    else {
								        account += '<option value="2">Freihafen; Zollausschlussgebiet</option>';
								    }
								    if (ss_steuerschluesseloptionset == 3) {
								        account += '<option value="3" selected="selected">EU-Ausland</option>';
								    }
								    else {
								        account += '<option value="3">EU-Ausland</option>';
								    }

								    if (ss_steuerschluesseloptionset == 4) {
								        account += '<option value="4" selected="selected">Nicht-EU-Ausland</option>';
								    }
								    else {
								        account += '<option value="4">Nicht-EU-Ausland</option>';
								    }
								    if (ss_steuerschluesseloptionset == 5) {
								        account += '<option value="5" selected="selected">internationale Institutionen</option>';
								    }
								    else {
								        account += '<option value="5">internationale Institutionen</option>';
								    }
								    if (ss_steuerschluesseloptionset == 6) {
								        account += '<option value="6" selected="selected">NATO-Truppen</option>';
								    }
								    else {
								        account += '<option value="6">NATO-Truppen</option>';
								    }

								    account += '</select>';
								}


								//if (ss_steuerschlssel != null) {

								//	account += '<select id="SteuerschlüsselId" onchange="updateAccount(this)" class="form-control">' +
								//			   '<option value="">Wählen</option>';
								//	if (ss_steuerschlssel == "Deutschland") {
								//		account += '<option value="Deutschland" selected="selected">Deutschland</option>';
								//	}
								//	else {
								//		account += '<option value="Deutschland">Deutschland</option>';
								//	}
								//	if (ss_steuerschlssel == "Freihafen; Zollausschlussgebiet") {
								//		account += '<option value="Freihafen; Zollausschlussgebiet" selected="selected">Freihafen; Zollausschlussgebiet</option>';
								//	}
								//	else {
								//		account += '<option value="Freihafen; Zollausschlussgebiet">Freihafen; Zollausschlussgebiet</option>';
								//	}
								//	if (ss_steuerschlssel == "EU-Ausland") {
								//		account += '<option value="EU-Ausland" selected="selected">EU-Ausland</option>';
								//	}
								//	else {
								//		account += '<option value="EU-Ausland">EU-Ausland</option>';
								//	}

								//	if (ss_steuerschlssel == "Nicht-EU-Ausland") {
								//		account += '<option value="Nicht-EU-Ausland" selected="selected">Nicht-EU-Ausland</option>';
								//	}
								//	else {
								//		account += '<option value="Nicht-EU-Ausland">Nicht-EU-Ausland</option>';
								//	}
								//	if (ss_steuerschlssel == "internationale Institutionen") {
								//		account += '<option value="internationale Institutionen" selected="selected">internationale Institutionen</option>';
								//	}
								//	else {
								//		account += '<option value="internationale Institutionen">internationale Institutionen</option>';
								//	}
								//	if (ss_steuerschlssel == "NATO-Truppen") {
								//		account += '<option value="NATO-Truppen" selected="selected">NATO-Truppen</option>';
								//	}
								//	else {
								//		account += '<option value="NATO-Truppen">NATO-Truppen</option>';
								//	}

								//	account += '</select>';

								//	//  account += ' <input type="text" name="SteuerschlüsselId" value = "' + ss_steuerschlssel + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
								//}
								else {
									account += '<select id="SteuerschlüsselId" class="form-control" onchange="updateAccount(this)">' +
												'<option value="" selected="selected">Wählen</option>' +
												'<option value="1">Deutschland</option>' +
												'<option value="2">Freihafen; Zollausschlussgebiet</option>' +
												'<option value="3">EU-Ausland</option>' +
												'<option value="4">Nicht-EU-Ausland</option>' +
												'<option value="5">internationale Institutionen</option>' +
												'<option value="6">NATO-Truppen</option>' +
											   '</select>';

									//account += ' <input type="text" name="SteuerschlüsselId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';

								}

								account += ' </div>' +
										  ' </div>' +
										  '  <div class="row form-group">' +
											  '  <div class="col-md-12">' +
												  ' <label class="control-label">Abweichende Rechnungsanschrift:</label>';

								if (ss_abweichenderechnungsanschrift == true) {

									account += ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" checked="checked" disabled="disabled">Ja' +
									' </label>' +
									' <label class="radio-inline">' +
										'<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" disabled="disabled">Nein' +
									'  </label>';

								}
								else {
									account += ' <label class="radio-inline">' +
							 ' <input type="radio" value="Ja" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioJa" disabled="disabled">Ja' +
							 ' </label>' +
							 ' <label class="radio-inline">' +
								 '<input type="radio" value="Nein" onclick="CheckAbweichendeRechnungsanschrift(this)" name="AbweichendeOptradioNein" checked="checked" disabled="disabled">Nein' +
							 '  </label>';
								}

								if (ss_abweichenderechnungsanschrift == true) {
									account += '  </div>' +
												 '  </div>' +
											 ' <div class="row form-group">' +
												 '  <div class="col-md-4">' +
													 ' <label class="control-label">Firmenname</label>';
									if (ss_firmenname1 != null) {
										account += ' <input type="text" name="Firmenname1Id" value = "' + ss_firmenname1 + '" onchange="updateAccount(this)" maxlength="155" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Firmenname1Id" onchange="updateAccount(this)" maxlength="155" class="form-control input-sm"  />';

									}

									account += ' </div>' +
															' <div class="col-md-2">' +
																' <label class="control-label">Vorname</label>';

									if (ss_vorname1 != null) {
										account += ' <input type="text" name="Vorname1Id" value = "' + ss_vorname1 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Vorname1Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm"  />';

									}

									account += ' </div>' +
																		' <div class="col-md-2">' +
																			' <label class="control-label">Nachname</label>';

									if (ss_nachname1 != null) {
										account += ' <input type="text" name="NameId" value = "' + ss_nachname1 + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="NameId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';

									}

									account += ' </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Abteilung</label>';

									if (ss_abteilung1 != null) {
										account += ' <input type="text" name="AbteilungId" value = "' + ss_abteilung1 + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="AbteilungId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm"  />';

									}

									account += ' </div>' +
									 ' <div class="col-md-3">' +
										 ' <label class="control-label">Strasse:</label>';

									if (ss_strasse1 != null) {


										account += ' <input type="text" name="Strasse1Id" value = "' + ss_strasse1 + '" onchange="updateAccount(this)" maxlength="60" class="form-control input-sm" />';

									}
									else {
										account += ' <input type="text" name="Strasse1Id" onchange="updateAccount(this)" maxlength="60" class="form-control input-sm"  />';

									}

									if (ss_nr1 != null) {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Nr.:</label>' +
													' <input type="text" name="Nr1Id" value = "' + ss_nr1 + '" onchange="updateAccount(this)" maxlength="40" class="form-control input-sm" />' +
												' </div>';
									}
									else {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Nr.:</label>' +
													' <input type="text" name="Nr1Id" onchange="updateAccount(this)" maxlength="40" class="form-control input-sm" />' +
												' </div>';

									}

									account += ' <div class="col-md-2">' +
											   ' <label class="control-label">PLZ:</label>';
									if (ss_plz1 != null) {
										account += ' <input type="text" name="PLZ1Id" value = "' + ss_plz1 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="PLZ1Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm"  />';

									}

									account += '   </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label">Ort:</label>';
									if (ss_ort11 != null) {
										account += ' <input type="text" name="Ort2Id" value = "' + ss_ort11 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Ort2Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm"  />';

									}

									account += '  </div>' +
											  '   </div>' +
											  '  <div class="row form-group">' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label">Telefon:</label>';
									if (ss_telefon1 != null) {
										account += ' <input type="text" name="Telefon1Id" value = "' + ss_telefon1 + '" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Telefon1Id" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm"  />';

									}


									account += ' </div>' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label">Fax:</label>';
									if (ss_fax1 != null) {
										account += ' <input type="text" name="Fax1Id" value = "' + ss_fax1 + '" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Fax1Id" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm"  />';

									}
									account += ' </div>' +
											   ' <div class="col-md-4">' +
												   ' <label class="control-label">Email:</label>';
									if (ss_email1 != null) {
										account += ' <input type="text" name="Email1Id" value = "' + ss_email1 + '" onchange="updateAccount(this)" class="form-control input-sm" />';
									}
									else {
										account += ' <input type="text" name="Email1Id" onchange="updateAccount(this)" class="form-control input-sm"  />';

									}

									account += '</div>' +
									   ' </div>' +
										'<hr style="border-top: dotted 2px;" />' +
										'<div class="row form-group">' +
													' <div class="col-md-4">' +
														'<label class="control-label">UREG</label>';
									if (ss_ureg != null) {
										account += '   <input name="UREGId" value = "' + ss_ureg + '" onchange="updateUREG(this)"  maxlength="15" class="form-control input-sm" type="text">';
									}
									else {
										account += '   <input name="UREGId" onchange="updateUREG(this)"  maxlength="15" class="form-control input-sm" type="text">';

									}
									account += ' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">Cockpit Type:</label>';
									if (ss_cockpittype == 1) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit" selected="selected">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									else if (ss_cockpittype == 2) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit" selected="selected">PR Cockpit</option></select>';

									}
									else {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									account += '</div>' +
													'<div class="col-md-4">' +
														' <label class="control-label">Anzeige im Cockpit-Admin:</label>';
									if (ss_anzeigeimcockpitadmin == true) {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja"  checked="checked">Ja</label>' +
													   '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" name="AnzeigeimCockpitAdmin" style="margin-left: 50px" value="Nein">Nein</label>';
									}
									else {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
													  '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" name="AnzeigeimCockpitAdmin" style="margin-left: 50px" value="Nein" checked="checked">Nein</label>';
									}

									account += ' </div>' +
												' </div>' +
						'  </form>';
								}
								else {
									account += '  </div>' +
											 '  </div>' +
										 ' <div class="row form-group">' +
											 '  <div class="col-md-4">' +
												 ' <label class="control-label" style="display:none">Firmenname</label>';
									if (ss_firmenname1 != null) {
										account += ' <input type="text" name="Firmenname1Id" value = "' + ss_firmenname1 + '" onchange="updateAccount(this)" maxlength="155" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Firmenname1Id" onchange="updateAccount(this)" maxlength="155" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
															' <div class="col-md-2">' +
																' <label class="control-label" style="display:none">Vorname</label>';

									if (ss_vorname1 != null) {
										account += ' <input type="text" name="Vorname1Id" value = "' + ss_vorname1 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="Vorname1Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
																		' <div class="col-md-2">' +
																			' <label class="control-label" style="display:none">Nachname</label>';

									if (ss_nachname1 != null) {
										account += ' <input type="text" name="NameId" value = "' + ss_nachname1 + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="NameId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Abteilung</label>';

									if (ss_abteilung1 != null) {
										account += ' <input type="text" name="AbteilungId" value = "' + ss_abteilung1 + '" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="AbteilungId" onchange="updateAccount(this)" maxlength="100" class="form-control input-sm" style="display:none" />';

									}

									account += ' </div>' +
									 ' <div class="col-md-3">' +
										 ' <label class="control-label" style="display:none">Strasse:</label>';

									if (ss_strasse1 != null) {


										account += ' <input type="text" name="Strasse1Id" value = "' + ss_strasse1 + '" onchange="updateAccount(this)" maxlength="60" class="form-control input-sm" style="display:none" />';

									}
									else {
										account += ' <input type="text" name="Strasse1Id" onchange="updateAccount(this)" maxlength="60" class="form-control input-sm" style="display:none" />';

									}

									if (ss_nr1 != null) {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Nr.:</label>' +
													' <input type="text" name="Nr1Id" value = "' + ss_nr1 + '" onchange="updateAccount(this)" maxlength="40" class="form-control input-sm" style="display:none" />' +
												' </div>';
									}
									else {

										account += '</div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Nr.:</label>' +
													' <input type="text" name="Nr1Id" onchange="updateAccount(this)" maxlength="40" class="form-control input-sm" style="display:none" />' +
												' </div>';

									}

									account += ' <div class="col-md-2">' +
											   ' <label class="control-label" style="display:none">PLZ:</label>';
									if (ss_plz1 != null) {
										account += ' <input type="text" name="PLZ1Id" value = "' + ss_plz1 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="PLZ1Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none" />';

									}

									account += '   </div>' +
												' <div class="col-md-2">' +
													' <label class="control-label" style="display:none">Ort:</label>';
									if (ss_ort11 != null) {
										account += ' <input type="text" name="Ort2Id" value = "' + ss_ort11 + '" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none" />';
									}
									else {
										account += ' <input type="text" name="Ort2Id" onchange="updateAccount(this)" maxlength="32" class="form-control input-sm" style="display:none" />';

									}

									account += '  </div>' +
											  '   </div>' +
											  '  <div class="row form-group">' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label" style="display:none">Telefon:</label>';
									if (ss_telefon1 != null) {
										account += ' <input type="text" name="Telefon1Id" value = "' + ss_telefon1 + '" maxlength="22" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Telefon1Id" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" style="display:none" />';

									}


									account += ' </div>' +
												  ' <div class="col-md-4">' +
													  '  <label class="control-label" style="display:none">Fax:</label>';
									if (ss_fax1 != null) {
										account += ' <input type="text" name="Fax1Id" value = "' + ss_fax1 + '" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Fax1Id" onchange="updateAccount(this)" maxlength="22" class="form-control input-sm" style="display:none" />';

									}
									account += ' </div>' +
											   ' <div class="col-md-4">' +
												   ' <label class="control-label" style="display:none">Email:</label>';
									if (ss_email1 != null) {
										account += ' <input type="text" name="Email1Id" value = "' + ss_email1 + '" onchange="updateAccount(this)" class="form-control input-sm" style="display:none"/>';
									}
									else {
										account += ' <input type="text" name="Email1Id" onchange="updateAccount(this)" class="form-control input-sm" style="display:none" />';

									}

									account += '</div>' +
								  ' </div>' +
								  '<hr style="border-top: dotted 2px;" />' +
								   '<div class="row form-group">' +
											   ' <div class="col-md-4">' +
												   '<label class="control-label">UREG</label>';
									if (ss_ureg != null) {
										account += '   <input name="UREGId" value = "' + ss_ureg + '" onchange="updateUREG(this)" class="form-control input-sm" type="text">';
									}
									else {
										account += '   <input name="UREGId" onchange="updateUREG(this)" class="form-control input-sm" type="text">';

									}
									account += ' </div>' +
									'<div class="col-md-4">' +
										' <label class="control-label">Cockpit Type:</label>';
									if (ss_cockpittype == 1) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit" selected="selected">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									else if (ss_cockpittype == 2) {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit" selected="selected">PR Cockpit</option></select>';

									}
									else {
										account += '<select id="CockpitTypeDrp" class="form-control" onchange="updateCockpitType(this)"><option value="none"></option><option value="IRCockpit">IR Cockpit</option><option value="PRCockpit">PR Cockpit</option></select>';
									}
									account += '</div>' +
													'<div class="col-md-4">' +
														' <label class="control-label">Anzeige im Cockpit-Admin:</label>';
									if (ss_anzeigeimcockpitadmin == true) {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja"  checked="checked">Ja</label>' +
													   '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" name="AnzeigeimCockpitAdmin" value="Nein">Nein</label>';
									}
									else {
										account += '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminJa" name="AnzeigeimCockpitAdmin" value="Ja">Ja</label>' +
													  '<label><input onchange="updateAnzeigeimCockpitAdmin(this)" type="radio" id="AnzeigeimCockpitAdminNien" name="AnzeigeimCockpitAdmin" value="Nein" checked="checked">Nein</label>';
									}

									account += ' </div>' +
												' </div>' +
						'  </form>';
								}

							}
							displayDownloadLinks();
							$("#accountList").html(account);
							if (companiesName.length > 0) {
								SimilarAccounts();
							}
							else {
								request--
								if (request == 0) {
									hideLoadingMessage();
									$(".loder-text p").html("");
								}
							}
						}
						else {
							hideLoadingMessage();
							$(".loder-text p").html("");
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in retrieveDummyRecords");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();

						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in retrieveDummyRecords catch");
			}
		}

		function updateUREG(input) {
			try {
				var accountid = $(input).closest('form').attr('id');
				var UREGVal = input.value;

				if (UREGVal != null && UREGVal != "") {
					var entity = {};
					//entity.ss_anzeigeimcockpitadmin = false;
					//entity.ss_cockpittype = 1;
					entity.ss_ureg = UREGVal;

					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								//Success - No Return Data - Do Something
							} else {

								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in updateUREG");
								//  opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateUREG catch");
			}
		}

		function updateCockpitType(select) {
			try {
				var accountid = $(select).closest('form').attr('id');

				var CockpitType = $(select).find('option:selected').val();

				if (CockpitType != null && CockpitType != undefined) {
					var entity = {};

					if (CockpitType == "IRCockpit") {
						entity.ss_cockpittype = 1;
					}
					else if (CockpitType == "PRCockpit") {
						entity.ss_cockpittype = 2;
					}

					var req = new XMLHttpRequest();
					req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", true);
					req.setRequestHeader("OData-MaxVersion", "4.0");
					req.setRequestHeader("OData-Version", "4.0");
					req.setRequestHeader("Accept", "application/json");
					req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req.onreadystatechange = function () {
						if (this.readyState === 4) {
							req.onreadystatechange = null;
							if (this.status === 204) {
								//Success - No Return Data - Do Something
							} else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in updateCockpitType");
								// opener.Xrm.Utility.alertDialog(this.responseText);
								window.close();
							}
						}
					};
					req.send(JSON.stringify(entity));
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateCockpitType catch");
			}
		}
		function updateAnzeigeimCockpitAdmin(radio) {
			try {
				var accountid = $(radio).closest('form').attr('id');

				var entity = {};
				if ($(radio).attr('value') == "Ja") {
					entity.ss_anzeigeimcockpitadmin = true;
				}
				else if ($(radio).attr('value') == "Nein") {
					entity.ss_anzeigeimcockpitadmin = false;
				}

				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							//Success - No Return Data - Do Something
						} else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in updateAnzeigeimCockpitAdmin");
							//  opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entity));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateAnzeigeimCockpitAdmin catch");
			}
		}

		function updateAccount(input) {
			try {
				var accountid = $(input).closest('form').attr('id');

				var form = $(input).closest('form')

				var entityupdateAccount = {};

				var similaraccountid = "";
				if (form[0]["similarAccountdrp"] != undefined) {
					similaraccountid = form[0]["similarAccountdrp"].value;
				}
				//.find('option:selected').val();

				if (similaraccountid != "" && similaraccountid != undefined) {
					entityupdateAccount["ss_similaraccountid@odata.bind"] = "/accounts(" + similaraccountid + ")";
				}
				if (form[0]["FirmennameId"].value != "") {
					entityupdateAccount.ss_firmenname = form[0]["FirmennameId"].value.toString().trim();
				}
				if (form[0]["StrasseId"].value != "") {
					entityupdateAccount.ss_strasse = form[0]["StrasseId"].value.toString().trim();
				}
				if (form[0]["NrId"].value != "") {
					entityupdateAccount.ss_nr = form[0]["NrId"].value.toString().trim();
				}
				if (form[0]["PLZId"].value != "") {
					entityupdateAccount.ss_plz = form[0]["PLZId"].value.toString().trim();
				}
				if (form[0]["OrtId"].value != "") {
					entityupdateAccount.ss_ort = form[0]["OrtId"].value.toString().trim();
				}
				if (form[0]["HomepageId"].value != "") {
					entityupdateAccount.ss_homepage = form[0]["HomepageId"].value.toString().trim();
				}
				if (form[0]["AllgemeineEmailId"].value != "") {
					entityupdateAccount.ss_allgemeineemail = form[0]["AllgemeineEmailId"].value.toString().trim();
				}
				if (form[0]["TelefonId"].value != "") {
					entityupdateAccount.ss_telefon = form[0]["TelefonId"].value.toString().trim();
				}
				if (form[0]["FaxId"].value != "") {
					entityupdateAccount.ss_fax = form[0]["FaxId"].value.toString().trim();
				}
				//new_registerart is optionset
				if (form[0]["RegisterartId"].value != "" && form[0]["RegisterartId"].value != 0) {
					//entityupdateAccount.ss_registerart = form[0]["RegisterartId"].value.toString().trim();
					//added by saad
					entityupdateAccount.ss_registerartoptionset = form[0]["RegisterartId"].value;
				}
				if (form[0]["SteuerschlüsselId"].value != "" && form[0]["SteuerschlüsselId"].value != 0) {
				    //entityupdateAccount.ss_steuerschlssel = form[0]["SteuerschlüsselId"].value.toString().trim();
				    entityupdateAccount.ss_steuerschluesseloptionset = form[0]["SteuerschlüsselId"].value.toString().trim();
				}
				if (form[0]["Fax1Id"].value != "") {
					entityupdateAccount.ss_fax1 = form[0]["Fax1Id"].value.toString().trim();
				}

				if (form[0]["EQS-ID"].value != "") {
					entityupdateAccount.ss_eqsid = form[0]["EQS-ID"].value.toString().trim();
				}
				if (form[0]["Kunden-Nr"].value != "") {
					entityupdateAccount.ss_kundennt = form[0]["Kunden-Nr"].value.toString().trim();
				}
				if (form[0]["ArtderGesellschaftId"].value != "" && form[0]["ArtderGesellschaftId"].value != 0) {
					 //var artdergesellschaftObj = form[0]["ArtderGesellschaftId"];

					//entityupdateAccount.ss_artdergesellschaft = form[0]["ArtderGesellschaftId"].value.toString().trim();
					//entityupdateAccount.ss_artdergesellschafttext = $(artdergesellschaftObj).find(":selected").text();

					//added by saad
					entityupdateAccount.ss_new_company_type = form[0]["ArtderGesellschaftId"].value;
				}
				if (form[0]["R-NrId"].value != "") {
					entityupdateAccount.ss_rnr = form[0]["R-NrId"].value.toString().trim();
				}
				if (form[0]["Ort1Id"].value != "") {
					var ort1Obj = form[0]["Ort1Id"];
					entityupdateAccount.ss_amtsgericht = $(ort1Obj).find(":selected").text();
					//entityupdateAccount.ss_ort1 = $(ort1Obj).find(":selected").text();
					//entityupdateAccount.ss_ort1value = form[0]["Ort1Id"].value.toString().trim();
					//entityupdateAccount.ss_amtsgerichtvalue = $(ort1Obj).find(":selected").text();//changed M107A3

					entityupdateAccount.ss_amtsgerichtvalue = form[0]["Ort1Id"].value;
					entityupdateAccount.ss_registergerichtoptionset = form[0]["Ort1Id"].value;

				}
				if (form[0]["RechtsformId"].value != "" && form[0]["RechtsformId"].value != 0) {
				    entityupdateAccount.ss_rechtsformoptionset = form[0]["RechtsformId"].value;

				}

				if (form[0]["Firmenname1Id"].value != "") {
					entityupdateAccount.ss_firmenname1 = form[0]["Firmenname1Id"].value.toString().trim();
				}
				if (form[0]["Vorname1Id"].value != "") {
					entityupdateAccount.ss_vorname1 = form[0]["Vorname1Id"].value.toString().trim();
				}
				if (form[0]["NameId"].value != "") {
					entityupdateAccount.ss_nachname1 = form[0]["NameId"].value.toString().trim();
				}
				if (form[0]["AbteilungId"].value != "") {
					entityupdateAccount.ss_abteilung1 = form[0]["AbteilungId"].value.toString().trim();
				}
				if (form[0]["Strasse1Id"].value != "") {
					entityupdateAccount.ss_strasse1 = form[0]["Strasse1Id"].value.toString().trim();
				}
				if (form[0]["Nr1Id"].value != "") {
					entityupdateAccount.ss_nr1 = form[0]["Nr1Id"].value.toString().trim();
				}

				if (form[0]["Ort2Id"].value != "") {
					entityupdateAccount.ss_ort11 = form[0]["Ort2Id"].value.toString().trim();
				}
				if (form[0]["PLZ1Id"].value != "") {
					entityupdateAccount.ss_plz1 = form[0]["PLZ1Id"].value.toString().trim();
				}
				if (form[0]["Email1Id"].value != "") {
					entityupdateAccount.ss_email1 = form[0]["Email1Id"].value.toString().trim();
				}
				if (form[0]["Telefon1Id"].value != "") {
					entityupdateAccount.ss_telefon1 = form[0]["Telefon1Id"].value.toString().trim();
				}

				//entity["ss_RelatedOpportunity@odata.bind"] = "/opportunities(" + opportunityId + ")";

				if (form[0]["VornameId"].value != "") {
					entityupdateAccount.ss_vorname = form[0]["VornameId"].value;
				}

				if (form[0]["NachnameId"].value != "") {
					entityupdateAccount.ss_nachname = form[0]["NachnameId"].value.toString().trim();
				}
				if (form[0]["AnredeId"].value != "") {
					entityupdateAccount.ss_anrede = form[0]["AnredeId"].value.toString().trim();
				}

				if (form[0]["EmailId"].value != "") {
					entityupdateAccount.ss_email = form[0]["EmailId"].value.toString().trim();
				}
				if (form[0]["GesellschatsgrId"].value != "") {
					entityupdateAccount.ss_gesellschaftsgre = form[0]["GesellschatsgrId"].value.toString().trim();
				}



				var req = new XMLHttpRequest();
				req.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/ss_xmlchecklisttempaccounts(" + accountid + ")", false);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 204) {
							//Success - No Return Data - Do Something
						} else {
							hideLoadingMessage();
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in updateAccount");
							// opener.Xrm.Utility.alertDialog(this.responseText);
							window.close();
						}
					}
				};
				req.send(JSON.stringify(entityupdateAccount));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateAccount catch");
			}
		}

		function updateKundenGruppe(radio) {
			try {
				var entity = {};
				if ($(radio).attr('value') == "PR Kunde") {
					entity.ss_xmlclienttype = 3;
				}
				else if ($(radio).attr('value') == "Tochter") {
					entity.ss_xmlclienttype = 2;
				}

				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/opportunities(" + opportunityId + ")?$select=_parentaccountid_value", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
				req.onreadystatechange = function () {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);
							var _parentaccountid_value = result["_parentaccountid_value"];
							var _parentaccountid_value_formatted = result["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
							var _parentaccountid_value_lookuplogicalname = result["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

							if (_parentaccountid_value != null) {
								var req1 = new XMLHttpRequest();
								req1.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.1/accounts(" + _parentaccountid_value + ")", true);
								req1.setRequestHeader("OData-MaxVersion", "4.0");
								req1.setRequestHeader("OData-Version", "4.0");
								req1.setRequestHeader("Accept", "application/json");
								req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req1.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
								req1.onreadystatechange = function () {
									if (this.readyState === 4) {
										req1.onreadystatechange = null;
										if (this.status === 204) {
											//Success - No Return Data - Do Something
										} else {
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in updateKundenGruppe");
											// opener.Xrm.Utility.alertDialog(this.responseText);
											window.close();
										}
									}
								};
								req1.send(JSON.stringify(entity));
							}
						} else {
							opener.Xrm.Utility.alertDialog(this.responseText);
							LogExceptioninCRM(errorText, this.status, "error in updateKundenGruppe 2");
							window.close();
						}
					}
				};
				req.send();


				var entityXmlWorkflow = {};
				if ($(radio).attr('value') == "PR Kunde") {
					entityXmlWorkflow.ss_xmlclienttype = 3;
				}
				else if ($(radio).attr('value') == "Tochter") {
					entityXmlWorkflow.ss_xmlclienttype = 2;
				}
				var req1 = new XMLHttpRequest();
				req1.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", true);
				req1.setRequestHeader("OData-MaxVersion", "4.0");
				req1.setRequestHeader("OData-Version", "4.0");
				req1.setRequestHeader("Accept", "application/json");
				req1.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req1.onreadystatechange = function () {
					if (this.readyState === 4) {
						req1.onreadystatechange = null;
						if (this.status === 204) {
							//Success - No Return Data - Do Something
						} else {
							var errorText = JSON.parse(this.responseText).error.message;
							exceptionMessage(errorText);
							LogExceptioninCRM(errorText, this.status, "error in updateKundenGruppe 3");
							//  opener.Xrm.Utility.alertDialog(this.statusText);
						}
					}
				};
				req1.send(JSON.stringify(entityXmlWorkflow));
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in updateKundenGruppe catch");
			}
		}

		function deleteWorkflow() {
			try {
				if (confirm('Are you sure to delete WorkFlow ?')) {

					showLoadingMessage();
					$(".loder-text p").html("Deleting Workflow...");
					if (SharepointFolder == "") {
						var req = new XMLHttpRequest();
						req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/accounts(" + ChicklistEnitityId + ")?$select=ss_sharepointfolder", false);
						req.setRequestHeader("OData-MaxVersion", "4.0");
						req.setRequestHeader("OData-Version", "4.0");
						req.setRequestHeader("Accept", "application/json");
						req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
						req.onreadystatechange = function () {
							if (this.readyState === 4) {
								req.onreadystatechange = null;
								if (this.status === 200) {
									var result = JSON.parse(this.response);
									SharepointFolder = result["ss_sharepointfolder"];
								} else {
									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in deleteWorkflow");
									//opener.Xrm.Utility.alertDialog(this.statusText);
								}
							}
						};
						req.send();
					}

					var processName = "ss_ActionXMLChecklistIntegrationFolderDeletioninSP";
					// SharepointFolder = SharepointFolder.replace(/&/g, "&amp;").replace(/>/g, "&gt;").replace(/</g, "&lt;");
					var requestXML = "";

					requestXML += "<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\">";
					requestXML += "<s:Body>";
					requestXML += "<Execute xmlns=\"http://schemas.microsoft.com/xrm/2011/Contracts/Services\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">";
					requestXML += "<request xmlns:a=\"http://schemas.microsoft.com/xrm/2011/Contracts\">";

					requestXML += "<a:Parameters xmlns:b=\"http://schemas.datacontract.org/2004/07/System.Collections.Generic\">";

					requestXML += "<a:KeyValuePairOfstringanyType>";
					requestXML += "<b:key>FolderURL</b:key>";
					requestXML += "<b:value i:type=\"c:string\" xmlns:c=\"http://www.w3.org/2001/XMLSchema\">" + SharepointFolder + "</b:value>";
					requestXML += "</a:KeyValuePairOfstringanyType>";

					requestXML += "</a:Parameters>";
					requestXML += "<a:RequestId i:nil=\"true\" />";
					requestXML += "<a:RequestName>" + processName + "</a:RequestName>";
					requestXML += "</request>";
					requestXML += "</Execute>";
					requestXML += "</s:Body>";
					requestXML += "</s:Envelope>";

					var req1 = new XMLHttpRequest();
					req1.open("POST", GetClientUrl(), false)
					req1.setRequestHeader("Accept", "application/xml, text/xml, */*");
					req1.setRequestHeader("Content-Type", "text/xml; charset=utf-8");

					//req.setRequestHeader("Accept", "application/json");
					//req.setRequestHeader("Content-Type", "application/json; charset=utf-8");

					req1.setRequestHeader("SOAPAction", "http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");
					req1.send(requestXML);
					if (req1.status == 200) {
						var result = JSON.stringify(req1.response);

					}
					else {
						var errorText = $(req1.responseText).find("Message")[0].innerHTML;
						// var errorText = JSON.parse(req1.responseText).error.message;
						exceptionMessage(errorText);
						LogExceptioninCRM(errorText, this.status, "error in deleteWorkflow 2");

					}


					var form = this;
					var BulkRequests = [];
					var req2 = new XMLHttpRequest();
					req2.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklisttempaccounts?$select=ss_xmlchecklisttempaccountid&$filter=_ss_relatedopportunity_value eq " + opportunityId, false);
					req2.setRequestHeader("OData-MaxVersion", "4.0");
					req2.setRequestHeader("OData-Version", "4.0");
					req2.setRequestHeader("Accept", "application/json");
					req2.setRequestHeader("Content-Type", "application/json; charset=utf-8");
					req2.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
					req2.onreadystatechange = function () {
						if (this.readyState === 4) {
							req2.onreadystatechange = null;
							if (this.status === 200) {
								var results = JSON.parse(this.response);
								for (var i = 0; i < results.value.length; i++) {
									var ss_xmlchecklisttempaccountid = results.value[i]["ss_xmlchecklisttempaccountid"];
									BulkRequests.push(ss_xmlchecklisttempaccountid);
								}
							} else {
								var errorText = JSON.parse(this.responseText).error.message;
								exceptionMessage(errorText);
								LogExceptioninCRM(errorText, this.status, "error in deleteWorkflow 3");
								//  opener.Xrm.Utility.alertDialog(this.statusText);
							}
						}
					};
					req2.send();

					if (BulkRequests.length > 0) {
						var data = [];
						data.push('--batch_123456');
						data.push('Content-Type: multipart/mixed;boundary=changeset_BBB456');
						data.push('');
						//Add requests to the collection
						for (var i = 0; i < BulkRequests.length; i++) {
							data.push('--changeset_BBB456');
							data.push('Content-Type:application/http');
							data.push('Content-Transfer-Encoding:binary');
							var id = i + 1;
							data.push('Content-ID:' + id);
							data.push('');
							data.push('DELETE ' + opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/ss_xmlchecklisttempaccounts(' + BulkRequests[i] + ') HTTP/1.1');
							data.push('Content-Type:application/json;type=entry');
							data.push('');
							data.push('{}');
						}
						data.push('--changeset_BBB456--');
						data.push('--batch_123456--');
						var payload = data.join('\r\n');

						$.ajax({
							method: 'POST',
							url: opener.Xrm.Page.context.getClientUrl() + '/api/data/v8.1/$batch',
							headers: {
								'Content-Type': 'multipart/mixed;boundary=batch_123456',
								'Accept': 'application/json',
								'Odata-MaxVersion': '4.0',
								'Odata-Version': '4.0'

							},
							data: payload,
							async: false,
							success: function (data, textStatus, xhr) {
								var req3 = new XMLHttpRequest();
								req3.open("DELETE", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
								req3.setRequestHeader("Accept", "application/json");
								req3.setRequestHeader("Content-Type", "application/json; charset=utf-8");
								req3.setRequestHeader("OData-MaxVersion", "4.0");
								req3.setRequestHeader("OData-Version", "4.0");
								req3.onreadystatechange = function () {
									if (this.readyState === 4) {
										req3.onreadystatechange = null;
										if (this.status === 204 || this.status === 1223) {
											alert("Workflow Has been deleted");
											$(".loder-text p").html("");
											hideLoadingMessage();
											form.close();

										} else {
											$(".loder-text p").html("");
											hideLoadingMessage();
											var errorText = JSON.parse(this.responseText).error.message;
											exceptionMessage(errorText);
											LogExceptioninCRM(errorText, this.status, "error in deleteWorkflow 4");
											// opener.Xrm.Utility.alertDialog(this.statusText);
										}
									}
								};
								req3.send();
							},
							error: function (xhr, textStatus, errorThrown) {
								alert("Error Occurred \n" + "TextStatus: " + textStatus + "\n ErrorThrown :" + errorThrown);
								//alert(textStatus + " " + errorThrown);
							}
						});

					}
					else {
						var req3 = new XMLHttpRequest();
						req3.open("DELETE", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations(" + ChicklistEnitityId + ")", false);
						req3.setRequestHeader("Accept", "application/json");
						req3.setRequestHeader("Content-Type", "application/json; charset=utf-8");
						req3.setRequestHeader("OData-MaxVersion", "4.0");
						req3.setRequestHeader("OData-Version", "4.0");
						req3.onreadystatechange = function () {
							if (this.readyState === 4) {
								req3.onreadystatechange = null;
								if (this.status === 204 || this.status === 1223) {
									alert("Workflow Has been deleted");
									$(".loder-text p").html("");
									hideLoadingMessage();
									form.close();

								} else {
									$(".loder-text p").html("");
									hideLoadingMessage();
									var errorText = JSON.parse(this.responseText).error.message;
									exceptionMessage(errorText);
									LogExceptioninCRM(errorText, this.status, "error in deleteWorkflow 5");
									//opener.Xrm.Utility.alertDialog(this.statusText);
								}
							}
						};
						req3.send();
					}
				}
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in deleteWorkflow catch");
			}
		}
		function textonly(e) {
			var code;
			if (!e) var e = window.event;
			if (e.keyCode) code = e.keyCode;
			else if (e.which) code = e.which;
			var character = String.fromCharCode(code);
			//alert('Character was ' + character);
			//alert(code);
			//if (code == 8) return true;
			var AllowRegex = /^[\ba-zA-Z\s-]$/;
			if (AllowRegex.test(character)) return true;
			return false;
		}
		function validateNumber(value, min, max) {
			if (parseInt(value) < min || isNaN(parseInt(value)))
				return 0;
			else if (parseInt(value) > max) {
				alert("Maximum value is 225");
				return 225;
			}
			else return value;
		}

		function exceptionMessage(message) {
			alert("An Error Occurred \n Error Message : " + message + "\n \n Please Contact Development Team");
		}


		function LogExceptioninCRM(errorText, status, errorStep) {
			opportunityId = opener.Xrm.Page.data.entity.getId().replace("{", "").replace("}", "");
			var userId = opener.Xrm.Page.context.getUserId().replace("{", "").replace("}", "");

			var entity = {};
			entity.ss_name = "";
			if (status != 0) {
				entity.ss_errorstatus = status;
			}
			entity.ss_errormessage = errorText;
			entity["ss_Opportunity@odata.bind"] = "/opportunities(" + opportunityId + ")";
			entity["ss_User@odata.bind"] = "/systemusers(" + userId + ")";
			if (errorStep != null && errorStep != "") {
				entity["ss_errorstep"] = errorStep;
			}
			var req = new XMLHttpRequest();
			req.open("POST", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistworkflowerrorlogs", false);
			req.setRequestHeader("OData-MaxVersion", "4.0");
			req.setRequestHeader("OData-Version", "4.0");
			req.setRequestHeader("Accept", "application/json");
			req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
			req.onreadystatechange = function () {
				if (this.readyState === 4) {
					req.onreadystatechange = null;
					if (this.status === 204) {
						var uri = this.getResponseHeader("OData-EntityId");
						var regExp = /\(([^)]+)\)/;
						var matches = regExp.exec(uri);
						var newEntityId = matches[1];
					} else {
						// opener.Xrm.Utility.alertDialog(this.statusText);
						var errorText = JSON.parse(this.responseText).error.message;
						exceptionMessage(errorText);
					}
				}
			};
			req.send(JSON.stringify(entity));

		}

		function updateOpportunityAccount(xmlchecklistid) {
			try {

				var opportunityId = opener.Xrm.Page.data.entity.getId();

				if(opportunityId == null || opportunityId == "")
				{
					alert("null opportunity Id");
					return;
				}

				var _ss_wirtschaftsprfer_value = "";
				var req = new XMLHttpRequest();
				req.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/ss_xmlchecklistintegrations("+ xmlchecklistid +")?$select=_ss_muttergesellschaft_value,_ss_wirtschaftsprfer_value,ss_vertragberwirtschaftsprfer,_ss_wpkontakt_value,ss_notizen,ss_vatid,ss_notes,ss_euauslnder,ss_xmlclienttype,ss_vertragurl,ss_firmenlisturl", true);
				req.setRequestHeader("OData-MaxVersion", "4.0");
				req.setRequestHeader("OData-Version", "4.0");
				req.setRequestHeader("Accept", "application/json");
				req.setRequestHeader("Content-Type", "application/json; charset=utf-8");
				req.onreadystatechange = function() {
					if (this.readyState === 4) {
						req.onreadystatechange = null;
						if (this.status === 200) {
							var result = JSON.parse(this.response);

							var _ss_muttergesellschaft_value = result["_ss_muttergesellschaft_value"];

							_ss_wirtschaftsprfer_value = result["_ss_wirtschaftsprfer_value"];
							var ss_vertragberwirtschaftsprfer = result["ss_vertragberwirtschaftsprfer"];
							var ss_vertragberwirtschaftsprfer_formatted = result["ss_vertragberwirtschaftsprfer@OData.Community.Display.V1.FormattedValue"];

							var _ss_wpkontakt_value = result["_ss_wpkontakt_value"];
							var _ss_wpkontakt_value_formatted = result["_ss_wpkontakt_value@OData.Community.Display.V1.FormattedValue"];
							var _ss_wpkontakt_value_lookuplogicalname = result["_ss_wpkontakt_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

							var ss_notizen = result["ss_notizen"];
							var ss_vatid = result["ss_vatid"];
							var ss_notes = result["ss_notes"];
							var ss_euauslnder = result["ss_euauslnder"];

							var ss_xmlclienttype = result["ss_xmlclienttype"];
							var ss_xmlclienttype_formatted = result["ss_xmlclienttype@OData.Community.Display.V1.FormattedValue"];

							var ss_vertragurl = result["ss_vertragurl"];
							var ss_firmenlisturl = result["ss_firmenlisturl"];

							opportunityId = opportunityId.replace(/{/g, "");
							opportunityId = opportunityId.replace(/}/g, "");
							//opener.Xrm.Utility.alertDialog("opportunity id = "+opportunityId);

							var parentAccount = "";
							var req2 = new XMLHttpRequest();
							req2.open("GET", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/opportunities("+opportunityId+")?$select=_parentaccountid_value", true);
							req2.setRequestHeader("OData-MaxVersion", "4.0");
							req2.setRequestHeader("OData-Version", "4.0");
							req2.setRequestHeader("Accept", "application/json");
							req2.setRequestHeader("Content-Type", "application/json; charset=utf-8");
							req2.setRequestHeader("Prefer", "odata.include-annotations=\"*\"");
							req2.onreadystatechange = function() {
								if (this.readyState === 4) {
									req2.onreadystatechange = null;
									if (this.status === 200) {
										var result1 = JSON.parse(this.response);
										var parentAccount = result1["_parentaccountid_value"];
										//opener.Xrm.Utility.alertDialog("opportunity account = "+parentAccount);

										var _parentaccountid_value_formatted = result1["_parentaccountid_value@OData.Community.Display.V1.FormattedValue"];
										var _parentaccountid_value_lookuplogicalname = result1["_parentaccountid_value@Microsoft.Dynamics.CRM.lookuplogicalname"];

										if(parentAccount != "" && parentAccount != null)
										{
											try
											{
												var entity = {};

												if(_ss_muttergesellschaft_value != null)
												{
													entity["parentaccountid@odata.bind"] = "/accounts("+_ss_muttergesellschaft_value+")";
												}
												if(_ss_wirtschaftsprfer_value != null)
												{
													entity["ss_Wirtschaftsprfer@odata.bind"] = "/accounts("+_ss_wirtschaftsprfer_value+")";
												}
												if(ss_vertragberwirtschaftsprfer != null)
												{
													entity.new_contractviawp = ss_vertragberwirtschaftsprfer;
												}
												if(_ss_wpkontakt_value != null)
												{
													entity["new_contactwp@odata.bind"] = "/contacts("+_ss_wpkontakt_value+")";
												}
												if(ss_notizen != "" && ss_notizen != null)
												{
													entity.new_noteswp = ss_notizen;
												}
												else
												{
													entity.new_noteswp = "";
												}
												if(ss_vatid != "" && ss_vatid != null)
												{
													entity.new_vatid = ss_vatid;
												}
												else
												{
													entity.new_vatid = "";
												}
												if(ss_notes != "" && ss_notes != null)
												{
													entity.new_notesxmlchecklist = ss_notes;
												}
												else
												{
													entity.new_notesxmlchecklist = "";
												}
												if(ss_euauslnder != null)
												{
													entity.new_vatapplicaple = ss_euauslnder;
												}
												if(ss_xmlclienttype != null)
												{
													entity.ss_xmlclienttype = ss_xmlclienttype;
												}
												if(ss_vertragurl != "" & ss_vertragurl != null)
												{
													entity.new_xmlcontracturl = ss_vertragurl;
												}
												else
												{
													entity.new_xmlcontracturl = "";
												}
												if(ss_firmenlisturl != "" && ss_firmenlisturl != null)
												{
													entity.new_xmlcompanylisturl = ss_firmenlisturl;
												}
												else
												{
													entity.new_xmlcompanylisturl = "";
												}


												//entity.ss_strassehausnummer = "asdsdf updated";

												var req3 = new XMLHttpRequest();
												req3.open("PATCH", opener.Xrm.Page.context.getClientUrl() + "/api/data/v8.2/accounts("+parentAccount+")", true);
												req3.setRequestHeader("OData-MaxVersion", "4.0");
												req3.setRequestHeader("OData-Version", "4.0");
												req3.setRequestHeader("Accept", "application/json");
												req3.setRequestHeader("Content-Type", "application/json; charset=utf-8");
												req3.onreadystatechange = function() {
													if (this.readyState === 4) {
														req3.onreadystatechange = null;
														if (this.status === 204) {
															alert("opportunity account is successfully updated");
														} else {
															alert(this.statusText);
														}
													}
												};
												req3.send(JSON.stringify(entity));
											}
											catch (e)
											{
												exceptionMessage(e.message);
												LogExceptioninCRM(e.message, 0, "error in updating opportunity account");
											}
										}
										else
										{
											alert("missing parent account id");
										}


									} else {
										alert(this.statusText);
									}
								}
							};
							req2.send();


						} else {
							opener.Xrm.Utility.alertDialog(this.statusText);
						}
					}
				};
				req.send();
			}
			catch (e) {
				exceptionMessage(e.message);
				LogExceptioninCRM(e.message, 0, "error in retrieval of opportunity account");
			}
		}

    </script>
</head>
<body onload="PopulateCrmData()">
    <div class="container">

        <form id="XMLFORM" class="form-style">
            <div class="row xmlhead-background">
                <h1 class="text-center">XML</h1>
            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Kundenname:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="KundennameId" class="form-control" placeholder="" readonly />
                </div>
            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Kundenbetreuer:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="KundenbetreuerId" class="form-control" placeholder="" readonly />
                </div>

            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Amtsgericht:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="AmtsgerichtId" class="form-control" placeholder="" readonly />
                </div>

            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Handelsregisternummer:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="HandelsregisternummerId" class="form-control" placeholder="" readonly />
                </div>

            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Muttergesellschaft:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="MuttergesellschaftId" class="form-control" placeholder="" readonly />
                </div>

            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <br />
                    <label class="control-label">Kundengruppe:</label>
                </div>
                <div class="col-md-4">
                    <div class="radio" id="KundengruppeId">
                        <label><input onchange="updateKundenGruppe(this)" type="radio" id="KundengruppePR" name="Kundengruppe" value="PR Kunde">PR Kunde</label>
                    </div>
                    <div class="radio">
                        <label><input onchange="updateKundenGruppe(this)" type="radio" id="KundengruppeTo" name="Kundengruppe" value="Tochter">Tochter</label>
                    </div>
                </div>

            </div>

            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Preismodell:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="PreismodellId" class="form-control" placeholder="" readonly />
                </div>

            </div>
            <!--<div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Stammdatenblatt vorhanden</label>
                </div>
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-md-6">
                            <label class="checkbox-inline">
                                <input type="checkbox" onchange="uncheckotherCheckBoxIncaseofStammdatenblattVorhanden(this)" id="ja_StammdatenblattVorhanden" value="">Ja
                            </label>
                        </div>
                        <div class="col-md-6">
                            <label class="checkbox-inline">
                                <input type="checkbox" onchange="uncheckotherCheckBoxIncaseofStammdatenblattVorhanden(this)" id="Nein_StammdatenblattVorhanden" value="">Nein
                            </label>
                        </div>
                    </div>
                </div>

            </div>-->
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">Vertrag über Wirtschaftsprüfer</label>
                </div>
                <div class="col-md-4">
                    <div class="row">
                        <div class="col-md-6">
                            <label class="checkbox-inline">
                                <input onchange="uncheckotherBoxIncaseofStammdatenblattVorhanden(this)" type="checkbox" id="ja_VertraguberWirtschaftsprufer" value="">Ja
                            </label>
                        </div>
                        <div class="col-md-6">
                            <label class="checkbox-inline">
                                <input onchange="uncheckotherBoxIncaseofStammdatenblattVorhanden(this)" type="checkbox" id="Nein_VertraguberWirtschaftsprufer" value="">Nein
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row vertragHiddenRow" style="display:none">
                <div class="col-md-12 styleHiddenRow">
                    <div class="row form-group">
                        <div class="col-md-2">
                            <label class="control-label">Wirtschaftsprüfer:</label>
                        </div>
                        <div class="col-md-4">
                            <div class="form-group">
                                <label class="control-label" for="inputGroup">Input Group </label>
                                <div class="input-group">
                                    <input type="text" class="form-control"
                                           placeholder="Search" id="searchCompany" />
                                    <span onclick="SearchAccount()" class="input-group-addon">
                                        <i class="fa fa-search"></i>
                                    </span>
                                </div>
                                <div id="tblsearchResult" class="searchResult" style="display:none">
                                    <table id="accountTable" class="table-custom">

                                        <tbody id="dataTable"></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="row form-group">
                        <div class="col-md-2">
                            <label class="control-label">WP Kontakt:</label>
                        </div>
                        <div class="col-md-4">
                            <select id="contacts" class="form-control"></select>
                        </div>

                    </div>
                    <div class="row form-group">
                        <div class="col-md-2">
                            <label class="control-label">Notizen:</label>
                        </div>
                        <div class="col-md-4">
                            <input type="text" id="NotizenId" class="form-control" placeholder="Comment" />
                        </div>
                    </div>
                </div>
            </div>
            <div class="row form-group">
                <div class="col-md-2">
                    <label class="control-label">EU-Ausländer Umsatzsteuer ID-NR. (VAT-ID) eingeholt:</label>
                </div>
                <div class="col-md-4">
                    <br />
                    <div class="row">
                        <div class="col-md-6">
                            <label class="checkbox-inline">
                                <input type="checkbox" onchange="uncheckotherBoxIncaseofVATID(this)" id="ja_VATID" value="">Ja
                            </label>
                        </div>
                        <div class="col-md-6">

                            <label class="checkbox-inline">
                                <input type="checkbox" onchange="uncheckotherBoxIncaseofVATID(this)" id="Nein_VATID" value="">Nein
                            </label>
                        </div>
                    </div>
                </div>

            </div>
            <div class="row form-group vatHiddenRow" style="display:none">
                <div class="col-md-2 styleHiddenRow">
                    <label class="control-label">VAT-ID:</label>
                </div>
                <div class="col-md-4">
                    <input type="text" id="VATIDId" class="form-control" placeholder="" />
                </div>

            </div>
            <div class="row form-group">
                <div class="col-md-2 ">
                    <label class="control-label">Notes:</label>
                </div>
                <div class="col-md-4">
                    <textarea id="noteId" class="form-control" rows="5" placeholder="Notes input area"></textarea>
                </div>

            </div>
            <div class="row form-group">
                <!--<div class="col-md-4 text-center">
                    <label class="control-label">Stammdatenblatt:</label>
                    <div class="text-center uploadbtnbox">
                        <img src="ss_addNewFile" class="center-block" width="50" height="50" />
                        <label class="btn btn-primary btn-file uploadbtn">
                            Upload File <input type="file" class="filestyle" id="StammdatenblattFile" onchange="uploadStammdatenblattFile()" multiple>
                        </label>

                    </div>
                </div>-->
                <div class="col-md-1">

                </div>
                <div class="col-md-5 text-center">
                    <label class="control-label">Vertrag:</label>
                    <div class="text-center uploadbtnbox">
                        <img src="ss_addNewFile" class="center-block" width="50" height="50" />

                        <label class="btn btn-primary btn-file uploadbtn">
                            Upload File <input type="file" class="filestyle" id="VertragFile" onchange="uploadVertragFile()" multiple>
                        </label>

                    </div>
                </div>
                <div class="col-md-5 text-center">
                    <label class="control-label">Firmenliste:</label>
                    <div class="text-center uploadbtnbox">
                        <img src="ss_addNewFile" class="center-block" width="50" height="50" />

                        <label class="btn btn-primary btn-file uploadbtn">
                            Upload File <input type="file" class="filestyle" id="FirmenlisteFile" onchange="uploadFirmenlisteFile()">
                        </label>

                    </div>
                </div>

                <div class="col-md-1">

                </div>
            </div>
            <div class="row form-group">
                <div class="col-sm-12 text-center">
                    <button id="cntBtnsaveXml" type="button" onclick="SaveXMLData()" class="btn btn-primary btn-lg"> CONTINUE</button>
                </div>
            </div>
        </form>
        <div class="form-style">
            <div class="row newsroomhead-background">
                <h1 class="text-center">Newsroom</h1>
            </div>
            <!--<div class="row">
                <div class="col-md-8 text-right">
                    <button type="button" class="btn btn-primary">Print</button>
                    <button type="button" class="btn btn-primary">Download Excel</button>
                </div>
            </div>-->
            <div class="row form-group">
                <div id="accountList" class="col-md-8">

                </div>
                <div class="col-md-4">
                    <form id="sideForm" class="form-style">
                        <div class="row form-group form-inline">
                            <div class="col-md-3">
                                <label class="control-label">Verified by XML</label>
                            </div>
                            <div class="col-md-9 text-right">

                                <input type="text" id="verifiedByXMLLookup" class="form-control input-sm right-block" placeholder="" readonly />
                            </div>
                        </div>

                        <div class="row form-group form-inline">
                            <div style="word-wrap: break-word" class="col-md-12 text-left">
                                <ul id="urlLink"></ul>
                            </div>
                            <div class="col-md-12 text-left" style="word-wrap: break-word">
                                <ul>
                                    <li>
                                        <a href="" style="display:none" id="FirmenlisteUrl" onclick="downloadFiles(this)"></a>
                                    </li>
                                </ul>
                            </div>
                        </div>


                        <div class="row form-group form-inline">
                            <div class="col-md-3">
                                <label class="control-label">Verified by Newsroom:</label>
                            </div>
                            <div class="col-md-9 text-right">
                                <input type="text" id="KundenbetreuerLookup" class="form-control input-sm right-block" placeholder="" readonly />
                            </div>
                        </div>

                        <!--<div class="row form-group form-inline">
                            <div class="col-md-3">
                                <label class="control-label">Kundenbetreuer Accounting</label>
                            </div>
                            <div class="col-md-9 text-right">
                                <input type="text" id="KundenbetreuerAccounting " class="form-control input-sm right-block" placeholder="" readonly />
                            </div>
                        </div>-->
                        <!--<div class="row form-group form-inline">
                            <div class="col-md-12">
                                <div class="row form-group">
                                    <div class="col-md-9">
                                        <label class="control-label">Anlegen der Unternehmensdaten im Company Admin bzw. Main Admin!</label>
                                    </div>

                                    <div class="col-md-3">
                                        <label class="checkbox-inline">
                                            <input id="CompanyAdminCheckBox" type="checkbox" class="checkbox-lg" value="">
                                        </label>
                                    </div>
                                </div>

                            </div>
                        </div>-->
                        <!--<div class="row form-group">
                            <div class="col-md-8 right-form">
                                <p class="control-label ">(http://admin.equitystory.com)</p>
                                <br />
                                <p>- Kunden-Nr. vergeben (liste)</p>
                                <p>- "Kunde im IR-Admin verf�gbar anklicken"</p>
                                <p>- Kunde in UReg anlegen (Rechnungsda ten = Kundenanschrift)</p>
                                <p>- Felder Unternehmens register a�sfull en</p>
                                <p>- Felder XML-Accounting Ausf�llen</p>
                                <p>- Ubernahme der Angaben aus Stammdatenblatt (Steuerschl�ss el, Rechtsform, Registerart, Register-Nr.)</p>
                            </div>
                        </div>-->
                        <div class="row form-group form-inline">
                            <div class="col-md-9">
                                <label class="control-label">Company-ID im CRM eintragen. evtl. Verknüpfung mit Mutter</label>
                            </div>

                            <div class="col-md-3">
                                <label class="checkbox-inline">
                                    <input id="CompanyIDimCRMCheckBox" type="checkbox" class="checkbox-lg" value="">
                                </label>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row form-group">
                <div class="col-sm-12 text-left form-inline" style="margin-left: 10%">

                    <button id="verifiedByXMLtxt" onclick="VerifiedByXML()" type="button" class="btn btn-primary btn-lg"> Verified by XML</button>
                    <button id="verifiedByNewsroomtxt" onclick="VerifiedByNewsroom()" type="button" class="btn btn-primary btn-lg" disabled="disabled"> Verified by NewsRoom</button>
                    <button id="continuebtn" onclick="sendEmailToAccounting()" type="button" class="btn btn-primary btn-lg" disabled="disabled"> Continue</button>

                </div>
            </div>
            <!--<div class="row form-group">
                <div class="col-sm-12 text-center">
                    <button id="continuebtn" onclick="sendEmailToAccounting()" type="button" class="btn btn-primary btn-lg" disabled="disabled"> Continue</button>
                </div>
            </div>-->
        </div>

        <form class="form-style">
            <div class="row accountinghead-background">
                <h1 class="text-center">Accounting</h1>
            </div>
            <div class="row form-group form-horizontal">
                <div class="col-md-5 col-md-offset-3 form-accounting">
                    <label id="accountingLable" class="control-label">Datenpflege in Navision:</label>
                    <input id="accountingCheckbox" type="checkbox" onchange="checkedByAccounting(this)" class="checkbox-lg" value="" disabled="disabled">
                    <button id="finishBtn" onclick="finish()" type="button" class="btn btn-primary btn-lg" disabled="disabled"> Finish</button>
                </div>
            </div>
        </form>

        <div class="del-btn text-center">
            <button id="deleteWorkflowbtn" type="button" onclick="deleteWorkflow()" class="btn btn-primary btn-lg"> Delete Workflow</button>
        </div>
    </div>

    <div id="msgDiv">
        <div id="page-preloader">
            <span class="spinner border-t_second_b border-t_prim_a"></span>
            <div class="loder-text"><p>Loading...</p></div>
        </div>
    </div>
</body>
</html>